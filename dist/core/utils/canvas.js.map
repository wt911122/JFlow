{"version":3,"sources":["core/utils/canvas.js"],"names":["createCanvas","wrapper","canvas","document","createElement","ctx","getContext","getBoundingClientRect","width","height","left","top","style","userSelect","scale","window","devicePixelRatio","Math","floor","position","append","raw_width","raw_height","caheCanvas","caheCanvasctx","requestCacheCanvas","render","clearRect","save","restore"],"mappings":";;;;;;;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;AACA;AACA;AACA;AACO,SAASA,YAAT,CAAsBC,OAAtB,EAA+B;AAClC,MAAMC,MAAM,GAAGC,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAf;AACA,MAAMC,GAAG,GAAGH,MAAM,CAACI,UAAP,CAAkB,IAAlB,CAAZ;;AACA,8BAAqCL,OAAO,CAACM,qBAAR,EAArC;AAAA,MAAQC,KAAR,yBAAQA,KAAR;AAAA,MAAeC,MAAf,yBAAeA,MAAf;AAAA,MAAuBC,IAAvB,yBAAuBA,IAAvB;AAAA,MAA6BC,GAA7B,yBAA6BA,GAA7B;;AACAT,EAAAA,MAAM,CAACU,KAAP,CAAaJ,KAAb,GAAqBA,KAAK,GAAG,IAA7B;AACAN,EAAAA,MAAM,CAACU,KAAP,CAAaH,MAAb,GAAsBA,MAAM,GAAG,IAA/B;AACAP,EAAAA,MAAM,CAACU,KAAP,CAAaC,UAAb,GAA0B,MAA1B;AACA,MAAMC,KAAK,GAAGC,MAAM,CAACC,gBAArB;AACAd,EAAAA,MAAM,CAACM,KAAP,GAAeS,IAAI,CAACC,KAAL,CAAWV,KAAK,GAAGM,KAAnB,CAAf;AACAZ,EAAAA,MAAM,CAACO,MAAP,GAAgBQ,IAAI,CAACC,KAAL,CAAWT,MAAM,GAAGK,KAApB,CAAhB;;AAEA,MAAGb,OAAH,EAAY;AACRA,IAAAA,OAAO,CAACW,KAAR,CAAcO,QAAd,GAAyB,UAAzB;AACAlB,IAAAA,OAAO,CAACmB,MAAR,CAAelB,MAAf;AACH;;AACD,SAAO;AACHA,IAAAA,MAAM,EAANA,MADG;AAEHM,IAAAA,KAAK,EAALA,KAFG;AAGHC,IAAAA,MAAM,EAANA,MAHG;AAIHY,IAAAA,SAAS,EAAEnB,MAAM,CAACM,KAJf;AAKHc,IAAAA,UAAU,EAAEpB,MAAM,CAACO,MALhB;AAMHC,IAAAA,IAAI,EAAJA,IANG;AAOHC,IAAAA,GAAG,EAAHA,GAPG;AAQHN,IAAAA,GAAG,EAAHA,GARG;AASHS,IAAAA,KAAK,EAALA;AATG,GAAP;AAWH;;AAED,IAAMS,UAAU,GAAGpB,QAAQ,CAACC,aAAT,CAAuB,QAAvB,CAAnB;AACAmB,UAAU,CAACf,KAAX,GAAmB,CAAnB;AACAe,UAAU,CAACd,MAAX,GAAoB,CAApB;AACA,IAAMe,aAAa,GAAGD,UAAU,CAACjB,UAAX,CAAsB,IAAtB,CAAtB;AACA,IAAMQ,KAAK,GAAGC,MAAM,CAACC,gBAArB;AACAQ,aAAa,CAACV,KAAd,CAAoBA,KAApB,EAA2BA,KAA3B;AAEA;AACA;AACA;AACA;;AACO,SAASW,kBAAT,CAA4BC,MAA5B,EAAoC;AACvCF,EAAAA,aAAa,CAACG,SAAd,CAAwB,CAAxB,EAA0B,CAA1B,EAA4B,CAA5B,EAA8B,CAA9B;AACAH,EAAAA,aAAa,CAACI,IAAd;AACAF,EAAAA,MAAM,CAACF,aAAD,CAAN;AACAA,EAAAA,aAAa,CAACK,OAAd;AACAL,EAAAA,aAAa,CAACG,SAAd,CAAwB,CAAxB,EAA0B,CAA1B,EAA4B,CAA5B,EAA8B,CAA9B;AACH","sourcesContent":["\n/**\n * @typedef {Object} CanvasMeta\n * @property {Element} canvas - canvas 元素\n * @property {number} width - 画布宽度\n * @property {number} height - 画布高度\n * @property {number} raw_width - 画布元素宽度\n * @property {number} raw_height - 画布元素高度\n * @property {number} left - 画布距离左端距离\n * @property {number} top - 画布距离顶端距离\n * @property {Context2d} ctx - Context2d\n * @property {number} scale - 当前的像素设备比\n */\n/**\n * 创建一个 canvas 元素\n * @param  {Element} wrapper - dom元素\n * @return {CanvasMeta}\n */\nexport function createCanvas(wrapper) {\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n    const { width, height, left, top } = wrapper.getBoundingClientRect();\n    canvas.style.width = width + \"px\";\n    canvas.style.height = height + \"px\";\n    canvas.style.userSelect = 'none';\n    const scale = window.devicePixelRatio;\n    canvas.width = Math.floor(width * scale);\n    canvas.height = Math.floor(height * scale);\n\n    if(wrapper) {\n        wrapper.style.position = 'relative';\n        wrapper.append(canvas);\n    }\n    return {\n        canvas,\n        width,\n        height,\n        raw_width: canvas.width,\n        raw_height: canvas.height,\n        left,\n        top,\n        ctx,\n        scale,\n    }\n}\n\nconst caheCanvas = document.createElement('canvas');\ncaheCanvas.width = 1;\ncaheCanvas.height = 1;\nconst caheCanvasctx = caheCanvas.getContext('2d');\nconst scale = window.devicePixelRatio;\ncaheCanvasctx.scale(scale, scale);\n\n/**\n * 在离线canvas上绘制元素\n * @param  {render} render - 绘图函数\n */\nexport function requestCacheCanvas(render) {\n    caheCanvasctx.clearRect(0,0,5,5);\n    caheCanvasctx.save();\n    render(caheCanvasctx);\n    caheCanvasctx.restore();\n    caheCanvasctx.clearRect(0,0,5,5);\n}"],"file":"canvas.js"}
{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/utils/canvas.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/utils/constance.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/utils/functions.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/stack.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/instance.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/polyline-link.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/stackMixin.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/layoutMixin.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/messageMixin.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/node.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/point.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/events/index.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/rectangle.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/group.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/text.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/image.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/base-link.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/link.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/bezier-link.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/layout/linear-layout.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/layout/low-code-types/baseNode.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/layout/low-code-layout.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/flow/index.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/components/StackMixin.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/components-template/JFlow.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/components/JFlowInstance.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/components/JFlowLink.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/components/JFlowGroup.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/JFlowPlugin.js","webpack:///./src/App.vue?0180","webpack:///./src/components/variable.vue?7b87","webpack:///src/components/variable.vue","webpack:///./src/components/variable.vue?635d","webpack:///./src/components/variable.vue","webpack:///./src/components/ifstatement.vue?ee55","webpack:///src/components/ifstatement.vue","webpack:///./src/components/ifstatement.vue?d165","webpack:///./src/components/ifstatement.vue","webpack:///./src/components/start.vue?bea5","webpack:///src/components/start.vue","webpack:///./src/components/start.vue?989d","webpack:///./src/components/start.vue","webpack:///./src/components/end.vue?9b1a","webpack:///src/components/end.vue","webpack:///./src/components/end.vue?df4a","webpack:///./src/components/end.vue","webpack:///./src/components/endpoint.vue?6c61","webpack:///src/components/endpoint.vue","webpack:///./src/components/endpoint.vue?fad3","webpack:///./src/components/endpoint.vue","webpack:///./src/components/switch.vue?1f05","webpack:///./src/components/switchcase.vue?6ee9","webpack:///src/components/switchcase.vue","webpack:///./src/components/switchcase.vue?48a4","webpack:///./src/components/switchcase.vue","webpack:///src/components/switch.vue","webpack:///./src/components/switch.vue?8fad","webpack:///./src/components/switch.vue","webpack:///./src/components/whilestatement.vue?b6c8","webpack:///src/components/whilestatement.vue","webpack:///./src/components/whilestatement.vue?e5d2","webpack:///./src/components/whilestatement.vue","webpack:///./src/components/callLogic.vue?c3ab","webpack:///src/components/callLogic.vue","webpack:///./src/components/callLogic.vue?735a","webpack:///./src/components/callLogic.vue","webpack:///src/App.vue","webpack:///./src/App.vue?4c4f","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/App.vue?fd8d","webpack:///./src/assets/logic.svg","webpack:///./src/App.vue?8544"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","createCanvas","wrapper","canvas","document","createElement","ctx","getContext","getBoundingClientRect","width","height","left","top","style","scale","devicePixelRatio","Math","floor","position","append","raw_width","raw_height","caheCanvas","caheCanvasctx","requestCacheCanvas","render","clearRect","save","restore","DIRECTION","RIGHT","BOTTOM","LEFT","TOP","APPROXIMATE","bounding_box","points","min_x","Infinity","min_y","max_x","max_y","idx","item","max","x","y","sqr","dist2","v","w","distToSegmentSquared","l2","min","bezierPoints","p1","p2","start_dir","end_dir","anticlock","isSameDirection","isVerticalStart","includes","isVerticalEnd","arrowspan","endX","endY","span","abs","symb","cp1","cp2","spanStart","spanEnd","u1","u2","distToBezierSegmentSquared","b","Bezier","point","project","getBezierAngle","sx","sy","cp1x","cp1y","cp2x","cp2y","ex","ey","dx","pow","dy","atan2","PI","InstanceStack","movingTarget","this","forEach","instance","_isMoving","visible","reflow","_reflowed","condition","ignoreHit","ishit","isHit","_isHit","getBoundingRect","Array","ishitKey","Instance","configs","assign","status","hover","focus","moving","_belongs","undefined","_layoutNode","borderWidth","borderColor","hoverStyle","content","color","strokeColor","fontFamily","fontSize","textColor","textAlign","textBaseline","_jflow","_target","link","_getMovingTarget","dispatchEvent","CustomEvent","detail","uniqueName","keys","k","anchor","rect","customEvent","console","log","bubbles","bubbleEvent","type","calculateToRealWorld","remove","EventTarget","LinkPolyline","from","to","conrolNodes","controlPoint","defaultStyle","start","calculateIntersectionInFourDimension","getCenter","end","_calculateAnchorPoints","diffDIR","dir","mid","fillStyle","strokeStyle","getColor","beginPath","moveTo","lineTo","stroke","endP","closePath","fill","lx","rx","by","ty","StackMixin","instances","links","_stack","_linkStack","initStack","addToStack","replaceFromStack","target","index","findIndex","addToLinkStack","removeFromStack","removeFromLinkStack","emptyLink","addInstanceToLink","targetLink","_constuctor","__proto__","constructor","l1","LayoutMixin","_layout","initLayout","layout","recalculateUp","recalculate","_getBoundingGroupRect","staticCheck","MessageMixin","_message","sendMessage","msg","consumeMessage","Node","margin","p0","p3","h","Point","radius","radiusExpo2","globalAlpha","arc","_isTargeting","renderFocus","ltx","lty","rbx","rby","x1","y1","x2","y2","vecx","vecy","dist","sqrt","ratio","allIntersections","interDir","checkLinked","JFlowEvent","event","originEvent","jflow","Rectangle","borderRadius","quadraticCurveTo","theta1","theta2","dirx","diry","calculateToCoordination","JSON","stringify","_intersections","Group","definedWidth","definedHeight","padding","hasShrink","lock","shrink","offsetY","offsetX","getBoundingRectPoints","bbox","spanV","spanH","translate","gx","gy","_calculatePointBack","_currentp","checkHit","cx","cy","createInputElement","params","input","setAttribute","Text","lineHeight","indent","backgroundColor","editable","acceptPatten","editStatus","editting","renderShadowText","_makeEditable","addEventListener","exec","inputElement","DOMwrapper","oldVal","transform","calculateToRealWorldWithScalar","textIndent","_render","outline","blurHandler","val","e","keyCode","font","measureText","actualBoundingBoxLeft","actualBoundingBoxRight","fontBoundingBoxAscent","fontBoundingBoxDescent","fillText","Icon","image","onload","requestAnimationFrame","imageBounding","imageWidth","imageHeight","drawImage","BaseLink","fromDir","toDir","_cachePoints","Link","controlPoints","calculateIntersection","startX","startY","len","sin","cos","a","BezierLink","getIntersectionsInFourDimension","angle","bezierCurveTo","rotate","LinearLayout","direction","gap","alignment","group","stack","filter","outOfFlow","reduceHeight","lastInstanceHeight","maxWidth","getBoundingDimension","reduceWidth","lastInstanceWidth","maxHeight","BaseNode","source","id","getJflowInstance","level","sequence","isLocked","isFree","parent","parentIterateType","callback","spanX","spanY","nodes","traverse","Root","isroot","body","map","mapFunc","playgrounditerator","playground","reflowPreCalculate","preCallback","node","last","part","meta","makeLink","IfStatement","consequent","alternate","c_spanX","c_spanY","a_spanX","a_spanY","nextSequeence","Endpoint","lastc","lasta","makeAST","linkMeta","unshift","SwitchStatement","cases","lastCase","cc","s_spanX","s_spanY","ca","ForEachStatement","WhileStatement","SwitchCase","TYPE_MAPPING","other","makeEndpoint","Constructor","LowcodeLayout","linkLength","reOrder","ast","static","flowStack","flowLinkStack","root","layoutMeta","currentTopNodeId","layoutMapping","vertical","horizontal","playgroundLayoutMapping","reflowBodyPreCalculate","reflowPlaygroundPreCalculate","topNode","finded","find","nowAnchor","currentAnchor","verticalMapping","horizontalMapping","columnNumber","column","rowWidth","rows","rowNumber","row","rowHeight","columns","reflowByMapping","values","mapping","JFlow","plugins","dpr","maxZoom","minZoom","offeset","_lastState","dragging","processing","_lastDragState","isInstanceDirty","isLinkDirty","cache","belongs","initialX","initialY","dragovering","_lastFocus","allowDrop","plugin","dom","c_width","c_height","canvasMeta","actual_width","actual_height","_createEventHandler","p_width","p_height","contentBox","w_ratio","h_ratio","align","scaleRatio","nowx","nowy","destroyListener","zoomHandler","_onZoom","pressStartHandler","_onPressStart","pressMoveHandler","_onPressMove","pressUpHandler","_onPressUp","pressUpDocument","_onPressUpDocument","contextmenuHandler","_onContextMenu","preventDefault","destroyPlainEventListener","removeEventListener","dragoverHandler","_onDragover","dropHandler","_onDrop","destroy","offsetPoint","linkStack","movingtarget","getNodes","_targetLockOn","payload","clientX","clientY","_zooming","deltaY","newScale","amount","deltaScale","currentWidth","currentHeight","deltaWidth","deltaHeight","tX","tY","pX","pY","button","cursor","deltaX","_recalculatePosition","isDocument","stopPropagation","_clearTarget","checkresult","setTransform","_resetTransform","provide","getInstanceByName","methods","obj","_jflowInstance","onStackChangeHandler","mixins","renderJFlow","addNameToRootStack","props","default","vnodes","$scopedSlots","vnode","componentInstance","$children","vlinks","$slots","created","mounted","$nextTick","$mount","$el","$listeners","func","layoutNodes","freeNodes","ln","concat","getInstance","nameNode","bulder","JFlowInstance","inject","String","watch","diffed","diff","reflowKeys","lk","toLowerCase","endsWith","setConfig","news","deletes","vnew","handler","vold","hnew","q","hold","bindListeners","destroyed","isLink","resetLink","fromInstance","toInstance","$vnode","addToBelongStack","removeFromBelongStack","JFLOW_NODES","JFLOW_LINKS","components","component","JFlowComponent","JFLowGroup","JFlowLink","componentPrefix","install","Vue","options","prefixToUse","prefix","custom","_vm","_h","$createElement","_c","_self","class","$style","attrs","sidebar","on","onDragStartRectangle","_v","onDragStartPoint","staticStyle","ref","onClickNoWhere","onDrop","onPressEnd","scopedSlots","_u","fn","$event","onPressStart","onOutOfFlow","onChangeContent","onToggleSelect","onDropToLink","hoverblock","_l","onSelectLogic","_s","_e","domProps","prettyJson","staticRenderFns","_g","groupConfig","onContentChange","onMouseEnter","onMouseLeave","switchcase","headerConfigs","imageConfig","contentConfigs","onClick","paramsConfigs","param","injectStyles","context","locals","config","productionTip","use","JFlowVuePlugin","App"],"mappings":"aACE,SAASA,EAAqBC,GAQ7B,IAPA,IAMIC,EAAUC,EANVC,EAAWH,EAAK,GAChBI,EAAcJ,EAAK,GACnBK,EAAiBL,EAAK,GAIHM,EAAI,EAAGC,EAAW,GACpCD,EAAIH,EAASK,OAAQF,IACzBJ,EAAUC,EAASG,GAChBG,OAAOC,UAAUC,eAAeC,KAAKC,EAAiBX,IAAYW,EAAgBX,IACpFK,EAASO,KAAKD,EAAgBX,GAAS,IAExCW,EAAgBX,GAAW,EAE5B,IAAID,KAAYG,EACZK,OAAOC,UAAUC,eAAeC,KAAKR,EAAaH,KACpDc,EAAQd,GAAYG,EAAYH,IAG/Be,GAAqBA,EAAoBhB,GAE5C,MAAMO,EAASC,OACdD,EAASU,OAATV,GAOD,OAHAW,EAAgBJ,KAAKK,MAAMD,EAAiBb,GAAkB,IAGvDe,IAER,SAASA,IAER,IADA,IAAIC,EACIf,EAAI,EAAGA,EAAIY,EAAgBV,OAAQF,IAAK,CAG/C,IAFA,IAAIgB,EAAiBJ,EAAgBZ,GACjCiB,GAAY,EACRC,EAAI,EAAGA,EAAIF,EAAed,OAAQgB,IAAK,CAC9C,IAAIC,EAAQH,EAAeE,GACG,IAA3BX,EAAgBY,KAAcF,GAAY,GAE3CA,IACFL,EAAgBQ,OAAOpB,IAAK,GAC5Be,EAASM,EAAoBA,EAAoBC,EAAIN,EAAe,KAItE,OAAOD,EAIR,IAAIQ,EAAmB,GAKnBhB,EAAkB,CACrB,IAAO,GAGJK,EAAkB,GAGtB,SAASS,EAAoB1B,GAG5B,GAAG4B,EAAiB5B,GACnB,OAAO4B,EAAiB5B,GAAU6B,QAGnC,IAAIC,EAASF,EAAiB5B,GAAY,CACzCK,EAAGL,EACH+B,GAAG,EACHF,QAAS,IAUV,OANAf,EAAQd,GAAUW,KAAKmB,EAAOD,QAASC,EAAQA,EAAOD,QAASH,GAG/DI,EAAOC,GAAI,EAGJD,EAAOD,QAKfH,EAAoBM,EAAIlB,EAGxBY,EAAoBO,EAAIL,EAGxBF,EAAoBQ,EAAI,SAASL,EAASM,EAAMC,GAC3CV,EAAoBW,EAAER,EAASM,IAClC3B,OAAO8B,eAAeT,EAASM,EAAM,CAAEI,YAAY,EAAMC,IAAKJ,KAKhEV,EAAoBe,EAAI,SAASZ,GACX,qBAAXa,QAA0BA,OAAOC,aAC1CnC,OAAO8B,eAAeT,EAASa,OAAOC,YAAa,CAAEC,MAAO,WAE7DpC,OAAO8B,eAAeT,EAAS,aAAc,CAAEe,OAAO,KAQvDlB,EAAoBmB,EAAI,SAASD,EAAOE,GAEvC,GADU,EAAPA,IAAUF,EAAQlB,EAAoBkB,IAC/B,EAAPE,EAAU,OAAOF,EACpB,GAAW,EAAPE,GAA8B,kBAAVF,GAAsBA,GAASA,EAAMG,WAAY,OAAOH,EAChF,IAAII,EAAKxC,OAAOyC,OAAO,MAGvB,GAFAvB,EAAoBe,EAAEO,GACtBxC,OAAO8B,eAAeU,EAAI,UAAW,CAAET,YAAY,EAAMK,MAAOA,IACtD,EAAPE,GAA4B,iBAATF,EAAmB,IAAI,IAAIM,KAAON,EAAOlB,EAAoBQ,EAAEc,EAAIE,EAAK,SAASA,GAAO,OAAON,EAAMM,IAAQC,KAAK,KAAMD,IAC9I,OAAOF,GAIRtB,EAAoB0B,EAAI,SAAStB,GAChC,IAAIM,EAASN,GAAUA,EAAOiB,WAC7B,WAAwB,OAAOjB,EAAO,YACtC,WAA8B,OAAOA,GAEtC,OADAJ,EAAoBQ,EAAEE,EAAQ,IAAKA,GAC5BA,GAIRV,EAAoBW,EAAI,SAASgB,EAAQC,GAAY,OAAO9C,OAAOC,UAAUC,eAAeC,KAAK0C,EAAQC,IAGzG5B,EAAoB6B,EAAI,GAExB,IAAIC,EAAaC,OAAO,gBAAkBA,OAAO,iBAAmB,GAChEC,EAAmBF,EAAW3C,KAAKsC,KAAKK,GAC5CA,EAAW3C,KAAOf,EAClB0D,EAAaA,EAAWG,QACxB,IAAI,IAAItD,EAAI,EAAGA,EAAImD,EAAWjD,OAAQF,IAAKP,EAAqB0D,EAAWnD,IAC3E,IAAIU,EAAsB2C,EAI1BzC,EAAgBJ,KAAK,CAAC,EAAE,kBAEjBM,K,kvBCrIF,SAASyC,EAAaC,GACzB,IAAMC,EAASC,SAASC,cAAc,UAChCC,EAAMH,EAAOI,WAAW,MAC9B,EAAqCL,EAAQM,wBAArCC,EAAR,EAAQA,MAAOC,EAAf,EAAeA,OAAQC,EAAvB,EAAuBA,KAAMC,EAA7B,EAA6BA,IAC7BT,EAAOU,MAAMJ,MAAQA,EAAQ,KAC7BN,EAAOU,MAAMH,OAASA,EAAS,KAC/B,IAAMI,EAAQhB,OAAOiB,iBAQrB,OAPAZ,EAAOM,MAAQO,KAAKC,MAAMR,EAAQK,GAClCX,EAAOO,OAASM,KAAKC,MAAMP,EAASI,GAEjCZ,IACCA,EAAQW,MAAMK,SAAW,WACzBhB,EAAQiB,OAAOhB,IAEZ,CACHA,SACAM,QACAC,SACAU,UAAWjB,EAAOM,MAClBY,WAAYlB,EAAOO,OACnBC,OACAC,MACAN,MACAQ,SAIR,IAAMQ,EAAalB,SAASC,cAAc,UAC1CiB,EAAWb,MAAQ,EACnBa,EAAWZ,OAAS,EACpB,IAAMa,EAAgBD,EAAWf,WAAW,MACtCO,EAAQhB,OAAOiB,iBAcd,SAASS,EAAmBC,GAC/BF,EAAcG,UAAU,EAAE,EAAE,EAAE,GAC9BH,EAAcI,OACdF,EAAOF,GACPA,EAAcK,UACdL,EAAcG,UAAU,EAAE,EAAE,EAAE,GAlBlCH,EAAcT,MAAMA,EAAOA,G,wEC7Cde,EAAY,CAErBC,MAAO,EAEPC,OAAQ,EAERC,KAAM,EAENC,IAAK,GAYF,IAAMC,EAAc,ECfpB,SAASC,EAAaC,GACzB,IAAIC,EAAQC,IACRC,EAAQD,IACRE,GAASF,IACTG,GAASH,IACb,IAAI,IAAII,KAAON,EAAQ,CACnB,IAAMO,EAAOP,EAAOM,GACjBC,EAAK,GAAKN,IACTA,EAAQM,EAAK,IAGbA,EAAK,GAAKH,IACVA,EAAQG,EAAK,IAGbA,EAAK,GAAKJ,IACVA,EAAQI,EAAK,IAGbA,EAAK,GAAKF,IACVA,EAAQE,EAAK,IAGrB,MAAO,CAEHlC,MAAOO,KAAK4B,IAAIJ,EAAQH,EAAO,IAC/B3B,OAAQM,KAAK4B,IAAIH,EAAQF,EAAO,IAChCM,EAAGR,EACHS,EAAGP,GAIX,SAASQ,EAAIF,GACT,OAAOA,EAAIA,EAEf,SAASG,EAAMC,EAAGC,GACd,OAAOH,EAAIE,EAAE,GAAKC,EAAE,IAAMH,EAAIE,EAAE,GAAKC,EAAE,IAMpC,SAASC,EAAqBvD,EAAGqD,EAAGC,GACvC,IAAME,EAAKJ,EAAMC,EAAGC,GACpB,GAAW,IAAPE,EAAU,OAAOJ,EAAMpD,EAAGqD,GAC9B,IAAI/D,IAAMU,EAAE,GAAKqD,EAAE,KAAOC,EAAE,GAAKD,EAAE,KAAOrD,EAAE,GAAKqD,EAAE,KAAOC,EAAE,GAAKD,EAAE,KAAOG,EAE1E,OADAlE,EAAI8B,KAAK4B,IAAI,EAAG5B,KAAKqC,IAAI,EAAGnE,IACrB8D,EAAMpD,EAAG,CAAEqD,EAAE,GAAK/D,GAAKgE,EAAE,GAAKD,EAAE,IAAKA,EAAE,GAAK/D,GAAKgE,EAAE,GAAKD,EAAE,MAI9D,SAASK,EAAaC,EAAIC,GAA2E,IAAvEC,EAAuE,uDAA3D5B,EAAUI,IAAKyB,EAA4C,uDAAlC7B,EAAUI,IAAK0B,EAAmB,wDAClGC,EAAkBH,IAAcC,EAChCG,EAAkB,CAAChC,EAAUI,IAAKJ,EAAUE,QAAQ+B,SAASL,GAC7DM,EAAgB,CAAClC,EAAUI,IAAKJ,EAAUE,QAAQ+B,SAASJ,GAC3DM,EAAY,CAACnC,EAAUI,IAAKJ,EAAUG,MAAM8B,SAASJ,IAAY,EAAI,EACrEO,EAAOF,EAAgBP,EAAG,GAAKA,EAAG,GAAKQ,EACvCE,EAAOH,EAAgBP,EAAG,GAAKQ,EAAYR,EAAG,GACpD,GAAGI,EAAiB,CAChB,IAAIO,EAAOnD,KAAKoD,IAAIP,EAAmBK,EAAOX,EAAG,GAAOU,EAAOV,EAAG,IAClEY,EAAOnD,KAAKqC,IAAIc,EAAM,IACtB,IAAME,EAAO,CAACxC,EAAUC,MAAOD,EAAUE,QAAQ+B,SAASJ,GAC1DS,EAAOE,EAAOF,GAASA,EACvB,IAAMG,EAAMT,EAAkB,CAACN,EAAG,GAAIA,EAAG,GAAKY,GAAQ,CAACZ,EAAG,GAAKY,EAAMZ,EAAG,IAClEgB,EAAMR,EAAgB,CAACE,EAAMC,EAAOC,GAAQ,CAACF,EAAOE,EAAMD,GAChE,gBACOI,EACAC,EAFP,CAGIN,EAAMC,IAEd,IAAIM,GAAab,GAAa,EAAI,IAAME,GAAmBK,EAAOX,EAAG,IAAM,GAAKU,EAAOV,EAAG,IAAM,GAC5FkB,GAAWd,GAAa,EAAI,IAAMI,GAAiBR,EAAG,GAAKW,GAAQ,GAAKX,EAAG,GAAKU,GAAQ,GACxFS,EAAKF,EAAYxD,KAAKoD,IAAII,GAC9BA,EAAYE,EAAK1D,KAAKqC,IAAIrC,KAAKoD,IAAII,GAAY,IAC/C,IAAIG,EAAKF,EAAUzD,KAAKoD,IAAIK,GAC5BA,EAAUE,EAAK3D,KAAKqC,IAAIrC,KAAKoD,IAAIK,GAAU,IAC3C,IAAMH,EAAMT,EAAkB,CAACN,EAAG,GAAIA,EAAG,GAAKiB,GAAa,CAACjB,EAAG,GAAKiB,EAAWjB,EAAG,IAC5EgB,EAAMR,EAAgB,CAACE,EAAMC,EAAOO,GAAW,CAACR,EAAOQ,EAASP,GACtE,gBACOI,EACAC,EAFP,CAGIN,EAAMC,IAOP,SAASU,EAA2BhF,EAAGwC,GAC1C,IAAMyC,EAAI,eAAIC,YAAP,eAAiB1C,IAElB2C,EAAQF,EAAEG,QAAQ,CAAEnC,EAAGjD,EAAE,GAAIkD,EAAGlD,EAAE,KAClCrB,EAAIyE,EAAMpD,EAAG,CAAEmF,EAAMlC,EAAGkC,EAAMjC,IACpC,OAAOvE,EAGJ,SAAS0G,EAAe/F,EAAGgG,EAAIC,EAAIC,EAAMC,EAAMC,EAAMC,EAAMC,EAAIC,GACpE,IAAIC,EAAK1E,KAAK2E,IAAI,EAAEzG,EAAG,IAAIkG,EAAKF,GAAM,EAAEhG,GAAG,EAAEA,IAAIoG,EAAKF,GAAQlG,EAAIA,GAAKsG,EAAKF,GACxEM,EAAK5E,KAAK2E,IAAI,EAAEzG,EAAG,IAAImG,EAAKF,GAAM,EAAEjG,GAAG,EAAEA,IAAIqG,EAAKF,GAAQnG,EAAIA,GAAKuG,EAAKF,GAC5E,OAAQvE,KAAK6E,MAAMH,EAAIE,GAAM,GAAI5E,KAAK8E,G,wBCzGlCC,E,wDACF,aAAc,2C,6CAOd,SAAOzF,GACH,IAAI0F,EACJC,KAAKC,SAAQ,SAAAC,GACNA,EAASC,UACRJ,EAAeG,EAGhBA,EAASE,UACR/F,EAAIqB,OACDwE,EAASG,SAAWH,EAASI,YAC5BJ,EAASG,SACTH,EAASI,WAAY,GAEzBJ,EAAS1E,OAAOnB,GAChBA,EAAIsB,cAGToE,IACC1F,EAAIqB,OACDqE,EAAaM,SAAWN,EAAaO,YACpCP,EAAaM,SACbN,EAAaO,WAAY,GAE7BP,EAAavE,OAAOnB,GACpBA,EAAIsB,a,sBAgBZ,SAASmD,EAAOyB,GACZ,IAAI9J,EAAIuJ,KAAKrJ,OAAS,EACtB,MAAMF,GAAK,EAAG,CACV,IAAMyJ,EAAWF,KAAKvJ,GAEtB,GAAGyJ,EAASE,UAAYF,EAASM,UAAW,CACxC,GAAGD,GAAaA,EAAUL,GAAW,CACjCzJ,IACA,SAEJ,IAAMgK,EAAQP,EAASQ,MAAM5B,EAAOyB,GAEpC,GADAL,EAASS,SAAWF,EACjBA,EACC,MAAoB,mBAAVA,EACCA,EAEJP,EAIfzJ,IAGJ,OAAO,O,mCAMX,WACI,IAAM0F,EAAS,GAMf,OALA6D,KAAKC,SAAQ,SAAAC,GACNA,EAASE,SACRjE,EAAOtE,OAAP,MAAAsE,EAAM,CAAQA,EAAOxF,OAAQ,GAAvB,sBAA6BuJ,EAASU,wBAG7CzE,M,kBApFa0E,QAwFbf,I,oCCzFTgB,G,8BAAWhI,OAAO,UAgBlBiI,E,wDAKF,aAA0B,MAAdC,EAAc,uDAAJ,GAAI,8BACtB,eACApK,OAAOqK,OAAPrK,OAAA,OAAAA,CAAA,GAAoBoK,GAGpB,EAAKZ,SAAU,EACf,EAAKc,OAAS,CACVC,OAAO,EACPC,OAAO,EACPC,QAAQ,GAGZ,EAAKC,cAAWC,EAChB,EAAKT,IAAY,EAGjB,EAAKU,iBAAcD,EAenB,EAAKE,iBAA2CF,IAAxBP,EAAQS,YAA4BT,EAAQS,YAAc,EAClF,EAAKC,YAAmBV,EAAQU,YAChC,EAAKC,WAAmBX,EAAQW,YAAc,cAC9C,EAAKC,QAAmBZ,EAAQY,SAAW,GAC3C,EAAKC,MAAmBb,EAAQa,OAAS,QACzC,EAAKC,YAAmBd,EAAQc,aAAe,QAC/C,EAAKC,WAAmBf,EAAQe,WAAa,6NAC7C,EAAKC,SAAmBhB,EAAQgB,UAAY,OAC5C,EAAKC,UAAmBjB,EAAQiB,WAAa,QAC7C,EAAKC,UAAmBlB,EAAQkB,WAAa,SAC7C,EAAKC,aAAmBnB,EAAQmB,cAAgB,SAzC1B,E,iDA8C1B,WACI,OAAOnC,QAAUA,KAAKoC,OAAOC,QAAQnC,UAAYF,KAAKoC,OAAOC,QAAQC,Q,qBAKzE,WACI,OAAOtC,OAASA,KAAKoC,OAAOG,qB,kBAKhC,WACI,OAAOvC,KAAKc,I,IAShB,SAAWL,GACJT,KAAKc,KAAcL,GAelBT,KAAKwC,cAAc,IAAIC,YAAYhC,EAAQ,aAAc,aAAe,CACpEiC,OAAQ,CACJxC,SAAUF,SAItBA,KAAKc,GAAYL,I,kBA1BrB,WACI,MAAoC,UAA7BT,KAAKsB,SAASqB,WAAyB3C,KAAKsB,SAAWtB,KAAKsB,SAASc,S,uBAgChF,SAAUpB,GAAS,WACfpK,OAAOgM,KAAK5B,GAASf,SAAQ,SAAA4C,QACPtB,IAAfP,EAAQ6B,IAAmC,OAAf7B,EAAQ6B,KACnC,EAAKA,GAAK7B,EAAQ6B,S,oBAQ9B,SAAOxI,GACH,KAAM,6B,mBAOV,SAAMyE,GACF,KAAM,4B,6BAMV,WACI,KAAM,sC,mCAEV,WACI,KAAM,4C,6CAUV,WACI,KAAM,sD,uBAQV,WACI,OAAOkB,KAAK8C,S,kCAQhB,WACI,IAAMC,EAAO7C,SAASU,kBAClBtE,EAAQD,IACRG,GAASH,IACTD,EAAQC,IACRE,GAASF,IAOb,OANA0G,EAAK9C,SAAQ,SAAAnB,GACTtC,EAAQzB,KAAK4B,IAAIH,EAAOsC,EAAM,IAC9BxC,EAAQvB,KAAKqC,IAAId,EAAOwC,EAAM,IAC9BvC,EAAQxB,KAAK4B,IAAIJ,EAAOuC,EAAM,IAC9B1C,EAAQrB,KAAKqC,IAAIhB,EAAO0C,EAAM,OAE3B,CACHrE,OAAQ+B,EAAQF,EAChB9B,MAAO+B,EAAQH,K,yBAOvB,SAAY4G,GACRhD,KAAKwC,cAAcQ,GACnBC,QAAQC,IAAIF,GACTA,EAAYN,OAAOS,SAAWnD,KAAKsB,SAAS8B,cAC3CH,QAAQC,IAAIF,EAAYK,MACxBrD,KAAKsB,SAAS8B,YAAYJ,M,kCAQlC,SAAqBlE,GACjB,OAAGkB,KAAKsB,UAAYtB,KAAKsB,SAASgC,qBACvBtD,KAAKsB,SAASgC,qBAAqBxE,GAEnCA,I,4CAIf,SAA+BnI,GAC3B,OAAOqJ,KAAKoC,OAAOvH,MAAQlE,I,oCAM/B,WACOqJ,KAAKwB,aACJxB,KAAKwB,YAAY+B,a,kBAnNNC,cAwNRzC,ICzOT0C,E,wDACF,WAAYzC,GAAS,oCACjB,cAAMA,GACN,EAAK0C,KAAS1C,EAAQ0C,KACtB,EAAKC,GAAS3C,EAAQ2C,GACtB,EAAKC,YAAc,GACnB,EAAKC,aAAe,GACpB,EAAKC,aAAe,QACpB,EAAKnC,WAAa,iBAPD,E,6DAWrB,WACI,IAAMoC,EAAQ/D,KAAK0D,KAAKM,qCAAqChE,KAAK2D,GAAGM,aAC/DC,EAAMlE,KAAK2D,GAAGK,qCAAqChE,KAAK0D,KAAKO,aACnE,MAAO,CACHF,QACAG,S,sBAIR,WACI,OAAGlE,KAAKkB,OAAOC,MACJnB,KAAK2B,WAET3B,KAAK8D,e,oBAGhB,SAAOzJ,GACH,MAAuB2F,KAAKmE,yBAApBJ,EAAR,EAAQA,MAAOG,EAAf,EAAeA,IACTE,EAAUrJ,KAAKoD,IAAI4F,EAAMM,IAAMH,EAAIG,KACrCR,EAAe,CAACE,EAAMpK,GAC1B,GAAe,IAAZyK,GAA6B,IAAZA,EAEbL,EAAMM,IAAM,IAAM,EACjBR,EAAa5M,KAAK,CAACiN,EAAIvK,EAAE,GAAIoK,EAAMpK,EAAE,KAErCkK,EAAa5M,KAAK,CAAC8M,EAAMpK,EAAE,GAAIuK,EAAIvK,EAAE,UAIzC,GAAGoK,EAAMM,IAAM,IAAM,GACjB,GAAGN,EAAMpK,EAAE,KAAOuK,EAAIvK,EAAE,GAAK,CACzB,IAAM2K,GAAOP,EAAMpK,EAAE,GAAKuK,EAAIvK,EAAE,IAAK,EAAIuK,EAAIvK,EAAE,GAC/CkK,EAAa5M,KAAK,CAAEqN,EAAKP,EAAMpK,EAAE,KACjCkK,EAAa5M,KAAK,CAAEqN,EAAKJ,EAAIvK,EAAE,WAGnC,GAAGoK,EAAMpK,EAAE,KAAOuK,EAAIvK,EAAE,GAAK,CACzB,IAAM2K,GAAOP,EAAMpK,EAAE,GAAKuK,EAAIvK,EAAE,IAAK,EAAIuK,EAAIvK,EAAE,GAC/CkK,EAAa5M,KAAK,CAAE8M,EAAMpK,EAAE,GAAI2K,IAChCT,EAAa5M,KAAK,CAAEiN,EAAIvK,EAAE,GAAI2K,IAI1CT,EAAa5M,KAAKiN,EAAIvK,GACtBqG,KAAK6D,aAAeA,EACpBxJ,EAAIkK,UAAYlK,EAAImK,YAAcxE,KAAKyE,WACvCpK,EAAIqK,YACJ,IAAK,IAAIjO,EAAI,EAAGA,EAAIoN,EAAalN,OAAQF,IAAM,CAC3C,qBAAeoN,EAAapN,GAA5B,GAAOmG,EAAP,KAAUC,EAAV,KACU,IAANpG,EAAS4D,EAAIsK,OAAO/H,EAAGC,GACtBxC,EAAIuK,OAAOhI,EAAGC,GAEvBxC,EAAIwK,SACJxK,EAAIqK,YACJ,IAAMI,EAAOZ,EAAIvK,EAGjB,OAFAU,EAAIsK,OAAOG,EAAK,GAAIA,EAAK,IAEjBZ,EAAIG,KACR,KAAKzI,EAAUI,IACX3B,EAAIuK,OAAOE,EAAK,GAAK,EAAGA,EAAK,GAAK,IAClCzK,EAAIuK,OAAOE,EAAK,GAAK,EAAGA,EAAK,GAAK,IAClC,MACJ,KAAKlJ,EAAUE,OACXzB,EAAIuK,OAAOE,EAAK,GAAK,EAAGA,EAAK,GAAK,IAClCzK,EAAIuK,OAAOE,EAAK,GAAK,EAAGA,EAAK,GAAK,IAClC,MACJ,KAAKlJ,EAAUC,MACXxB,EAAIuK,OAAOE,EAAK,GAAK,GAAIA,EAAK,GAAK,GACnCzK,EAAIuK,OAAOE,EAAK,GAAK,GAAIA,EAAK,GAAK,GACnC,MACJ,KAAKlJ,EAAUG,KACX1B,EAAIuK,OAAOE,EAAK,GAAK,GAAIA,EAAK,GAAK,GACnCzK,EAAIuK,OAAOE,EAAK,GAAK,GAAIA,EAAK,GAAK,GACnC,MACJ,QACI,MAERzK,EAAI0K,YACJ1K,EAAI2K,OACJ3K,EAAIwK,W,mBAGR,SAAM/F,GAGF,IAFA,IAAM+E,EAAe7D,KAAK6D,aAC1B,iBAAeA,EAAa,GAA5B,GAAK5E,EAAL,KAASC,EAAT,KACSzI,EAAI,EAAGA,EAAIoN,EAAalN,OAAQF,IAAM,CAE3C,qBAAiBoN,EAAapN,GAA9B,GAAO8I,EAAP,KAAWC,EAAX,KACIyF,OAAE,EAAEC,OAAE,EAAEC,OAAE,EAAEC,OAAE,EAalB,GAZGnG,IAAOM,IACN0F,EAAKhG,EAAKhD,EACViJ,EAAKjG,EAAKhD,EACVkJ,EAAKpK,KAAK4B,IAAIuC,EAAIM,GAClB4F,EAAKrK,KAAKqC,IAAI8B,EAAIM,IAEnBN,IAAOM,IACN4F,EAAKlG,EAAKjD,EACVkJ,EAAKjG,EAAKjD,EACViJ,EAAKnK,KAAK4B,IAAIsC,EAAIM,GAClB0F,EAAKlK,KAAKqC,IAAI6B,EAAIM,IAEnBT,EAAM,GAAKmG,GACPnG,EAAM,GAAKoG,GACXpG,EAAM,GAAKsG,GACXtG,EAAM,GAAKqG,EACV,OAAO,EAEflG,EAAKM,EACLL,EAAKM,EAET,OAAO,I,6BAGX,WACI,MAAuBQ,KAAKmE,yBAApBJ,EAAR,EAAQA,MAAOG,EAAf,EAAeA,IACf,MAAO,CAACH,EAAMpK,EAAGuK,EAAIvK,O,GA/HFoH,GAmIZ0C,IC5HT4B,EAAa,CACfC,UAAW,GACXC,MAAO,GACPC,OAAQ,KACRC,WAAY,KAKZC,UATe,YASK,WAARvP,EAAQ,EAARA,KACR6J,KAAKwF,OAAS,IAAI1F,EAClBE,KAAKyF,WAAa,IAAI3F,EAClB3J,IACJ6J,KAAKsF,UAAYnP,EAAKmP,UACtBtF,KAAKuF,MAAQpP,EAAKoP,MAClBvF,KAAKsF,UAAUrF,SAAQ,SAAAxJ,GACnB,EAAK+O,OAAOvO,KAAKR,GACjBA,EAAE6K,SAAW,KAEjBtB,KAAKuF,MAAMtF,SAAQ,SAACqC,GAChB,EAAKmD,WAAWxO,KAAKqL,GACrBA,EAAKhB,SAAW,OAOxBqE,WA5Be,SA4BJzF,GACPA,EAASoB,SAAWtB,KACpBA,KAAKwF,OAAOvO,KAAKiJ,IAQrB0F,iBAtCe,SAsCEC,EAAQ3F,GACrB,IAAM4F,EAAQ9F,KAAKwF,OAAOO,WAAU,SAAAtP,GAAC,OAAIA,IAAMoP,KAC/C7F,KAAKwF,OAAO3N,OAAOiO,EAAO,EAAG5F,GAC7B2F,EAAOvE,SAAW,KAClBpB,EAASoB,SAAWtB,MAOxBgG,eAjDe,SAiDA1D,GACXA,EAAKhB,SAAWtB,KAChBA,KAAKyF,WAAWxO,KAAKqL,IAMzB2D,gBAzDe,SAyDCJ,GAEZ,IAAMC,EAAQ9F,KAAKwF,OAAOO,WAAU,SAAAtP,GAAC,OAAIA,IAAMoP,KAC/C7F,KAAKwF,OAAO3N,OAAOiO,EAAO,IAO9BI,oBAnEe,SAmEKL,GAChB,IAAMC,EAAQ9F,KAAKyF,WAAWM,WAAU,SAAAtP,GAAC,OAAIA,IAAMoP,KACnD7F,KAAKyF,WAAW5N,OAAOiO,EAAO,IAGlCK,UAxEe,WAyEXnG,KAAKyF,WAAa,IAAI3F,GAyC1BsG,kBAlHe,SAkHGC,EAAYnG,GAC1BF,KAAK2F,WAAWzF,GAChB,IAAQwD,EAAa2C,EAAb3C,KAAMC,EAAO0C,EAAP1C,GACRmC,EAAQ9F,KAAKyF,WAAWM,WAAU,SAAA5N,GAAC,OAAIA,IAAMkO,KAC7CC,EAAcD,EAAWE,UAAUC,YACnCC,EAAK,IAAIH,EAAY,CACvB5C,OACAC,GAAIzD,IAERuG,EAAGnF,SAAWtB,KACd,IAAM7C,EAAK,IAAImJ,EAAY,CACvB5C,KAAMxD,EACNyD,OAEJxG,EAAGmE,SAAWtB,KAEdA,KAAKyF,WAAW5N,OAAOiO,EAAO,EAAGW,EAAItJ,KAwB9BkI,IC9JTqB,EAAc,CAChBC,QAAS,KACTrG,WAAW,EAKXsG,WAPgB,SAOL5F,GACPhB,KAAK2G,QAAU3F,EAAQ6F,QAK3BC,cAbgB,WAcZ9G,KAAK+G,cACF/G,KAAKsB,UACJtB,KAAKsB,SAASwF,iBAMtBC,YAtBgB,WAuBZ/G,KAAKM,WAAY,EACjBN,KAAKK,SACFL,KAAKgH,uBACJhH,KAAKgH,yBAYbC,YAtCgB,SAsCJ/G,GACR,QAAGF,KAAK2G,SACG3G,KAAK2G,QAAQM,YAAY/G,EAAUF,OAOlDK,OA/CgB,WAgDTL,KAAK2G,SACJ3G,KAAK2G,QAAQtG,OAAOL,QAKjB0G,ICtDTQ,EAAe,CACjBC,SAAU,KAKVC,YANiB,SAMLC,GACRrH,KAAKmH,SAAWE,GAMpBC,eAbiB,WAcb,IAAMD,EAAMrH,KAAKmH,SAEjB,OADAnH,KAAKmH,SAAW,KACTE,IAIAH,I,YClBTK,E,wDAOF,aAA0B,MAAdvG,EAAc,uDAAJ,GAAI,8BACtB,cAAMA,GAGN,EAAK8B,OAAW9B,EAAQ8B,QAAU,CAAC,EAAG,GACtC,EAAK0E,OAAWxG,EAAQwG,QAAU,EALZ,E,kDAuB1B,SAAYnN,GACR,IAAM8B,EAAS6D,KAAKY,kBACpB,GAAqB,IAAlBzE,EAAOxF,OAAV,CACA,IAAM6Q,EAASxH,KAAKwH,OACpB,iBAAyBrL,EAAzB,GAAOsL,EAAP,KAAWnK,EAAX,KAAeC,EAAf,KAAmBmK,EAAnB,KACMlN,EAAQ8C,EAAG,GAAKmK,EAAG,GACnBhN,EAASiN,EAAG,GAAKD,EAAG,GACpBxK,EAAY,GAARzC,EACJmN,EAAa,GAATlN,EACVJ,EAAIqB,OACJrB,EAAIqK,YACJrK,EAAIsK,OAAO8C,EAAG,GAAKD,EAAQC,EAAG,GAAKD,EAASG,GAC5CtN,EAAIuK,OAAO6C,EAAG,GAAKD,EAAQC,EAAG,GAAKD,GACnCnN,EAAIuK,OAAO6C,EAAG,GAAKD,EAASvK,EAAGwK,EAAG,GAAKD,GACvCnN,EAAIwK,SAEJxK,EAAIqK,YACJrK,EAAIsK,OAAOrH,EAAG,GAAKkK,EAASvK,EAAGK,EAAG,GAAKkK,GACvCnN,EAAIuK,OAAOtH,EAAG,GAAKkK,EAAQlK,EAAG,GAAKkK,GACnCnN,EAAIuK,OAAOtH,EAAG,GAAKkK,EAAQlK,EAAG,GAAKkK,EAASG,GAC5CtN,EAAIwK,SAEJxK,EAAIqK,YACJrK,EAAIsK,OAAOpH,EAAG,GAAKiK,EAAQjK,EAAG,GAAKiK,EAASG,GAC5CtN,EAAIuK,OAAOrH,EAAG,GAAKiK,EAAQjK,EAAG,GAAKiK,GACnCnN,EAAIuK,OAAOrH,EAAG,GAAKiK,EAASvK,EAAGM,EAAG,GAAKiK,GACvCnN,EAAIwK,SAEJxK,EAAIqK,YACJrK,EAAIsK,OAAO+C,EAAG,GAAKF,EAASvK,EAAGyK,EAAG,GAAKF,GACvCnN,EAAIuK,OAAO8C,EAAG,GAAKF,EAAQE,EAAG,GAAKF,GACnCnN,EAAIuK,OAAO8C,EAAG,GAAKF,EAAQE,EAAG,GAAKF,EAASG,GAC5CtN,EAAIwK,SACJxK,EAAIsB,e,GA/DOoF,GAmEJwG,ICpETK,E,wDAMF,WAAY5G,GAAS,oCACjB,cAAMA,GACN,EAAKqC,KAAmB,QACxB,EAAKwE,OAAmB7G,EAAQ6G,QAAU,GAC1C,EAAKC,YAAmB,EAAKD,OAAS,EAAKA,OAJ1B,E,6CAOrB,SAAOxN,GACHA,EAAIqB,OACDsE,KAAKG,YACJ9F,EAAI0N,YAAc,IAEtB1N,EAAIqK,YACJrK,EAAI2N,IAAIhI,KAAK8C,OAAO,GAAI9C,KAAK8C,OAAO,GAAI9C,KAAK6H,OAAQ,EAAG,EAAI9M,KAAK8E,IACjExF,EAAIkK,UAAYvE,KAAK6B,MACrBxH,EAAI2K,OACJ3K,EAAImK,YAAcxE,KAAK8B,YACvBzH,EAAIwK,SAQD7E,KAAKiI,cACJjI,KAAKkI,YAAY7N,GAErBA,EAAIsB,Y,mBAGR,SAAMmD,GACF,IAAMgE,EAAS9C,KAAK8C,OACpB,OAAO/H,KAAK2E,IAAIZ,EAAM,GAAKgE,EAAO,GAAI,GAAK/H,KAAK2E,IAAIZ,EAAM,GAAKgE,EAAO,GAAI,GAAK9C,KAAK8H,c,6BAGxF,WACI,IAAMhF,EAAS9C,KAAK8C,OACdjK,EAAImH,KAAK6H,OACTM,EAAMrF,EAAO,GAAKjK,EAClBuP,EAAMtF,EAAO,GAAKjK,EAClBwP,EAAMvF,EAAO,GAAKjK,EAClByP,EAAMxF,EAAO,GAAKjK,EACxB,MAAO,CACH,CAACsP,EAAKC,GACN,CAACC,EAAKD,GACN,CAACC,EAAKC,GACN,CAACH,EAAKG,M,mCAId,SAAsBxJ,GAClB,qBAAiBA,EAAjB,GAAOyJ,EAAP,KAAWC,EAAX,KACA,iBAAiBxI,KAAK8C,OAAtB,GAAO2F,EAAP,KAAWC,EAAX,KACMC,EAAOF,EAAKF,EACZK,EAAOF,EAAKF,EACZK,EAAO9N,KAAK+N,KAAKH,EAAOA,EAAOC,EAAOA,GAEtCG,EAAQ/I,KAAK6H,OAASgB,EAC5B,MAAO,CAACJ,EAAKM,EAAQJ,EAAMD,EAAKK,EAAQH,K,6CAG5C,WAAkC,MAC9B,iBAAiB5I,KAAK8C,OAAtB,GAAO2F,EAAP,KAAWC,EAAX,KACM7P,EAAImH,KAAK6H,OACf,6BACKjM,EAAUC,MAAS,CAAC4M,EAAK5P,EAAG6P,IADjC,iBAEK9M,EAAUG,KAAS,CAAC0M,EAAK5P,EAAG6P,IAFjC,iBAGK9M,EAAUE,OAAS,CAAC2M,EAAIC,EAAG7P,IAHhC,iBAIK+C,EAAUI,IAAS,CAACyM,EAAIC,EAAG7P,IAJhC,I,kDAQJ,SAAqCiG,EAAOoF,GAAK,MAC7C,iBAAiBpF,EAAjB,GAAOyJ,EAAP,KAAWC,EAAX,KACA,iBAAiBxI,KAAK8C,OAAtB,GAAO2F,EAAP,KAAWC,EAAX,KACM7P,EAAImH,KAAK6H,OACTc,EAAOF,EAAKF,EACZK,EAAOF,EAAKF,EACZQ,GAAgB,sBACjBpN,EAAUC,MAAS,CAAC4M,EAAK5P,EAAG6P,IADX,iBAEjB9M,EAAUG,KAAS,CAAC0M,EAAK5P,EAAG6P,IAFX,iBAGjB9M,EAAUE,OAAS,CAAC2M,EAAIC,EAAG7P,IAHV,iBAIjB+C,EAAUI,IAAS,CAACyM,EAAIC,EAAG7P,IAJV,GAkBlBoQ,EAAYlO,KAAKoD,IAAIyK,GAAQ7N,KAAKoD,IAAIwK,GACnCC,EAAO,EAAIhN,EAAUE,OAASF,EAAUI,IACxC2M,EAAO,EAAI/M,EAAUC,MAAQD,EAAUG,KAG9C,OADAkN,EAAWjJ,KAAKkJ,YAAYD,EAAU/E,GAC/B,CACHvK,EAAGqP,EAAiBC,GACpB5E,IAAK4E,K,kCAIb,WACI,MAAO,CACHzO,MAAqB,EAAdwF,KAAK6H,OACZpN,OAAsB,EAAduF,KAAK6H,Y,GArHLN,GA2HLK,I,YCjITuB,E,wDACF,WAAYC,GAAqB,IAAdpI,EAAc,uDAAJ,GAAI,uBAC7B,IAAM0B,EAAS,iCACR1B,GADK,IAERqI,YAAarI,EAAQoI,MACrBvD,OAAQ7E,EAAQ6E,OAChByD,MAAOtI,EAAQsI,MACfnG,QAASnC,EAAQmC,UAAW,IANH,mBAQvBiG,EAAO,CACT1G,W,yBAVaD,cAeV0G,ICTTI,G,kEAQF,aAA0B,MAAdvI,EAAc,uDAAJ,GAAI,8BACtB,cAAMA,GACN,EAAKqC,KAAmB,YACxB,EAAK7I,MAAmBwG,EAAQxG,OAAS,GACzC,EAAKC,OAAmBuG,EAAQvG,QAAU,GAC1C,EAAK+O,aAAmBxI,EAAQwI,cAAgB,EAL1B,E,6CAQ1B,SAAOnP,GACHA,EAAIqB,OACDsE,KAAKG,YACJ9F,EAAI0N,YAAc,IAEtB1N,EAAIqK,YACJ,IACkBmD,EACd7H,KADAwJ,aAA8BhP,GAC9BwF,KADsB8C,OACtB9C,KAD8BxF,OAAOC,EACrCuF,KADqCvF,OAEzC,GAAGuF,KAAKwJ,aAAc,CAClB,IAAM5M,EAAIoD,KAAK8C,OAAO,GAAK9C,KAAKxF,MAAQ,EAClCqC,EAAImD,KAAK8C,OAAO,GAAK9C,KAAKvF,OAAS,EACzCJ,EAAIsK,OAAO/H,EAAIiL,EAAQhL,GACvBxC,EAAIuK,OAAOhI,EAAIpC,EAAQqN,EAAQhL,GAC/BxC,EAAIoP,iBAAiB7M,EAAIpC,EAAOqC,EAAGD,EAAIpC,EAAOqC,EAAIgL,GAClDxN,EAAIuK,OAAOhI,EAAIpC,EAAOqC,EAAIpC,EAASoN,GACnCxN,EAAIoP,iBAAiB7M,EAAIpC,EAAOqC,EAAIpC,EAAQmC,EAAIpC,EAAQqN,EAAQhL,EAAIpC,GACpEJ,EAAIuK,OAAOhI,EAAIiL,EAAQhL,EAAIpC,GAC3BJ,EAAIoP,iBAAiB7M,EAAGC,EAAIpC,EAAQmC,EAAGC,EAAIpC,EAASoN,GACpDxN,EAAIuK,OAAOhI,EAAGC,EAAIgL,GAClBxN,EAAIoP,iBAAiB7M,EAAGC,EAAGD,EAAIiL,EAAQhL,GACvCxC,EAAI0K,iBAEJ1K,EAAI0I,KAAK/C,KAAK8C,OAAO,GAAK9C,KAAKxF,MAAQ,EAAGwF,KAAK8C,OAAO,GAAK9C,KAAKvF,OAAS,EAAGuF,KAAKxF,MAAOwF,KAAKvF,QAEjGJ,EAAIkK,UAAYvE,KAAK6B,MACrBxH,EAAI2K,OACDhF,KAAKyB,cACDzB,KAAKkB,OAAOC,MACX9G,EAAImK,YAAcxE,KAAK2B,WAEvBtH,EAAImK,YAAcxE,KAAK0B,YAE3BrH,EAAIwK,UAUL7E,KAAKiI,cACJjI,KAAKkI,YAAY7N,GAGrBA,EAAIsB,Y,mBAGR,SAAMmD,GACF,IAAMgE,EAAS9C,KAAK8C,OACd7F,EAAI+C,KAAKxF,MAAO,EAChBmN,EAAI3H,KAAKvF,OAAO,EACtB,OAAOqE,EAAM,GAAKgE,EAAO,GAAK7F,GACvB6B,EAAM,GAAKgE,EAAO,GAAK7F,GACvB6B,EAAM,GAAKgE,EAAO,GAAK6E,GACvB7I,EAAM,GAAKgE,EAAO,GAAK6E,I,6BAGlC,WACI,IAAM7E,EAAS9C,KAAK8C,OACd7F,EAAI+C,KAAKxF,MAAO,EAChBmN,EAAI3H,KAAKvF,OAAO,EAChB0N,EAAMrF,EAAO,GAAK7F,EAClBmL,EAAMtF,EAAO,GAAK6E,EAClBU,EAAMvF,EAAO,GAAK7F,EAClBqL,EAAMxF,EAAO,GAAK6E,EACxB,MAAO,CACH,CAACQ,EAAKC,GACN,CAACC,EAAKD,GACN,CAACC,EAAKC,GACN,CAACH,EAAKG,M,kCAId,WACI,MAAO,CACH7N,OAAQuF,KAAKvF,OACbD,MAAOwF,KAAKxF,S,mCAIpB,SAAsBsE,GAClB,IAUIlC,EAAGC,EAVP,iBAAiBiC,EAAjB,GAAOyJ,EAAP,KAAWC,EAAX,KACA,iBAAiBxI,KAAK8C,OAAtB,GAAO2F,EAAP,KAAWC,EAAX,KACMzL,EAAI+C,KAAKxF,MAAM,EACfmN,EAAI3H,KAAKvF,OAAO,EAChBkO,EAAOF,EAAKF,EACZK,EAAOF,EAAKF,EACZkB,EAAS/B,EAAE1K,EACX0M,EAAS5O,KAAKoD,IAAIyK,EAAKD,GACvBiB,EAAOrB,EAAKE,EACZoB,EAAOrB,EAAKE,EASlB,OAPGiB,EAASD,GACR9M,EAAI6L,GAAMmB,EAAK3M,GAAGA,GAClBJ,EAAII,GAAK4M,EAAKF,GAAQA,GAAUjB,IAEhC7L,EAAI6L,GAAMmB,EAAKlC,GAAGA,GAClB/K,EAAI+K,GAAKiC,EAAKD,GAAQA,GAAUlB,GAE7B,CAAC7L,EAAGC,K,6CAGf,WAAkC,MAC1BU,EAAKyC,KAAK8C,OACX9C,KAAKsB,UAAYtB,KAAKsB,SAASwI,0BAC9BvM,EAAKyC,KAAKsB,SAASwI,wBAAwBvM,IAG/C,MAAiBA,EAAjB,sBAAOkL,EAAP,KAAWC,EAAX,KACMzL,EAAI+C,KAAKxF,MAAM,EACfmN,EAAI3H,KAAKvF,OAAO,EACtB,6BACKmB,EAAUC,MAAS,CAAC4M,EAAGxL,EAAGyL,IAD/B,iBAEK9M,EAAUG,KAAS,CAAC0M,EAAGxL,EAAGyL,IAF/B,iBAGK9M,EAAUE,OAAS,CAAC2M,EAAIC,EAAGf,IAHhC,iBAIK/L,EAAUI,IAAS,CAACyM,EAAIC,EAAGf,IAJhC,I,kDAQJ,SAAqC7I,EAAOoF,GAAK,MAC7C,iBAAiBpF,EAAjB,GAAOyJ,EAAP,KAAWC,EAAX,KACIjL,EAAKyC,KAAK8C,OACX9C,KAAKsB,UAAYtB,KAAKsB,SAASwI,0BAC9BvM,EAAKyC,KAAKsB,SAASwI,wBAAwBvM,IAG/C,MAAiBA,EAAjB,sBAAOkL,EAAP,KAAWC,EAAX,KACMzL,EAAI+C,KAAKxF,MAAM,EACfmN,EAAI3H,KAAKvF,OAAO,EAChBuO,GAAgB,sBACjBpN,EAAUC,MAAS,CAAC4M,EAAGxL,EAAGyL,IADT,iBAEjB9M,EAAUG,KAAS,CAAC0M,EAAGxL,EAAGyL,IAFT,iBAGjB9M,EAAUE,OAAS,CAAC2M,EAAIC,EAAGf,IAHV,iBAIjB/L,EAAUI,IAAS,CAACyM,EAAIC,EAAGf,IAJV,GAMhBgB,EAAOF,EAAKF,EACZK,EAAOF,EAAKF,EACZkB,EAAS/B,EAAE1K,EACX0M,EAAS5O,KAAKoD,IAAIyK,EAAKD,GACvBiB,EAAOrB,EAAKE,EACZoB,EAAOrB,EAAKE,EACdO,EAAYU,EAASD,EAClBG,EAAOjO,EAAUE,OAASF,EAAUI,IACpC4N,EAAOhO,EAAUC,MAAQD,EAAUG,KAkB1C,OAhBGiE,KAAKsB,UAAYtB,KAAKsB,SAASwI,0BAC9B7G,QAAQC,IAAI6G,KAAKC,UAAUhK,KAAKiK,iBAChChH,QAAQC,IAAI+F,IAEhBA,EAAWjJ,KAAKkJ,YAAYD,EAAU/E,GACnClE,KAAKsB,UAAYtB,KAAKsB,SAASwI,yBAC9B7G,QAAQC,IAAI+F,GAUT,CACHtP,EAAGqP,EAAiBC,GACpB5E,IAAK4E,O,GAtLO1B,IA2LTgC,ICnKTW,E,wDAMF,WAAYlJ,GAAS,oCACjB,cAAMA,GACN,EAAK0E,UAAU1E,GACf,EAAK4F,WAAW5F,GAOhB,EAAKmJ,aAAmBnJ,EAAQxG,MAChC,EAAK4P,cAAmBpJ,EAAQvG,OAChC,EAAK4I,KAAmB,QACxB,EAAKgH,QAAmBrJ,EAAQqJ,SAAW,EAC3C,EAAK1I,WAAmBX,EAAQW,YAAc,iBAC9C,EAAK2I,UAAmBtJ,EAAQsJ,UAChC,EAAKC,KAAmBvJ,EAAQuJ,KAChC,EAAKrJ,OAAOsJ,QAAY,EACxB,EAAKC,QAAU,EACf,EAAKC,QAAU,EACf,EAAK1D,wBACL,EAAK3G,SACL,EAAK2G,wBAtBY,E,4DAiCrB,WACI,IAAM7K,EAAS6D,KAAKwF,OAAOmF,wBACrBC,EAAO1O,EAAaC,GACpBkO,EAAUrK,KAAKqK,QACfpN,EAAI2N,EAAKpQ,MAAkB,EAAV6P,EACjB1C,EAAIiD,EAAKnQ,OAAmB,EAAV4P,EACxBrK,KAAKxF,MAAQwF,KAAKmK,cAAgBlN,EAClC+C,KAAKvF,OAASuF,KAAKoK,eAAiBzC,EAGpC3H,KAAKyK,QAAUG,EAAK/N,EACpBmD,KAAK0K,QAAUE,EAAKhO,I,oBAUxB,SAAOvC,GACHA,EAAIqB,OACDsE,KAAKG,YACJ9F,EAAI0N,YAAc,IAGtB,IAAMjF,EAAS9C,KAAK8C,OACpBzI,EAAIqB,OACJ6N,EAAU1S,UAAU2E,OAAOzE,KAAKiJ,KAAM3F,GACtCA,EAAIsB,UACJ,IAAMlB,EAASuF,KAAKvF,OACdD,EAAQwF,KAAKxF,MACb6P,EAAUrK,KAAKqK,QACfQ,EAAQpQ,EAAS,EAAIuF,KAAKyK,QAAUJ,EACpCS,EAAQtQ,EAAQ,EAAIwF,KAAK0K,QAAUL,EACzChQ,EAAI0Q,UAAUjI,EAAO,GAAKgI,EAAOhI,EAAO,GAAK+H,GAC7C7K,KAAKwF,OAAOhK,OAAOnB,GACnB2F,KAAKyF,WAAWjK,OAAOnB,GACvBA,EAAI0Q,WAAWjI,EAAO,GAAKgI,GAAQhI,EAAO,GAAK+H,GAE5C7K,KAAKiI,cACJjI,KAAKkI,YAAY7N,GAErBA,EAAIsB,Y,iCAGR,SAAoBmD,GAChB,qBAAiBA,EAAjB,GAAOkM,EAAP,KAAWC,EAAX,KACMxQ,EAASuF,KAAKvF,OACdD,EAAQwF,KAAKxF,MACb6P,EAAUrK,KAAKqK,QACfQ,EAAQpQ,EAAS,EAAIuF,KAAKyK,QAAUJ,EACpCS,EAAQtQ,EAAQ,EAAIwF,KAAK0K,QAAUL,EACnCvH,EAAS9C,KAAK8C,OACdnJ,EAAI,CAACqR,EAAKlI,EAAO,GAAKgI,EAAOG,EAAKnI,EAAO,GAAI+H,GACnD,OAAOlR,I,mBAGX,SAAMmF,EAAOyB,GACT,IAAM5G,EAAIqG,KAAKkL,oBAAoBpM,GACnCkB,KAAKmL,UAAYxR,EAEb,IAAMkM,EAAS7F,KAAKwF,OAAO4F,SAASzR,EAAG4G,GACvC,OAAGsF,GAGA0D,EAAU1S,UAAU6J,MAAM3J,KAAKiJ,KAAMlB,K,qCAOhD,SAAwBA,GACpB,qBAAiBA,EAAjB,GAAOuM,EAAP,KAAWC,EAAX,KACM7Q,EAASuF,KAAKvF,OACdD,EAAQwF,KAAKxF,MACb6P,EAAUrK,KAAKqK,QACfQ,EAAQpQ,EAAS,EAAIuF,KAAKyK,QAAUJ,EACpCS,EAAQtQ,EAAQ,EAAIwF,KAAK0K,QAAUL,EACnCvH,EAAS9C,KAAK8C,OACdnJ,EAAI,CAAC0R,EAAKvI,EAAO,GAAKgI,EAAOQ,EAAKxI,EAAO,GAAK+H,GACpD,OAAG7K,KAAKsB,UAAYtB,KAAKsB,SAASwI,wBACvB9J,KAAKsB,SAASwI,wBAAwBnQ,GAEtCA,I,kCAIf,SAAqBmF,GACjB,qBAAiBA,EAAjB,GAAOuM,EAAP,KAAWC,EAAX,KACM7Q,EAASuF,KAAKvF,OACdD,EAAQwF,KAAKxF,MACb6P,EAAUrK,KAAKqK,QACfQ,EAAQpQ,EAAS,EAAIuF,KAAKyK,QAAUJ,EACpCS,EAAQtQ,EAAQ,EAAIwF,KAAK0K,QAAUL,EACnCvH,EAAS9C,KAAK8C,OACdnJ,EAAI,CAAC0R,EAAKvI,EAAO,GAAKgI,EAAOQ,EAAKxI,EAAO,GAAK+H,GACpD,GAAG7K,KAAKsB,UAAYtB,KAAKsB,SAASgC,qBAC9B,OAAOtD,KAAKsB,SAASgC,qBAAqB3J,O,GA3IlC4P,GAgJpB3S,OAAOqK,OAAOiJ,EAAMrT,UAAWwO,GAC/BzO,OAAOqK,OAAOiJ,EAAMrT,UAAW6P,GAChBwD,Q,UC5Kf,SAASqB,GAAmBC,GACxB,IAAMC,EAAQtR,SAASC,cAAc,SAWrC,OAVAqR,EAAMC,aAAa,QAAnB,+PAUOD,E,IAOLE,G,wDAQF,WAAY3K,GAAS,oCACjB,cAAMA,GACN,EAAKqC,KAAmB,OACxB,EAAKuI,WAAmB5K,EAAQ4K,WAChC,EAAKC,OAAmB7K,EAAQ6K,QAAU,EAC1C,EAAKC,gBAAmB9K,EAAQ8K,gBAChC,EAAKC,SAAmB/K,EAAQ+K,SAChC,EAAKC,aAAmBhL,EAAQgL,aAChC,EAAKC,WAAa,CACdC,UAAU,GAEd3Q,GAAmB,SAAClB,GAChB,EAAK8R,iBAAiB9R,MAE1B4I,QAAQC,IAAI,EAAK1I,MAAO,EAAKC,OAAQ,EAAKmH,SAC1C,EAAKwK,gBAfY,E,oDAmBrB,WAAgB,WACTpM,KAAK+L,UACJ/L,KAAKqM,iBAAiB,SAAS,SAACjD,GAC5B,IAAMzP,EAAI,CAAE,GAAI,EAAKc,OAAO,GACtBuH,GAAY,QAAQsK,KAAK,EAAKtK,UAAU,GAC9C,EAA2B,EAAKsB,qBAAqB3J,GAArD,sBAAO+Q,EAAP,KAAgBD,EAAhB,KACM8B,EAAehB,KACftR,EAAU,EAAKmI,OAAOoK,WACtBC,EAAS,EAAK7K,QACpB2K,EAAa3R,MAAM8R,UAAnB,oBAA2ChC,EAA3C,eAAyDD,EAAzD,OACA8B,EAAa3R,MAAMJ,MAAQ,EAAKmS,+BAA+B,EAAKnS,OAAS,KAC7E+R,EAAa3R,MAAMH,OAAS,EAAKkS,+BAA+B,EAAKlS,QAAU,KAC/E8R,EAAa3R,MAAMmH,WAAa,EAAKA,WACrCwK,EAAa3R,MAAMoH,SAAnB,UAAiCA,EAAW,EAAKI,OAAOvH,MAAxD,MACA0R,EAAa3R,MAAMgR,WAAnB,UAAmC,EAAKA,WAAa,EAAKxJ,OAAOvH,MAAjE,MACA0R,EAAa3R,MAAMgS,WAAnB,UAAmC,EAAKf,OAAS,EAAKzJ,OAAOvH,MAA7D,MACA0R,EAAavT,MAAQ,EAAK4I,QAC1B2K,EAAa3R,MAAMiH,MAAQ,EAAKI,UAChCsK,EAAaF,iBAAiB,SAAU,WACpC,EAAKzK,QAAU,GACf,EAAKQ,OAAOyK,UACZN,EAAa3R,MAAMkS,QAAU,UAEjC,IAAMC,EAAc,WAChB,GAAG,EAAKf,kBAED,CACH,IAAMgB,EAAMT,EAAavT,MACzB,EAAKwJ,cAAc,IAAI2G,EAAW,SAAU,CACxCtD,OAAQ,EACR4G,SACAO,SAEJ,EAAKpL,QAAU6K,EACfF,EAAahJ,WAGrBgJ,EAAaF,iBAAiB,OAAQU,GACtCR,EAAaF,iBAAiB,SAAS,SAACY,GACtB,UAAVA,EAAE3T,KAAiC,KAAd2T,EAAEC,SACvBH,OAGR9S,EAAQiB,OAAOqR,GACfA,EAAanL,a,8BAKzB,SAAiB/G,GACbA,EAAIqK,YACJrK,EAAI8S,KAAJ,UAAcnN,KAAKgC,SAAnB,YAA+BhC,KAAK+B,YACpC1H,EAAI6H,UAAYlC,KAAKkC,UACrB7H,EAAI8H,aAAenC,KAAKmC,aACxB9H,EAAIkK,UAAYvE,KAAKiC,UACrB,MAKI5H,EAAI+S,YAAYpN,KAAK4B,SAJrByL,EADJ,EACIA,sBACAC,EAFJ,EAEIA,uBACAC,EAHJ,EAGIA,sBACAC,EAJJ,EAIIA,uBAGJxN,KAAKxF,MAAQwF,KAAK6L,OAAS9Q,KAAKoD,IAAIkP,GAAyBtS,KAAKoD,IAAImP,GACtE,IAAM7S,EAASM,KAAKoD,IAAIoP,GAAyBxS,KAAKoD,IAAIqP,GACvDxN,KAAK4L,WACJ5L,KAAKvF,OAASuF,KAAK4L,WAEnB5L,KAAKvF,OAASA,I,uBAItB,SAAUuG,GAAS,WACfpK,OAAOgM,KAAK5B,GAASf,SAAQ,SAAA4C,QACPtB,IAAfP,EAAQ6B,IAAmC,OAAf7B,EAAQ6B,KACnC,EAAKA,GAAK7B,EAAQ6B,OAG1BtH,GAAmB,SAAClB,GAChB,EAAK8R,iBAAiB9R,Q,oBAI9B,SAAOA,GACHA,EAAIqB,OACDsE,KAAKG,YACJ9F,EAAI0N,YAAc,IAEtB/H,KAAKmM,iBAAiB9R,GAGtB,IACkBwN,EACd7H,KADAwJ,aAA8BhP,GAC9BwF,KADsB8C,OACtB9C,KAD8BxF,OAAOC,EACrCuF,KADqCvF,OAEzC,GAAGuF,KAAK8L,iBAAmB9L,KAAK0B,YAAY,CAGxC,GAFArH,EAAIqB,OACJrB,EAAIqK,YACD1E,KAAKwJ,aAAc,CAClB,IAAM5M,EAAIoD,KAAK8C,OAAO,GAAK9C,KAAKxF,MAAQ,EAClCqC,EAAImD,KAAK8C,OAAO,GAAK9C,KAAKvF,OAAS,EACzCJ,EAAIsK,OAAO/H,EAAIiL,EAAQhL,GACvBxC,EAAIuK,OAAOhI,EAAIpC,EAAQqN,EAAQhL,GAC/BxC,EAAIoP,iBAAiB7M,EAAIpC,EAAOqC,EAAGD,EAAIpC,EAAOqC,EAAIgL,GAClDxN,EAAIuK,OAAOhI,EAAIpC,EAAOqC,EAAIpC,EAASoN,GACnCxN,EAAIoP,iBAAiB7M,EAAIpC,EAAOqC,EAAIpC,EAAQmC,EAAIpC,EAAQqN,EAAQhL,EAAIpC,GACpEJ,EAAIuK,OAAOhI,EAAIiL,EAAQhL,EAAIpC,GAC3BJ,EAAIoP,iBAAiB7M,EAAGC,EAAIpC,EAAQmC,EAAGC,EAAIpC,EAASoN,GACpDxN,EAAIuK,OAAOhI,EAAGC,EAAIgL,GAClBxN,EAAIoP,iBAAiB7M,EAAGC,EAAGD,EAAIiL,EAAQhL,GACvCxC,EAAI0K,iBAEJ1K,EAAI0I,KAAK/C,KAAK8C,OAAO,GAAK9C,KAAKxF,MAAQ,EAAGwF,KAAK8C,OAAO,GAAK9C,KAAKvF,OAAS,EAAGuF,KAAKxF,MAAOwF,KAAKvF,QAE7FuF,KAAK8L,kBACLzR,EAAIkK,UAAYvE,KAAK8L,gBACrBzR,EAAI2K,QAELhF,KAAK0B,cACJrH,EAAImK,YAAcxE,KAAK0B,YACvBrH,EAAIwK,UAERxK,EAAIsB,UAGRtB,EAAIqK,YAKJrK,EAAIoT,SAASzN,KAAK4B,QAAS5B,KAAK8C,OAAO,GAAK9C,KAAK6L,OAAS,EAAG7L,KAAK8C,OAAO,IACzEzI,EAAIsB,c,GA5JO4N,GAgKJoC,MC5KT+B,G,wDAQF,WAAY1M,GAAS,oCACjB,cAAMA,GACN,EAAKS,YAAc,EACnB,EAAKkM,MAAQ3M,EAAQ2M,MACrB,EAAKA,MAAMC,OAAS,WAChBC,uBAAsB,WAClB,EAAKzL,OAAOyK,cAGpB,EAAKiB,cAAgB,CACjBtT,MAAOwG,EAAQ+M,YAAc/M,EAAQxG,MACrCC,OAAQuG,EAAQgN,aAAgBhN,EAAQvG,QAX3B,E,6CAerB,SAAOJ,GACHA,EAAIqB,OACDsE,KAAKG,YACJ9F,EAAI0N,YAAc,IAEtBwB,EAAU1S,UAAU2E,OAAOzE,KAAKiJ,KAAM3F,GACtC,IAAMuC,EAAIoD,KAAK8C,OAAO,GAAK9C,KAAKxF,MAAQ,EAClCqC,EAAImD,KAAK8C,OAAO,GAAK9C,KAAKvF,OAAS,EACzCJ,EAAI4T,UAAUjO,KAAK2N,MAAO/Q,EAAGC,EAAGmD,KAAK8N,cAActT,MAAOwF,KAAK8N,cAAcrT,QAC7EJ,EAAIsB,c,GAhCO4N,GAmCJmE,MCxCTQ,G,wDAUF,aAA0B,MAAdlN,EAAc,uDAAJ,GAAI,8BACtB,eACA,EAAK0C,KAAW1C,EAAQ0C,KACxB,EAAKC,GAAW3C,EAAQ2C,GACxB,EAAKwK,QAAWnN,EAAQmN,QACxB,EAAKC,MAAWpN,EAAQoN,MACxB,EAAK9U,IAAW0H,EAAQ1H,IACxB,EAAK+U,aAAe,KACpB,EAAKvK,aAAe,QACpB,EAAKnC,WAAa,iBATI,E,UAVPZ,GAuBRmN,MC1BTI,G,wDACF,WAAYtN,GAAS,oCACjB,cAAMA,GACN,EAAK0C,KAAS1C,EAAQ0C,KACtB,EAAKC,GAAS3C,EAAQ2C,GACtB,EAAK4K,cAAgB,CAAC,EAAG,GAAI,GAAI,GAAI,GAAI,GACzC,EAAKF,aAAe,KACpB,EAAKvK,aAAe,QACpB,EAAKnC,WAAa,iBAPD,E,+CAUrB,WACI,OAAG3B,KAAKiI,aACGjI,KAAK2B,WAET3B,KAAK8D,e,oCAGhB,WACI,IAAMC,EAAQ/D,KAAK0D,KAAK8K,sBAAsBxO,KAAK2D,GAAGM,aAChDC,EAAMlE,KAAK2D,GAAG6K,sBAAsBxO,KAAK0D,KAAKO,aAEpD,OADAjE,KAAKqO,aAAe,CAACtK,EAAOG,GACrB,CACHuK,OAAQ1K,EAAM,GACd2K,OAAQ3K,EAAM,GACd/F,KAAQkG,EAAI,GACZjG,KAAQiG,EAAI,M,oBAIpB,SAAO7J,GACH,MAAuC2F,KAAKmE,yBAApCsK,EAAR,EAAQA,OAAQC,EAAhB,EAAgBA,OAAQ1Q,EAAxB,EAAwBA,KAAMC,EAA9B,EAA8BA,KACxBsQ,EAAgBvO,KAAKuO,cACvB9O,EAAKzB,EAAOyQ,EACZ9O,EAAK1B,EAAOyQ,EACZC,EAAM5T,KAAK+N,KAAKrJ,EAAKA,EAAKE,EAAKA,GAC/BiP,EAAMjP,EAAKgP,EACXE,EAAMpP,EAAKkP,EACXG,EAAI,GACRA,EAAE7X,KAAK,EAAG,GACV,IAAK,IAAIR,EAAI,EAAGA,EAAI8X,EAAc5X,OAAQF,GAAK,EAAG,CAC9C,IAAImG,EAAI2R,EAAc9X,GAClBoG,EAAI0R,EAAc9X,EAAI,GAC1BqY,EAAE7X,KAAK2F,EAAI,EAAI+R,EAAM/R,EAAIA,EAAGC,GAEhCiS,EAAE7X,KAAK0X,EAAK,GACZ,IAASlY,EAAI8X,EAAc5X,OAAQF,EAAI,EAAGA,GAAK,EAAG,CAC1CmG,EAAI2R,EAAc9X,EAAI,GACtBoG,EAAI0R,EAAc9X,EAAI,GAC1BqY,EAAE7X,KAAK2F,EAAI,EAAI+R,EAAM/R,EAAIA,GAAIC,GAEjCiS,EAAE7X,KAAK,EAAG,GACVoD,EAAIkK,UAAYlK,EAAImK,YAAcxE,KAAKyE,WACvCpK,EAAIqK,YACJ,IAASjO,EAAI,EAAGA,EAAIqY,EAAEnY,OAAQF,GAAK,EAAG,CAC9BmG,EAAIkS,EAAErY,GAAKoY,EAAMC,EAAErY,EAAI,GAAKmY,EAAMH,EAClC5R,EAAIiS,EAAErY,GAAKmY,EAAME,EAAErY,EAAI,GAAKoY,EAAMH,EAC5B,IAANjY,EAAS4D,EAAIsK,OAAO/H,EAAGC,GACtBxC,EAAIuK,OAAOhI,EAAGC,GAEvBxC,EAAI2K,S,mBAGR,SAAMlG,GACF,IAAIkB,KAAKqO,aAAc,OAAO,EAC9B,qBAAuBrO,KAAKqO,aAA5B,GAAQtK,EAAR,KAAeG,EAAf,KACM2E,EAAO3L,EAAqB4B,EAAOiF,EAAOG,GAChD,OAAO2E,EAAO5M,I,6BAGlB,WACI,MAAuC+D,KAAKmE,yBAApCsK,EAAR,EAAQA,OAAQC,EAAhB,EAAgBA,OAAQ1Q,EAAxB,EAAwBA,KAAMC,EAA9B,EAA8BA,KAC9B,MAAO,CAAC,CAACwQ,EAAQC,GAAS,CAAC1Q,EAAMC,Q,GAxEtBiQ,IA4EJI,MCxETS,I,kEAMF,WAAY/N,GAAS,oCACjB,cAAMA,GACN,EAAKtD,UAAgBsD,EAAQtD,UAFZ,E,+CAQrB,WACI,OAAGsC,KAAKiI,aACGjI,KAAK2B,WAET3B,KAAK8D,e,oCAGhB,WACI,IAAIC,EACAG,OACgB3C,IAAjBvB,KAAKmO,UACJpK,EAAQ,CACJM,IAAKrE,KAAKmO,QACVxU,EAAGqG,KAAK0D,KAAKsL,kCAAkChP,KAAKmO,gBAG1C5M,IAAfvB,KAAKoO,QACJlK,EAAM,CACFG,IAAKrE,KAAKoO,MACVzU,EAAGqG,KAAK2D,GAAGqL,kCAAkChP,KAAKoO,SAO1D,IAAM9Q,EAAKyG,EAAMpK,EACX4D,EAAK2G,EAAIvK,EACTwC,EAASkB,EAAaC,EAAIC,EAAIwG,EAAMM,IAAKH,EAAIG,IAAKrE,KAAKtC,WAE7DsC,KAAKqO,aAAL,yBAAwB/Q,GAAxB,eAA+BnB,M,oBAGnC,SAAO9B,GACH2F,KAAKmE,yBACL,IAAMhI,EAAS6D,KAAKqO,aACdY,EAAQjQ,EAAe1H,MAAM,KAArB,CAA4B,GAA5B,sBAAkC6E,KAEhD9B,EAAIkK,UAAYlK,EAAImK,YAAcxE,KAAKyE,WACvCpK,EAAIqK,YACJrK,EAAIsK,OAAOxI,EAAO,GAAIA,EAAO,IAC7B9B,EAAI6U,cAAJ,MAAA7U,EAAG,eAAkB8B,EAAOpC,MAAM,KAClCM,EAAIwK,SACJxK,EAAIqK,YACJrK,EAAI0Q,UAAU5O,EAAO,GAAIA,EAAO,IAChC9B,EAAI8U,OAAOF,GACX5U,EAAIsK,OAAO,EAAG,GACdtK,EAAIuK,OAAO,GAAI,GACfvK,EAAIuK,OAAO,EAAG,GACdvK,EAAIuK,OAAO,EAAG,GACdvK,EAAI2K,OACJ3K,EAAI8U,QAAQF,GACZ5U,EAAI0Q,WAAW5O,EAAO,IAAKA,EAAO,M,mBAGtC,SAAM2C,GACF,IAAIkB,KAAKqO,aAAc,OAAO,EAC9B,IAAMlS,EAAS6D,KAAKqO,aACdxF,EAAOlK,EAA2BG,EAAO3C,GAC/C,OAAO0M,EAAO5M,I,6BAGlB,WACI,MAAuC+D,KAAKmE,yBAApCsK,EAAR,EAAQA,OAAQC,EAAhB,EAAgBA,OAAQ1Q,EAAxB,EAAwBA,KAAMC,EAA9B,EAA8BA,KAC9B,MAAO,CAAC,CAACwQ,EAAQC,GAAS,CAAC1Q,EAAMC,Q,GA9EhBiQ,KAkFVa,MCrETK,I,qBACF,aAA0B,IAAdpO,EAAc,uDAAJ,GAAI,uBAOtBhB,KAAKqP,UAAgBrO,EAAQqO,WAAa,WAC1CrP,KAAKsP,IAAgBtO,EAAQsO,KAAO,EACpCtP,KAAKuP,UAAgBvO,EAAQuO,WAAa,S,6CAI9C,SAAOC,GAAO,WACJC,EAAQD,EAAMhK,OAAOkK,QAAO,SAAAxP,GAAQ,OAAIA,EAASE,UAAYF,EAASyP,aAE5E,GAAsB,aAAnB3P,KAAKqP,UAA0B,CAC9B,IAAIO,EAAe,EACfC,EAAqB,EACrBC,EAAW,EACfL,EAAMxP,SAAQ,SAACC,EAAUzD,GACrB,MAA0ByD,EAAS6P,uBAA3BvV,EAAR,EAAQA,MAAOC,EAAf,EAAeA,OACfqV,EAAW/U,KAAK4B,IAAInC,EAAOsV,GAC3BF,GAAiBnV,EAAO,GAAKgC,EAAM,EAAI,EAAK6S,IAAM,GAAKO,EACvDA,EAAqBpV,EAAS,EAC9ByF,EAAS4C,OAAS,CAAC,EAAG8M,MAGJ,UAAnB5P,KAAKuP,WACJE,EAAMxP,SAAQ,SAACC,EAAUzD,GACrB,MAAkByD,EAAS6P,uBAAnBvV,EAAR,EAAQA,MACR0F,EAAS4C,OAAO,KAAOgN,EAAWtV,GAAS,KAG7B,QAAnBwF,KAAKuP,WACJE,EAAMxP,SAAQ,SAACC,EAAUzD,GACrB,MAAkByD,EAAS6P,uBAAnBvV,EAAR,EAAQA,MACR0F,EAAS4C,OAAO,IAAMgN,EAAWtV,GAAS,KAItD,GAAsB,eAAnBwF,KAAKqP,UAA4B,CAChC,IAAIW,EAAc,EACdC,EAAoB,EACpBC,EAAY,EAChBT,EAAMxP,SAAQ,SAACC,EAAUzD,GACrB,MAA0ByD,EAAS6P,uBAA3BvV,EAAR,EAAQA,MAAOC,EAAf,EAAeA,OACfyV,EAAYnV,KAAK4B,IAAIlC,EAAQyV,GAC7BF,GAAgBxV,EAAM,GAAKiC,EAAM,EAAI,EAAK6S,IAAM,GAAKW,EACrDA,EAAoBzV,EAAQ,EAC5B0F,EAAS4C,OAAS,CAACkN,EAAa,MAGd,UAAnBhQ,KAAKuP,WACJE,EAAMxP,SAAQ,SAACC,EAAUzD,GACrB,MAAmByD,EAAS6P,uBAApBtV,EAAR,EAAQA,OACRyF,EAAS4C,OAAO,KAAOoN,EAAYzV,GAAU,KAG/B,QAAnBuF,KAAKuP,WACJE,EAAMxP,SAAQ,SAACC,EAAUzD,GACrB,MAAmByD,EAAS6P,uBAApBtV,EAAR,EAAQA,OACRyF,EAAS4C,OAAO,IAAMoN,EAAYzV,GAAU,U,MAOjD2U,MCvFTe,I,yCACF,WAAYC,GAAQ,uBAChBpQ,KAAKoQ,OAASA,EACdpQ,KAAKqQ,GAAKD,EAAOC,GACjBrQ,KAAKqD,KAAO+M,EAAO/M,KACnBrD,KAAKsQ,sBAAmB/O,EACxBvB,KAAKuQ,WAAQhP,EACbvB,KAAKwQ,cAAWjP,EAChBvB,KAAKyQ,UAAW,EAChBzQ,KAAK0Q,QAAS,EACd1Q,KAAK2Q,YAASpP,EACdvB,KAAKvD,SAAM8E,EACXvB,KAAK4Q,uBAAoBrP,E,yDAG7B,WAAsD,IAAnCgP,EAAmC,uDAA3B,EAAGC,EAAwB,uDAAb,EAAGK,EAAU,uCASlD,OARA7Q,KAAKuQ,MAAQA,EACbvQ,KAAKwQ,SAAWA,EAChBxQ,KAAK8Q,MAAQ,EACb9Q,KAAK+Q,MAAQ,EACVF,IACC5N,QAAQC,IAAIqN,EAAOC,EAAUxQ,KAAKqQ,IAClCQ,EAASN,EAAOC,EAAUxQ,OAEvB,CACH8Q,MAAO9Q,KAAK8Q,MACZC,MAAO/Q,KAAK+Q,MACZR,QAAOC,c,sBAIf,SAASK,GACL,OAAO7Q,O,0BAGX,c,sBAEA,SAAS6Q,GACLA,EAAS7Q,Q,sBAGb,WACI,IAAMgR,EAAQ,GAKd,OAJAhR,KAAKiR,UAAS,SAAAzX,GACPA,EAAE8W,kBACDU,EAAM/Z,KAAKuC,EAAE8W,uBAEdU,I,wBAGX,SAAWZ,GACPpQ,KAAK2Q,OAAOP,OAAOpQ,KAAK4Q,mBAAmB/Y,OAAOmI,KAAKvD,IAAM,EAAG,EAAG2T,K,oBAGvE,WACIpQ,KAAK2Q,OAAOP,OAAOpQ,KAAK4Q,mBAAmB/Y,OAAOmI,KAAKvD,IAAK,O,MAI9DyU,G,wDACF,WAAYd,GAAQ,6BAChB,cAAMA,GACN,EAAKe,QAAS,EACd,EAAKC,MAAQhB,EAAOgB,MAAQ,IAAIC,IAAIC,GAAQ,QAAQ/X,KAAhB,oBACpC,IAAMgY,EAAqBD,GAAQ,cAAc/X,KAAtB,mBAJX,OAKhB,EAAKiY,YAAcpB,EAAOoB,YAAc,IAAIH,KAAI,SAACtZ,EAAG0E,GAChD,IAAMjD,EAAI+X,EAAmBxZ,EAAG0E,GAEhC,OADAjD,EAAEkX,QAAS,EACJlX,KARK,E,6DAYpB,WAA0D,IAAnC+W,EAAmC,uDAA3B,EAAGC,EAAwB,uDAAb,EAAGK,EAAU,uCAClDC,EAAQ,EACRC,EAAQ,EAeZ,OAdA/Q,KAAKuQ,MAAQA,EACbvQ,KAAKwQ,SAAWA,EACbK,GACCA,EAASN,EAAOC,EAAUxQ,MAE9BA,KAAKoR,KAAKnR,SAAQ,SAACrB,GACf,MAAiCA,EAAE6S,mBAAmBlB,EAAQ,EAAGC,EAAUK,GAA5D5R,EAAf,EAAQ6R,MAAkB5R,EAA1B,EAAmB6R,MACnBD,EAAQ/V,KAAK4B,IAAIsC,EAAI6R,GACrBC,GAAS7R,EACTqR,GAASrR,KAGbc,KAAK8Q,MAAQA,EACb9Q,KAAK+Q,MAAQA,EACN,CACHD,QAAOC,QAAOR,QAAOC,c,0CAI7B,SAA6BkB,EAAab,GACtC7Q,KAAKwR,WAAWvR,SAAQ,SAAA0R,GACpBD,EAAYC,GACZA,EAAKF,mBAAmB,EAAG,EAAGZ,Q,sBAKtC,SAASA,GACL,IAAIe,EAyBJ,OAxBA5R,KAAKoR,KAAKnR,SAAQ,SAAArB,GACVgT,GAIJf,EAAS,CACLnN,KAAMkO,EAAKvB,GACX1M,GAAI/E,EAAEyR,GACNwB,KAAM,OACN1D,QAASvS,EAAUE,OACnBsS,MAAOxS,EAAUI,IACjB8V,KAAM,CACFpO,KAAMkO,EACNjO,GAAI/E,KAIZA,EAAIA,EAAEmT,SAASlB,GACfe,EAAOhT,GAhBHgT,EAAOhT,KAmBfoB,KAAKwR,WAAWvR,SAAQ,SAAAzG,GACpBA,EAAEuY,SAASlB,MAER7Q,O,sBAGX,SAAS6Q,GACL7Q,KAAKoR,KAAKnR,SAAQ,SAAAzG,GACdA,EAAEyX,SAASJ,MAGf7Q,KAAKwR,WAAWvR,SAAQ,SAAAzG,GACpBA,EAAEyX,SAASJ,U,GA9EJV,IAmFb6B,G,wDACF,WAAY5B,GAAQ,oCAChB,cAAMA,GACN,EAAK6B,YAAc7B,EAAO6B,YAAc,IAAIZ,IAAIC,GAAQ,cAAc/X,KAAtB,oBAChD,EAAK2Y,WAAa9B,EAAO8B,WAAa,IAAIb,IAAIC,GAAQ,aAAa/X,KAArB,oBAC9C,EAAKkX,UAAW,EAJA,E,yDAOpB,WAAsD,IAAnCF,EAAmC,uDAA3B,EAAGC,EAAwB,uDAAb,EAAGK,EAAU,uCAC9CC,EAAQ,EACRC,EAAQ,EACZ/Q,KAAKuQ,MAAQA,EACbvQ,KAAKwQ,SAAWA,EACbK,GACCA,EAASN,EAAOC,EAAUxQ,MAE9B,IAAImS,EAAU,EACVC,EAAU,EACVC,EAAU,EACVC,EAAU,EACdtS,KAAKiS,WAAWhS,SAAQ,SAAC5H,EAAGoE,GACxB,MAAiCpE,EAAEoZ,mBAAmBlB,EAAQ,EAAGC,EAAUK,GAA5D5R,EAAf,EAAQ6R,MAAkB5R,EAA1B,EAAmB6R,MACnBoB,EAAUpX,KAAK4B,IAAIwV,EAASlT,GAC5BmT,GAAWlT,EACXqR,GAASrR,KAEb,IAAMqT,EAAgB/B,EAAW2B,EACjC5B,EAAQvQ,KAAKuQ,MACbvQ,KAAKkS,UAAUjS,SAAQ,SAAC6O,EAAGrS,GACvB,MAAiCqS,EAAE2C,mBAAmBlB,EAAQ,EAAGgC,EAAe1B,GAAjE5R,EAAf,EAAQ6R,MAAkB5R,EAA1B,EAAmB6R,MACnBsB,EAAUtX,KAAK4B,IAAI0V,EAASpT,GAC5BqT,GAAWpT,EACXqR,GAASrR,KAEb4R,EAAQ/V,KAAK4B,IAAI,EAAGwV,EAAUE,GAC9BtB,GAAShW,KAAK4B,IAAIyV,EAASE,GAC3B/B,EAAQvQ,KAAKuQ,MAAQQ,EAAQ,EAC7B,MAAsB/Q,KAAKwS,SAASf,mBAAmBlB,EAAQ,EAAGC,EAAUK,GAA7D3R,EAAf,EAAQ6R,MAIR,OAHAA,GAAS7R,EACTc,KAAK8Q,MAAQA,EACb9Q,KAAK+Q,MAAQA,EACN,CACHD,QAAOC,QAAOR,QAAOC,c,sBAI7B,SAASK,GAAU,WACX4B,EAAQzS,KACZA,KAAKiS,WAAWhS,SAAQ,SAAA5H,GACpBwY,EAAS,CACLnN,KAAM+O,EAAMpC,GACZ1M,GAAItL,EAAEgY,GACNwB,KAAM,aACN1D,QAASvS,EAAUE,OACnBsS,MAAOxS,EAAUI,IACjB8V,KAAM,CACFpO,KAAM+O,EACN9O,GAAItL,KAIZA,EAAIA,EAAE0Z,SAASlB,GACf4B,EAAQpa,KAGZwY,EAAS,CACLnN,KAAM+O,EAAMpC,GACZ1M,GAAI3D,KAAKwS,SAASnC,GAClBlC,QAASvS,EAAUE,OACnBsS,MAAOxS,EAAUI,IACjB6V,KAAM,aACNC,KAAM,CACFpO,KAAM+O,EACN9O,GAAI3D,KAAKwS,YAIjB,IAAIE,EAAQ1S,KA4BZ,OA3BAA,KAAKkS,UAAUjS,SAAQ,SAAA6O,GACnB+B,EAAS,CACLnN,KAAMgP,EAAMrC,GACZ1M,GAAImL,EAAEuB,GACNlC,QAASuE,IAAU,EAAO9W,EAAUC,MAAQD,EAAUE,OACtDsS,MAAOxS,EAAUI,IACjB6V,KAAM,YACNC,KAAM,CACFpO,KAAMgP,EACN/O,GAAImL,KAGZA,EAAIA,EAAEiD,SAASlB,GACf6B,EAAQ5D,KAEZ+B,EAAS,CACLnN,KAAMgP,EAAMrC,GACZ1M,GAAI3D,KAAKwS,SAASnC,GAClBlC,QAASuE,IAAU1S,KAAOpE,EAAUC,MAAQD,EAAUE,OACtDsS,MAAOxS,EAAUC,MACjBgW,KAAM,YACNC,KAAM,CACFpO,KAAMgP,EACN/O,GAAI3D,KAAKwS,YAIVxS,KAAKwS,W,0BAGhB,WACIxS,KAAKwS,SAAWG,GAAQ,CACpBtP,KAAM,WACNgN,GAAI,GAAF,OAAKrQ,KAAKqQ,GAAV,eAENrQ,KAAKwS,SAAS7B,OAAS3Q,KAAK2Q,OAC5B3Q,KAAKwS,SAAS/V,IAAMuD,KAAKvD,IACzBuD,KAAKwS,SAAS5B,kBAAoB5Q,KAAK4Q,oB,sBAG3C,SAASC,GACLA,EAAS7Q,MACTA,KAAKiS,WAAWhS,SAAQ,SAAAzG,GACpBA,EAAEyX,SAASJ,MAEf7Q,KAAKkS,UAAUjS,SAAQ,SAAAzG,GACnBA,EAAEyX,SAASJ,MAEfA,EAAS7Q,KAAKwS,Y,wBAGlB,SAAWpC,EAAQwC,GACf5S,KAAKoQ,OAAOwC,EAASf,MAAMgB,QAAQzC,O,GAlIjBD,IAsIpB2C,G,wDACF,WAAY1C,GAAQ,oCAChB,cAAMA,GACN,EAAK2C,OAAS3C,EAAO2C,OAAS,IAAI1B,IAAIC,GAAQ,QAAQ/X,KAAhB,oBACnC,EAAKwZ,MAAMpc,SACV,EAAKoc,MAAM,EAAKA,MAAMpc,OAAS,GAAGqc,UAAW,GAEjD,EAAKvC,UAAW,EANA,E,yDASpB,WAAsD,WAAnCF,EAAmC,uDAA3B,EAAGC,EAAwB,uDAAb,EAAGK,EAAU,uCAC9CC,EAAQ,EACRC,EAAQ,EACZ/Q,KAAKuQ,MAAQA,EACbvQ,KAAKwQ,SAAWA,EACbK,GACCA,EAASN,EAAOC,EAAUxQ,MAG9B,IAAImS,EAAU,EACVC,EAAU,EACd,GAAGpS,KAAK+S,MAAMpc,OAAQ,CAClB,IAAMsb,EAAajS,KAAK+S,MAAM/S,KAAK+S,MAAMpc,OAAS,GAAGsb,WACrD1B,EAAQvQ,KAAKuQ,MACb0B,EAAWhS,SAAQ,SAAAgT,GACf,MAAiCA,EAAGxB,mBAAmBlB,EAAQ,EAAGC,EAAUK,GAA7D5R,EAAf,EAAQ6R,MAAkB5R,EAA1B,EAAmB6R,MACnBoB,EAAUpX,KAAK4B,IAAIwV,EAASlT,GAC5BmT,GAAWlT,EACXqR,GAASrR,KAKjB,IAAIgU,EAAUf,EACVgB,EAAU,EACdnT,KAAK+S,MAAM9S,SAAQ,SAAC5H,EAAGoE,GACnB,IAAM8V,EAAgB/B,EAAW0C,EAC7Bb,EAAU,EACVC,EAAU,EACd/B,EAAQ,EAAKA,MACblY,EAAE6Z,UAAUjS,SAAQ,SAAAmT,GAChB,MAAiCA,EAAG3B,mBAAmBlB,EAAQ,EAAGgC,EAAe1B,GAAlE5R,EAAf,EAAQ6R,MAAkB5R,EAA1B,EAAmB6R,MACnBsB,EAAUtX,KAAK4B,IAAI0V,EAASpT,GAC5BqT,GAAWpT,EACXqR,GAASrR,KAEbgU,GAAWb,EACXc,EAAUpY,KAAK4B,IAAIwW,EAASb,MAIhCxB,EAAQ/V,KAAK4B,IAAI,EAAGuW,GACpBnC,EAAQhW,KAAK4B,IAAIyV,EAASe,GAC1B5C,EAAQvQ,KAAKuQ,MAAQQ,EACrB,MAAsB/Q,KAAKwS,SAASf,mBAAmBlB,EAAQ,EAAGC,EAAUK,GAA7D3R,EAAf,EAAQ6R,MAKR,OAJAA,GAAS7R,EACT6R,GAAS,EACT/Q,KAAK8Q,MAAQA,EACb9Q,KAAK+Q,MAAQA,EACN,CACHD,QAAOC,QAAOR,QAAOC,c,sBAI7B,SAASK,GAAU,WACX4B,EAAQzS,KACZ,GAAGA,KAAK+S,MAAMpc,OAAQ,CAClB,IAAMsb,EAAajS,KAAK+S,MAAM/S,KAAK+S,MAAMpc,OAAS,GAAGsb,WACrDA,EAAWhS,SAAQ,SAAA5H,GACfwY,EAAS,CACLnN,KAAM+O,EAAMpC,GACZ1M,GAAItL,EAAEgY,GACNlC,QAASvS,EAAUE,OACnBsS,MAAOxS,EAAUI,IACjB6V,KAAM,aACNC,KAAM,CACFpO,KAAM+O,EACN9O,GAAItL,KAGZoa,EAAQpa,EAAE0Z,SAASlB,MA6C3B,OA1CAA,EAAS,CACLnN,KAAM+O,EAAMpC,GACZ1M,GAAI3D,KAAKwS,SAASnC,GAClBlC,QAASvS,EAAUE,OACnBsS,MAAOxS,EAAUI,IACjB6V,KAAM,YACNC,KAAM,CACFpO,KAAM+O,EACN9O,GAAI3D,KAAKwS,YAIjBxS,KAAK+S,MAAM9S,SAAQ,SAAA5H,GACf,IAAIqa,EAAQra,EACZA,EAAE6Z,UAAUjS,SAAQ,SAAA6O,GAChB+B,EAAS,CACLnN,KAAMgP,EAAMrC,GACZ1M,GAAImL,EAAEuB,GACNlC,QAASuE,IAAUra,EAAIuD,EAAUC,MAAQD,EAAUE,OACnDsS,MAAOxS,EAAUI,IACjB6V,KAAM,YACNC,KAAM,CACFpO,KAAMgP,EACN/O,GAAImL,KAGZ4D,EAAQ5D,EAAEiD,SAASlB,MAGvBA,EAAS,CACLnN,KAAMgP,EAAMrC,GACZ1M,GAAI,EAAK6O,SAASnC,GAClBlC,QAASuE,IAAUra,EAAIuD,EAAUC,MAAQD,EAAUE,OACnDsS,MAAOxS,EAAUC,MACjBgW,KAAM,YACNC,KAAM,CACFpO,KAAMgP,EACN/O,GAAI,EAAK6O,eAKdxS,KAAKwS,W,0BAGhB,WACIxS,KAAKwS,SAAWG,GAAQ,CACpBtP,KAAM,WACNgN,GAAI,GAAF,OAAKrQ,KAAKqQ,GAAV,eAENrQ,KAAKwS,SAAS7B,OAAS3Q,KAAK2Q,OAC5B3Q,KAAKwS,SAAS5B,kBAAoB5Q,KAAK4Q,kBACvC5Q,KAAKwS,SAAS/V,IAAMuD,KAAKvD,M,sBAG7B,SAASoU,GACLA,EAAS7Q,MACTA,KAAK+S,MAAM9S,SAAQ,SAAAzG,GACfA,EAAEyX,SAASJ,MAEfA,EAAS7Q,KAAKwS,c,GA/IQrC,IAmJxBkD,G,qIAAyBlD,IAIzBmD,G,wDACF,WAAYlD,GAAQ,oCAChB,cAAMA,GACN,EAAKgB,MAAQhB,EAAOgB,MAAQ,IAAIC,IAAIC,GAAQ,QAAQ/X,KAAhB,oBACpC0J,QAAQC,IAAI,EAAKkO,MACjB,EAAKX,UAAW,EAJA,E,yDAOpB,WAAsD,IAAnCF,EAAmC,uDAA3B,EAAGC,EAAwB,uDAAb,EAAGK,EAAU,uCAC9CC,EAAQ,EACRC,EAAQ,EACZ/Q,KAAKuQ,MAAQA,EACbvQ,KAAKwQ,SAAWA,EACbK,GACCA,EAASN,EAAOC,EAAUxQ,MAE9B,IAAMuS,EAAgB/B,EAAW,EAWjC,OATAxQ,KAAKoR,KAAKnR,SAAQ,SAACrB,GACf,MAAiCA,EAAE6S,mBAAmBlB,EAAQ,EAAGgC,EAAe1B,GAAjE5R,EAAf,EAAQ6R,MAAkB5R,EAA1B,EAAmB6R,MACnBD,EAAQ/V,KAAK4B,IAAIsC,EAAI6R,GACrBC,GAAS7R,EACTqR,GAASrR,KAGbc,KAAK8Q,MAAQA,EAAQ,EACrB9Q,KAAK+Q,MAAQA,EACN,CACHD,QAAOC,QAAOR,QAAOC,c,sBAI7B,SAASK,GAAU,WACXe,EAAO5R,KA+BX,OA7BAA,KAAKoR,KAAKnR,SAAQ,SAACrB,EAAGnC,GAClBoU,EAAS,CACLnN,KAAMkO,EAAKvB,GACX1M,GAAI/E,EAAEyR,GACNwB,KAAM,OACN1D,QAASyD,IAAS,EAAOhW,EAAUC,MAAOD,EAAUE,OACpDsS,MAAOxS,EAAUI,IACjB8V,KAAM,CACFpO,KAAMkO,EACNjO,GAAI/E,KAIZA,EAAIA,EAAEmT,SAASlB,GACfe,EAAOhT,KAEXqE,QAAQC,IAAI0O,IAAS5R,MACrB6Q,EAAS,CACLnN,KAAMkO,EAAKvB,GACX1M,GAAI3D,KAAKqQ,GACTwB,KAAM,OACN1D,QAASyD,IAAS5R,KAAOpE,EAAUC,MAAQD,EAAUE,OACrD4B,UAAWkU,IAAS5R,KACpBoO,MAAOxS,EAAUE,OACjBgW,KAAM,CACFpO,KAAMkO,EACNjO,GAAI3D,QAGLA,O,sBAGX,SAAS6Q,GACLA,EAAS7Q,MACTA,KAAKoR,KAAKnR,SAAQ,SAAAzG,GACdA,EAAEyX,SAASJ,Q,wBAInB,SAAWT,EAAQwC,GACf5S,KAAKoQ,OAAOwC,EAASf,MAAMgB,QAAQzC,O,GA3EdD,IA+EvBoD,G,wDACF,WAAYnD,GAAQ,oCAChB,cAAMA,GACN,EAAK6B,YAAc7B,EAAO6B,YAAc,IAAIZ,IAAIC,GAAQ,cAAc/X,KAAtB,oBAChD,EAAK2Y,WAAa9B,EAAO8B,WAAa,IAAIb,IAAIC,GAAQ,aAAa/X,KAArB,oBAC9C,EAAKyZ,UAAW,EAJA,E,yDAOpB,WAAsD,IAAnCzC,EAAmC,uDAA3B,EAAGC,EAAwB,uDAAb,EAAGK,EAAU,uCAC9CC,EAAQ,EACRC,EAAQ,EACZ/Q,KAAKuQ,MAAQA,EACbvQ,KAAKwQ,SAAWA,EACbK,GACCA,EAASN,EAAOC,EAAUxQ,MAG9B,IAAImS,EAAU,EACVC,EAAU,EACVC,EAAU,EACVC,EAAU,EACXtS,KAAKgT,UACJhT,KAAKiS,WAAWhS,SAAQ,SAAC5H,EAAGoE,GACxB,MAAiCpE,EAAEoZ,mBAAmBlB,EAAQ,EAAGC,EAAUK,GAA5D5R,EAAf,EAAQ6R,MAAkB5R,EAA1B,EAAmB6R,MACnBoB,EAAUpX,KAAK4B,IAAIwV,EAASlT,GAC5BmT,GAAWlT,EACXqR,GAASrR,KAIjB,IAAMqT,EAAgB/B,EAAWzV,KAAK4B,IAAIwV,EAAS,GAanD,OAZA5B,EAAQvQ,KAAKuQ,MACbvQ,KAAKkS,UAAUjS,SAAQ,SAAC6O,EAAGrS,GACvB,MAAiCqS,EAAE2C,mBAAmBlB,EAAQ,EAAGgC,EAAe1B,GAAjE5R,EAAf,EAAQ6R,MAAkB5R,EAA1B,EAAmB6R,MACnBsB,EAAUtX,KAAK4B,IAAI0V,EAASpT,GAC5BqT,GAAWpT,EACXqR,GAASrR,KAEb4R,EAAQ/V,KAAK4B,IAAI,EAAGwV,EAAUE,GAC9BtB,GAAShW,KAAK4B,IAAIyV,EAASE,GAE3BtS,KAAK8Q,MAAQA,EACb9Q,KAAK+Q,MAAQA,EACN,CACHD,QAAOC,QAAOR,QAAOC,c,sBAI7B,SAASK,GACLA,EAAS7Q,MACTA,KAAKiS,WAAWhS,SAAQ,SAAAzG,GACpBA,EAAEyX,SAASJ,MAEf7Q,KAAKkS,UAAUjS,SAAQ,SAAAzG,GACnBA,EAAEyX,SAASJ,Q,wBAInB,SAAWT,EAAQwC,GACf5S,KAAKoQ,OAAOwC,EAASf,MAAMgB,QAAQzC,O,GA3DlBD,IA+DnBqD,GAAe,CACjBxB,eACAc,mBACAS,cACAF,oBACAC,kBACApC,QACAuC,MAAOtD,IAGX,SAASmB,GAAQjO,GACb,OAAO,SAAS7J,EAAGiD,GACf,IAAM9C,EAAIgZ,GAAQnZ,GAKlB,OAJAG,EAAEgX,OAAS3Q,KACXrG,EAAE8C,IAAMA,EACR9C,EAAEiX,kBAAoBvN,EACtB1J,EAAE+Z,eACK/Z,GAGf,SAASgZ,GAAQvC,GACb,IAAM/M,EAAO+M,EAAO/M,KACdsQ,EAAcH,GAAanQ,IAASmQ,GAAaC,MACvDxQ,QAAQC,IAAIG,GACZ,IAAMsO,EAAO,IAAIgC,EAAYvD,GAC7B,OAAOuB,ECjlBX,SAAS7U,GAAIF,GACT,OAAOA,EAAIA,EAEf,SAASG,GAAMC,EAAGC,GACd,OAAOH,GAAIE,EAAE,GAAKC,EAAE,IAAMH,GAAIE,EAAE,GAAKC,EAAE,I,IAiBrC2W,G,WACF,WAAY5S,GAAS,uBACjBhB,KAAK6T,WAAa7S,EAAQ6S,YAAc,GACxC7T,KAAKsP,IAAMtO,EAAQsO,KAAO,GAC1BtP,KAAK8T,QAAQ9S,EAAQ+S,KACrB/T,KAAKgU,QAAS,E,8CAMlB,SAAQD,GAAK,WACT/T,KAAK+T,IAAMA,EACX/T,KAAKiU,UAAY,GACjBjU,KAAKkU,cAAgB,GAErBlU,KAAKmU,KAAOxB,GAAQ3S,KAAK+T,KACzB/T,KAAKmU,KAAKlD,UAAS,SAACU,GAChB,EAAKsC,UAAUhd,KAAK,CAChBoM,KAAMsO,EAAKtO,KACXrC,QAAS2Q,EAAKvB,OACdgE,WAAYzC,OAIpB,IAmBI0C,EAnBEC,EAAgB,CAClBC,SAAU,GACVC,WAAY,IAEVC,EAA0B,GAChCzU,KAAKmU,KAAKO,uBAAuB,EAAG,GAAG,SAACnE,EAAOC,EAAUmB,GACjDA,EAAKR,SACDmD,EAAcC,SAAShE,KACvB+D,EAAcC,SAAShE,GAAS,IAEpC+D,EAAcC,SAAShE,GAAOC,GAAYmB,EAEtC2C,EAAcE,WAAWhE,KACzB8D,EAAcE,WAAWhE,GAAY,IAEzC8D,EAAcE,WAAWhE,GAAUD,GAASoB,MAKpD3R,KAAKmU,KAAKQ,8BACN,SAACC,GACGP,EAAmBO,EAAQvE,GAC3BoE,EAAwBG,EAAQvE,IAAM,CAClCkE,SAAU,GACVC,WAAY,GACZ7C,KAAMiD,MAGd,SAACrE,EAAOC,EAAUmB,GACd,IAAM2C,EAAgBG,EAAwBJ,GAC1CC,EAAcC,SAAShE,KACvB+D,EAAcC,SAAShE,GAAS,IAEpC+D,EAAcC,SAAShE,GAAOC,GAAYmB,EAEtC2C,EAAcE,WAAWhE,KACzB8D,EAAcE,WAAWhE,GAAY,IAEzC8D,EAAcE,WAAWhE,GAAUD,GAASoB,KAGpD3R,KAAKsU,cAAgBA,EACrBtU,KAAKyU,wBAA0BA,EAC/BzU,KAAKmU,KAAKpC,UAAS,SAAC/Q,GAChB,EAAKkT,cAAcjd,KAAK+J,Q,yBAIhC,SAAYd,EAAUoJ,GAElB,GAAGpJ,EAASsB,aAAetB,EAASsB,YAAYkP,OAC5C,OAAO,EAEX,IAAMmE,EAASvL,EAAM7D,WAAWqP,MAAK,SAAA3c,GAAC,OAAIA,EAAEuL,OAASxD,GAAY/H,EAAEwL,KAAOzD,KAC1E,IAAI2U,EACA,OAAO,EAEX,IAAME,EAAY7U,EAAS4C,OAAO/I,QAElC,GADAuP,EAAMjJ,WACHiJ,EAAM7D,WAAW9O,OAAS,GAA7B,CACA,IAAMqe,EAAgB9U,EAAS4C,OACzBxK,EAAIyE,GAAMgY,EAAWC,GAC3B,OAAG1c,EAAI,MACH2K,QAAQC,IAAIhD,GACZA,EAASsC,cAAc,IAAI2G,EAAW,YAAa,CAC/CrG,OAAQiS,EACR7U,WACAoJ,QACAxK,MAAOiW,MAEJ,M,6BAKf,SAAgBT,GAA6B,IAAd1X,EAAc,uDAAV,EAAGC,EAAO,uDAAH,EAChCgX,EAAa7T,KAAK6T,WAClBvE,EAAMtP,KAAKsP,IAEH2F,EAEVX,EAFAC,SACYW,EACZZ,EADAE,WAGAxE,EAAcpT,EAClBhG,OAAOgM,KAAKsS,GAAmBjV,SAAQ,SAACkV,EAAc1Y,GAClD,IAAM2Y,EAASF,EAAkBC,GAC7BE,EAAW,EACTC,EAAO1e,OAAOgM,KAAKwS,GACzBE,EAAKrV,SAAQ,SAAAsV,GACT,IAAMxB,EAAMqB,EAAOG,GACbrV,EAAW6T,EAAIzD,mBACrB,EAAkBpQ,EAAS6P,uBAAnBvV,EAAR,EAAQA,MACR6a,EAAWta,KAAK4B,IAAInC,EAAO6a,MAE/BrF,GAAuB,IAARvT,EAAY,EAAG4Y,EAAS,EACvCC,EAAKrV,SAAQ,SAAAsV,GACT,IAAMxB,EAAMqB,EAAOG,GACbrV,EAAW6T,EAAIzD,mBACrBpQ,EAAS4C,OAAO,GAAKkN,KAEzBA,GAAgBqF,EAAS,EAAI/F,KAGjC,IAAIM,EAAe/S,EAEnBjG,OAAOgM,KAAKqS,GAAiBhV,SAAQ,SAACsV,EAAW9Y,GAC7C,IAAM+Y,EAAMP,EAAgBM,GACxBE,EAAY,EACVC,EAAU9e,OAAOgM,KAAK4S,GAC5BE,EAAQzV,SAAQ,SAAAkV,GACZ,IAAMpB,EAAMyB,EAAIL,GACVjV,EAAW6T,EAAIzD,mBACrB,EAA0BpQ,EAAS6P,uBAA3BtV,EAAR,EAAQA,OAAR,EAAgBD,MAChBib,EAAY1a,KAAK4B,IAAIlC,EAAQgb,MAEjC7F,GAAwB,IAARnT,EAAY,EAAIgZ,EAAU,EAC1CC,EAAQzV,SAAQ,SAAAkV,GACZ,IAAMpB,EAAMyB,EAAIL,GACVjV,EAAW6T,EAAIzD,mBACrBpQ,EAAS4C,OAAO,GAAK8M,KAEzBA,GAAiB6F,EAAU,EAAI5B,O,4BAKvC,SAAe7S,GACX,IAAM6T,EAAS7U,KAAKiU,UAAUa,MAAK,SAAAnD,GAAI,OAAIA,EAAK3Q,UAAYA,KAC5D,OAAG6T,EACQA,EAAOT,WAEX,O,oBAGX,SAAO9K,GAAM,WACTtJ,KAAK2V,gBAAgB3V,KAAKsU,eAC1B1d,OAAOgf,OAAO5V,KAAKyU,yBAAyBxU,SAAQ,SAAA4V,GAChD,IAAMlE,EAAOkE,EAAQlE,KAAKrB,mBAC1B,EAAKqF,gBAAgBE,EAASlE,EAAK7O,OAAO,GAAI6O,EAAK7O,OAAO,W,KAKvD8Q,MC3KTkC,G,wDAKF,WAAY9U,GAAS,oCACjB,eACA,EAAK2B,WAAa,QAClB,EAAK+C,UAAU1E,GACf,EAAK4F,WAAW5F,GAQhB,EAAK+U,QAAU,GACf,EAAK1b,IAAM,KACX,EAAKH,OAAS,KACd,EAAK8b,IAAM,EACX,EAAK3L,QAAU,GAQf,EAAKpP,SAAW,KACtB,EAAKJ,MAAQ,KACP,EAAKob,QAAU,EACf,EAAKC,QAAU,GAGrB,EAAKC,QAAU,KACT,EAAKC,WAAa,CACdxZ,EAAG,KACHC,EAAG,KACHwZ,UAAU,EACVC,YAAY,GAEhB,EAAKC,eAAiB,CAClB1Q,OAAQ,KACRQ,WAAY,KACZiQ,YAAY,GAGhB,EAAKjU,QAAU,CACXnC,SAAU,KACVoC,KAAM,KACNjB,OAAQ,KACRmV,iBAAiB,EACjBC,aAAa,EAEbC,MAAO,CACHjH,MAAO,KACPkH,QAAS,KACT7X,MAAO,MAEXgT,KAAM,CACFlV,OAAG2E,EACH1E,OAAG0E,EACHqV,cAAUrV,EACVsV,cAAUtV,GAEdL,OAAQ,CACJ4V,aAAa,EACbT,UAAU,EACVC,YAAY,IAIpB,EAAKS,WAAa,CACd7W,SAAU,KACVoW,YAAY,GAGhB,EAAKU,UAAYhW,EAAQgW,UAzER,E,0CA4ErB,SAAIC,GACAjX,KAAK+V,QAAQ9e,KAAKggB,K,oBAMtB,SAAOC,GACH,MASIld,EAAakd,GARbhd,EADJ,EACIA,OACAG,EAFJ,EAEIA,IACO2b,EAHX,EAGInb,MACOsc,EAJX,EAII3c,MACQ4c,EALZ,EAKI3c,OACAU,EANJ,EAMIA,UACAC,EAPJ,EAOIA,WAPJ,EAQIV,KARJ,EAQUC,IAEVqF,KAAKK,SACLL,KAAK3F,IAAMA,EACX2F,KAAKwM,WAAa0K,EAClBlX,KAAK9F,OAASA,EACd8F,KAAKqX,WAAa,CACd7c,MAAOW,EACPV,OAAQW,EACRkc,aAAcH,EACdI,cAAeH,GAEnBpX,KAAKgW,IAAMA,EACXhW,KAAKwX,sBACLxX,KAAKgH,wBAEL,IAAMqD,EAAUrK,KAAKqK,QACrB,EAAmDrK,KAAK9D,aAAzCub,EAAf,EAAQjd,MAAwBkd,EAAhC,EAAwBjd,OAAkBmC,EAA1C,EAA0CA,EAAGC,EAA7C,EAA6CA,EACvC8a,EAAa,CACf/a,EAAGyN,EACHxN,EAAGwN,EACH7P,MAAO2c,EAAoB,EAAV9M,EACjB5P,OAAQ2c,EAAqB,EAAV/M,GAEjBpP,EAAW,CAAE2B,EAAG,EAAGC,EAAG,EAAG6N,QAAS,EAAGD,QAAS,GAC9CmN,EAAUD,EAAWnd,MAAQid,EAC7BI,EAAUF,EAAWld,OAASid,EAC9BI,EAAQF,GAAWC,EAAU,IAAM,IACnCE,EAAahd,KAAKqC,IAAIwa,EAASC,GACrC7X,KAAKnF,MAAQkd,EACVA,EAAa/X,KAAKiW,UACjBjW,KAAKiW,QAAU8B,GAEhBA,EAAa/X,KAAKkW,UACjBlW,KAAKkW,QAAU6B,GAGnB9c,EAAS2B,EAAc,MAAVkb,EAAgBH,EAAW/a,GAAK+a,EAAWnd,MAAQid,EAAUM,GAAc,EAAI1N,EAC5FpP,EAAS4B,EAAc,MAAVib,EAAgBH,EAAW9a,GAAK8a,EAAWld,OAASid,EAAWK,GAAc,EAAI1N,EAC9FpP,EAASyP,QAAUzP,EAAS2B,EAAIA,EAAImb,EACpC9c,EAASwP,QAAUxP,EAAS4B,EAAIA,EAAIkb,EACpC/X,KAAK/E,SAAWA,EAChB+E,KAAK6M,Y,mCAoCT,WACI,IAAM1Q,EAAS6D,KAAKwF,OAAOmF,wBAC3B,GAAG3K,KAAK9D,aAAc,CAClB8D,KAAK9D,aAAeA,EAAaC,GACjC,MAGI6D,KAAK9D,aAFF8b,EADP,EACIpb,EACGqb,EAFP,EAEIpb,EAEEhC,EAAQmF,KAAKnF,MACnBmF,KAAK/E,SAAS2B,EAAIoD,KAAK/E,SAASyP,QAAUsN,EAAOnd,EACjDmF,KAAK/E,SAAS4B,EAAImD,KAAK/E,SAASwP,QAAUwN,EAAOpd,OAEjDmF,KAAK9D,aAAeA,EAAaC,K,uBAQzC,SAAU+D,GAAU,WACbF,KAAK+W,WAAWT,aACnBtW,KAAK+W,WAAWT,YAAa,EAC1BtW,KAAK+W,WAAW7W,WACfF,KAAK+W,WAAW7W,SAASgB,OAAOE,OAAQ,GAG5CpB,KAAK+W,WAAW7W,SAAWA,EACxBA,IACCA,EAASgB,OAAOE,OAAQ,EACxBlB,EAASkD,YAAY,IAAI+F,EAAW,WAGxC0E,uBAAsB,WAClB,EAAKhB,UACL,EAAKkK,WAAWT,YAAa,Q,iCAKrC,WACI,IAgBI4B,EAhBEhe,EAAS8F,KAAK9F,OACdie,EAAcnY,KAAKoY,QAAQ7e,KAAKyG,MAChCqY,EAAoBrY,KAAKsY,cAAc/e,KAAKyG,MAC5CuY,EAAmBvY,KAAKwY,aAAajf,KAAKyG,MAC1CyY,EAAiBzY,KAAK0Y,WAAWnf,KAAKyG,MACtC2Y,EAAkB3Y,KAAK4Y,mBAAmBrf,KAAKyG,MAC/C6Y,EAAqB7Y,KAAK8Y,eAAevf,KAAKyG,MACpD9F,EAAOmS,iBAAiB,QAAS8L,GACjCje,EAAOmS,iBAAiB,eAAe,SAAAY,GACnCA,EAAE8L,oBAEN7e,EAAOmS,iBAAiB,cAAegM,GACvCne,EAAOmS,iBAAiB,cAAekM,GACvCre,EAAOmS,iBAAiB,YAAaoM,GACrCve,EAAOmS,iBAAiB,cAAewM,GACvC1e,SAASkS,iBAAiB,YAAasM,GAEvC,IAAMK,EAA4B,WAC9B9e,EAAO+e,oBAAoB,QAASd,GACpCje,EAAO+e,oBAAoB,cAAeZ,GAC1Cne,EAAO+e,oBAAoB,cAAeV,GAC1Cre,EAAO+e,oBAAoB,YAAaR,GACxCte,SAAS8e,oBAAoB,YAAaN,IAI9C,GAFAT,EAAkBc,EAEfhZ,KAAKgX,UAAW,CACf,IAAMkC,EAAkBlZ,KAAKmZ,YAAY5f,KAAKyG,MACxCoZ,EAAcpZ,KAAKqZ,QAAQ9f,KAAKyG,MACtC9F,EAAOmS,iBAAiB,WAAY6M,GACpChf,EAAOmS,iBAAiB,OAAQ+M,GAChClB,EAAkB,WACdc,IACA9e,EAAO+e,oBAAoB,WAAYC,GACvChf,EAAO+e,oBAAoB,OAAQG,IAG3CpZ,KAAKsZ,QAAUpB,I,2BAGnB,SAAcqB,EAAanQ,GAAO,WAC1BtK,EAAQkB,KAAKkL,oBAAoBqO,GACrCvZ,KAAKmL,UAAYrM,EACjB,IAAI2Q,EAAQzP,KAAKwF,OACXK,EAAS4J,EAAMrE,SAAStM,GAAO,SAACoB,GAClC,OAAO,EAAKmC,QAAQnB,OAAOmV,UAAanW,IAAa,EAAKqC,sBAE1DiX,EAAYxZ,KAAKyF,WACjBkR,EAAU3W,KACX6F,IACC2T,EAAY3T,EAAOvE,SAASmE,WAC5B3G,EAAQ+G,EAAOvE,SAAS6J,UACxBsE,EAAQ5J,EAAOvE,SAASkE,OACxBmR,EAAU9Q,EAAOvE,UAErB,IAAM+E,EAAamT,EAAUpO,SAAStM,GAkBtC,GAhBAlI,OAAOqK,OAAOjB,KAAKqC,QAAS,CACxBnC,SAAU2F,EACVvD,KAAM+D,EACNmQ,gBAAiB3Q,IAAW7F,KAAKqC,QAAQnC,SACzCuW,YAAapQ,IAAerG,KAAKqC,QAAQC,OAE7C1L,OAAOqK,OAAOjB,KAAKqC,QAAQqU,MAAO,CAC9BjH,QACAkH,UACA7X,UAEJlI,OAAOqK,OAAOjB,KAAKqC,QAAQyP,KAAM,CAC7BlV,EAAG2c,EAAY,GACf1c,EAAG0c,EAAY,KAGN,eAAVnQ,IAA2BpJ,KAAKqC,QAAQnB,OAAOmV,WAAarW,KAAKqC,QAAQnB,OAAO4V,YAAa,CAC5F,IAAI2C,EAAe5T,EACnB,MAAO4T,GAAgBA,EAAanY,SAASiJ,MAAQkP,IAAiBzZ,KAClEyZ,EAAeA,EAAanY,SAE7BmY,IAAiBzZ,OAChByZ,EAAe5T,GAEhB4T,IAEKA,EADDA,EAAajY,aAAeiY,EAAajY,YAAYiP,SACrCgJ,EAAajY,YAAYkY,WAEzB,CAACD,IAGxB7iB,OAAOqK,OAAOjB,KAAKqC,QAAS,CACxBhB,OAAQoY,IAIhB,OAAOzZ,KAAKqC,U,8BAGhB,WACI,OAAOrC,KAAKqC,QAAQhB,QAAUrB,KAAKqC,QAAQhB,OAAO,K,yBAGtD,SAAY+H,GAAO,WAEf,GADAA,EAAM2P,kBACH/Y,KAAKuW,eAAeD,WAAvB,CACAtW,KAAKuW,eAAeD,YAAa,EACjC,IAAQ5L,EAAqBtB,EAArBsB,QAASD,EAAYrB,EAAZqB,QACjB7T,OAAOqK,OAAOjB,KAAKqC,QAAQnB,OAAQ,CAC/B4V,aAAa,IAEjB9W,KAAK2Z,cAAc,CAACjP,EAASD,IAE1BzK,KAAKqC,QAAQoU,aAAezW,KAAKqC,QAAQmU,gBACxC3I,uBAAsB,WAClB,EAAKhB,UACL,EAAKxK,QAAQoU,aAAc,EAC3B,EAAKpU,QAAQmU,iBAAkB,EAC/B,EAAKD,eAAeD,YAAa,KAGrCtW,KAAKuW,eAAeD,YAAa,K,qBAIzC,SAAQlN,GAAO,WAELwQ,GADyCxQ,EAAvCsB,QAAuCtB,EAA9BqB,QAA8BrB,EAArByQ,QAAqBzQ,EAAZ0Q,QACnB9Z,KAAKsH,kBACfpH,EAAW0Z,EAAQ1Z,SAEzB,EAGIF,KAAKqC,QAFLC,EADJ,EACIA,KACUuD,EAFd,EAEI3F,SAEJ,EAEIF,KAAKqC,QAAQqU,MADb5X,EADJ,EACIA,MAAO6X,EADX,EACWA,QAERrU,GAaCpC,EAAS4C,OAAShE,EAClBwD,EAAKE,cAAc,IAAI2G,EAAW,OAAQ,CACtCC,QACAlJ,WACAoC,OACAgH,MAAOtJ,KACP2W,UACA7X,YAGE+G,EAYNA,EAAOzC,YAAY,IAAI+F,EAAW,OAAQ,CACtCC,QACAlJ,WACAoJ,MAAOtJ,KACP6F,SACA/G,WAgBJkB,KAAKwC,cAAc,IAAI2G,EAAW,OAAQ,CACtCC,QACAlJ,WACAoJ,MAAOtJ,KACP6F,SACA/G,WASR+O,uBAAsB,WAElB,EAAKxL,QAAQnC,SAAW,KACxB,EAAKmC,QAAQC,KAAO,KACpB1L,OAAOqK,OAAO,EAAKoB,QAAQnB,OAAQ,CAChC4V,aAAa,S,qBAMxB,SAAQ1N,GAAO,WAEX,GADAA,EAAM2P,kBACH/Y,KAAK+Z,SAAR,CACA/Z,KAAK+Z,UAAW,EAChB,IAAQrP,EAA6BtB,EAA7BsB,QAASD,EAAoBrB,EAApBqB,QAASuP,EAAW5Q,EAAX4Q,OAC1B,EAAmDha,KAAK9D,aAAzCub,EAAf,EAAQjd,MAAwBkd,EAAhC,EAAwBjd,OAAkBmC,EAA1C,EAA0CA,EAAGC,EAA7C,EAA6CA,EACzCod,EAAWja,KAAKnF,MACdqf,EAASF,EAAS,EAAI,IAAM,EAAI,IACtCC,GAAYC,EAERla,KAAKiW,SAAWgE,EAAWja,KAAKiW,UAEhCgE,EAAWja,KAAKiW,SAGjBjW,KAAKkW,SAAW+D,EAAWja,KAAKkW,UAC/B+D,EAAWja,KAAKkW,SAGpB,IAAIiE,EAAgBF,EAAWja,KAAKnF,MAChCuf,EAAgB3C,EAAUzX,KAAKnF,MAC/Bwf,EAAgB3C,EAAW1X,KAAKnF,MAChCyf,EAAgB7C,EAAU0C,EAC1BI,EAAgB7C,EAAWyC,EAE3BK,EAAK9P,EAAU1K,KAAK/E,SAAS2B,EAC7B6d,EAAKhQ,EAAUzK,KAAK/E,SAAS4B,EAC7B6d,GAAMF,EAAKJ,EACXO,GAAMF,EAAKJ,EAEfra,KAAKnF,MAAQof,EACbja,KAAK/E,SAAS2B,GAAK8d,EAAKJ,EAC9Bta,KAAK/E,SAAS4B,GAAK8d,EAAKJ,EAClBva,KAAK/E,SAASyP,QAAU1K,KAAK/E,SAAS2B,EAAIA,EAAIqd,EAC9Cja,KAAK/E,SAASwP,QAAUzK,KAAK/E,SAAS4B,EAAIA,EAAIod,EAC9CpM,uBAAsB,WAClB,EAAKhB,UACL,EAAKkN,UAAW,Q,2BAIxB,SAAc3Q,GACVnG,QAAQC,IAAI,aAAckG,GAC1B,IAAQsB,EAAqCtB,EAArCsB,QAASD,EAA4BrB,EAA5BqB,QAAiBmQ,GAAWxR,EAAnB4Q,OAAmB5Q,EAAXwR,QAClC,GAAc,IAAXA,IACH5a,KAAK2Z,cAAc,CAACjP,EAASD,GAAU,cACvC7T,OAAOqK,OAAOjB,KAAKqC,QAAQyP,KAAM,CAC7B8E,SAAUlM,EACVmM,SAAUpM,IAEd7T,OAAOqK,OAAOjB,KAAKqC,QAAQnB,OAAQ,CAC/BmV,UAAU,EACVC,YAAY,IAEbtW,KAAKqC,QAAQhB,QAAQ,CACpB,IAAMA,EAASrB,KAAKuC,mBAUpBlB,EAAOmB,cAAc,IAAI2G,EAAW,aAAc,CAC9CC,QACAlJ,SAAUmB,EACViI,MAAOtJ,W,0BAKnB,SAAaoJ,GAAO,WAEhB,EAEIpJ,KAAKqC,QAAQnB,OADbmV,EADJ,EACIA,SAAUC,EADd,EACcA,WAEd,EAAiBtW,KAAKqC,QAAQyP,KAAtBlV,EAAR,EAAQA,EAAGC,EAAX,EAAWA,EAEH6N,EAAuCtB,EAAvCsB,QAASD,EAA8BrB,EAA9BqB,QAA8BrB,EAArByQ,QAAqBzQ,EAAZ0Q,QACnC,IAAIzD,IAAaC,EAAY,CACzB,MAGItW,KAAK2Z,cAAc,CAACjP,EAASD,IAF7BnI,EADJ,EACIA,KACApC,EAFJ,EAEIA,SAGAF,KAAK9F,OAAOU,MAAMigB,OADnB3a,GAAYoC,EACgB,OAEA,UAGnC,GAAI+T,IACDC,EAAH,CAEA,IAAMmD,EAAezZ,KAAKqC,QAAQhB,OAElCrB,KAAKqC,QAAQnB,OAAOoV,YAAa,EACjC,IAAMwE,EAASpQ,EAAU9N,EACnBod,EAASvP,EAAU5N,EAEtB4c,EACCA,EAAaxZ,SAAQ,SAAAhH,GACjBA,EAAE6J,OAAO,IAAMgY,EAAS,EAAKjgB,MAC7B5B,EAAE6J,OAAO,IAAMkX,EAAS,EAAKnf,SAGjCmF,KAAK+a,qBAAqBD,EAAQd,GAEtCha,KAAK2Z,cAAc,CAACjP,EAASD,IAK7BoD,uBAAsB,WAClB,EAAKhB,UACL,EAAKxK,QAAQoU,aAAc,EAC3B,EAAKpU,QAAQmU,iBAAkB,EAC/B,EAAKnU,QAAQnB,OAAOoV,YAAa,Q,wBAKzC,SAAWlN,EAAO4R,GACd5R,EAAM2P,iBACN3P,EAAM6R,kBACN,IAAQL,EAAWxR,EAAXwR,OACR,GAAc,IAAXA,EAAH,CACA,IAAM9I,EAAO9R,KAAKqC,QAAQyP,KAQ1B,GAAGA,EAAK8E,WAAa9E,EAAKlV,GACnBkV,EAAK+E,WAAa/E,EAAKjV,EAAG,CACzB,GAAGmD,KAAKqC,QAAQnC,WAAa8a,EAAY,CACrC,IAAM/hB,EAAI+G,KAAKqC,QAAQnC,SAmBvB,OARAjH,EAAEmK,YAAY,IAAI+F,EAAW,QAAS,CAClCC,QACAvD,OAAQ5M,EACRqQ,MAAOtJ,KACPmD,SAAS,KAEbnD,KAAKkb,oBACLlb,KAAK6M,UASL,OANA7M,KAAKwC,cAAc,IAAI2G,EAAW,QAAS,CACvCC,QACAE,MAAOtJ,QAEXA,KAAKkb,oBACLlb,KAAK6M,UAIV,GAAG7M,KAAKqC,QAAQhB,OAAQ,CAC3B,IAAI8Z,GAAc,EAKlB,GAJGnb,KAAK2G,QAAQqN,SACZmH,EAAcnb,KAAKiH,YAAYjH,KAAKuC,sBAGpC4Y,GAAenb,KAAKqC,QAAQC,KAAM,CAClC,MAEItC,KAAKqC,QAAQqU,MADNC,GADX,EACI7X,MADJ,EACW6X,SAELrU,EAAOtC,KAAKqC,QAAQC,KACpBpC,EAAWF,KAAKuC,mBAqBtBD,EAAKE,cAAc,IAAI2G,EAAW,OAAQ,CACtCC,QACAlJ,WACAoC,OACAgH,MAAOtJ,KACP2W,aAQJ3W,KAAKqC,QAAQC,KAAO,KACpBtC,KAAKqC,QAAQnC,SAAW,KAUzBF,KAAKqC,QAAQhB,SACTrB,KAAKqC,QAAQnC,SAYZF,KAAKqC,QAAQnC,SAASkD,YAAY,IAAI+F,EAAW,WAAY,CACzDC,QACAlJ,SAAUF,KAAKuC,mBACf+G,MAAOtJ,KACP6F,OAAQ7F,KAAKqC,QAAQnC,SACrBiD,SAAS,KAYbnD,KAAKwC,cAAc,IAAI2G,EAAW,WAAY,CAC1CC,QACAlJ,SAAUF,KAAKuC,mBACf+G,MAAOtJ,SAInBA,KAAKqC,QAAQhB,OAAS,KAEtBrB,KAAK6M,UAET7M,KAAKkb,kB,0BAGT,WACItkB,OAAOqK,OAAOjB,KAAKqC,QAAQyP,KAAM,CAC7BlV,OAAG2E,EACH1E,OAAG0E,EACHqV,cAAUrV,EACVsV,cAAUtV,IAEd3K,OAAOqK,OAAOjB,KAAKqC,QAAQnB,OAAQ,CAC/BmV,UAAU,EACVC,YAAY,IAEhB1f,OAAOqK,OAAOjB,KAAKqC,QAAS,CACxBnC,SAAU,KACVoC,KAAM,KACNjB,OAAQ,S,gCAIhB,SAAmB+H,GACfpJ,KAAK0Y,WAAWtP,GAAO,K,sBAG3B,SAASA,GACL,IAAQsB,EAAqBtB,EAArBsB,QAASD,EAAYrB,EAAZqB,QACX3L,EAAQkB,KAAKkL,oBAAoB,CAACR,EAASD,IAClCzK,KAAKwF,OAAO4F,SAAStM,K,4BAGxC,SAAesK,GACXA,EAAM2P,iBACN3P,EAAM6R,kBACN,IAAQvQ,EAAqBtB,EAArBsB,QAASD,EAAYrB,EAAZqB,QACjB,EAGIzK,KAAK2Z,cAAc,CAACjP,EAASD,IAF7BnI,EADJ,EACIA,KACApC,EAFJ,EAEIA,SAEJ,GAAGA,GAAYoC,EAAM,CACjB,IAAMuD,EAAU3F,GAAYoC,EAC5BuD,EAAOzC,YAAY,IAAI+F,EAAW,eAAgB,CAC9CC,QACAE,MAAOtJ,KACP6F,SACA1C,SAAS,Q,kCAKrB,SAAqB2X,EAAQd,EAAQnf,GACjC,MAAiBmF,KAAK9D,aAAdU,EAAR,EAAQA,EAAGC,EAAX,EAAWA,OACE0E,IAAV1G,IACCA,EAAQmF,KAAKnF,OAEjBmF,KAAK/E,SAAS2B,GAAKke,EACzB9a,KAAK/E,SAAS4B,GAAKmd,EACbha,KAAK/E,SAASyP,QAAU1K,KAAK/E,SAAS2B,EAAIA,EAAI/B,EAC9CmF,KAAK/E,SAASwP,QAAUzK,KAAK/E,SAAS4B,EAAIA,EAAIhC,I,kCAGlD,SAAqBlB,GACjB,IAAMkB,EAAQmF,KAAKnF,MACbI,EAAW+E,KAAK/E,SACtB,MAAO,CAACtB,EAAE,GAAKkB,EAAQI,EAASyP,QAAS/Q,EAAE,GAAKkB,EAAQI,EAASwP,W,iCAGrE,SAAoB9Q,GAChB,IAAMkB,EAAQmF,KAAKnF,MACbI,EAAW+E,KAAK/E,SACtB,MAAO,EAAEtB,EAAE,GAAKsB,EAASyP,SAAS7P,GAAQlB,EAAE,GAAKsB,EAASwP,SAAW5P,K,gCAGzE,SAAmB1C,GACf,IAAM0C,EAAQmF,KAAKnF,MACnB,OAAOA,EAAQ1C,I,6BAGnB,WACI,MAA6C6H,KAAKqX,WAAnCF,EAAf,EAAQ3c,MAAwB4c,EAAhC,EAAwB3c,OAClBQ,EAAW+E,KAAK/E,SAChBJ,EAAQmF,KAAKnF,MACbR,EAAM2F,KAAK3F,IACjBA,EAAI+gB,eACJ/gB,EAAIoB,UAAU,EAAG,EAAG0b,EAASC,GAC7B/c,EAAIQ,MAAMmF,KAAKgW,IAAKhW,KAAKgW,KACzB3b,EAAIqS,UAAU7R,EAAO,EAAG,EAAGA,EAAOI,EAASyP,QAASzP,EAASwP,W,qBAKjE,WACIzK,KAAKqb,kBAIL,IAAI7B,EAAYxZ,KAAKyF,WAMrB+T,EAAUhe,OAAOwE,KAAK3F,KACtB2F,KAAKwF,OAAOhK,OAAOwE,KAAK3F,S,kBAhyBZmJ,cAoyBpB5M,OAAOqK,OAAO6U,GAAMjf,UAAWqQ,GAC/BtQ,OAAOqK,OAAO6U,GAAMjf,UAAWwO,GAC/BzO,OAAOqK,OAAO6U,GAAMjf,UAAW6P,GAEhBoP,UC/zBA,I,UAAA,CACXwF,QADW,WAEP,MAAO,CACH3V,WAAY3F,KAAK2F,WACjBK,eAAgBhG,KAAKgG,eACrBC,gBAAiBjG,KAAKiG,gBACtBC,oBAAqBlG,KAAKkG,oBAC1BqV,kBAAmBvb,KAAKub,oBAGhCplB,KAVW,WAWP,MAAO,CACHsZ,MAAO,KAGf+L,QAAS,CACLD,kBADK,SACahjB,GACd,IAAMkjB,EAAMzb,KAAKyP,MAAMqF,MAAK,SAAAre,GAAC,OAAIA,EAAE8B,OAASA,KAC5C,OAAGkjB,EACQA,EAAIvb,SAER,MAEXyF,WARK,SAQMzF,EAAU3H,GACjByH,KAAK0b,eAAe/V,WAAWzF,GAC/BF,KAAKyP,MAAMxY,KAAK,CACZsB,OACA2H,cAIR8F,eAhBK,SAgBU1D,GACXtC,KAAK0b,eAAe1V,eAAe1D,IAGvC2D,gBApBK,SAoBW/F,GACZF,KAAK0b,eAAezV,gBAAgB/F,IAGxCgG,oBAxBK,SAwBe5D,GAChBtC,KAAK0b,eAAexV,oBAAoB5D,IAG5CqZ,qBA5BK,WA6BD3b,KAAK0b,eAAe3U,cACpB/G,KAAK0b,eAAerb,aCrCjB,IACXub,OAAQ,CAACvW,IACTiW,QAFW,WAGP,MAAO,CACHO,YAAa7b,KAAK6b,YAClBC,mBAAoB9b,KAAK8b,qBAGjCC,MAAO,CACH/a,QAAS,CACLqC,KAAMzM,OACNolB,QAAS,WACL,MAAO,MAInB7lB,KAhBW,WAiBP,MAAO,CACH6a,MAAO,GACPzL,MAAO,KAGf/J,OAAQ,SAAUpB,GAAe,WAC7B,GAAI4F,KAAKgR,MAAMra,OAER,CACH,IAAMslB,EAASjc,KAAKgR,MAAMK,KAAI,YAA6B,IAA1BhO,EAA0B,EAA1BA,KAAMrC,EAAoB,EAApBA,QAAS8Q,EAAW,EAAXA,KAC5C,GAAI,EAAKoK,aAAa7Y,GAAtB,CAGA,MAAgB,EAAK6Y,aAAa7Y,GAAM,CAAErC,UAAS8Q,SAAnD,sBAAOqK,EAAP,KAYA,OAXArK,EAAKxB,iBAAmB,WAEpB,IAAIpQ,EAAWic,EAAMC,kBACrB,MAAMlc,IAAaA,EAASwb,eACxBxb,EAAWA,EAASmc,UAAU,GAIlC,OADAnc,EAASwb,eAAela,YAAcsQ,EAC/B5R,EAASwb,gBAEpBS,EAAM7iB,IAAM0H,EAAQqP,GACb8L,MAELG,EAAStc,KAAKuF,MAAM8L,KAAI,SAAAS,GAC1B,IAAIzO,EAAOyO,EAAKzO,MAAQ,YACxB,IAAI,EAAK6Y,aAAa7Y,GAClB,OAAO,KAEX,MAAgB,EAAK6Y,aAAa7Y,GAAM,CAAErC,QAAS8Q,IAAnD,sBAAOqK,EAAP,KAEA,OADAA,EAAM7iB,IAAN,UAAewY,EAAKpO,KAApB,YAA4BoO,EAAKnO,GAAjC,YAAuCmO,EAAKD,MACrCsK,KAGX,OAAO/hB,EAAc,MAAD,yBAAY6hB,GAAZ,eAAuBK,KA9B3C,OAAOliB,EAAc,MAAO4F,KAAKuc,OAAOP,UAkChDQ,QA1DW,WA2DPxc,KAAK0b,eAAiB,IAAI5F,GAAM9V,KAAKgB,UAEzCyb,QA7DW,WA6DD,WACNxZ,QAAQC,IAAIlD,MAEZA,KAAKgR,MAAQhR,KAAK0b,eAAe/U,QAAQsN,UAAU5C,KAAI,SAAAS,GACnD,MAAO,CACHzO,KAAMyO,EAAKzO,KACXrC,QAAS8Q,EAAK9Q,QACd8Q,KAAMA,EAAKsC,eAInBpU,KAAKuF,MAAQvF,KAAK0b,eAAe/U,QAAQuN,cAAcna,QACvDiG,KAAK0c,WAAU,WACX,EAAKhB,eAAeiB,OAAO,EAAKC,QAepChmB,OAAOgM,KAAK5C,KAAK6c,YAAYxL,KAAI,SAAAjI,GAC7BnG,QAAQC,IAAIkG,GACZ,IAAM0T,EAAO,EAAKD,WAAWzT,GAAO7P,KAAK,GACzC,EAAKmiB,eAAerP,iBAAiBjD,EAAO0T,OAIpDtB,QAAS,CAULnb,OAVK,SAUEqR,GAAa,WACVqL,EAAc/c,KAAK0b,eAAe/U,QAAQsN,UAAU5C,KAAI,SAAAS,GAC1D,MAAO,CACHzO,KAAMyO,EAAKzO,KACXrC,QAAS8Q,EAAK9Q,QACd8Q,KAAMA,EAAKsC,eAGb4I,EAAY,GAClBhd,KAAKgR,MAAM/Q,SAAQ,SAAAzG,GACXujB,EAAYjI,MAAK,SAAAmI,GAAE,OAAIA,EAAGjc,QAAQqP,KAAO7W,EAAEwH,QAAQqP,OACnD2M,EAAU/lB,KAAKuC,MAGvBwG,KAAKgR,MAAQ+L,EAAYG,OAAOF,GAChChd,KAAKuF,MAAQvF,KAAK0b,eAAe/U,QAAQuN,cAAcna,QACvDiG,KAAK0c,WAAU,WACRhL,GACCA,IAEJ,EAAKgK,eAAe3U,cACpB,EAAK2U,eAAe7O,UACpB5J,QAAQC,IAAI,EAAKwY,eAAexf,kBAOxCihB,YAvCK,WAwCD,OAAOnd,KAAK0b,gBAKhBG,YA7CK,WA8CD7b,KAAK0b,eAAe7O,WAExBiP,mBAhDK,SAgDc5b,EAAU3H,GACxByH,KAAKyP,MAAMxY,KAAK,CACbsB,OACA2H,gB,oCCzJD,YAAUkd,GACrB,IAAMC,EAA8B,kBAAbD,EACjBE,EAAcF,GACdA,EAWN,MAAO,CACHG,OAAQ,CAAC,aAAc,kBAAkB,sBACzCxB,MAAO,CACH/a,QAAS,CACLqC,KAAMzM,OACNolB,QAAS,WACL,MAAO,KAGfzjB,KAAM,CACF8K,KAAMma,SAGdC,MAAO,CACHzc,QADG,SACKgM,EAAKP,GACT,GAAG1C,KAAKC,UAAUgD,KAASjD,KAAKC,UAAUyC,GAA1C,CAGA,IAAMiR,EAASC,KAAK3Q,EAAKP,GACnBmR,EAAahnB,OAAOgM,KAAK8a,GAAQhO,QAAO,SAAA7M,GAC1C,IAAMgb,EAAKhb,EAAEib,cACb,QAASD,EAAGE,SAAS,UAAYlb,EAAEkb,SAAS,aAEhD/d,KAAK0b,eAAesC,UAAUhR,GAC3B4Q,EAAWjnB,QACVqJ,KAAK0b,eAAepa,SAASyF,cAEjC/G,KAAK0b,eAAetZ,OAAOyK,YAE/B,WAhBG,SAgBWG,EAAKP,GAAQ,WACnBwR,EAAO,GACPC,EAAU,GACRC,EAAOvnB,OAAOgM,KAAKoK,GAAKqE,KAAI,SAAApE,GAAC,MAAK,CAAE7D,MAAO6D,EAAGmR,QAASpR,EAAIC,OAC3DoR,EAAOznB,OAAOgM,KAAK6J,GAAQ4E,KAAI,SAAApE,GAAC,MAAK,CAAE7D,MAAO6D,EAAGmR,QAAS3R,EAAOQ,OACvEkR,EAAKle,SAAQ,SAACjD,GACV,IAAMshB,EAAOthB,EAAEohB,QACXC,EAAKvJ,MAAK,SAACyJ,GAAD,OAAOA,EAAEH,UAAYE,MAC/BL,EAAKhnB,KAAK+F,MAGlBqhB,EAAKpe,SAAQ,SAACjD,GACV,IAAMwhB,EAAOxhB,EAAEohB,QACXD,EAAKrJ,MAAK,SAACyJ,GAAD,OAAOA,EAAEH,UAAYI,MAC/BN,EAAQjnB,KAAK+F,MAIrBihB,EAAKhe,SAAQ,SAACjD,GACV,EAAK0e,eAAerP,iBAAiBrP,EAAEoM,MAAOpM,EAAEohB,YAEpDF,EAAQje,SAAQ,SAACjD,GACb,EAAK0e,eAAezC,oBAAoBjc,EAAEoM,MAAOpM,EAAEohB,cAI/D5iB,OAAQ,SAAUpB,GACd,OAAO,MAEXoiB,QA1DG,WA2DCxc,KAAK0b,eAAkB,IAAI2B,EAAOrd,KAAKgB,SACvChB,KAAKye,gBACLze,KAAK2F,WAAW3F,KAAK0b,eAAgB1b,KAAKzH,OAE9CmmB,UA/DG,WAgEC1e,KAAKiG,gBAAgBjG,KAAK0b,iBAE9BF,QAAS,CACLiD,cADK,WACW,WACZ7nB,OAAOgM,KAAK5C,KAAK6c,YAAYxL,KAAI,SAAAjI,GAC7B,IAAM0T,EAAO,EAAKD,WAAWzT,GAC7B,EAAKsS,eAAerP,iBAAiBjD,EAAO0T,UCpFjD,YAAUM,EAAUuB,GAU/B,MAAO,CACHpB,OAAQ,CAAE,iBAAkB,sBAAuB,qBACnDxB,MAAO,CACH/a,QAAS,CACLqC,KAAMzM,OACNolB,QAAS,WACL,MAAO,KAGftY,KAAM8Z,OACN7Z,GAAI6Z,QAERC,MAAO,CACH/Z,KADG,WAEC1D,KAAK4e,aAETjb,GAJG,WAKC3D,KAAK4e,cAGbpjB,OAAQ,SAAUpB,GACd,OAAO,MAEXoiB,QAvBG,WAuBO,WACAqC,EAAe7e,KAAKub,kBAAkBvb,KAAK0D,MAC3Cob,EAAa9e,KAAKub,kBAAkBvb,KAAK2D,IACzCrK,EAAM0G,KAAK+e,OAAOzlB,IACrBulB,GAAgBC,IACf9e,KAAK0b,eAAkB,IAAI4B,EAAcF,GAAlB,iCAChBpd,KAAKgB,SADW,IAEnB1H,MACAoK,KAAMmb,EACNlb,GAAImb,KAER9e,KAAKgG,eAAehG,KAAK0b,gBACzB9kB,OAAOgM,KAAK5C,KAAK6c,YAAYxL,KAAI,SAAAjI,GAC7B,IAAM0T,EAAO,EAAKD,WAAWzT,GAAO7P,KAAK,GACzC,EAAKmiB,eAAerP,iBAAiBjD,EAAO0T,QAIxDtB,QAAS,CACLoD,UADK,WAED,IAAMC,EAAe7e,KAAKub,kBAAkBvb,KAAK0D,MAC3Cob,EAAa9e,KAAKub,kBAAkBvb,KAAK2D,IAC/C3D,KAAK0b,eAAehY,KAAOmb,EAC3B7e,KAAK0b,eAAe/X,GAAKmb,IAGjCJ,UAjDG,WAkDI1e,KAAK0b,gBACJ1b,KAAKkG,oBAAoBlG,KAAK0b,mBCrD/B,IACXE,OAAQ,CAACvW,IACTkY,OAAQ,CACJyB,iBAAkB,CACdtb,KAAM,cAEVub,sBAAuB,CACnBvb,KAAM,mBAEVmY,YAAa,CACTnY,KAAM,eAEVoY,mBAAoB,CAChBpY,KAAM,uBAGdlI,OAAQ,SAAUpB,GACd,OAAOA,EAAc,WAAY4F,KAAKuc,OAAOP,UAEjDD,MAAO,CACH/a,QAAS,CACLqC,KAAMzM,OACNolB,QAAS,WACL,MAAO,KAGfzjB,KAAM,CACF8K,KAAMma,SAGbC,MAAO,CACJzc,QADI,SACIgM,EAAKP,GACN1C,KAAKC,UAAUgD,KAASjD,KAAKC,UAAUyC,IAG1CzM,KAAK0b,eAAesC,UAAUhR,IAElC,WAPI,SAOUA,EAAKP,GAAQ,WACnBwR,EAAO,GACPC,EAAU,GACRC,EAAOvnB,OAAOgM,KAAKoK,GAAKqE,KAAI,SAAApE,GAAC,MAAK,CAAE7D,MAAO6D,EAAGmR,QAASpR,EAAIC,OAC3DoR,EAAOznB,OAAOgM,KAAK6J,GAAQ4E,KAAI,SAAApE,GAAC,MAAK,CAAE7D,MAAO6D,EAAGmR,QAAS3R,EAAOQ,OACvEkR,EAAKle,SAAQ,SAACjD,GACV,IAAMshB,EAAOthB,EAAEohB,QACXC,EAAKvJ,MAAK,SAACyJ,GAAD,OAAOA,EAAEH,UAAYE,MAC/BL,EAAKhnB,KAAK+F,MAGlBqhB,EAAKpe,SAAQ,SAACjD,GACV,IAAMwhB,EAAOxhB,EAAEohB,QACXD,EAAKrJ,MAAK,SAACyJ,GAAD,OAAOA,EAAEH,UAAYI,MAC/BN,EAAQjnB,KAAK+F,MAIrBihB,EAAKhe,SAAQ,SAACjD,GACV,EAAK0e,eAAerP,iBAAiBrP,EAAEoM,MAAOpM,EAAEohB,YAEpDF,EAAQje,SAAQ,SAACjD,GACb,EAAK0e,eAAezC,oBAAoBjc,EAAEoM,MAAOpM,EAAEohB,cAI/D5B,QA/DW,WA+DD,WACNxc,KAAK0b,eAAkB,IAAIxR,EAAMlK,KAAKgB,SACtCpK,OAAOgM,KAAK5C,KAAK6c,YAAYxL,KAAI,SAAAjI,GAC7B,IAAM0T,EAAO,EAAKD,WAAWzT,GAAO7P,KAAK,GACzC,EAAKmiB,eAAerP,iBAAiBjD,EAAO0T,MAGhD9c,KAAKgf,iBAAiBhf,KAAK0b,eAAgB1b,KAAKzH,MAChDyH,KAAK8b,mBAAmB9b,KAAK0b,eAAgB1b,KAAKzH,OAEtDkkB,QAzEW,WA0EPzc,KAAK0b,eAAe3U,eAExB2X,UA5EW,WA6EP1e,KAAKif,sBAAsBjf,KAAK0b,kBClFlCwD,GAAc,CAChB,QACA,YACA,OACA,QAEEC,GAAc,CAChB,OACA,eACA,cAGEC,GAAa,CACf,CACI7mB,KAAM,QACN8mB,UAAWC,IAEf,CACI/mB,KAAM,QACN8mB,UAAWE,KAPH,sBASTL,GAAY7N,KAAI,SAAA9Y,GAAI,MAAK,CACxBA,OACA8mB,UAAW/B,GAAc/kB,QAXjB,eAaT4mB,GAAY9N,KAAI,SAAA9Y,GAAI,MAAK,CACxBA,OACA8mB,UAAWG,GAAUjnB,SAGvBknB,GAAkB,IAKT,IASXC,QAAS,SAACC,GAAsB,IAAjBC,EAAiB,uDAAP,GACjBC,EAAcJ,GACfG,GAAWA,EAAQE,SAClBD,EAAcD,EAAQE,QAE1BV,GAAWnf,SAAQ,SAAA4C,GACf8c,EAAIN,UAAJ,UAAiBQ,GAAjB,OAA+Bhd,EAAEtK,MAAQsK,EAAEwc,cAG5CO,EAAQG,QACPnpB,OAAOgM,KAAKgd,EAAQG,QAAQ9f,SAAQ,SAAA1H,GAChConB,EAAIN,UAAJ,UAAiBQ,GAAjB,OAA+BtnB,GAAQ+kB,GAAcsC,EAAQG,OAAOxnB,UC5DhF,GAAS,WAAa,IAAIynB,EAAIhgB,KAASigB,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,MAAML,EAAIM,OAAOlP,KAAKmP,MAAM,CAAC,GAAK,QAAQ,CAACJ,EAAG,MAAM,CAACE,MAAML,EAAIM,OAAOE,SAAS,CAACL,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,MAAML,EAAIM,OAAOzO,KAAK0O,MAAM,CAAC,UAAY,OAAO,KAAO,eAAeE,GAAG,CAAC,UAAYT,EAAIU,uBAAuB,CAACV,EAAIW,GAAG,mBAAmBR,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,MAAML,EAAIM,OAAOzO,KAAK0O,MAAM,CAAC,UAAY,OAAO,KAAO,YAAYE,GAAG,CAAC,UAAYT,EAAIY,mBAAmB,CAACZ,EAAIW,GAAG,kBAAkBR,EAAG,MAAM,CAACU,YAAY,CAAC,SAAW,aAAa,CAACV,EAAG,UAAU,CAACW,IAAI,QAAQT,MAAML,EAAIM,OAAOrmB,QAAQsmB,MAAM,CAAC,QAAUP,EAAIhf,SAASyf,GAAG,CAAC,MAAQT,EAAIe,eAAe,KAAOf,EAAIgB,OAAO,SAAWhB,EAAIiB,YAAYC,YAAYlB,EAAImB,GAAG,CAAC,CAAC7nB,IAAI,QAAQ8nB,GAAG,SAASN,GAC5uB,IAAI9f,EAAU8f,EAAI9f,QAClB,MAAO,CAACmf,EAAG,UAAU,CAACI,MAAM,CAAC,KAAO,CAAEhoB,KAAMyI,EAAQqP,UAAW,CAAC/W,IAAI,MAAM8nB,GAAG,SAASN,GACtF,IAAI9f,EAAU8f,EAAI9f,QAClB,MAAO,CAACmf,EAAG,QAAQ,CAACI,MAAM,CAAC,KAAO,CAAEhoB,KAAMyI,EAAQqP,UAAW,CAAC/W,IAAI,WAAW8nB,GAAG,SAASN,GACzF,IAAI9f,EAAU8f,EAAI9f,QACd8Q,EAAOgP,EAAIhP,KACf,MAAO,CAACqO,EAAG,aAAa,CAACI,MAAM,CAAC,KAAO,CAAEhoB,KAAMyI,EAAQqP,GAAIzO,QAASZ,EAAQY,UAAW6e,GAAG,CAAC,WAAa,SAASY,GAAQ,OAAOrB,EAAIsB,aAAatgB,IAAU,UAAY,SAASqgB,GAAQ,OAAOrB,EAAIuB,YAAYF,EAAQvP,IAAO,OAAS,SAASuP,GAAQ,OAAOrB,EAAIwB,gBAAgBH,EAAQrgB,UAAgB,CAAC1H,IAAI,cAAc8nB,GAAG,SAASN,GAC1U,IAAI9f,EAAU8f,EAAI9f,QACd8Q,EAAOgP,EAAIhP,KACf,MAAO,CAACqO,EAAG,gBAAgB,CAACI,MAAM,CAAC,KAAO,CAAEhoB,KAAMyI,EAAQqP,GAAIzO,QAASZ,EAAQY,UAAW6e,GAAG,CAAC,WAAa,SAASY,GAAQ,OAAOrB,EAAIsB,aAAatgB,IAAU,UAAY,SAASqgB,GAAQ,OAAOrB,EAAIuB,YAAYF,EAAQvP,UAAa,CAACxY,IAAI,kBAAkB8nB,GAAG,SAASN,GAC1Q,IAAI9f,EAAU8f,EAAI9f,QACd8Q,EAAOgP,EAAIhP,KACf,MAAO,CAACqO,EAAG,WAAW,CAACI,MAAM,CAAC,KAAO,CAAEhoB,KAAMyI,EAAQqP,GAAIzO,QAASZ,EAAQqP,GAAI0C,MAAO/R,EAAQ+R,QAAS0N,GAAG,CAAC,WAAa,SAASY,GAAQ,OAAOrB,EAAIsB,aAAatgB,IAAU,UAAY,SAASqgB,GAAQ,OAAOrB,EAAIuB,YAAYF,EAAQvP,UAAa,CAACxY,IAAI,iBAAiB8nB,GAAG,SAASN,GACrR,IAAI9f,EAAU8f,EAAI9f,QACd8Q,EAAOgP,EAAIhP,KACf,MAAO,CAACqO,EAAG,mBAAmB,CAACI,MAAM,CAAC,KAAO,CAAEhoB,KAAMyI,EAAQqP,GAAIzO,QAASZ,EAAQY,UAAW6e,GAAG,CAAC,WAAa,SAASY,GAAQ,OAAOrB,EAAIsB,aAAatgB,IAAU,UAAY,SAASqgB,GAAQ,OAAOrB,EAAIuB,YAAYF,EAAQvP,UAAa,CAACxY,IAAI,WAAW8nB,GAAG,SAASN,GACtQ,IAAI9f,EAAU8f,EAAI9f,QAClB,MAAO,CAACmf,EAAG,aAAa,CAACI,MAAM,CAAC,KAAO,CAAEhoB,KAAMyI,EAAQqP,UAAW,CAAC/W,IAAI,YAAY8nB,GAAG,SAASN,GAC/F,IAAI9f,EAAU8f,EAAI9f,QACd8Q,EAAOgP,EAAIhP,KACf,MAAO,CAACqO,EAAG,cAAc,CAACI,MAAM,CAAC,KAAO,CAAEhoB,KAAMyI,EAAQqP,GAAIzO,QAASZ,EAAQY,QAAS4J,OAAQxK,EAAQwK,SAAWiV,GAAG,CAAC,gBAAgB,SAASY,GAAQ,OAAOrB,EAAIyB,eAAeJ,EAAQrgB,IAAU,WAAa,SAASqgB,GAAQ,OAAOrB,EAAIsB,aAAatgB,IAAU,UAAY,SAASqgB,GAAQ,OAAOrB,EAAIuB,YAAYF,EAAQvP,UAAa,CAACxY,IAAI,YAAY8nB,GAAG,SAASN,GACxW,IAAI9f,EAAU8f,EAAI9f,QAClB,MAAO,CAACmf,EAAG,cAAc,CAACI,MAAM,CAAC,QAAUvf,EAAQ,KAAOA,EAAQ0C,KAAK,GAAK1C,EAAQ2C,IAAI8c,GAAG,CAAC,KAAO,SAASY,GAAQ,OAAOrB,EAAI0B,aAAaL,EAAQrgB,cAAqBgf,EAAW,QAAEG,EAAG,MAAM,CAACW,IAAI,aAAaT,MAAML,EAAIM,OAAOqB,WAAW/mB,MAAQ,wBAA0BolB,EAAItV,QAAU,OAASsV,EAAIvV,QAAU,OAAS,CAAC0V,EAAG,KAAKH,EAAI4B,GAAI5B,EAAU,QAAE,SAAS7nB,GAAG,OAAOgoB,EAAG,KAAK,CAAC7mB,IAAInB,EAAEyJ,QAAQ6e,GAAG,CAAC,MAAQ,SAASY,GAAQ,OAAOrB,EAAI6B,cAAc1pB,MAAM,CAAC6nB,EAAIW,GAAGX,EAAI8B,GAAG3pB,EAAEyJ,eAAc,KAAKoe,EAAI+B,MAAM,GAAG5B,EAAG,MAAM,CAACE,MAAML,EAAIM,OAAOvM,KAAK,CAACoM,EAAG,MAAM,CAAC6B,SAAS,CAAC,UAAYhC,EAAI8B,GAAG9B,EAAIiC,WAAWjC,EAAIjM,cACxkBmO,GAAkB,G,mCCxBlB,GAAS,WAAa,IAAIlC,EAAIhgB,KAASigB,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAUH,EAAImC,GAAG,CAAC5B,MAAM,CAAC,KAAOP,EAAIrO,KAAKpZ,KAAK,QAAUynB,EAAIoC,cAAcpC,EAAInD,YAAY,CAACsD,EAAG,SAAS,CAACI,MAAM,CAAC,QAAU,CACpNve,SAAU,OACVC,UAAW,UACXL,QAASoe,EAAIrO,KAAK/P,QAClBgK,WAAY,GACZG,UAAU,IACX0U,GAAG,CAAC,OAAST,EAAIqC,oBAAoB,IACxC,GAAkB,GCWtB,IACE,MAAF,CACI,KAAJ,QAEE,SAAF,CACI,YADJ,WAEM,MAAN,CACQ,OAAR,QACU,UAAV,aACU,IAAV,IAEQ,YAAR,UACQ,YAAR,EACQ,aAAR,EACQ,QAAR,GACQ,WAAR,EACQ,MAAR,EACQ,OAAR,sBAIE,QAAF,CACI,gBADJ,SACA,GACM,QAAN,cACM,KAAN,gBACQ,IAAR,aACQ,OAAR,qBC5CkV,M,aCO9UhD,GAAY,gBACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,GAAAA,G,QClBX,GAAS,WAAa,IAAIW,EAAIhgB,KAASigB,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAUH,EAAImC,GAAG,CAAC5B,MAAM,CAAC,KAAOP,EAAIrO,KAAKpZ,KAAK,QAAUynB,EAAIoC,cAAcpC,EAAInD,YAAY,CAACsD,EAAG,SAAS,CAACI,MAAM,CAAC,QAAU,CACpNve,SAAU,OACVC,UAAW,UACXL,QAAS,cAAgBoe,EAAIrO,KAAKpZ,KAClCqT,WAAY,GACZC,OAAQ,QACN,IACN,GAAkB,GCUtB,IACE,MAAF,CACI,KAAJ,OACI,cAAJ,OAEE,SAAF,CACI,YADJ,WAEM,MAAN,CACQ,OAAR,QACU,UAAV,aACU,IAAV,IAEQ,YAAR,UACQ,YAAR,EACQ,aAAR,EACQ,WAAR,EACQ,MAAR,EACQ,OAAR,uBClCqV,MCOjV,GAAY,gBACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,QClBX,GAAS,WAAa,IAAImU,EAAIhgB,KAASigB,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAU,CAACI,MAAM,CAAC,KAAOP,EAAIrO,KAAKpZ,KAAK,QAAUynB,EAAIhf,SAASyf,GAAG,CAAC,WAAaT,EAAIsC,aAAa,WAAatC,EAAIuC,eAAe,CAACpC,EAAG,SAAS,CAACW,IAAI,QAAQP,MAAM,CAAC,QAAU,CACtQve,SAAU,OACVC,UAAW+d,EAAI/d,UACfL,QAAS,SACRue,EAAG,UAAU,CAACI,MAAM,CAAC,QAAU,CAChC1e,MAAO,UACPgG,OAAQ,QACN,IACN,GAAkB,GCatB,IACE,MAAF,CACI,KAAJ,QAEE,KAJF,WAKI,MAAJ,CACM,UAAN,UACM,QAAN,CACQ,OAAR,QACU,UAAV,WACU,IAAV,IAEQ,YAAR,cACQ,YAAR,EACQ,WAAR,cACQ,MAAR,cACQ,WAAR,EACQ,MAAR,KAIE,QAAF,CACI,aADJ,WAEM,KAAN,iBAEI,aAJJ,WAKM,KAAN,uBC/C+U,MCO3U,GAAY,gBACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,QClBX,GAAS,WAAa,IAAImY,EAAIhgB,KAASigB,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAU,CAACI,MAAM,CAAC,KAAOP,EAAIrO,KAAKpZ,KAAK,QAAUynB,EAAIhf,UAAU,CAACmf,EAAG,SAAS,CAACI,MAAM,CAAC,QAAU,CACzLve,SAAU,OACVC,UAAW,UACXL,QAAS,SACRue,EAAG,cAAc,CAACI,MAAM,CAAC,QAAU,CACpC1e,MAAO,UACPrH,MAAO,GACPC,OAAQ,GACR+O,aAAc,OACZ,IACN,GAAkB,GCStB,IACE,MAAF,CACI,KAAJ,QAEE,KAJF,WAKI,MAAJ,CACM,QAAN,CACQ,OAAR,QACU,UAAV,WACU,IAAV,IAEQ,YAAR,cACQ,YAAR,EACQ,WAAR,YACQ,MAAR,cACQ,WAAR,EACQ,MAAR,MCnC6U,MCOzU,GAAY,gBACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,QClBX,GAAS,WAAa,IAAIwW,EAAIhgB,KAASigB,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAU,CAACI,MAAM,CAAC,KAAOP,EAAIrO,KAAKpZ,KAAK,QAAU,CAC5IsJ,MAAO,OACPC,YAAa,OACbL,YAAa,EACboG,OAAQ,EACRrH,WAAW,OAEf,GAAkB,GCOtB,IACE,MAAF,CACI,KAAJ,SChBkV,MCO9U,GAAY,gBACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,QClBX,GAAS,WAAa,IAAIwf,EAAIhgB,KAASigB,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAUH,EAAImC,GAAG,CAAC5B,MAAM,CAAC,KAAOP,EAAIrO,KAAKpZ,KAAK,QAAUynB,EAAIhf,UAAUgf,EAAInD,YAAY,CAACsD,EAAG,SAAS,CAACI,MAAM,CAAC,QAAU,CAChNve,SAAU,OACVC,UAAW+d,EAAI/d,UACfL,QAASoe,EAAIrO,KAAK/P,YACjBoe,EAAI4B,GAAI5B,EAAIrO,KAAU,OAAE,SAAS6Q,GAAY,MAAO,CAACrC,EAAG,eAAe,CAAC7mB,IAAIkpB,EAAWnS,GAAGkQ,MAAM,CAAC,KAAO,CAAE3e,QAAS4gB,EAAWnS,GAAI9X,KAAMiqB,EAAWnS,YAAY,IACpK,GAAkB,GCLlB,GAAS,WAAa,IAAI2P,EAAIhgB,KAASigB,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAUH,EAAImC,GAAG,CAAC5B,MAAM,CAAC,KAAOP,EAAIrO,KAAKpZ,KAAK,QAAUynB,EAAIoC,YAAY,UAAW,IAAOpC,EAAInD,YAAY,CAACsD,EAAG,SAAS,CAACI,MAAM,CAAC,QAAU,CACpOve,SAAU,OACVC,UAAW,UACXL,QAASoe,EAAIrO,KAAKpZ,KAClBqT,WAAY,GACZC,OAAQ,QACN,IACN,GAAkB,GCWtB,IACE,MAAF,CACI,KAAJ,QAEE,SAAF,CACI,YADJ,WAEM,MAAN,CACQ,OAAR,QACU,UAAV,aACU,IAAV,IAEQ,YAAR,UACQ,YAAR,EACQ,aAAR,EACQ,WAAR,EACQ,MAAR,EACQ,OAAR,uBClCoV,MCOhV,GAAY,gBACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,QCEf,IACE,WAAF,CAEI,eAAJ,IAEE,MAAF,CACI,KAAJ,QAEE,KARF,WASI,MAAJ,CACM,UAAN,UACM,QAAN,CACQ,OAAR,QACU,UAAV,WACU,IAAV,IAEQ,YAAR,UACQ,YAAR,EACQ,aAAR,EACQ,WAAR,cACQ,MAAR,cACQ,WAAR,EACQ,MAAR,MC1CgV,MCO5U,GAAY,gBACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,QClBX,GAAS,WAAa,IAAImU,EAAIhgB,KAASigB,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAUH,EAAImC,GAAG,CAAC5B,MAAM,CAAC,KAAOP,EAAIrO,KAAKpZ,KAAK,QAAUynB,EAAIoC,cAAcpC,EAAInD,YAAY,CAACsD,EAAG,SAAS,CAACI,MAAM,CAAC,QAAU,CACpNve,SAAU,OACVC,UAAW,UACXL,QAASoe,EAAIrO,KAAKpZ,KAClBqT,WAAY,GACZC,OAAQ,QACN,IACN,GAAkB,GCUtB,IACE,MAAF,CACI,KAAJ,QAEE,SAAF,CACI,YADJ,WAEM,MAAN,CACQ,OAAR,QACU,UAAV,aACU,IAAV,IAEQ,YAAR,UACQ,YAAR,EACQ,aAAR,EACQ,WAAR,EACQ,MAAR,MChCwV,MCOpV,GAAY,gBACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,QClBX,GAAS,WAAa,IAAImU,EAAIhgB,KAASigB,EAAGD,EAAIE,eAAmBC,EAAGH,EAAII,MAAMD,IAAIF,EAAG,OAAOE,EAAG,UAAUH,EAAImC,GAAG,CAAC5B,MAAM,CAAC,KAAOP,EAAIrO,KAAKpZ,KAAK,QAAUynB,EAAIhf,UAAUgf,EAAInD,YAAY,CAACsD,EAAG,UAAU,CAACI,MAAM,CAAC,QAAUP,EAAIyC,gBAAgB,CAACtC,EAAG,SAAS,CAACI,MAAM,CAAC,QAAUP,EAAI0C,eAAevC,EAAG,SAAS,CAACI,MAAM,CAAC,QAAU,CACjTve,SAAU,OACVC,UAAW,UACXL,QAAS,YACP,GAAGue,EAAG,UAAU,CAACI,MAAM,CAAC,QAAUP,EAAI2C,gBAAgBlC,GAAG,CAAC,MAAQT,EAAI4C,UAAU,CAACzC,EAAG,SAAS,CAACI,MAAM,CAAC,QAAU,CACjHve,SAAU,OACVC,UAAW,UACXL,QAASoe,EAAIrO,KAAK/P,SAAW,QAC7BgK,WAAY,GACZC,OAAQ,QACN,GAAImU,EAAIrO,KAAKnG,QAAUwU,EAAIrO,KAAKnG,OAAO7U,OAAQ,CAACwpB,EAAG,SAAS,CAACI,MAAM,CAAC,QAAU,CAChFve,SAAU,OACVC,UAAW,UACXL,QAAS,SACRue,EAAG,UAAU,CAACW,IAAI,aAAaP,MAAM,CAAC,QAAUP,EAAI6C,gBAAgB7C,EAAI4B,GAAI5B,EAAIrO,KAAW,QAAE,SAASmR,GAAO,OAAO3C,EAAG,SAAS,CAAC7mB,IAAIwpB,EAAMlhB,QAAQ2e,MAAM,CAAC,QAAU,CACjKve,SAAU,OACVC,UAAW,UACXL,QAASkhB,EAAMlhB,eACZ,IAAIoe,EAAI+B,MAAM,IAC7B,GAAkB,G,wBCsBtB,aACA,YACA,QACE,MAAF,CACI,KAAJ,QAEE,KAJF,WAKI,MAAJ,CACM,QAAN,CACQ,OAAR,QACU,UAAV,WACU,IAAV,EACU,UAAV,UAEQ,QAAR,GACQ,YAAR,UACQ,YAAR,EACQ,aAAR,GACQ,MAAR,IACQ,WAAR,cACQ,WAAR,EACQ,MAAR,GAEM,cAAN,CACQ,OAAR,QACU,UAAV,aACU,IAAV,IAEQ,aAAR,GACQ,YAAR,OACQ,WAAR,UACQ,YAAR,EACQ,MAAR,GAEM,eAAN,CACQ,OAAR,QACU,UAAV,aACU,IAAV,IAEQ,YAAR,UACQ,YAAR,EACQ,aAAR,EACQ,MAAR,IACQ,WAAR,cACQ,WAAR,EACQ,MAAR,GAEM,cAAN,CACQ,OAAR,QACU,UAAV,WACU,IAAV,EACU,UAAV,UAEQ,YAAR,cACQ,WAAR,cACQ,WAAR,EACQ,MAAR,GAEM,YAAN,CACQ,MAAR,GACQ,MAAR,GACQ,OAAR,MAIE,MAAF,CACI,cADJ,WACM,IAAN,OACM,KAAN,sBACQ,IAAR,oCACQ,EAAR,gBACQ,EAAR,sBAIE,QAAF,CACI,QADJ,SACA,GACM,QAAN,OACM,EAAN,kBACM,IAAN,kBACA,iBACA,4BAEM,KAAN,4BC3HmV,MCO/U,GAAY,gBACd,GACA,GACA,IACA,EACA,KACA,KACA,MAIa,M,QCqGf,SACA,IACE,WAAF,CACI,aAAJ,GACI,UAAJ,GACI,QAAJ,GACI,aAAJ,GACI,WAAJ,GACI,gBAAJ,GACI,mBAAJ,GACI,cAAJ,IAEE,KAXF,WAYI,IAAJ,GACM,KAAN,OACM,KAAN,CACA,CACQ,KAAR,QACQ,GAAR,SAEA,CACQ,KAAR,cACQ,QAAR,OACQ,GAAR,SACQ,WAAR,CACA,CACU,KAAV,WACU,QAAV,gBACU,GAAV,WAGQ,UAAR,CACA,CACU,KAAV,cACU,QAAV,UACU,GAAV,SACU,WAAV,CACA,CACY,KAAZ,WACY,QAAZ,UACY,GAAZ,YAGU,UAAV,CACA,CACY,KAAZ,WACY,QAAZ,OACY,GAAZ,aAIA,CACU,KAAV,YACU,GAAV,aACU,QAAV,GACU,OAAV,MAIA,CACQ,KAAR,kBACQ,GAAR,SACQ,MAAR,CACA,CACU,KAAV,aACU,GAAV,eACU,QAAV,eACU,UAAV,CACA,CACY,KAAZ,WACY,QAAZ,OACY,GAAZ,eAIA,CACU,KAAV,aACU,GAAV,eACU,QAAV,eACU,UAAV,CACA,CACY,KAAZ,WACY,QAAZ,SACY,GAAZ,eAGU,WAAV,CACA,CACY,KAAZ,WACY,QAAZ,UACY,GAAZ,gBAMA,CACQ,KAAR,iBACQ,GAAR,SACQ,QAAR,SACQ,KAAR,IAQA,CACQ,KAAR,MACQ,GAAR,QAGM,WAAN,IAEA,UACM,WAAN,GACM,IAAN,IAEI,MAAJ,CACM,IAAN,EACM,QAAN,CACQ,WAAR,EACQ,OAAR,GAEM,SAAN,EACM,QAAN,EACM,QAAN,EACM,cAAN,KACM,YAAN,GACM,OAAN,EACQ,QAAR,MACQ,OAAR,EACU,QAAV,QAEA,CACQ,QAAR,OACQ,OAAR,EACU,QAAV,MACA,CACU,QAAV,QAEA,CACQ,QAAR,UACQ,OAAR,EACU,QAAV,QAEA,CACQ,QAAR,QACQ,OAAR,EACU,QAAV,MACA,CACU,QAAV,MACA,CACU,QAAV,SAGM,qBAAN,OAGE,SAAF,CACI,gBADJ,WAEM,OAAN,kCAAQ,OAAR,eAGE,QApKF,WAqKI,QAAJ,qCAEE,QAAF,CACI,WADJ,WAEM,OAAN,0BAEI,qBAJJ,WAKM,IAAN,iCACM,EAAN,aACQ,SAAR,CACU,KAAV,cACU,QAAV,+BACU,GAAV,+BACU,WAAV,GACU,UAAV,OAKI,iBAjBJ,WAkBM,IAAN,iCACM,EAAN,aACQ,SAAR,CACU,KAAV,WACU,QAAV,kBACU,GAAV,+BAII,YA3BJ,SA2BA,KACM,IAAN,sBACA,QACA,iCAAU,EAAV,oBAAU,EAAV,KACM,KAAN,uBACM,KAAN,iCACM,KAAN,qBACM,EAAN,0CAEI,OApCJ,SAoCA,GAAM,IAAN,OACA,oBACM,KAAN,uBACM,KAAN,iCACM,KAAN,+BACQ,IAAR,qCACA,IACU,EAAV,8CAII,QA/CJ,SA+CA,GACM,IAAN,kBACA,iBACA,4BACA,sBAAU,EAAV,KAAU,EAAV,KACM,KAAN,sBACM,KAAN,UACM,KAAN,WAEI,aAxDJ,SAwDA,GACM,QAAN,kBACM,QAAN,OACM,KAAN,iBAEI,WA7DJ,WA8DM,QAAN,gBACM,KAAN,oBAEI,aAjEJ,SAiEA,KACM,QAAN,SACM,IAAN,oBACA,qBACQ,EAAR,yBACQ,EAAR,oBAGM,EAAN,0BACM,KAAN,iCACM,KAAN,sBAEI,eA7EJ,SA6EA,KACM,IAAN,sBAAU,EAAV,KAAU,EAAV,KACM,KAAN,UACM,KAAN,UACM,KAAN,sBACA,aACQ,KAAR,uBAEQ,KAAR,2BAGI,cAxFJ,SAwFA,GACM,KAAN,WACM,QAAN,+BACM,KAAN,uCACM,KAAN,sCAEI,eA9FJ,WA+FM,KAAN,WACM,KAAN,2BAEI,gBAlGJ,SAkGA,KACM,EAAN,iBClY8T,M,aCQ9T,SAASgB,GAAcC,GAErBhjB,KAAK,UAAa,cAAOijB,QAAU,cAMrC,IAAI,GAAY,gBACd,GACA,GACAf,IACA,EACAa,GACA,KACA,MAIa,M,QCvBfpD,OAAIuD,OAAOC,eAAgB,EAC3BxD,OAAIyD,IAAIC,IACR,IAAI1D,OAAI,CACNnkB,OAAQ,SAAAmM,GAAC,OAAIA,EAAE2b,OACd3G,OAAO,S,oCCRV,oE,qBCAAzkB,EAAOD,QAAU,IAA0B,0B,qBCC3CC,EAAOD,QAAU,CAAC,IAAM,gBAAgB,QAAU,oBAAoB,KAAO,iBAAiB,QAAU,oBAAoB,KAAO,iBAAiB,KAAO,iBAAiB,OAAS,mBAAmB,IAAM,gBAAgB,KAAO,iBAAiB,WAAa","file":"js/app.a268690c.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","\n/**\n * @typedef {Object} CanvasMeta\n * @property {Element} canvas - canvas 元素\n * @property {number} width - 画布宽度\n * @property {number} height - 画布高度\n * @property {number} raw_width - 画布元素宽度\n * @property {number} raw_height - 画布元素高度\n * @property {number} left - 画布距离左端距离\n * @property {number} top - 画布距离顶端距离\n * @property {Context2d} ctx - Context2d\n * @property {number} scale - 当前的像素设备比\n */\n/**\n * 创建一个 canvas 元素\n * @param  {Element} wrapper - dom元素\n * @return {CanvasMeta}\n */\nexport function createCanvas(wrapper) {\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n    const { width, height, left, top } = wrapper.getBoundingClientRect();\n    canvas.style.width = width + \"px\";\n    canvas.style.height = height + \"px\";\n    const scale = window.devicePixelRatio;\n    canvas.width = Math.floor(width * scale);\n    canvas.height = Math.floor(height * scale);\n\n    if(wrapper) {\n        wrapper.style.position = 'relative';\n        wrapper.append(canvas);\n    }\n    return {\n        canvas,\n        width,\n        height,\n        raw_width: canvas.width,\n        raw_height: canvas.height,\n        left,\n        top,\n        ctx,\n        scale,\n    }\n}\n\nconst caheCanvas = document.createElement('canvas');\ncaheCanvas.width = 1;\ncaheCanvas.height = 1;\nconst caheCanvasctx = caheCanvas.getContext('2d');\nconst scale = window.devicePixelRatio;\ncaheCanvasctx.scale(scale, scale);\n\n/**\n * 对象绘制\n * @name render\n * @function\n * @param {Context2d} ctx - 绘图对象\n*/\n\n/**\n * 在离线canvas上绘制元素\n * @param  {render} render - 绘图函数\n */\nexport function requestCacheCanvas(render) {\n    caheCanvasctx.clearRect(0,0,5,5);\n    caheCanvasctx.save();\n    render(caheCanvasctx);\n    caheCanvasctx.restore();\n    caheCanvasctx.clearRect(0,0,5,5);\n}","/**\n * 方向\n * @readonly\n * @enum {number}\n */\nexport const DIRECTION = {\n    /** RIGHT */\n    RIGHT: 0,\n    /** BOTTOM */\n    BOTTOM: 1,\n    /** LEFT */\n    LEFT: 2,\n    /** TOP */\n    TOP: 3\n}\n\nexport function nextDirection(direction, clockwise) {\n    const nextDir = (direction + (clockwise ? 1 : -1)) % 4;\n    return nextDir;\n}\n\nexport function oppositeDirection(direction) {\n    return (direction + 2) % 4\n}\n\nexport const APPROXIMATE = 6;","import {\n    Bezier,\n} from 'bezier-js';\nimport { DIRECTION } from './constance';\n\n/**\n * 根据点计算最小外接矩形\n * @param {number[][]} points - 点集合\n * @return {Object} demension 宽高，坐标\n */\nexport function bounding_box(points) {\n    let min_x = Infinity; \n    let min_y = Infinity; \n    let max_x = -Infinity; \n    let max_y = -Infinity; \n    for(let idx in points) {\n        const item = points[idx];\n        if(item[0] < min_x){\n            min_x = item[0]\n        }\n\n        if (item[0] > max_x) {\n            max_x = item[0]\n        } \n\n        if (item[1] < min_y) {\n            min_y = item[1]\n        }\n\n        if (item[1] > max_y) {\n            max_y = item[1]\n        }\n    }\n    return {\n        // points: [(min_x,min_y),(max_x,min_y),(max_x,max_y),(min_x,max_y)],\n        width: Math.max(max_x - min_x, 10),\n        height: Math.max(max_y - min_y, 10),\n        x: min_x,\n        y: min_y,\n    }\n}\n\nfunction sqr(x) {\n    return x * x;\n}\nfunction dist2(v, w) {\n    return sqr(v[0] - w[0]) + sqr(v[1] - w[1]);\n}\n\n// p - point\n// v - start point of segment\n// w - end point of segment\nexport function distToSegmentSquared(p, v, w) {\n    const l2 = dist2(v, w);\n    if (l2 === 0) return dist2(p, v);\n    let t = ((p[0] - v[0]) * (w[0] - v[0]) + (p[1] - v[1]) * (w[1] - v[1])) / l2;\n    t = Math.max(0, Math.min(1, t));\n    return dist2(p, [ v[0] + t * (w[0] - v[0]), v[1] + t * (w[1] - v[1]) ]);\n}\n\n\nexport function bezierPoints(p1, p2, start_dir = DIRECTION.TOP, end_dir = DIRECTION.TOP, anticlock = false) {\n    const isSameDirection = start_dir === end_dir;\n    const isVerticalStart = [DIRECTION.TOP, DIRECTION.BOTTOM].includes(start_dir);   \n    const isVerticalEnd = [DIRECTION.TOP, DIRECTION.BOTTOM].includes(end_dir);\n    const arrowspan = [DIRECTION.TOP, DIRECTION.LEFT].includes(end_dir) ? -5 : 5;\n    const endX = isVerticalEnd ? p2[0] : p2[0] + arrowspan;\n    const endY = isVerticalEnd ? p2[1] + arrowspan : p2[1];\n    if(isSameDirection) {\n        let span = Math.abs(isVerticalStart ? (endY - p1[1]) : (endX - p1[0]))\n        span = Math.min(span, 50);\n        const symb = [DIRECTION.RIGHT, DIRECTION.BOTTOM].includes(end_dir)\n        span = symb ? span : - span;\n        const cp1 = isVerticalStart ? [p1[0], p1[1] + span] : [p1[0] + span, p1[1]];\n        const cp2 = isVerticalEnd ? [endX, endY + span] : [endX + span, endY];\n        return [ \n            ...cp1,\n            ...cp2,\n            endX, endY ];\n    }\n    let spanStart = (anticlock ? -5 : 1) * (isVerticalStart ? (endY - p1[1]) / 2 : (endX - p1[0]) / 2)\n    let spanEnd = (anticlock ? -4 : 1) * (isVerticalEnd ? (p1[1] - endY) / 2 : (p1[0] - endX) / 2)\n    let u1 = spanStart / Math.abs(spanStart);\n    spanStart = u1 * Math.min(Math.abs(spanStart), 50);\n    let u2 = spanEnd / Math.abs(spanEnd);\n    spanEnd = u2 * Math.min(Math.abs(spanEnd), 50);\n    const cp1 = isVerticalStart ? [p1[0], p1[1] + spanStart] : [p1[0] + spanStart, p1[1]];\n    const cp2 = isVerticalEnd ? [endX, endY + spanEnd] : [endX + spanEnd, endY];\n    return [ \n        ...cp1,\n        ...cp2,\n        endX, endY ];\n}\n\n// export function bezierPoints(p1, p2, start_vec, end_vec) {\n\n// }\n\nexport function distToBezierSegmentSquared(p, points) {\n    const b = new Bezier(...points);\n\n    const point = b.project({ x: p[0], y: p[1] });\n    const d = dist2(p, [ point.x, point.y ]);\n    return d;\n}\n\nexport function getBezierAngle(t, sx, sy, cp1x, cp1y, cp2x, cp2y, ex, ey) {\n  var dx = Math.pow(1-t, 2)*(cp1x-sx) + 2*t*(1-t)*(cp2x-cp1x) + t * t * (ex - cp2x);\n  var dy = Math.pow(1-t, 2)*(cp1y-sy) + 2*t*(1-t)*(cp2y-cp1y) + t * t * (ey - cp2y);\n  return -Math.atan2(dx, dy) + 0.5*Math.PI;\n}\n\n\nexport function getInstanceHeight(instance) {\n    const rect = instance.getBoundingRect();\n    let min_y = Infinity;\n    let max_y = -Infinity;\n    let min_x = Infinity;\n    let max_x = -Infinity;\n    rect.forEach(point => {\n        max_y = Math.max(max_y, point[1]);\n        min_y = Math.min(min_y, point[1]);\n        max_x = Math.max(max_x, point[0]);\n        min_x = Math.min(min_x, point[0]);\n    });\n    return {\n        height: max_y - min_y,\n        width: max_x - min_x,\n    }\n}","/**\n * 绘图栈\n * @extends Array\n */\nclass InstanceStack extends Array {\n    constructor() {\n        super();\n    }\n    /**\n     * 绘制当前栈\n     * @param {Context2d} ctx - canvas context2d\n     */\n    render(ctx) {\n        let movingTarget;\n        this.forEach(instance => {\n            if(instance._isMoving) {\n                movingTarget = instance;\n                return;\n            }\n            if(instance.visible) {\n                ctx.save();\n                if(instance.reflow && !instance._reflowed) {\n                    instance.reflow();\n                    instance._reflowed = true;\n                }\n                instance.render(ctx);\n                ctx.restore();\n            }\n        });\n        if(movingTarget) {\n            ctx.save();\n            if(movingTarget.reflow && !movingTarget._reflowed) {\n                movingTarget.reflow();\n                movingTarget._reflowed = true;\n            }\n            movingTarget.render(ctx);\n            ctx.restore();\n        }\n    }\n\n    /**\n     * 碰撞对象过滤条件\n     * @name InstanceFilter\n     * @function\n     * @param {Instance} instance - 当前对象\n    */\n    /**\n     * 碰撞检测\n     * @param {number[]} point - 碰撞点\n     * @param {InstanceFilter} condition - 碰撞对象过滤条件\n     * @return {Instance}\n     */\n    checkHit(point, condition){\n        let i = this.length - 1;\n        while(i >= 0) {\n            const instance = this[i];\n            \n            if(instance.visible && !instance.ignoreHit) {\n                if(condition && condition(instance)) {\n                    i--\n                    continue;\n                }\n                const ishit = instance.isHit(point, condition);\n                instance._isHit = !!ishit;\n                if(ishit) {\n                    if(typeof ishit !== 'boolean') {\n                        return ishit;\n                    }\n                    return instance;\n                }\n                \n            }\n            i--\n        }\n\n        return null;\n    }\n    /**\n     * 获取当前层栈的最小外接矩形\n     * @return {number[][]} - 外接矩形坐标\n     */\n    getBoundingRectPoints() {\n        const points = [];\n        this.forEach(instance => {\n            if(instance.visible) {\n                points.splice(points.length, 0, ...instance.getBoundingRect());\n            }\n        });\n        return points;\n    }\n}\n\nexport default InstanceStack;\n","import { setUniqueId, getUniqueId } from '../utils/functions';\nimport { nextDirection } from '../utils/constance';\nconst margin = 5;\nconst ishitKey = Symbol('ishit');\n/**\n * @typedef Configs\n * @type {object}\n * @property {number} borderWidth      - 边的宽度 默认是 2\n * @property {string} borderColor      - 边的颜色 默认 black\n * @property {string} hoverStyle       - 悬停颜色 默认 transparent\n * @property {string} content          - 内容\n * @property {string} color            - 填充颜色 默认 white\n * @property {string} font             - 字体 默认 28px serif\n * @property {string} textColor        - 字体颜色 默认 white\n * @property {string} textAlign        - 字体左右对齐 默认 center\n * @property {string} textBaseline     - 字体垂直对齐 默认 center\n */\n\n/** 图中的最小单元 */\nclass Instance extends EventTarget{\n    /**\n     * 创建一个最小单元.\n     * @param {Configs} configs - 最小单元的一些通用属性配置\n     */\n    constructor(configs = {}) {\n        super();\n        Object.assign(this, configs);\n        // this.anchor = configs.anchor || [0, 0];\n        // this.belongs = undefined;\n        this.visible = true;\n        this.status = {\n            hover: false,\n            focus: false,\n            moving: false,\n        }\n        // this._jflow = undefined;\n        this._belongs = undefined;\n        this[ishitKey] = false; \n\n        /** layout 抽象节点关联属性 */\n        this._layoutNode = undefined;\n\n        /**\n         * 通用样式属性\n         * @property {number} borderWidth      - 边的宽度 默认是 2\n         * @property {string} borderColor      - 边的颜色 默认 black\n         * @property {string} hoverStyle       - 悬停颜色 默认 transparent\n         * @property {string} content          - 内容\n         * @property {string} color            - 填充颜色 默认 white\n         * @property {string} fontFamily       - 字体 默认 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji\n         * @property {string} fontSize         - 字体大小 默认 28px\n         * @property {string} textColor        - 字体颜色 默认 white\n         * @property {string} textAlign        - 字体左右对齐 默认 center\n         * @property {string} textBaseline     - 字体垂直对齐 默认 center\n         */\n        this.borderWidth =      configs.borderWidth !== undefined ? configs.borderWidth : 2;\n        this.borderColor =      configs.borderColor;\n        this.hoverStyle =       configs.hoverStyle || 'transparent';\n        this.content =          configs.content || '';\n        this.color =            configs.color || 'white';\n        this.strokeColor =      configs.strokeColor || 'white';\n        this.fontFamily =       configs.fontFamily = '-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'\n        this.fontSize =         configs.fontSize || '28px';\n        this.textColor =        configs.textColor || 'white';\n        this.textAlign =        configs.textAlign || 'center';\n        this.textBaseline =     configs.textBaseline || 'middle';\n    }\n    /**\n     * @property {boolean} _isTargeting - 当前单元选中状态\n     */\n    get _isTargeting() {\n        return this === (this._jflow._target.instance || this._jflow._target.link);\n    }\n    /**\n     * @property {boolean} _isMoving - 当前单元移动状态\n     */\n    get _isMoving() {\n        return this === this._jflow._getMovingTarget();\n    }\n    /**\n     * @property {boolean} _isHit  - 当前单元碰撞检测状态\n     */\n    get _isHit() {\n        return this[ishitKey];\n    }\n    /**\n     * @property {JFlow} _jflow -     * canvas上 jflow 实体\n     */\n    get _jflow() {\n        return this._belongs.uniqueName === 'jflow' ? this._belongs : this._belongs._jflow;\n    }\n\n    set _isHit(ishit) {\n        if(this[ishitKey] !== ishit) {\n            /**\n             * 鼠标移入事件\n             *\n             * @event Instance#mouseenter\n             * @type {object}\n             * @property {Instance} instance      - 移入的对象 \n             */\n            /**\n             * 鼠标移出事件\n             *\n             * @event Instance#mouseleave\n             * @type {object}\n             * @property {Instance} instance      - 移入的对象 \n             */\n            this.dispatchEvent(new CustomEvent(ishit ? 'mouseenter': 'mouseleave' , {\n                detail: {\n                    instance: this,\n                }\n            }));\n        }\n        this[ishitKey] = ishit; // validation could be checked here such as only allowing non numerical values\n    }\n\n    /**\n     * 改变当前配置\n     * @param {Configs} configs - The string containing two comma-separated numbers.\n     */\n    setConfig(configs) {\n        Object.keys(configs).forEach(k => {\n            if(configs[k] !== undefined && configs[k] !== null) {\n                this[k] = configs[k]\n            }\n        })\n    }\n    /**\n     * 绘制单元\n     * @param {Context2d} ctx \n     */\n    render(ctx) {\n        throw 'require render implement'\n    }\n    /**\n     * 判断当前单元是否被命中\n     * @param {number[]} point \n     * @return {Boolean}\n     */\n    isHit(point) {\n        throw 'require isHit implement'\n    }\n    /**\n     * 计算当前的最大外接矩形的\n     * @return {number[][]} [lefttop: [number,number], rightbottom: [number, number]]\n     */\n    getBoundingRect() {\n        throw 'require getBoundingRect implement'\n    }\n    calculateIntersection() {\n        throw 'require calculateIntersection implement'\n    }\n    /**\n     * 计算当前连线接入点的位置\n     * @return {Object} intersection 交叉点\n     * @return {number} intersection[DIRECTION.TOP] 上\n     * @return {number} intersection[DIRECTION.BOTTOM] 下\n     * @return {number} intersection[DIRECTION.LEFT] 上\n     * @return {number} intersection[DIRECTION.RIGHT] 右\n     */\n    getIntersectionsInFourDimension() {\n        throw 'require getIntersectionsInFourDimension implement'\n    }\n\n\n    /**\n     * 获取当前所在层级的坐标\n     * @return {Number[]} 坐标\n     */\n    getCenter() {\n        return this.anchor;\n    }\n    /**\n     * 获取宽高\n     * @return {Object} demension 宽高\n     * @return {number} demension.width 宽\n     * @return {number} demension.height 高\n     */\n    getBoundingDimension() {\n        const rect = instance.getBoundingRect();\n        let min_y = Infinity;\n        let max_y = -Infinity;\n        let min_x = Infinity;\n        let max_x = -Infinity;\n        rect.forEach(point => {\n            max_y = Math.max(max_y, point[1]);\n            min_y = Math.min(min_y, point[1]);\n            max_x = Math.max(max_x, point[0]);\n            min_x = Math.min(min_x, point[0]);\n        });\n        return {\n            height: max_y - min_y,\n            width: max_x - min_x,\n        }\n    }\n    /**\n     * 事件冒泡\n     * @param {JFlowEvent} customEvent 自定义事件\n     */\n    bubbleEvent(customEvent){\n        this.dispatchEvent(customEvent);\n        console.log(customEvent)\n        if(customEvent.detail.bubbles && this._belongs.bubbleEvent){\n            console.log(customEvent.type)\n            this._belongs.bubbleEvent(customEvent);\n        }\n    }\n    /**\n     * 反算回页面的像素坐标\n     * @param {Number[]} point\n     * @return {Number[]} 世界坐标\n     */\n    calculateToRealWorld(point) {\n        if(this._belongs && this._belongs.calculateToRealWorld) {\n            return this._belongs.calculateToRealWorld(point);\n        } else {\n            return point;\n        }\n    }\n\n    calculateToRealWorldWithScalar(length){\n        return this._jflow.scale * length;\n    }\n\n    /**\n     * 从当前布局中删除虚拟布局节点\n     */\n    removeFromLayoutSource() {\n        if(this._layoutNode) {\n            this._layoutNode.remove();\n        }\n    }\n}\n\nexport default Instance;","import Instance from './instance';\nimport { DIRECTION, APPROXIMATE } from '../utils/constance';\nclass LinkPolyline extends Instance {\n    constructor(configs) {\n        super(configs);\n        this.from   = configs.from; // Instance\n        this.to     = configs.to;   // Instance\n        this.conrolNodes = [];\n        this.controlPoint = [];\n        this.defaultStyle = 'black';\n        this.hoverStyle = 'cornflowerblue';\n    }\n\n\n    _calculateAnchorPoints() {\n        const start = this.from.calculateIntersectionInFourDimension(this.to.getCenter());\n        const end = this.to.calculateIntersectionInFourDimension(this.from.getCenter());\n        return {\n            start,\n            end\n        }\n    }\n\n    getColor() {\n        if(this.status.hover) {\n            return this.hoverStyle;\n        }\n        return this.defaultStyle;\n    }\n\n    render(ctx) {\n        const { start, end } = this._calculateAnchorPoints();\n        const diffDIR = Math.abs(start.dir - end.dir);\n        let controlPoint = [start.p];\n        if(diffDIR === 1 || diffDIR === 3) {\n            // 证明只需要一个控制点\n            if(start.dir % 2 === 1) {\n                controlPoint.push([end.p[0], start.p[1]]);\n            } else {\n                controlPoint.push([start.p[0], end.p[1]]);\n            }\n\n        } else {\n            if(start.dir % 2 === 1) {\n                if(start.p[1] !== end.p[1] ) {\n                    const mid = (start.p[0] - end.p[0]) /2 + end.p[0]\n                    controlPoint.push([ mid, start.p[1] ]);\n                    controlPoint.push([ mid, end.p[1] ]);\n                }\n            } else {\n                if(start.p[0] !== end.p[0] ) {\n                    const mid = (start.p[1] - end.p[1]) /2 + end.p[1]\n                    controlPoint.push([ start.p[0], mid ]);\n                    controlPoint.push([ end.p[0], mid ]);\n                }\n            }\n        }\n        controlPoint.push(end.p);\n        this.controlPoint = controlPoint;\n        ctx.fillStyle = ctx.strokeStyle = this.getColor();\n        ctx.beginPath();\n        for (let i = 0; i < controlPoint.length; i ++) {\n            const [x, y] = controlPoint[i];\n            if (i === 0) ctx.moveTo(x, y);\n            else ctx.lineTo(x, y);\n        }\n        ctx.stroke();\n        ctx.beginPath();\n        const endP = end.p;\n        ctx.moveTo(endP[0], endP[1]);\n\n        switch (end.dir) {\n            case DIRECTION.TOP:\n                ctx.lineTo(endP[0] - 5, endP[1] - 10)\n                ctx.lineTo(endP[0] + 5, endP[1] - 10)\n                break;\n            case DIRECTION.BOTTOM:\n                ctx.lineTo(endP[0] + 5, endP[1] + 10)\n                ctx.lineTo(endP[0] - 5, endP[1] + 10)\n                break;\n            case DIRECTION.RIGHT:\n                ctx.lineTo(endP[0] + 10, endP[1] + 5)\n                ctx.lineTo(endP[0] + 10, endP[1] - 5)\n                break;\n            case DIRECTION.LEFT:\n                ctx.lineTo(endP[0] - 10, endP[1] - 5)\n                ctx.lineTo(endP[0] - 10, endP[1] + 5)\n                break;\n            default:\n                break;\n        }\n        ctx.closePath();\n        ctx.fill();\n        ctx.stroke();\n    }\n\n    isHit(point) {\n        const controlPoint = this.controlPoint;\n        let [sx, sy] = controlPoint[0];\n        for (let i = 1; i < controlPoint.length; i ++) {\n\n            const [ex, ey] = controlPoint[i];\n            let lx, rx, by, ty;\n            if(sx === ex) {\n                lx = sx - APPROXIMATE;\n                rx = sx + APPROXIMATE;\n                by = Math.max(sy, ey);\n                ty = Math.min(sy, ey);\n            }\n            if(sy === ey) {\n                ty = sy - APPROXIMATE;\n                by = sy + APPROXIMATE;\n                rx = Math.max(sx, ex);\n                lx = Math.min(sx, ex);\n            }\n            if(point[0] > lx \n                && point[0] < rx \n                && point[1] > ty \n                && point[1] < by) {\n                    return true;\n                }\n            sx = ex;\n            sy = ey;\n        } \n        return false;\n    }\n\n    getBoundingRect() {\n        const { start, end } = this._calculateAnchorPoints(); \n        return [start.p, end.p]\n    }\n}\n\nexport default LinkPolyline;","import InstanceStack from './stack';\n// import Link from './link';\nimport Link from './polyline-link';\nimport { setUniqueId, getUniqueId } from '../utils/functions';\n/**\n * 对象栈 mixin 用于方便控制节点栈和连线栈\n *\n * @mixin\n */\nconst StackMixin = {\n    instances: [],\n    links: [],\n    _stack: null,\n    _linkStack: null,\n    /**\n     * 初始化对象栈\n     * @param {JflowConfigs} configs - 配置\n     */\n    initStack({ data }) {\n        this._stack = new InstanceStack();\n        this._linkStack = new InstanceStack();\n        if(!data) return;\n        this.instances = data.instances;\n        this.links = data.links;\n        this.instances.forEach(i => { \n            this._stack.push(i);\n            i._belongs = this;\n        })\n        this.links.forEach((link) => {\n            this._linkStack.push(link);\n            link._belongs = this;\n        });\n    },\n    /**\n     * 加入节点对象\n     * @param {Node} instance - 节点对象\n     */\n    addToStack(instance) {\n        instance._belongs = this;\n        this._stack.push(instance);\n        // this.recalculate()\n    },\n    /**\n     * 替换对象\n     * @param {Instance} target - 被替换的对象\n     * @param {Instance} instance - 替换对象\n     */\n    replaceFromStack(target, instance) {\n        const index = this._stack.findIndex(i => i === target);\n        this._stack.splice(index, 1, instance);\n        target._belongs = null;\n        instance._belongs = this;\n        // this.recalculate()\n    },\n    /**\n     * 加入连线对象\n     * @param {BaseLink} instance - 连线对象\n     */\n    addToLinkStack(link) {\n        link._belongs = this;\n        this._linkStack.push(link);\n    },\n    /**\n     * 删除节点对象\n     * @param {Node} target - 节点对象\n     */\n    removeFromStack(target) {\n        // this.removeLinkOnInstance(target);\n        const index = this._stack.findIndex(i => i === target);\n        this._stack.splice(index, 1);\n        // this.recalculate()\n    },\n    /**\n     * 删除连线对象\n     * @param {Node} target - 连线对象\n     */\n    removeFromLinkStack(target) {\n        const index = this._linkStack.findIndex(i => i === target);\n        this._linkStack.splice(index, 1);\n    },\n   \n    emptyLink() {\n        this._linkStack = new InstanceStack();\n    },\n    /* \n        还是丢给实现方去处理，这个不属于框架自带的通用逻辑\n    removeLinkOnInstance(target) {\n        const fromInstances = [];\n        const toInstances = [];\n        const removelinks = [];\n        let _constuctor;\n        this._linkStack.forEach(l => {\n            if(l.from === target){\n                toInstances.push(l.to);\n                _constuctor = l.__proto__.constructor;\n                removelinks.push(l);\n            }\n            if(l.to === target){\n                fromInstances.push(l.from);\n                _constuctor = l.__proto__.constructor;\n                removelinks.push(l);\n            }  \n        })\n        \n        removelinks.forEach(l => {\n            this.removeFromLinkStack(l);\n        });\n        // 暂且全连接吧\n        fromInstances.forEach(f => {\n            toInstances.forEach(t => {\n                this.addToLinkStack(new _constuctor({\n                    from: f, \n                    to: t\n                }))\n            });\n        });\n        return {\n            fromInstances,\n            toInstances,\n            removelinks,\n        }\n    }, */ \n\n    addInstanceToLink(targetLink, instance) {\n        this.addToStack(instance);\n        const { from, to } = targetLink;\n        const index = this._linkStack.findIndex(l => l === targetLink);\n        const _constuctor = targetLink.__proto__.constructor;\n        const l1 = new _constuctor({\n            from, \n            to: instance,\n        });\n        l1._belongs = this;\n        const l2 = new _constuctor({\n            from: instance, \n            to,\n        });\n        l2._belongs = this;\n\n        this._linkStack.splice(index, 1, l1, l2);\n    }\n    // reLayout() {\n    //     this.reflow();\n    //     this._getBoundingGroupRect();\n    //     if(this._belongs) {\n    //         this._belongs.reLayout();\n    //     }\n    // }\n    // addToTempStack(instance) {\n    //     this._tempStack.push(instance);\n    // },\n\n    // truncateTempStack() {\n    //     let temp;\n    //     if(this._tempStack) {\n    //         temp = this._tempStack.slice();\n    //     }\n    //     this._tempStack = new InstanceStack();\n    //     return temp;\n    // }\n\n}\n\nexport default StackMixin;","/**\n * 布局 mixin 用于注册和方便控制布局\n *\n * @mixin\n */\nconst LayoutMixin = {\n    _layout: null,\n    _reflowed: false,\n    /**\n     * 初始化布局\n     * @param {JflowConfigs} configs - 配置\n     */\n    initLayout(configs) {\n        this._layout = configs.layout;\n    },\n    /**\n     * 向上层递归重排\n     */\n    recalculateUp() {\n        this.recalculate();\n        if(this._belongs) {\n            this._belongs.recalculateUp();\n        }\n    },\n    /**\n     * 重新计算布局，相当于浏览器里面重排，并重算当前布局下的最小外接矩形\n     */\n    recalculate() {\n        this._reflowed = true;\n        this.reflow();\n        if(this._getBoundingGroupRect){\n            this._getBoundingGroupRect();\n        }\n        // 这个地方到底是手动还是自动？自动时机再试试看好了\n        // if(this._belongs) {\n        //     this._belongs.recalculate();\n        // }\n    },\n    /**\n     * 布局静态检查\n     * @param {Instance} instance - 检查单元\n     * @return {Boolean} - 检查结果 \n     */\n    staticCheck(instance) {\n        if(this._layout) {\n            return this._layout.staticCheck(instance, this);\n        }\n        return false;\n    },\n    /**\n     * 重新计算布局，相当于浏览器里面重排\n     */\n    reflow() {\n        if(this._layout) {\n            this._layout.reflow(this);\n        }\n    }\n}\n\nexport default LayoutMixin;","/**\n * 消息 mixin 用于给Jflow传递消息\n *\n * @mixin\n */\nconst MessageMixin = {\n    _message: null,\n    /**\n     * 发送消息\n     * @param {Object} msg - 消息体\n     */\n    sendMessage(msg) {\n        this._message = msg;\n    },\n    /**\n     * 接收消息\n     * @return {Object} msg - 消息体\n     */\n    consumeMessage() {\n        const msg = this._message;\n        this._message = null;\n        return msg;\n    },\n}\n\nexport default MessageMixin;","import Instance from './instance';\nimport { nextDirection } from '../utils/constance';\n\n/**\n * 节点基类\n * @extends Instance\n */\nclass Node extends Instance {\n    /**\n     * 创建节点.\n     * @param {Configs} configs - 配置\n     * @param {number[]} configs.anchor - 起始位置\n     * @param {number} configs.margin   - focus 状态下外层指示器的 margin\n     */\n    constructor(configs = {}) {\n        super(configs);\n        // for layout\n        // this._intersections = [];\n        this.anchor =   configs.anchor || [0, 0];\n        this.margin =   configs.margin || 5;\n    }\n\n    // end: from | to\n    // from 逆时针, to 顺时针\n    // checkLinked(interDir, end) {\n    //     if(this._intersections.find(i => i === interDir)) {\n    //         interDir = nextDirection(interDir, end === 'to');\n    //     } else {\n    //         this._intersections.push(interDir)\n    //     }\n    //     return interDir;\n    // }\n    \n    /**\n     * 绘制 focus 状态下外层指示器\n     * @param {Context2d} ctx \n     */\n    renderFocus(ctx) {\n        const points = this.getBoundingRect();\n        if(points.length !== 4) return;\n        const margin = this.margin;\n        const [p0, p1, p2, p3] = points;\n        const width = p1[0] - p0[0];\n        const height = p3[1] - p0[1];\n        const w = width * 0.2;\n        const h = height * 0.2;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(p0[0] - margin, p0[1] - margin + h);\n        ctx.lineTo(p0[0] - margin, p0[1] - margin);\n        ctx.lineTo(p0[0] - margin + w, p0[1] - margin);\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.moveTo(p1[0] + margin - w, p1[1] - margin);\n        ctx.lineTo(p1[0] + margin, p1[1] - margin);\n        ctx.lineTo(p1[0] + margin, p1[1] - margin + h);\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.moveTo(p2[0] + margin, p2[1] + margin - h);\n        ctx.lineTo(p2[0] + margin, p2[1] + margin);\n        ctx.lineTo(p2[0] + margin - w, p2[1] + margin);\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.moveTo(p3[0] - margin + w, p3[1] + margin);\n        ctx.lineTo(p3[0] - margin, p3[1] + margin);\n        ctx.lineTo(p3[0] - margin, p3[1] + margin - h);\n        ctx.stroke();\n        ctx.restore();\n    }\n}\n\nexport default Node;","import Node from './node';\nimport { DIRECTION } from '../utils/constance';\n/**\n * 圆形节点\n * @extends Node\n */\nclass Point extends Node {\n    /**\n     * 创建圆形节点.\n     * @param {Configs} configs - 配置\n     * @param {number} configs.radius - 半径\n     */\n    constructor(configs) {\n        super(configs);\n        this.type =             'Point';\n        this.radius =           configs.radius || 10;\n        this.radiusExpo2 =      this.radius * this.radius;\n    }\n\n    render(ctx) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n        ctx.beginPath();\n        ctx.arc(this.anchor[0], this.anchor[1], this.radius, 0, 2 * Math.PI);\n        ctx.fillStyle = this.color;\n        ctx.fill();   \n        ctx.strokeStyle = this.strokeColor;\n        ctx.stroke();\n        // if(this.content) {\n        //     ctx.font = this.font;\n        //     ctx.textAlign = this.textAlign;\n        //     ctx.textBaseline = this.textBaseline;\n        //     ctx.fillStyle = this.textColor;\n        //     ctx.fillText(this.content, this.anchor[0], this.anchor[1]);\n        // }   \n        if(this._isTargeting) {\n            this.renderFocus(ctx);\n        }\n        ctx.restore();\n    }\n\n    isHit(point) {\n        const anchor = this.anchor;\n        return Math.pow(point[0] - anchor[0], 2) + Math.pow(point[1] - anchor[1], 2) < this.radiusExpo2\n    }\n\n    getBoundingRect() {\n        const anchor = this.anchor;\n        const r = this.radius;\n        const ltx = anchor[0] - r;\n        const lty = anchor[1] - r;\n        const rbx = anchor[0] + r;\n        const rby = anchor[1] + r;\n        return [\n            [ltx, lty],\n            [rbx, lty],\n            [rbx, rby],\n            [ltx, rby],\n        ]\n    }\n\n    calculateIntersection(point) {\n        const [x1, y1] = point;\n        const [x2, y2] = this.anchor;\n        const vecx = x2 - x1;\n        const vecy = y2 - y1;\n        const dist = Math.sqrt(vecx * vecx + vecy * vecy);\n\n        const ratio = this.radius / dist;\n        return [x2 - ratio * vecx, y2 - ratio * vecy];\n    }\n\n    getIntersectionsInFourDimension() {\n        const [x2, y2] = this.anchor;\n        const r = this.radius;\n        return {\n            [DIRECTION.RIGHT]:  [x2 + r, y2],\n            [DIRECTION.LEFT]:   [x2 - r, y2],\n            [DIRECTION.BOTTOM]: [x2, y2+r],\n            [DIRECTION.TOP]:    [x2, y2-r],\n        }\n    }\n\n    calculateIntersectionInFourDimension(point, end) {\n        const [x1, y1] = point;\n        const [x2, y2] = this.anchor;\n        const r = this.radius;\n        const vecx = x2 - x1;\n        const vecy = y2 - y1;\n        const allIntersections = {\n            [DIRECTION.RIGHT]:  [x2 + r, y2],\n            [DIRECTION.LEFT]:   [x2 - r, y2],\n            [DIRECTION.BOTTOM]: [x2, y2+r],\n            [DIRECTION.TOP]:    [x2, y2-r],\n        }\n        // console.log(Math.abs(vecx) > Math.abs(vecy), vecx, r)\n        // if() {\n        //     return {\n        //         p: [x2 + (vecx<0?r:-r), y2],\n        //         dir: vecx<0 ? DIRECTION.RIGHT : DIRECTION.LEFT,\n        //     }\n        // } else {\n        //     return {\n        //         p: [x2, y2+(vecy<0?r:-r)],\n        //         dir: vecy<0 ? DIRECTION.BOTTOM : DIRECTION.TOP,\n        //     }\n        // }\n        let interDir = (Math.abs(vecy) > Math.abs(vecx)\n            ? (vecy < 0 ? DIRECTION.BOTTOM : DIRECTION.TOP) \n            : (vecx < 0 ? DIRECTION.RIGHT : DIRECTION.LEFT));\n\n        interDir = this.checkLinked(interDir, end);\n        return {\n            p: allIntersections[interDir],\n            dir: interDir,\n        }\n    }\n\n    getBoundingDimension() {\n        return {\n            width: this.radius * 2,\n            height: this.radius * 2,\n        }\n    }\n    \n}\n\nexport default Point;","class JFlowEvent extends CustomEvent{\n    constructor(event, configs = {}) {\n        const detail = {\n            ...configs,\n            originEvent: configs.event,\n            target: configs.target,\n            jflow: configs.jflow,\n            bubbles: configs.bubbles || false,    \n        }\n        super(event, {\n            detail\n        });\n    }\n}\n\nexport default JFlowEvent;","import Node from './node';\nimport { DIRECTION, oppositeDirection } from '../utils/constance';\n/**\n * 矩形单元\n * @extends Node\n */\nclass Rectangle extends Node {\n    /**\n     * 创建矩形节点.\n     * @param {Configs} configs - 配置\n     * @param {number} configs.width - 宽\n     * @param {number} configs.height - 高\n     * @param {number} configs.borderRadius - 圆角矩形半径\n     */\n    constructor(configs = {}) {\n        super(configs);\n        this.type =             'Rectangle';\n        this.width =            configs.width || 10;\n        this.height =           configs.height || 10;\n        this.borderRadius =     configs.borderRadius || 0;\n    }\n\n    render(ctx) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n        ctx.beginPath();\n        const {\n            borderRadius: radius, anchor, width, height\n        } = this;\n        if(this.borderRadius) {\n            const x = this.anchor[0] - this.width / 2;\n            const y = this.anchor[1] - this.height / 2;\n            ctx.moveTo(x + radius, y);\n            ctx.lineTo(x + width - radius, y);\n            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\n            ctx.lineTo(x + width, y + height - radius);\n            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n            ctx.lineTo(x + radius, y + height);\n            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\n            ctx.lineTo(x, y + radius);\n            ctx.quadraticCurveTo(x, y, x + radius, y);\n            ctx.closePath();\n        } else {\n            ctx.rect(this.anchor[0] - this.width / 2, this.anchor[1] - this.height / 2, this.width, this.height);\n        }\n        ctx.fillStyle = this.color;\n        ctx.fill();     \n        if(this.borderWidth){\n            if(this.status.hover) {\n                ctx.strokeStyle = this.hoverStyle;\n            } else {\n                ctx.strokeStyle = this.borderColor;\n            }\n            ctx.stroke();\n        }\n        // if(this.content) {\n        //     ctx.font = this.font;\n        //     ctx.textAlign = this.textAlign;\n        //     ctx.textBaseline = this.textBaseline;\n        //     ctx.fillStyle = this.textColor;\n        //     ctx.fillText(this.content, this.anchor[0], this.anchor[1]);\n        // } \n       \n        if(this._isTargeting) {\n            this.renderFocus(ctx);\n        }\n\n        ctx.restore();\n    }\n\n    isHit(point) {\n        const anchor = this.anchor;\n        const w = this.width /2;\n        const h = this.height/2;\n        return point[0] > anchor[0] - w \n            && point[0] < anchor[0] + w \n            && point[1] > anchor[1] - h \n            && point[1] < anchor[1] + h;\n    }\n\n    getBoundingRect() {\n        const anchor = this.anchor;\n        const w = this.width /2;\n        const h = this.height/2;\n        const ltx = anchor[0] - w;\n        const lty = anchor[1] - h;\n        const rbx = anchor[0] + w;\n        const rby = anchor[1] + h;\n        return [\n            [ltx, lty],\n            [rbx, lty],\n            [rbx, rby],\n            [ltx, rby],\n        ]\n    }\n\n    getBoundingDimension() {\n        return {\n            height: this.height,\n            width: this.width,\n        }\n    }\n\n    calculateIntersection(point) {\n        const [x1, y1] = point;\n        const [x2, y2] = this.anchor;\n        const w = this.width/2;\n        const h = this.height/2;\n        const vecx = x2 - x1;\n        const vecy = y2 - y1;\n        const theta1 = h/w;\n        const theta2 = Math.abs(vecy/vecx);\n        const dirx = x1 > x2;\n        const diry = y1 > y2;\n        let x, y;\n        if(theta2 < theta1) {\n            x = x2 + (dirx?w:-w);\n            y = w * (diry?theta2:-theta2) + y2;\n        } else {\n            y = y2 + (diry?h:-h);\n            x = h / (dirx?theta2:-theta2) + x2;\n        }\n        return [x, y];\n    }\n\n    getIntersectionsInFourDimension() {\n        let p2 = this.anchor;\n        if(this._belongs && this._belongs.calculateToCoordination) {\n            p2 = this._belongs.calculateToCoordination(p2);\n        }\n        \n        const [x2, y2] = p2;\n        const w = this.width/2;\n        const h = this.height/2;\n        return {\n            [DIRECTION.RIGHT]:  [x2+w, y2],\n            [DIRECTION.LEFT]:   [x2-w, y2],\n            [DIRECTION.BOTTOM]: [x2, y2+h],\n            [DIRECTION.TOP]:    [x2, y2-h],\n        }\n    }\n  \n    calculateIntersectionInFourDimension(point, end) {\n        const [x1, y1] = point;\n        let p2 = this.anchor;\n        if(this._belongs && this._belongs.calculateToCoordination) {\n            p2 = this._belongs.calculateToCoordination(p2);\n        }\n        \n        const [x2, y2] = p2;\n        const w = this.width/2;\n        const h = this.height/2;\n        const allIntersections = {\n            [DIRECTION.RIGHT]:  [x2+w, y2],\n            [DIRECTION.LEFT]:   [x2-w, y2],\n            [DIRECTION.BOTTOM]: [x2, y2+h],\n            [DIRECTION.TOP]:    [x2, y2-h],\n        }\n        const vecx = x2 - x1;\n        const vecy = y2 - y1;\n        const theta1 = h/w;\n        const theta2 = Math.abs(vecy/vecx);\n        const dirx = x1 > x2;\n        const diry = y1 > y2;\n        let interDir = (theta2 > theta1 \n            ? (diry ? DIRECTION.BOTTOM : DIRECTION.TOP) \n            : (dirx ? DIRECTION.RIGHT : DIRECTION.LEFT));\n\n        if(this._belongs && this._belongs.calculateToCoordination) {\n            console.log(JSON.stringify(this._intersections));\n            console.log(interDir)\n        }\n        interDir = this.checkLinked(interDir, end);\n        if(this._belongs && this._belongs.calculateToCoordination) {\n            console.log(interDir)\n        }\n        \n        // if(!interDir) {\n        //     debugger\n        // }\n        // let endDir = interDir;\n        // if(end === 'to') {\n        //     endDir = oppositeDirection(endDir)\n        // }\n        return {\n            p: allIntersections[interDir],\n            dir: interDir,\n        }\n    }\n}\n\nexport default Rectangle;","import Rectangle from './rectangle';\nimport StackMixin from './stackMixin';\nimport LayoutMixin from './layoutMixin';\nimport { bounding_box } from '../utils/functions';\nimport { DIRECTION } from '../utils/constance';\n/**\n * @typedef GroupConfigs\n * @type {object}\n * @property {number} borderWidth      - 边的宽度 默认是 2\n * @property {string} borderColor      - 边的颜色 默认 black\n * @property {string} hoverStyle       - 悬停颜色 默认 transparent\n * @property {string} content          - 内容\n * @property {string} color            - 填充颜色 默认 white\n * @property {string} fontFamily       - 字体 默认 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji\n * @property {string} fontSize         - 字体大小 默认 28px\n * @property {string} textColor        - 字体颜色 默认 white\n * @property {string} textAlign        - 字体左右对齐 默认 center\n * @property {string} textBaseline     - 字体垂直对齐 默认 center\n * @property {number} width            - 设定宽度，则宽度不随内部元素变宽而变宽\n * @property {number} height           - 设定高度，则宽度不随内部元素变高而变高\n * @property {number} padding          - padding\n * @property {number} lock              - lock 后，内部元素不能被拖动\n */\n/**\n * 组单元\n * @description 组单元包含绘图栈，能够包裹内部单元，具有独立的坐标系，目前为中心对齐的坐标系\n * @extends Rectangle\n * @mixes LayoutMixin\n * @mixes StackMixin\n */\nclass Group extends Rectangle {\n    /**\n     * 创建一个组\n     * @param {GroupConfigs} configs - 配置\n\n     **/\n    constructor(configs) {\n        super(configs)\n        this.initStack(configs);\n        this.initLayout(configs);\n         /**\n         * @property {number} definedWidth     - 设定宽度 \n         * @property {number} definedHeight    - 设定高度 \n         * @property {number} padding          - 内边距\n         * @property {boolean} lock            - 布局锁定状态\n         */\n        this.definedWidth =     configs.width;\n        this.definedHeight =    configs.height;\n        this.type =             'Group';\n        this.padding =          configs.padding || 2;\n        this.hoverStyle =       configs.hoverStyle || 'cornflowerblue';\n        this.hasShrink =        configs.hasShrink;\n        this.lock =             configs.lock;\n        this.status.shrink =    false;\n        this.offsetY = 0;\n        this.offsetX = 0;\n        this._getBoundingGroupRect();\n        this.reflow();\n        this._getBoundingGroupRect();\n        // this.addEventListener('click', (event) => {\n        //     console.log(this.status.focusOnControlPoint)\n        //     if(this.status.focusOnControlPoint) {\n        //         this.shrink = !this.shrink;\n        //         event.detail.jflow._render();\n        //     }\n        // });\n        // this._currentCenter = this.getCenter();\n    }\n\n    _getBoundingGroupRect() {\n        const points = this._stack.getBoundingRectPoints();\n        const bbox = bounding_box(points);\n        const padding = this.padding;\n        const w = bbox.width + padding * 2;\n        const h = bbox.height + padding * 2;\n        this.width = this.definedWidth || w;\n        this.height = this.definedHeight || h;\n\n        // this.height = h;\n        this.offsetY = bbox.y;\n        this.offsetX = bbox.x;\n        // 收起的重算\n        // if(this.bounding_box && !this.bounding_box.shrink) {\n        //     const vecx = bx - this.bounding_box.x;\n        //     const vecy = by - this.bounding_box.y;\n        //     this.anchor[0] += vecx;\n        //     this.anchor[1] += vecy;\n        // }\n    }\n\n    render(ctx) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n        // this._getBoundingGroupRect();\n        const anchor = this.anchor;\n        ctx.save();\n        Rectangle.prototype.render.call(this, ctx);\n        ctx.restore();\n        const height = this.height;\n        const width = this.width;\n        const padding = this.padding;\n        const spanV = height / 2 + this.offsetY - padding\n        const spanH = width / 2 + this.offsetX - padding\n        ctx.translate(anchor[0] - spanH, anchor[1] - spanV);\n        this._stack.render(ctx);\n        this._linkStack.render(ctx);\n        ctx.translate(-anchor[0] + spanH, -anchor[1] + spanV);\n        \n        if(this._isTargeting) {\n            this.renderFocus(ctx);\n        }\n        ctx.restore();\n    }\n\n    _calculatePointBack(point) {\n        const [gx, gy] = point;\n        const height = this.height;\n        const width = this.width;\n        const padding = this.padding;\n        const spanV = height / 2 + this.offsetY - padding\n        const spanH = width / 2 + this.offsetX - padding\n        const anchor = this.anchor;\n        const p = [gx - anchor[0] + spanH, gy - anchor[1] +spanV ];\n        return p\n    }\n\n    isHit(point, condition) {\n        const p = this._calculatePointBack(point);\n        this._currentp = p; // 暂存，为了后续计算别的位置\n        // if(!this.lock) {\n            const target = this._stack.checkHit(p, condition);\n            if(target) return target;\n        // }\n\n        return Rectangle.prototype.isHit.call(this, point);\n    }\n    /**\n     * 反算回 canvas 顶层坐标\n     * @param {Number[]} point\n     * @return {Number[]} 世界坐标\n     */\n    calculateToCoordination(point) {\n        const [cx, cy] = point;\n        const height = this.height;\n        const width = this.width;\n        const padding = this.padding;\n        const spanV = height / 2 + this.offsetY - padding\n        const spanH = width / 2 + this.offsetX - padding\n        const anchor = this.anchor;\n        const p = [cx + anchor[0] - spanH, cy + anchor[1] - spanV];\n        if(this._belongs && this._belongs.calculateToCoordination) {\n            return this._belongs.calculateToCoordination(p);\n        } else {\n            return p;\n        }\n    }\n\n    calculateToRealWorld(point) {\n        const [cx, cy] = point;\n        const height = this.height;\n        const width = this.width;\n        const padding = this.padding;\n        const spanV = height / 2 + this.offsetY - padding\n        const spanH = width / 2 + this.offsetX - padding\n        const anchor = this.anchor;\n        const p = [cx + anchor[0] - spanH, cy + anchor[1] - spanV];\n        if(this._belongs && this._belongs.calculateToRealWorld) {\n            return this._belongs.calculateToRealWorld(p);\n        }\n\n    }\n}\nObject.assign(Group.prototype, StackMixin);\nObject.assign(Group.prototype, LayoutMixin);\nexport default Group;","import Rectangle from './rectangle';\nimport { DIRECTION } from '../utils/constance';\nimport { requestCacheCanvas } from '../utils/canvas';\nimport JFlowEvent from '../events';\nfunction createInputElement(params) {\n    const input = document.createElement('input');\n    input.setAttribute('style',`\n        position: absolute;\n        left: 0;\n        top: 0;\n        border:none;\n        background-image:none;\n        background-color:transparent;\n        -webkit-box-shadow: none;\n        -moz-box-shadow: none;\n        box-shadow: none;`);\n    return input;\n}\n/**\n * 文字对象\n * @description 可以绘制文字\n * @extends Rectangle\n */\nclass Text extends Rectangle {\n    /**\n     * 创建一个文本对象\n     * @param {Configs} configs - 配置\n     * @param {number} configs.lineHeight   - 行高\n     * @param {number} configs.indent   - 缩进\n     * @param {number} configs.editable   - 是否可编辑\n     **/\n    constructor(configs) {\n        super(configs);\n        this.type =             'Text';\n        this.lineHeight =       configs.lineHeight ;\n        this.indent =           configs.indent || 0;\n        this.backgroundColor =  configs.backgroundColor;\n        this.editable =         configs.editable;\n        this.acceptPatten =     configs.acceptPatten;\n        this.editStatus = {\n            editting: false,\n        }\n        requestCacheCanvas((ctx) => {\n            this.renderShadowText(ctx);\n        });\n        console.log(this.width, this.height, this.content);\n        this._makeEditable();\n    }\n\n\n    _makeEditable() {\n        if(this.editable) {\n            this.addEventListener('click', (event) => {\n                const p = [ 0, -this.height/2 ];\n                const fontSize = +/(\\d+)/.exec(this.fontSize)[1];\n                const [offsetX, offsetY] = this.calculateToRealWorld(p);\n                const inputElement = createInputElement();\n                const wrapper = this._jflow.DOMwrapper;\n                const oldVal = this.content;\n                inputElement.style.transform =`translate(${offsetX}px, ${offsetY}px)`;\n                inputElement.style.width = this.calculateToRealWorldWithScalar(this.width) + 'px';\n                inputElement.style.height = this.calculateToRealWorldWithScalar(this.height) + 'px';\n                inputElement.style.fontFamily = this.fontFamily;\n                inputElement.style.fontSize = `${fontSize * this._jflow.scale}px`;\n                inputElement.style.lineHeight = `${this.lineHeight * this._jflow.scale}px`;\n                inputElement.style.textIndent = `${this.indent * this._jflow.scale}px`;\n                inputElement.value = this.content;\n                inputElement.style.color = this.textColor;\n                inputElement.addEventListener(\"focus\",  () => {\n                    this.content = '';\n                    this._jflow._render();\n                    inputElement.style.outline = \"none\";  \n                });\n                const blurHandler = () => {\n                    if(this.acceptPatten){\n                        \n                    } else {\n                        const val = inputElement.value;\n                        this.dispatchEvent(new JFlowEvent('change', {\n                            target: this,\n                            oldVal,\n                            val,\n                        }))\n                        this.content = oldVal;\n                        inputElement.remove();\n                    }\n                };\n                inputElement.addEventListener('blur', blurHandler);\n                inputElement.addEventListener('keyup', (e) => {\n                    if (e.key === 'Enter' || e.keyCode === 13) {\n                        blurHandler();\n                    }\n                })\n                wrapper.append(inputElement);\n                inputElement.focus();\n            })\n        }\n    }\n\n    renderShadowText(ctx) {\n        ctx.beginPath();\n        ctx.font = `${this.fontSize} ${this.fontFamily}`;\n        ctx.textAlign = this.textAlign;\n        ctx.textBaseline = this.textBaseline;\n        ctx.fillStyle = this.textColor;\n        const {\n            actualBoundingBoxLeft,\n            actualBoundingBoxRight,\n            fontBoundingBoxAscent,\n            fontBoundingBoxDescent\n        } = ctx.measureText(this.content);\n\n        this.width = this.indent + Math.abs(actualBoundingBoxLeft) + Math.abs(actualBoundingBoxRight);\n        const height = Math.abs(fontBoundingBoxAscent) + Math.abs(fontBoundingBoxDescent);\n        if(this.lineHeight) {\n            this.height = this.lineHeight;\n        } else {\n            this.height = height;\n        }\n    }\n\n    setConfig(configs) {\n        Object.keys(configs).forEach(k => {\n            if(configs[k] !== undefined && configs[k] !== null) {\n                this[k] = configs[k]\n            }\n        });\n        requestCacheCanvas((ctx) => {\n            this.renderShadowText(ctx);\n        });\n    }\n\n    render(ctx) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n        this.renderShadowText(ctx);\n\n\n        const {\n            borderRadius: radius, anchor, width, height\n        } = this;\n        if(this.backgroundColor || this.borderColor){\n            ctx.save();\n            ctx.beginPath();\n            if(this.borderRadius) {\n                const x = this.anchor[0] - this.width / 2;\n                const y = this.anchor[1] - this.height / 2;\n                ctx.moveTo(x + radius, y);\n                ctx.lineTo(x + width - radius, y);\n                ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\n                ctx.lineTo(x + width, y + height - radius);\n                ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n                ctx.lineTo(x + radius, y + height);\n                ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\n                ctx.lineTo(x, y + radius);\n                ctx.quadraticCurveTo(x, y, x + radius, y);\n                ctx.closePath();\n            } else {\n                ctx.rect(this.anchor[0] - this.width / 2, this.anchor[1] - this.height / 2, this.width, this.height);\n            }\n            if (this.backgroundColor){\n                ctx.fillStyle = this.backgroundColor;\n                ctx.fill();\n            }\n            if(this.borderColor) {\n                ctx.strokeStyle = this.borderColor;\n                ctx.stroke();\n            }\n            ctx.restore();\n        }\n\n        ctx.beginPath();\n\n        // ctx.rect(this.anchor[0] - this.width / 2, this.anchor[1] - this.height / 2, this.width, this.height);\n        // ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';\n        // ctx.fill();\n        ctx.fillText(this.content, this.anchor[0] + this.indent / 2, this.anchor[1]);\n        ctx.restore();\n    }\n}\n\nexport default Text;","import Rectangle from './rectangle';\nimport StackMixin from './stackMixin';\nimport LayoutMixin from './layoutMixin';\nimport { bounding_box } from '../utils/functions';\nimport { DIRECTION } from '../utils/constance';\n\n/**\n * 图片单元\n * @description 图片单元可以绘制图片，图片加载后会自动重新绘制\n * @extends Rectangle\n */\nclass Icon extends Rectangle {\n      /**\n        * 创建一个图片单元\n        * @param {Configs} configs - 配置\n        * @param {number} configs.image   - 图片地址\n        * @param {number} configs.imageWidth   - 图片宽度\n        * @param {number} configs.imageHeight   - 图片高度\n        **/\n    constructor(configs) {\n        super(configs)\n        this.borderWidth = 0;\n        this.image = configs.image;\n        this.image.onload = () => {\n            requestAnimationFrame(() => {\n                this._jflow._render();\n            })\n        }\n        this.imageBounding = {\n            width: configs.imageWidth || configs.width,\n            height: configs.imageHeight ||  configs.height,\n        }\n    }\n\n    render(ctx) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n        Rectangle.prototype.render.call(this, ctx);\n        const x = this.anchor[0] - this.width / 2;\n        const y = this.anchor[1] - this.height / 2;\n        ctx.drawImage(this.image, x, y, this.imageBounding.width, this.imageBounding.height);\n        ctx.restore();\n    }\n}\nexport default Icon;","import Instance from './instance';\n\n/**\n * 连线基类\n * @extends Instance\n */\nclass BaseLink extends Instance{\n    /**\n     * 创建连线.\n     * @param {Configs} configs - 配置\n     * @param {Instance} configs.from   - 起始单元\n     * @param {Instance} configs.to     - 终止单元\n     * @param {String} configs.fromDir  - 起始方向 \n     * @param {String} configs.toDir    - 终止方向 \n     * @param {String} configs.key      - 连线唯一键值\n     */\n    constructor(configs = {}) {\n        super();\n        this.from     = configs.from; // Instance\n        this.to       = configs.to;   // Instance\n        this.fromDir  = configs.fromDir;\n        this.toDir    = configs.toDir;\n        this.key      = configs.key;\n        this._cachePoints = null;\n        this.defaultStyle = 'black';\n        this.hoverStyle = 'cornflowerblue';\n    }\n}\n\nexport default BaseLink;","import BaseLink from './base-link';\nimport { distToSegmentSquared } from '../utils/functions';\nimport { APPROXIMATE } from '../utils/constance';\nclass Link extends BaseLink {\n    constructor(configs) {\n        super(configs);\n        this.from   = configs.from; // Instance\n        this.to     = configs.to;   // Instance\n        this.controlPoints = [0, 1, -10, 1, -10, 5];\n        this._cachePoints = null;\n        this.defaultStyle = 'black';\n        this.hoverStyle = 'cornflowerblue';\n    }\n\n    getColor() {\n        if(this._isTargeting) {\n            return this.hoverStyle;\n        }\n        return this.defaultStyle;\n    }\n\n    _calculateAnchorPoints() {\n        const start = this.from.calculateIntersection(this.to.getCenter());\n        const end = this.to.calculateIntersection(this.from.getCenter());\n        this._cachePoints = [start, end];\n        return {\n            startX: start[0], \n            startY: start[1],\n            endX  : end[0],\n            endY  : end[1],\n        }\n    }\n\n    render(ctx) {\n        const { startX, startY, endX, endY } = this._calculateAnchorPoints();\n        const controlPoints = this.controlPoints;\n        var dx = endX - startX;\n        var dy = endY - startY;\n        var len = Math.sqrt(dx * dx + dy * dy);\n        var sin = dy / len;\n        var cos = dx / len;\n        var a = [];\n        a.push(0, 0);\n        for (var i = 0; i < controlPoints.length; i += 2) {\n            var x = controlPoints[i];\n            var y = controlPoints[i + 1];\n            a.push(x < 0 ? len + x : x, y);\n        }\n        a.push(len, 0);\n        for (var i = controlPoints.length; i > 0; i -= 2) {\n            var x = controlPoints[i - 2];\n            var y = controlPoints[i - 1];\n            a.push(x < 0 ? len + x : x, -y);\n        }\n        a.push(0, 0);\n        ctx.fillStyle = ctx.strokeStyle = this.getColor();\n        ctx.beginPath();\n        for (var i = 0; i < a.length; i += 2) {\n            var x = a[i] * cos - a[i + 1] * sin + startX;\n            var y = a[i] * sin + a[i + 1] * cos + startY;\n            if (i === 0) ctx.moveTo(x, y);\n            else ctx.lineTo(x, y);\n        }\n        ctx.fill();\n    }\n\n    isHit(point) {\n        if(!this._cachePoints) return false;\n        const [ start, end ] = this._cachePoints;\n        const dist = distToSegmentSquared(point, start, end)\n        return dist < APPROXIMATE;\n    }\n\n    getBoundingRect() {\n        const { startX, startY, endX, endY } = this._calculateAnchorPoints(); \n        return [[startX, startY], [endX, endY]]\n    }\n}\n\nexport default Link;","import BaseLink from './base-link';\nimport { bezierPoints, distToBezierSegmentSquared, getBezierAngle } from '../utils/functions';\nimport { APPROXIMATE } from '../utils/constance';\n/**\n * 贝塞尔曲线\n * @extends BaseLink\n */\nclass BezierLink extends BaseLink {\n     /**\n     * 创建贝塞尔曲线.\n     * @param {Configs} configs - 配置\n     * @param {Boolean} configs.anticlock   - 进出方向反转\n     **/\n    constructor(configs) {\n        super(configs);\n        this.anticlock     = configs.anticlock;\n    }\n    /**\n     * 根据当前状态获取颜色，当前单元是否被选中\n     * @return {String} 颜色\n     */\n    getColor() {\n        if(this._isTargeting) {\n            return this.hoverStyle;\n        }\n        return this.defaultStyle;\n    }\n    \n    _calculateAnchorPoints() {\n        let start;\n        let end;\n        if(this.fromDir !== undefined) {\n            start = {\n                dir: this.fromDir,\n                p: this.from.getIntersectionsInFourDimension()[this.fromDir],\n            }\n        } \n        if(this.toDir !== undefined) {\n            end = {\n                dir: this.toDir,\n                p: this.to.getIntersectionsInFourDimension()[this.toDir],\n            }\n        }\n        \n        \n        // const start = this.from.calculateIntersectionInFourDimension(this.to.getCenter(), 'from');\n        // const end = this.to.calculateIntersectionInFourDimension(this.from.getCenter(), 'to');\n        const p1 = start.p;\n        const p2 = end.p;\n        const points = bezierPoints(p1, p2, start.dir, end.dir, this.anticlock);\n\n        this._cachePoints = [...p1, ...points]\n    }\n\n    render(ctx) {\n        this._calculateAnchorPoints();\n        const points = this._cachePoints;\n        const angle = getBezierAngle.apply(null, [1, ...points])\n\n        ctx.fillStyle = ctx.strokeStyle = this.getColor();\n        ctx.beginPath();\n        ctx.moveTo(points[0], points[1])\n        ctx.bezierCurveTo(...points.slice(2));\n        ctx.stroke();\n        ctx.beginPath();\n        ctx.translate(points[6], points[7]);\n        ctx.rotate(angle);\n        ctx.moveTo(5, 0);\n        ctx.lineTo(0, -4);\n        ctx.lineTo(0, 4);\n        ctx.lineTo(5, 0);\n        ctx.fill();\n        ctx.rotate(-angle);\n        ctx.translate(-points[6], -points[7]);\n    }\n\n    isHit(point) {\n        if(!this._cachePoints) return false;\n        const points = this._cachePoints;\n        const dist = distToBezierSegmentSquared(point, points)\n        return dist < APPROXIMATE;\n    }\n\n    getBoundingRect() {\n        const { startX, startY, endX, endY } = this._calculateAnchorPoints(); \n        return [[startX, startY], [endX, endY]]\n    }\n}\n\nexport default BezierLink;","/**\n    线性布局\n\n    排列方向\n    direction:\n        + vertical 从上至下排布\n        + horizontal 从左至右排布\n    \n    不重叠，中线对齐\n    只针对当前的 group\n\n    对齐方式\n    alignment: \n        + start 主轴左侧对齐\n        + center 主轴对齐\n        + end   主轴右侧对齐\n    \n * @implements {Layout}\n */\n\nclass LinearLayout {\n    constructor(configs = {}) {\n        /**\n         * 通用样式属性\n         * @property {string} direction     - 排列方向 默认 vertical\n         * @property {number} gap           - 边距\n         * @property {string} alignment     - 对齐方式 默认 center\n         */\n        this.direction =     configs.direction || 'vertical';\n        this.gap =           configs.gap || 5;\n        this.alignment =     configs.alignment || 'center';\n    }\n\n\n    reflow(group) {\n        const stack = group._stack.filter(instance => instance.visible && !instance.outOfFlow);\n        // console.log(this, stack)\n        if(this.direction === 'vertical') {\n            let reduceHeight = 0;\n            let lastInstanceHeight = 0;\n            let maxWidth = 0;\n            stack.forEach((instance, idx) =>  {\n                const { width, height } = instance.getBoundingDimension();\n                maxWidth = Math.max(width, maxWidth);\n                reduceHeight += (height/2 + (idx > 0 ? this.gap : 0) + lastInstanceHeight)\n                lastInstanceHeight = height / 2;\n                instance.anchor = [0, reduceHeight];\n            });\n\n            if(this.alignment === 'start') {\n                stack.forEach((instance, idx) =>  {\n                    const { width } = instance.getBoundingDimension();\n                    instance.anchor[0] = -(maxWidth - width) / 2;\n                })\n            }\n            if(this.alignment === 'end') {\n                stack.forEach((instance, idx) =>  {\n                    const { width } = instance.getBoundingDimension();\n                    instance.anchor[0] = (maxWidth - width) / 2;\n                })\n            }\n        } \n        if(this.direction === 'horizontal') {\n            let reduceWidth = 0;\n            let lastInstanceWidth = 0;\n            let maxHeight = 0;\n            stack.forEach((instance, idx) =>  {\n                const { width, height } = instance.getBoundingDimension();\n                maxHeight = Math.max(height, maxHeight);\n                reduceWidth += (width/2 + (idx > 0 ? this.gap : 0) + lastInstanceWidth)\n                lastInstanceWidth = width / 2;\n                instance.anchor = [reduceWidth, 0]\n            });\n\n            if(this.alignment === 'start') {\n                stack.forEach((instance, idx) =>  {\n                    const { height } = instance.getBoundingDimension();\n                    instance.anchor[1] = -(maxHeight - height) / 2;\n                })\n            }\n            if(this.alignment === 'end') {\n                stack.forEach((instance, idx) =>  {\n                    const { height } = instance.getBoundingDimension();\n                    instance.anchor[1] = (maxHeight - height) / 2;\n                })\n            }\n        }\n    }\n}\n\nexport default LinearLayout;","\n// import EventEmitter from '../../utils/EventEmitter';\nimport { DIRECTION } from '../../utils/constance';\nclass BaseNode {\n    constructor(source) {\n        this.source = source;\n        this.id = source.id;\n        this.type = source.type;\n        this.getJflowInstance = undefined;\n        this.level = undefined;\n        this.sequence = undefined;\n        this.isLocked = false;\n        this.isFree = false;\n        this.parent = undefined;\n        this.idx = undefined;\n        this.parentIterateType = undefined;\n    }\n\n    reflowPreCalculate(level = 0, sequence = 0, callback) {\n        this.level = level;\n        this.sequence = sequence;\n        this.spanX = 1;\n        this.spanY = 1;\n        if(callback) {\n            console.log(level, sequence, this.id)\n            callback(level, sequence, this);\n        }\n        return {\n            spanX: this.spanX, \n            spanY: this.spanY, \n            level, sequence,\n        }\n    }\n\n    makeLink(callback) {\n        return this;\n    }\n\n    makeEndpoint() { }\n\n    traverse(callback) {\n        callback(this);\n    }\n\n    getNodes() {\n        const nodes = [];\n        this.traverse(n => {\n            if(n.getJflowInstance)\n                nodes.push(n.getJflowInstance());\n        })\n        return nodes;\n    }\n\n    linkSource(source) {\n        this.parent.source[this.parentIterateType].splice(this.idx + 1, 0, source);\n    }\n\n    remove() {\n        this.parent.source[this.parentIterateType].splice(this.idx, 1);\n    }\n}\n\nclass Root extends BaseNode {\n    constructor(source) {\n        super(source);\n        this.isroot = true;\n        this.body = (source.body || []).map(mapFunc('body').bind(this));\n        const playgrounditerator = mapFunc('playground').bind(this)\n        this.playground = (source.playground || []).map((s, idx) => {\n            const n = playgrounditerator(s, idx);\n            n.isFree = true;\n            return n;\n        });\n    }\n\n    reflowBodyPreCalculate(level = 0, sequence = 0, callback) {\n        let spanX = 1;\n        let spanY = 1;\n        this.level = level;\n        this.sequence = sequence;\n        if(callback) {\n            callback(level, sequence, this);\n        }\n        this.body.forEach((b) => {\n            const { spanX: sx, spanY: sy } = b.reflowPreCalculate(level + 1, sequence, callback);\n            spanX = Math.max(sx, spanX);\n            spanY += sy;\n            level += sy;\n        });\n\n        this.spanX = spanX;\n        this.spanY = spanY;\n        return {\n            spanX, spanY, level, sequence\n        }\n    }\n\n    reflowPlaygroundPreCalculate(preCallback, callback) {\n        this.playground.forEach(node => {\n            preCallback(node)\n            node.reflowPreCalculate(0, 0, callback)\n        })\n    }\n\n\n    makeLink(callback) {\n        let last;\n        this.body.forEach(b => {\n            if(!last) {\n                last = b;\n                return;\n            }\n            callback({\n                from: last.id,\n                to: b.id,\n                part: 'body',\n                fromDir: DIRECTION.BOTTOM,\n                toDir: DIRECTION.TOP,\n                meta: {\n                    from: last,\n                    to: b\n                }\n            })\n            \n            b = b.makeLink(callback);\n            last = b;\n        });\n\n        this.playground.forEach(n => {\n            n.makeLink(callback);\n        });\n        return this;\n    }\n\n    traverse(callback) {\n        this.body.forEach(n => {\n            n.traverse(callback);\n        });\n\n        this.playground.forEach(n => {\n            n.traverse(callback);\n        })\n    }\n}\n\nclass IfStatement extends BaseNode {\n    constructor(source) {\n        super(source);\n        this.consequent = (source.consequent || []).map(mapFunc('consequent').bind(this));\n        this.alternate = (source.alternate || []).map(mapFunc('alternate').bind(this));\n        this.isLocked = true;\n    }\n    \n    reflowPreCalculate(level = 0, sequence = 0, callback) {\n        let spanX = 1;\n        let spanY = 1;\n        this.level = level;\n        this.sequence = sequence;\n        if(callback) {\n            callback(level, sequence, this);\n        }\n        let c_spanX = 1;\n        let c_spanY = 0;\n        let a_spanX = 0;\n        let a_spanY = 0;\n        this.consequent.forEach((c, idx) => {   \n            const { spanX: sx, spanY: sy } = c.reflowPreCalculate(level + 1, sequence, callback);\n            c_spanX = Math.max(c_spanX, sx);\n            c_spanY += sy;\n            level += sy;\n        });\n        const nextSequeence = sequence + c_spanX;\n        level = this.level;\n        this.alternate.forEach((a, idx) => {\n            const { spanX: sx, spanY: sy } = a.reflowPreCalculate(level + 1, nextSequeence, callback);\n            a_spanX = Math.max(a_spanX, sx);\n            a_spanY += sy;\n            level += sy;\n        });\n        spanX = Math.max(1, c_spanX + a_spanX);\n        spanY += Math.max(c_spanY, a_spanY);\n        level = this.level + spanY - 1;\n        const { spanY: sy } = this.Endpoint.reflowPreCalculate(level + 1, sequence, callback);\n        spanY += sy;\n        this.spanX = spanX;\n        this.spanY = spanY;\n        return {\n            spanX, spanY, level, sequence\n        }\n    }\n\n    makeLink(callback) {\n        let lastc = this;\n        this.consequent.forEach(c => {\n            callback({\n                from: lastc.id,\n                to: c.id,\n                part: 'consequent',\n                fromDir: DIRECTION.BOTTOM,\n                toDir: DIRECTION.TOP,\n                meta: {\n                    from: lastc,\n                    to: c\n                }\n            });\n\n            c = c.makeLink(callback)\n            lastc = c;\n        })\n\n        callback({\n            from: lastc.id,\n            to: this.Endpoint.id,\n            fromDir: DIRECTION.BOTTOM,\n            toDir: DIRECTION.TOP,\n            part: 'consequent',\n            meta: {\n                from: lastc,\n                to: this.Endpoint\n            }\n        });\n\n        let lasta = this;\n        this.alternate.forEach(a => {\n            callback({\n                from: lasta.id,\n                to: a.id,\n                fromDir: lasta === this ? DIRECTION.RIGHT : DIRECTION.BOTTOM,\n                toDir: DIRECTION.TOP,\n                part: 'alternate',\n                meta: {\n                    from: lasta,\n                    to: a\n                }\n            })\n            a = a.makeLink(callback)\n            lasta = a;\n        });\n        callback({\n            from: lasta.id,\n            to: this.Endpoint.id,\n            fromDir: lasta === this ? DIRECTION.RIGHT : DIRECTION.BOTTOM,\n            toDir: DIRECTION.RIGHT,\n            part: 'alternate',\n            meta: {\n                from: lasta,\n                to: this.Endpoint\n            }\n        });\n\n        return this.Endpoint;\n    }\n\n    makeEndpoint() {\n        this.Endpoint = makeAST({\n            type: 'endpoint',\n            id: `${this.id}-endpoint`,\n        });\n        this.Endpoint.parent = this.parent;\n        this.Endpoint.idx = this.idx;\n        this.Endpoint.parentIterateType = this.parentIterateType;     \n    }\n\n    traverse(callback) {\n        callback(this);\n        this.consequent.forEach(n => {\n            n.traverse(callback);\n        });\n        this.alternate.forEach(n => {\n            n.traverse(callback);\n        });\n        callback(this.Endpoint);\n    }\n\n    linkSource(source, linkMeta) {\n        this.source[linkMeta.part].unshift(source);\n    }\n}\n\nclass SwitchStatement extends BaseNode {\n    constructor(source) {\n        super(source);\n        this.cases = (source.cases || []).map(mapFunc('case').bind(this))\n        if(this.cases.length) {\n            this.cases[this.cases.length - 1].lastCase = true;\n        }\n        this.isLocked = true;\n    }\n\n    reflowPreCalculate(level = 0, sequence = 0, callback) {\n        let spanX = 1;\n        let spanY = 1;\n        this.level = level;\n        this.sequence = sequence;\n        if(callback) {\n            callback(level, sequence, this);\n        }\n\n        let c_spanX = 1;\n        let c_spanY = 0;\n        if(this.cases.length) {\n            const consequent = this.cases[this.cases.length - 1].consequent;\n            level = this.level;\n            consequent.forEach(cc => {\n                const { spanX: sx, spanY: sy } = cc.reflowPreCalculate(level + 1, sequence, callback);\n                c_spanX = Math.max(c_spanX, sx);\n                c_spanY += sy;\n                level += sy;\n            });\n        }\n        \n        \n        let s_spanX = c_spanX;\n        let s_spanY = 0;\n        this.cases.forEach((c, idx) => {\n            const nextSequeence = sequence + s_spanX;\n            let a_spanX = 0;\n            let a_spanY = 0;\n            level = this.level;\n            c.alternate.forEach(ca => {\n                const { spanX: sx, spanY: sy } = ca.reflowPreCalculate(level + 1, nextSequeence, callback);\n                a_spanX = Math.max(a_spanX, sx);\n                a_spanY += sy;\n                level += sy;\n            });\n            s_spanX += a_spanX;\n            s_spanY = Math.max(s_spanY, a_spanY);\n        });\n       \n        \n        spanX = Math.max(1, s_spanX);\n        spanY = Math.max(c_spanY, s_spanY);\n        level = this.level + spanY;\n        const { spanY: sy } = this.Endpoint.reflowPreCalculate(level + 1, sequence, callback);\n        spanY += sy;\n        spanY += 1 // 要算上自己\n        this.spanX = spanX;\n        this.spanY = spanY;\n        return {\n            spanX, spanY, level, sequence\n        }       \n    }\n\n    makeLink(callback) {\n        let lastc = this;\n        if(this.cases.length) {\n            const consequent = this.cases[this.cases.length - 1].consequent;\n            consequent.forEach(c => {\n                callback({\n                    from: lastc.id,\n                    to: c.id,\n                    fromDir: DIRECTION.BOTTOM,\n                    toDir: DIRECTION.TOP,\n                    part: 'consequent',\n                    meta: {\n                        from: lastc,\n                        to: c\n                    }\n                });\n                lastc = c.makeLink(callback)\n            });\n        }\n        callback({\n            from: lastc.id,\n            to: this.Endpoint.id,\n            fromDir: DIRECTION.BOTTOM,\n            toDir: DIRECTION.TOP,\n            part: 'alternate',\n            meta: {\n                from: lastc,\n                to: this.Endpoint\n            }\n        });\n\n        this.cases.forEach(c => {\n            let lasta = c;\n            c.alternate.forEach(a => {\n                callback({\n                    from: lasta.id,\n                    to: a.id,\n                    fromDir: lasta === c ? DIRECTION.RIGHT : DIRECTION.BOTTOM,\n                    toDir: DIRECTION.TOP,\n                    part: 'alternate',\n                    meta: {\n                        from: lasta,\n                        to: a\n                    }\n                });\n                lasta = a.makeLink(callback)\n            })\n            \n            callback({\n                from: lasta.id,\n                to: this.Endpoint.id,\n                fromDir: lasta === c ? DIRECTION.RIGHT : DIRECTION.BOTTOM,\n                toDir: DIRECTION.RIGHT,\n                part: 'alternate',\n                meta: {\n                    from: lasta,\n                    to: this.Endpoint\n                }\n            });\n        });\n\n        return this.Endpoint;\n    }\n\n    makeEndpoint() {\n        this.Endpoint = makeAST({\n            type: 'endpoint',\n            id: `${this.id}-endpoint`,\n        });\n        this.Endpoint.parent = this.parent;\n        this.Endpoint.parentIterateType = this.parentIterateType;     \n        this.Endpoint.idx = this.idx;\n    }\n\n    traverse(callback) {\n        callback(this);\n        this.cases.forEach(n => {\n            n.traverse(callback);\n        });\n        callback(this.Endpoint);\n    }\n}\n\nclass ForEachStatement extends BaseNode {\n    \n}\n\nclass WhileStatement extends BaseNode {\n    constructor(source) {\n        super(source);\n        this.body = (source.body || []).map(mapFunc('body').bind(this));\n        console.log(this.body)\n        this.isLocked = true\n    }\n\n    reflowPreCalculate(level = 0, sequence = 0, callback) {\n        let spanX = 1;\n        let spanY = 1;\n        this.level = level;\n        this.sequence = sequence;\n        if(callback) {\n            callback(level, sequence, this);\n        }\n        const nextSequeence = sequence + 1;\n        // level--;\n        this.body.forEach((b) => {\n            const { spanX: sx, spanY: sy } = b.reflowPreCalculate(level + 1, nextSequeence, callback);\n            spanX = Math.max(sx, spanX);\n            spanY += sy;\n            level += sy;\n        });\n\n        this.spanX = spanX + 1;\n        this.spanY = spanY;\n        return {\n            spanX, spanY, level, sequence\n        }\n    }\n\n    makeLink(callback) {\n        let last = this;\n        // const lastIdx = this.body.length - 1;\n        this.body.forEach((b, idx) => {\n            callback({\n                from: last.id,\n                to: b.id,\n                part: 'body',\n                fromDir: last === this ? DIRECTION.RIGHT: DIRECTION.BOTTOM,\n                toDir: DIRECTION.TOP,\n                meta: {\n                    from: last,\n                    to: b\n                }\n            })\n            \n            b = b.makeLink(callback);\n            last = b;\n        });\n        console.log(last === this)\n        callback({\n            from: last.id,\n            to: this.id,\n            part: 'body',\n            fromDir: last === this ? DIRECTION.RIGHT : DIRECTION.BOTTOM,\n            anticlock: last === this,\n            toDir: DIRECTION.BOTTOM,\n            meta: {\n                from: last,\n                to: this\n            }\n        });\n        return this;\n    }\n\n    traverse(callback) {\n        callback(this);\n        this.body.forEach(n => {\n            n.traverse(callback);\n        });\n    }\n\n    linkSource(source, linkMeta) {\n        this.source[linkMeta.part].unshift(source);\n    }\n}\n\nclass SwitchCase extends BaseNode {\n    constructor(source) {\n        super(source);\n        this.consequent = (source.consequent || []).map(mapFunc('consequent').bind(this));\n        this.alternate = (source.alternate || []).map(mapFunc('alternate').bind(this));\n        this.lastCase = false;\n    }\n\n    reflowPreCalculate(level = 0, sequence = 0, callback) {\n        let spanX = 1;\n        let spanY = 1;\n        this.level = level;\n        this.sequence = sequence;\n        if(callback) {\n            callback(level, sequence, this);\n        }\n        \n        let c_spanX = 0;\n        let c_spanY = 0;\n        let a_spanX = 0;\n        let a_spanY = 0;\n        if(this.lastCase) {\n            this.consequent.forEach((c, idx) => {\n                const { spanX: sx, spanY: sy } = c.reflowPreCalculate(level + 1, sequence, callback);\n                c_spanX = Math.max(c_spanX, sx);\n                c_spanY += sy;\n                level += sy;\n            });\n        }\n        \n        const nextSequeence = sequence + Math.max(c_spanX, 1);\n        level = this.level;\n        this.alternate.forEach((a, idx) => {\n            const { spanX: sx, spanY: sy } = a.reflowPreCalculate(level + 1, nextSequeence, callback);\n            a_spanX = Math.max(a_spanX, sx);\n            a_spanY += sy;\n            level += sy;\n        });\n        spanX = Math.max(1, c_spanX + a_spanX);\n        spanY += Math.max(c_spanY, a_spanY);\n\n        this.spanX = spanX;\n        this.spanY = spanY;\n        return {\n            spanX, spanY, level, sequence\n        }       \n    }\n\n    traverse(callback) {\n        callback(this);\n        this.consequent.forEach(n => {\n            n.traverse(callback);\n        });\n        this.alternate.forEach(n => {\n            n.traverse(callback);\n        });\n    }\n\n    linkSource(source, linkMeta) {\n        this.source[linkMeta.part].unshift(source);\n    }\n}\n \nconst TYPE_MAPPING = {\n    IfStatement,\n    SwitchStatement,\n    SwitchCase,\n    ForEachStatement,\n    WhileStatement,\n    Root,\n    other: BaseNode,\n}\n\nfunction mapFunc(type)  {\n    return function(n, idx) {\n        const p = makeAST(n);\n        p.parent = this;\n        p.idx = idx;\n        p.parentIterateType = type;\n        p.makeEndpoint();\n        return p;\n    }\n}\nfunction makeAST(source) {\n    const type = source.type;\n    const Constructor = TYPE_MAPPING[type] || TYPE_MAPPING.other;\n    console.log(type)\n    const node = new Constructor(source);\n    return node;\n}\nexport { \n    makeAST,\n}\n\n","import JFlowEvent from '../events'; \nimport { DIRECTION } from '../utils/constance';\nimport { makeAST } from './low-code-types/baseNode';\n\nfunction sqr(x) {\n    return x * x;\n}\nfunction dist2(v, w) {\n    return sqr(v[0] - w[0]) + sqr(v[1] - w[1]);\n}\n\n/**\n    lowcode layout\n\n    type: \n        + IfStatement,\n        + SwitchStatement,\n        + SwitchCase,\n        + ForEachStatement,\n        + WhileStatement,\n        + Root,\n        + other,\n    \n    * @implements {Layout}\n */\nclass LowcodeLayout {\n    constructor(configs) {\n        this.linkLength = configs.linkLength || 18;\n        this.gap = configs.gap || 30;\n        this.reOrder(configs.ast);\n        this.static = true;\n    }\n    /**\n     * 从 ast 计算布局\n     * @param {AstNode} ast - ASL 树\n     */\n    reOrder(ast) {\n        this.ast = ast;\n        this.flowStack = [];\n        this.flowLinkStack = [];\n\n        this.root = makeAST(this.ast)// new AstNode(this.ast, this.flowStack, true);\n        this.root.traverse((node) => {\n            this.flowStack.push({\n                type: node.type,\n                configs: node.source,\n                layoutMeta: node,\n            });\n        });\n\n        const layoutMapping = {\n            vertical: {},\n            horizontal: {},\n        };\n        const playgroundLayoutMapping = {}\n        this.root.reflowBodyPreCalculate(0, 0, (level, sequence, node) => {\n            if(!node.isroot) {\n                if(!layoutMapping.vertical[level]){\n                    layoutMapping.vertical[level] = {};\n                }\n                layoutMapping.vertical[level][sequence] = node;\n                \n                if(!layoutMapping.horizontal[sequence]){\n                    layoutMapping.horizontal[sequence] = {};\n                }\n                layoutMapping.horizontal[sequence][level] = node;\n            }\n        });\n\n        let currentTopNodeId;\n        this.root.reflowPlaygroundPreCalculate(\n            (topNode) => {\n                currentTopNodeId = topNode.id;\n                playgroundLayoutMapping[topNode.id] = {\n                    vertical: {},\n                    horizontal: {},\n                    node: topNode,\n                }\n            },\n            (level, sequence, node) => {\n                const layoutMapping = playgroundLayoutMapping[currentTopNodeId];\n                if(!layoutMapping.vertical[level]){\n                    layoutMapping.vertical[level] = {};\n                }\n                layoutMapping.vertical[level][sequence] = node;\n                \n                if(!layoutMapping.horizontal[sequence]){\n                    layoutMapping.horizontal[sequence] = {};\n                }\n                layoutMapping.horizontal[sequence][level] = node;\n            })\n\n        this.layoutMapping = layoutMapping;\n        this.playgroundLayoutMapping = playgroundLayoutMapping;\n        this.root.makeLink((configs) => {\n            this.flowLinkStack.push(configs)\n        })\n    }\n\n    staticCheck(instance, jflow) {\n\n        if(instance._layoutNode && instance._layoutNode.isFree) {\n            return false;\n        }\n        const finded = jflow._linkStack.find(l => l.from === instance || l.to === instance);\n        if(!finded) {\n            return false;\n        }\n        const nowAnchor = instance.anchor.slice();\n        jflow.reflow();\n        if(jflow._linkStack.length < 2) return;\n        const currentAnchor = instance.anchor;\n        const d = dist2(nowAnchor, currentAnchor);\n        if(d > 1000) {\n            console.log(instance)\n            instance.dispatchEvent(new JFlowEvent('outOfFlow', {\n                anchor: nowAnchor,\n                instance,\n                jflow,\n                point: nowAnchor,\n            }))\n            return true;\n        }\n        return false;\n    }\n\n    reflowByMapping(layoutMapping, x = 0, y = 0) {\n        const linkLength = this.linkLength;\n        const gap = this.gap;\n        const {\n            vertical: verticalMapping,\n            horizontal: horizontalMapping,\n        } = layoutMapping;\n\n        let reduceWidth = x;\n        Object.keys(horizontalMapping).forEach((columnNumber, idx) => {\n            const column = horizontalMapping[columnNumber];\n            let rowWidth = 0;\n            const rows = Object.keys(column)\n            rows.forEach(rowNumber => {\n                const ast = column[rowNumber];\n                const instance = ast.getJflowInstance();\n                const { width } = instance.getBoundingDimension();\n                rowWidth = Math.max(width, rowWidth);\n            });\n            reduceWidth += idx === 0 ? 0: rowWidth/2\n            rows.forEach(rowNumber => {\n                const ast = column[rowNumber];\n                const instance = ast.getJflowInstance();\n                instance.anchor[0] = reduceWidth;\n            });\n            reduceWidth += (rowWidth/2 + gap) ;\n        });\n\n        let reduceHeight = y;\n        // console.log(verticalMapping)\n        Object.keys(verticalMapping).forEach((rowNumber, idx) => {\n            const row = verticalMapping[rowNumber];\n            let rowHeight = 0;\n            const columns = Object.keys(row)\n            columns.forEach(columnNumber => {\n                const ast = row[columnNumber];\n                const instance = ast.getJflowInstance();\n                const { height, width } = instance.getBoundingDimension();\n                rowHeight = Math.max(height, rowHeight);\n            });\n            reduceHeight += idx === 0 ? 0 : rowHeight/2;\n            columns.forEach(columnNumber => {\n                const ast = row[columnNumber];\n                const instance = ast.getJflowInstance();\n                instance.anchor[1] = reduceHeight;\n            });\n            reduceHeight += (rowHeight/2 + linkLength) ;\n        });\n        \n    }\n\n    findLayoutNode(configs) {\n        const finded = this.flowStack.find(node => node.configs === configs);\n        if(finded) {\n            return finded.layoutMeta;\n        }\n        return null;\n    }\n\n    reflow(jflow){\n        this.reflowByMapping(this.layoutMapping);\n        Object.values(this.playgroundLayoutMapping).forEach(mapping => {\n            const node = mapping.node.getJflowInstance();\n            this.reflowByMapping(mapping, node.anchor[0], node.anchor[1]);\n        })\n    }\n}\n\nexport default LowcodeLayout;","import { createCanvas } from '../utils/canvas';\nimport { bounding_box } from '../utils/functions';\nimport StackMixin from '../instance/stackMixin';\nimport InstanceStack from '../instance/stack';\nimport LayoutMixin from '../instance/layoutMixin';\nimport MessageMixin from '../instance/messageMixin';\nimport { setUniqueId, getUniqueId } from '../utils/functions';\nimport Point from '../instance/point';\nimport JFlowEvent from '../events';\n/**\n * @typedef JflowConfigs\n * @type {object}\n * @property {Boolean} allowDrop      - 是否允许 dragdrop\n * @property {Object} layout          - 布局对象\n */\n\n/** \n * JFlow 对象\n * JFlow 是 canvas 上面封装的一个顶层对象，具有处理事件和绘制的功能\n * @mixes LayoutMixin\n * @mixes StackMixin\n * @mixes MessageMixin\n */\nclass JFlow extends EventTarget{\n    /**\n     * 创建一个JFlow对象\n     * @param {JflowConfigs} configs - 配置项\n     */\n    constructor(configs) {\n        super();\n        this.uniqueName = 'jflow';\n        this.initStack(configs);\n        this.initLayout(configs);\n        /**\n         * @property {Context2d} ctx        - Context2d 对象\n         * @property {Element} canvas       - canvas 元素\n         * @property {number} dpr           - 设备DPR\n         * @property {number} padding       - 内边距\n         */\n        // TODO 引入 plugin 拓展\n        this.plugins = [];\n        this.ctx = null;\n        this.canvas = null;\n        this.dpr = 1;\n        this.padding = 20;\n        /**\n         * for zoom and pinch\n         * @property {Context2d} position       - 平移位置\n         * @property {Element} scale            - 当前缩放比\n         * @property {number} maxZoom           - 最大缩放比\n         * @property {number} minZoom           - 最小缩放比\n         */\n        this.position = null;\n\t\tthis.scale = null;\n        this.maxZoom = 3;\n        this.minZoom = .5\n\t\t// this.initScale = 1;\n\t\t// this.initPosition = null\n\t\tthis.offeset = null;\n        this._lastState = {\n            x: null,\n            y: null,\n            dragging: false,\n            processing: false\n        };\n        this._lastDragState = {\n            target: null,\n            targetLink: null,\n            processing: false,\n        }\n\n        this._target = {\n            instance: null,\n            link: null,\n            moving: null,\n            isInstanceDirty: false, \n            isLinkDirty: false, \n            // isMovingDirty: false, \n            cache: {\n                stack: null,\n                belongs: null,\n                point: null,\n            },\n            meta: {\n                x: undefined,\n                y: undefined,\n                initialX: undefined,\n                initialY: undefined, \n            },\n            status: {\n                dragovering: false,\n                dragging: false,\n                processing: false,\n            }\n        }\n\n        this._lastFocus = {\n            instance: null,\n            processing: false,\n        }\n\n        this.allowDrop = configs.allowDrop;\n    }\n\n    use(plugin) {\n        this.plugins.push(plugin)\n    }\n    /**\n     * 在 Document 元素上初始化实例\n     * @param {Element} dom \n     */\n    $mount(dom) {\n        const { \n            canvas, \n            ctx, \n            scale: dpr, \n            width: c_width, \n            height: c_height, \n            raw_width,\n            raw_height,\n            left, top \n        } = createCanvas(dom);\n        this.reflow();\n        this.ctx = ctx;\n        this.DOMwrapper = dom;\n        this.canvas = canvas;\n        this.canvasMeta = {\n            width: raw_width,\n            height: raw_height,\n            actual_width: c_width,\n            actual_height: c_height\n        }\n        this.dpr = dpr;\n        this._createEventHandler();\n        this._getBoundingGroupRect();\n\n        const padding = this.padding;\n        const { width: p_width, height: p_height, x, y } = this.bounding_box;\n        const contentBox = {\n            x: padding,\n            y: padding,\n            width: c_width - padding * 2,\n            height: c_height - padding * 2,\n        }\n        const position = { x: 0, y: 0, offsetX: 0, offsetY: 0 };\n        const w_ratio = contentBox.width / p_width;\n        const h_ratio = contentBox.height / p_height;\n        const align = w_ratio <= h_ratio ? 'x' : 'y';\n        const scaleRatio = Math.min(w_ratio, h_ratio);\n        this.scale = scaleRatio;\n        if(scaleRatio > this.maxZoom) {\n            this.maxZoom = scaleRatio;\n        }\n        if(scaleRatio < this.minZoom) {\n            this.minZoom = scaleRatio;\n        }\n        // this.initScale = scaleRatio;\n        position.x = align === 'x' ? contentBox.x : (contentBox.width - p_width * scaleRatio) / 2 + padding\n        position.y = align === 'y' ? contentBox.y : (contentBox.height - p_height * scaleRatio) / 2 + padding\n        position.offsetX = position.x - x * scaleRatio;\n        position.offsetY = position.y - y * scaleRatio;\n        this.position = position;\n        this._render();\n    }\n    // _resetPosition() {\n    //     const padding = this.padding;\n    //     const {\n    //         c_width,\n    //         c_height,\n    //     } =  this.canvasMeta;\n    //     const { width: p_width, height: p_height, x, y } = this.bounding_box;\n    //     console.log(this.bounding_box)\n    //     const contentBox = {\n    //         x: padding,\n    //         y: padding,\n    //         width: c_width - padding * 2,\n    //         height: c_height - padding * 2,\n    //     }\n    //     const position = { x: 0, y: 0, offsetX: 0, offsetY: 0 };\n    //     const w_ratio = contentBox.width / p_width;\n    //     const h_ratio = contentBox.height / p_height;\n    //     const align = w_ratio <= h_ratio ? 'x' : 'y';\n    //     const scaleRatio = Math.min(w_ratio, h_ratio);\n    //     this.scale = scaleRatio;\n    //     if(scaleRatio > this.maxZoom) {\n    //         this.maxZoom = scaleRatio;\n    //     }\n    //     if(scaleRatio < this.minZoom) {\n    //         this.minZoom = scaleRatio;\n    //     }\n    //     // this.initScale = scaleRatio;\n    //     position.x = align === 'x' ? contentBox.x : (contentBox.width - p_width * scaleRatio) / 2 + padding\n    //     position.y = align === 'y' ? contentBox.y : (contentBox.height - p_height * scaleRatio) / 2 + padding\n    //     position.offsetX = position.x - x * scaleRatio;\n    //     position.offsetY = position.y - y * scaleRatio;\n    //     this.position = position;\n    // }\n    \n    _getBoundingGroupRect() {\n        const points = this._stack.getBoundingRectPoints();\n        if(this.bounding_box) {\n            this.bounding_box = bounding_box(points);\n            const {\n                x: nowx,\n                y: nowy,\n            } = this.bounding_box;\n            const scale = this.scale;\n            this.position.x = this.position.offsetX + nowx * scale;\n            this.position.y = this.position.offsetY + nowy * scale;\n        } else {\n            this.bounding_box = bounding_box(points);\n        }\n    }\n\n    /**\n     * 设置当前聚焦元素\n     * @param {Instance} instance \n     */\n    $setFocus(instance) {\n        if(this._lastFocus.processing) return;\n        this._lastFocus.processing = true;\n        if(this._lastFocus.instance){\n            this._lastFocus.instance.status.focus = false;\n        }\n        \n        this._lastFocus.instance = instance;\n        if(instance) {\n            instance.status.focus = true;\n            instance.bubbleEvent(new JFlowEvent('focus'))\n        }\n\n        requestAnimationFrame(() => {\n            this._render();\n            this._lastFocus.processing = false;\n        })\n\n    }\n\n    _createEventHandler() { \n        const canvas = this.canvas;\n        const zoomHandler = this._onZoom.bind(this);\n        const pressStartHandler = this._onPressStart.bind(this);\n        const pressMoveHandler = this._onPressMove.bind(this);\n        const pressUpHandler = this._onPressUp.bind(this);\n        const pressUpDocument = this._onPressUpDocument.bind(this);\n        const contextmenuHandler = this._onContextMenu.bind(this);\n        canvas.addEventListener('wheel', zoomHandler );\n        canvas.addEventListener('contextmenu', e => {\n            e.preventDefault();\n        });\n        canvas.addEventListener('pointerdown', pressStartHandler );\n        canvas.addEventListener('pointermove', pressMoveHandler );\n        canvas.addEventListener('pointerup', pressUpHandler );\n        canvas.addEventListener('contextmenu', contextmenuHandler)\n        document.addEventListener('pointerup', pressUpDocument);\n        let destroyListener;\n        const destroyPlainEventListener = () => {\n            canvas.removeEventListener('wheel', zoomHandler );\n            canvas.removeEventListener('pointerdown', pressStartHandler );\n            canvas.removeEventListener('pointermove', pressMoveHandler );\n            canvas.removeEventListener('pointerup', pressUpHandler );\n            document.removeEventListener('pointerup', pressUpDocument);\n        }\n        destroyListener = destroyPlainEventListener;\n\n        if(this.allowDrop) {\n            const dragoverHandler = this._onDragover.bind(this);\n            const dropHandler = this._onDrop.bind(this);\n            canvas.addEventListener('dragover', dragoverHandler);\n            canvas.addEventListener('drop', dropHandler);\n            destroyListener = () => {\n                destroyPlainEventListener();\n                canvas.removeEventListener('dragover', dragoverHandler);\n                canvas.removeEventListener('drop', dropHandler);\n            }\n        } \n        this.destroy = destroyListener;\n    }\n\n    _targetLockOn(offsetPoint, event) {\n        let point = this._calculatePointBack(offsetPoint);\n        this._currentp = point;\n        let stack = this._stack;\n        const target = stack.checkHit(point, (instance) => {\n            return this._target.status.dragging && (instance === this._getMovingTarget())\n        });\n        let linkStack = this._linkStack;\n        let belongs = this;\n        if(target) {\n            linkStack = target._belongs._linkStack;\n            point = target._belongs._currentp;\n            stack = target._belongs._stack;\n            belongs = target._belongs\n        }\n        const targetLink = linkStack.checkHit(point);\n\n        Object.assign(this._target, {\n            instance: target,\n            link: targetLink, \n            isInstanceDirty: target === this._target.instance,\n            isLinkDirty: targetLink === this._target.link,\n        });\n        Object.assign(this._target.cache, {\n            stack,\n            belongs,\n            point,\n        })\n        Object.assign(this._target.meta, {\n            x: offsetPoint[0],\n            y: offsetPoint[1],\n        });\n\n        if(event === 'pressStart' && !this._target.status.dragging && !this._target.status.dragovering) {\n            let movingtarget = target;\n            while (movingtarget && movingtarget._belongs.lock && movingtarget !== this) {\n                movingtarget = movingtarget._belongs;\n            }\n            if(movingtarget === this) {\n                movingtarget = target;\n            }\n            if(movingtarget) {\n                if(movingtarget._layoutNode && movingtarget._layoutNode.isLocked) {\n                    movingtarget = movingtarget._layoutNode.getNodes()\n                } else {\n                    movingtarget = [movingtarget];\n                }\n            } \n            Object.assign(this._target, {\n                moving: movingtarget,\n                // isMovingDirty: movingtarget[0] === this._target.moving[0],\n            })\n        }\n        return this._target;\n    }\n\n    _getMovingTarget() {\n        return this._target.moving && this._target.moving[0];\n    }\n\n    _onDragover(event) {\n        event.preventDefault();\n        if(this._lastDragState.processing) return;\n        this._lastDragState.processing = true;\n        const { offsetX, offsetY } = event\n        Object.assign(this._target.status, {\n            dragovering: true,\n        })\n        this._targetLockOn([offsetX, offsetY])\n        \n        if(this._target.isLinkDirty || this._target.isInstanceDirty) {\n            requestAnimationFrame(() => {\n                this._render();    \n                this._target.isLinkDirty = false; \n                this._target.isInstanceDirty = false;\n                this._lastDragState.processing = false;\n            })\n        } else {\n            this._lastDragState.processing = false;\n        } \n    }\n\n    _onDrop(event) {\n        const { offsetX, offsetY, clientX, clientY } = event\n        const payload = this.consumeMessage();\n        const instance = payload.instance;\n\n        const {\n            link,\n            instance: target,\n        } = this._target;\n        const {\n            point, belongs\n        } = this._target.cache;\n        if(link) {   \n            /**\n            * 丢在线上事件\n            *\n            * @event BaseLink#drop\n            * @type {object}\n            * @property {Event} event           - 原始事件 \n            * @property {Object} instance     - 拖动的对象 \n            * @property {BaseLink} link         - 目标连线 \n            * @property {JFlow} jflow           - 当前JFlow对象 \n            * @property {Group|JFlow} belongs   - 连线所在的绘图栈的对象\n            * @property {number[]} point        - 已经计算到绘图栈对应坐标系下的坐标\n            */\n            instance.anchor = point;\n            link.dispatchEvent(new JFlowEvent('drop', {\n                event,\n                instance,\n                link,\n                jflow: this,\n                belongs,\n                point\n            }))\n            // belongs.addInstanceToLink(link, instance)\n        } else if(target) {\n            /**\n            * 丢在节点上事件\n            *\n            * @event Node#drop\n            * @type {object}\n            * @property {Event} event           - 原始事件 \n            * @property {Object} instance       - 拖动的对象 \n            * @property {JFlow} jflow           - 当前JFlow对象 \n            * @property {Node} target           - 目标节点\n            * @property {number[]} point        - 已经计算到绘图栈对应坐标系下的坐标\n            */\n            target.bubbleEvent(new JFlowEvent('drop', {\n                event,\n                instance,\n                jflow: this,\n                target,\n                point\n            }))\n        } else {\n            // 丢在主图上\n            // instance.anchor = point;\n            // this.addToStack(instance);\n            /**\n            * 丢在主图上事件\n            *\n            * @event JFlow#drop\n            * @type {object}\n            * @property {Event} event           - 原始事件 \n            * @property {Object} instance       - 拖动的对象 \n            * @property {JFlow} jflow           - 当前JFlow对象 \n            * @property {number[]} point        - 已经计算到绘图栈对应坐标系下的坐标\n            */\n            this.dispatchEvent(new JFlowEvent('drop', {\n                event,\n                instance,\n                jflow: this,\n                target,\n                point,\n                // reflowCallback: (jflowinstance) => {\n                //     instance.anchor = point;\n                //     this.recalculate();\n                //     this.reflow();\n                // }\n            }))\n        }\n        \n        requestAnimationFrame(() => {\n            // this.recalculate();\n            this._target.instance = null;\n            this._target.link = null;\n            Object.assign(this._target.status, {\n               dragovering: false,\n            })\n            // this._render();\n        })\n    }\n\n    _onZoom(event) {\n        event.preventDefault();\n        if(this._zooming) return;\n        this._zooming = true;\n        const { offsetX, offsetY, deltaY } = event\n        const { width: p_width, height: p_height, x, y } = this.bounding_box;\n        let newScale = this.scale;\n        const amount = deltaY > 0 ? 1.1 : 1 / 1.1;\n        newScale *= amount;\n\n        if (this.maxZoom && newScale > this.maxZoom){\n            // could just return but then won't stop exactly at maxZoom\n            newScale = this.maxZoom;\n        }\n\n        if(this.minZoom && newScale < this.minZoom) {\n            newScale = this.minZoom;\n        }\n\n        var deltaScale    = newScale - this.scale;\n        var currentWidth  = p_width * this.scale;\n        var currentHeight = p_height * this.scale;\n        var deltaWidth    = p_width * deltaScale;\n        var deltaHeight   = p_height * deltaScale;\n\n        var tX = offsetX - this.position.x;\n        var tY = offsetY - this.position.y;\n        var pX = -tX / currentWidth;\n        var pY = -tY / currentHeight;\n\n        this.scale = newScale;\n        this.position.x += pX * deltaWidth;\n\t\tthis.position.y += pY * deltaHeight;\n        this.position.offsetX = this.position.x - x * newScale;\n        this.position.offsetY = this.position.y - y * newScale;\n        requestAnimationFrame(() => {\n            this._render();\n            this._zooming = false;\n        })\n    }\n\n    _onPressStart(event) { \n        console.log('pressStart', event )\n        const { offsetX, offsetY, deltaY, button } = event\n        if(button !== 0) return;\n        this._targetLockOn([offsetX, offsetY], 'pressStart');\n        Object.assign(this._target.meta, {\n            initialX: offsetX,\n            initialY: offsetY,\n        })\n        Object.assign(this._target.status, {\n            dragging: true,\n            processing: false,\n        });\n        if(this._target.moving) {\n            const moving = this._getMovingTarget();\n            /**\n             * 开始拖动对象事件\n             *\n             * @event Instance#pressStart\n             * @type {object}\n             * @property {Event} event           - 原始事件 \n             * @property {Instance} instance       - 拖动的对象 \n             * @property {JFlow} jflow           - 当前JFlow对象 \n             */\n            moving.dispatchEvent(new JFlowEvent('pressStart', {\n                event,\n                instance: moving,\n                jflow: this,\n            }))\n        }\n    }\n\n    _onPressMove(event) {\n        // console.log('_onPressMove')\n        const {\n            dragging, processing\n        } = this._target.status;\n        const { x, y } = this._target.meta;\n\n        const { offsetX, offsetY, clientX, clientY } = event\n        if(!dragging && !processing) {\n            const {\n                link,\n                instance\n            } = this._targetLockOn([offsetX, offsetY]);\n            if(instance || link) {\n                this.canvas.style.cursor = 'move';\n            } else {\n                this.canvas.style.cursor = 'default';\n            }\n        }\n        if(!dragging) return;\n        if(processing) return;\n        \n        const movingtarget = this._target.moving;\n\n        this._target.status.processing = true;\n        const deltaX = offsetX - x;\n        const deltaY = offsetY - y;\n\n        if(movingtarget) {\n            movingtarget.forEach(t => {\n                t.anchor[0] += deltaX / this.scale;\n                t.anchor[1] += deltaY / this.scale;\n            })\n        } else {\n            this._recalculatePosition(deltaX, deltaY);    \n        }\n        this._targetLockOn([offsetX, offsetY])\n\n        // this._target.meta.x = offsetX;\n        // this._target.meta.y = offsetY;\n        \n        requestAnimationFrame(() => {\n            this._render();\n            this._target.isLinkDirty = false; \n            this._target.isInstanceDirty = false;\n            this._target.status.processing = false;\n        })\n        \n    }\n\n    _onPressUp(event, isDocument) {\n        event.preventDefault();\n        event.stopPropagation();\n        const { button } = event\n        if(button !== 0) return;\n        const meta = this._target.meta;\n        // if(meta.initialX === undefined && isDocument) {\n        //     this.dispatchEvent(new JFlowEvent('click', {\n        //         event,\n        //         jflow: this,\n        //     }));\n        //     return;\n        // }\n        if(meta.initialX === meta.x\n            && meta.initialY === meta.y) {\n                if(this._target.instance && !isDocument) {\n                    const t = this._target.instance;\n                    /**\n                    * 点击事件\n                    *\n                    * @event Node#click\n                    * @type {object}\n                    * @property {Event} event          - 原始事件 \n                    * @property {Instance} target      - 点击的对象 \n                    * @property {JFlow} jflow          - 当前JFlow对象 \n                    * @property {Boolean} bubbles      - 冒泡\n                    */\n                    t.bubbleEvent(new JFlowEvent('click', {\n                        event,\n                        target: t,\n                        jflow: this,\n                        bubbles: true,\n                    }))\n                    this._clearTarget();\n                    this._render();\n                    return;\n                } else {\n                    this.dispatchEvent(new JFlowEvent('click', {\n                        event,\n                        jflow: this,\n                    }));\n                    this._clearTarget();\n                    this._render();\n                    return\n                }\n            \n        } else if(this._target.moving) {\n            let checkresult = false;\n            if(this._layout.static) {\n                checkresult = this.staticCheck(this._getMovingTarget());\n            }\n\n            if(!checkresult && this._target.link) {\n                const {\n                    point, belongs\n                } = this._target.cache;\n                const link = this._target.link;\n                const instance = this._getMovingTarget();\n                // instance.anchor = point;\n                // belongs.addInstanceToLink(this._target.link, instance);\n                // belongs.dispatchEvent(new JFlowEvent('drop', {\n                //     event,\n                //     instance,\n                //     link: ,\n                //     jflow: this,\n                //     target,\n                // }))\n                /**\n                 * 拖动到线上事件\n                 *\n                 * @event BaseLink#drop\n                 * @type {object}\n                 * @property {Event} event           - 原始事件 \n                 * @property {Object} instance     - 拖动的对象 \n                 * @property {BaseLink} link         - 目标连线 \n                 * @property {JFlow} jflow           - 当前JFlow对象 \n                 * @property {Group|JFlow} belongs   - 连线所在的绘图栈的对象\n                 */\n                link.dispatchEvent(new JFlowEvent('drop', {\n                    event,\n                    instance,\n                    link,\n                    jflow: this,\n                    belongs,\n                    // reflowCallback: () => {\n                    //     debugger\n                    //     belongs.recalculate();\n                    //     belongs.reflow();\n                    //     this._render();\n                    // }\n                }));\n                this._target.link = null;\n                this._target.instance = null;\n                // link.dispatchEvent(new JFlowEvent('dragover', {\n                //     event,\n                //     instance,\n                //     link,\n                //     jflow: this,\n                //     belongs,\n                // }))\n                // this.recalculate();\n            }\n            if(this._target.moving) {\n                if(this._target.instance) {\n                    /**\n                     * 拖动后放置到 Instance 上的事件\n                     *\n                     * @event Instance#pressEnd\n                     * @type {object}\n                     * @property {Event} event           - 原始事件 \n                     * @property {Instance} instance     - 拖动的对象 \n                     * @property {JFlow} jflow           - 当前JFlow对象 \n                     * @property {Instance} target       - 拖动到的对象\n                     * @property {boolean} bubbles       - 冒泡\n                     */\n                    this._target.instance.bubbleEvent(new JFlowEvent('pressEnd', {\n                        event,\n                        instance: this._getMovingTarget(),\n                        jflow: this,\n                        target: this._target.instance,\n                        bubbles: true\n                    }));\n                } else {\n                    /**\n                     * 拖动后放置到主图上的事件\n                     *\n                     * @event JFlow#pressEnd\n                     * @type {object}\n                     * @property {Event} event           - 原始事件 \n                     * @property {Instance} instance       - 拖动的对象 \n                     * @property {JFlow} jflow           - 当前JFlow对象 \n                     */\n                    this.dispatchEvent(new JFlowEvent('pressEnd', {\n                        event,\n                        instance: this._getMovingTarget(),\n                        jflow: this,\n                    }))\n                }\n            }\n            this._target.moving = null;\n            // this._target.isMovingDirty = false;\n            this._render();\n        }\n        this._clearTarget();\n    }\n\n    _clearTarget(){\n        Object.assign(this._target.meta, {\n            x: undefined,\n            y: undefined,\n            initialX: undefined,\n            initialY: undefined, \n        })\n        Object.assign(this._target.status, {\n            dragging: false,\n            processing: false,\n        });\n        Object.assign(this._target, {\n            instance: null,\n            link: null,\n            moving: null,\n        });\n    }\n\n    _onPressUpDocument(event) {\n        this._onPressUp(event, true);\n    }\n\n    _onClick(event) {\n        const { offsetX, offsetY } = event;\n        const point = this._calculatePointBack([offsetX, offsetY]);\n        const target = this._stack.checkHit(point);\n    }\n\n    _onContextMenu(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        const { offsetX, offsetY } = event;\n        const {\n            link,\n            instance\n        } = this._targetLockOn([offsetX, offsetY]);\n        if(instance || link) {\n            const target = (instance || link);\n            target.bubbleEvent(new JFlowEvent('contextclick', {\n                event,\n                jflow: this,\n                target,\n                bubbles: true\n            }));\n        }\n    }\n\n    _recalculatePosition(deltaX, deltaY, scale) {\n        const { x, y } = this.bounding_box;\n        if(scale === undefined) {\n            scale = this.scale;\n        }\n        this.position.x += deltaX;\n\t\tthis.position.y += deltaY;\n        this.position.offsetX = this.position.x - x * scale;\n        this.position.offsetY = this.position.y - y * scale;\n    }\n\n    calculateToRealWorld(p) {\n        const scale = this.scale;\n        const position = this.position;\n        return [p[0] * scale + position.offsetX, p[1] * scale + position.offsetY]\n    }\n\n    _calculatePointBack(p) {\n        const scale = this.scale;\n        const position = this.position;\n        return [(p[0] - position.offsetX)/scale, (p[1] - position.offsetY) / scale];\n    }\n\n    _calculateDistance(l) {\n        const scale = this.scale;\n        return scale * l;\n    }\n\n    _resetTransform() {\n        const { width: c_width, height: c_height } = this.canvasMeta;\n        const position = this.position;\n        const scale = this.scale;\n        const ctx = this.ctx;\n        ctx.setTransform();\n        ctx.clearRect(0, 0, c_width, c_height);\n        ctx.scale(this.dpr, this.dpr);\n        ctx.transform(scale, 0, 0, scale, position.offsetX, position.offsetY);\n    }\n     /**\n     * 绘制画布\n     */\n    _render() {\n        this._resetTransform();\n        // this._stack.forEach(instance => {\n        //     instance._intersections = [];\n        // });\n        let linkStack = this._linkStack;\n        // if(this._layout.alignLinkOrder) {\n        //     const p = new InstanceStack();\n        //     this._layout.alignLinkOrder(linkStack, p);\n        //     linkStack = p;\n        // }\n        linkStack.render(this.ctx);\n        this._stack.render(this.ctx);\n        \n    }\n}\nObject.assign(JFlow.prototype, MessageMixin);\nObject.assign(JFlow.prototype, StackMixin);\nObject.assign(JFlow.prototype, LayoutMixin);\n\nexport default JFlow;\nexport { default as JFlowEvent } from '../events';\nexport { default as Point } from '../instance/point';\nexport { default as Rectangle } from '../instance/rectangle';\nexport { default as Group } from '../instance/group';\nexport { default as Text } from '../instance/text';\nexport { default as Icon } from '../instance/image';\nexport { default as Link } from '../instance/link';\nexport { default as PolylineLink } from '../instance/polyline-link';\nexport { default as BezierLink } from '../instance/bezier-link';\nexport { default as LinearLayout} from '../layout/linear-layout';\n// export { default as TreeLayout } from '../layout/tree-layout';\nexport { default as Lowcodelayout } from '../layout/low-code-layout';","export default {\n    provide(){\n        return {\n            addToStack: this.addToStack,\n            addToLinkStack: this.addToLinkStack,\n            removeFromStack: this.removeFromStack,\n            removeFromLinkStack: this.removeFromLinkStack,\n            getInstanceByName: this.getInstanceByName,\n        }\n    },\n    data() {\n        return {\n            stack: [], // 主要是为了连线\n        }\n    },\n    methods: {\n        getInstanceByName(name) {\n            const obj = this.stack.find(i => i.name === name);\n            if(obj) {\n                return obj.instance;\n            }\n            return null;\n        },\n        addToStack(instance, name) {\n            this._jflowInstance.addToStack(instance);\n            this.stack.push({\n                name,\n                instance,\n            });\n            // this.$nextTick(this.onStackChangeHandler)\n        },\n        addToLinkStack(link) {\n            this._jflowInstance.addToLinkStack(link);\n            // this.$nextTick(this.onStackChangeHandler)\n        },\n        removeFromStack(instance) {\n            this._jflowInstance.removeFromStack(instance);\n            // this.$nextTick(this.onStackChangeHandler)\n        },\n        removeFromLinkStack(link) {\n            this._jflowInstance.removeFromLinkStack(link);\n            // this.$nextTick(this.onStackChangeHandler)\n        },\n        onStackChangeHandler() {\n            this._jflowInstance.recalculate();\n            this._jflowInstance.reflow();\n            // this.$nextTick(this.renderJFlow)\n        }\n    }\n}","import JFlow from '../../core/flow';\nimport StackMixin from '../components/StackMixin';\n/**\n * JFlow {@link JFlow} 的 vue 封装 \n * @vue-prop {JflowConfigs} configs - 传给 JFlow 的配置\n * @vue-event {drop} dropEvent - 同 JFlow 上的 {@link JFlow#event:drop} 事件\n * @vue-event {pressEnd} pressEndEvent- 同 JFlow 上的 {@link JFlow#event:pressEnd} 事件\n */\nexport default {\n    mixins: [StackMixin],\n    provide(){\n        return {\n            renderJFlow: this.renderJFlow,\n            addNameToRootStack: this.addNameToRootStack\n        }\n    },\n    props: {\n        configs: {\n            type: Object,\n            default: function () {\n                return {};\n            },\n        },\n    },\n    data() {\n        return {\n            nodes: [],\n            links: [],\n        }\n    },\n    render: function (createElement) {\n        if(!this.nodes.length) {\n            return createElement('div', this.$slots.default);\n        } else {\n            const vnodes = this.nodes.map(({ type, configs, meta }) => {\n                if(!this.$scopedSlots[type]) {\n                    return\n                }\n                const [vnode] = this.$scopedSlots[type]({ configs, meta });\n                meta.getJflowInstance = function() {\n                    // 只支持一个元素\n                    let instance = vnode.componentInstance;\n                    while(instance && !instance._jflowInstance)  {\n                        instance = instance.$children[0];\n                    }\n                    // TODO 优化下这里的逻辑\n                    instance._jflowInstance._layoutNode = meta;\n                    return instance._jflowInstance;\n                }\n                vnode.key = configs.id;\n                return vnode;\n            });\n            const vlinks = this.links.map(meta => {\n                let type = meta.type || 'plainlink'\n                if(!this.$scopedSlots[type]) {\n                    return null;\n                }\n                const [vnode] = this.$scopedSlots[type]({ configs: meta });\n                vnode.key = `${meta.from}-${meta.to}-${meta.part}`\n                return vnode\n            })\n\n            return createElement('div', [...vnodes, ...vlinks]);\n        }\n        \n    },\n    created() {\n        this._jflowInstance = new JFlow(this.configs);\n    },\n    mounted() {\n        console.log(this);\n        // this._jflowInstance = new JFlow(this.configs);\n        this.nodes = this._jflowInstance._layout.flowStack.map(meta => {\n            return {\n                type: meta.type,\n                configs: meta.configs,\n                meta: meta.layoutMeta,\n            }\n        });\n        \n        this.links = this._jflowInstance._layout.flowLinkStack.slice();\n        this.$nextTick(() => {\n            this._jflowInstance.$mount(this.$el);\n            // this._jflowInstance.addEventListener('drop', (e) => {\n            //     const astblock = e.detail.instance;\n            //     const node = {\n            //         type: astblock.type,\n            //         configs: astblock,\n            //         meta: {},\n            //     };\n            //     this.nodes.push(node);\n            //     this.$nextTick(() => {\n            //         node.meta.getJflowInstance().anchor = e.detail.point\n            //         this.renderJFlow();\n            //     })\n            // })\n        });\n        Object.keys(this.$listeners).map(event => {\n            console.log(event)\n            const func = this.$listeners[event].bind(this);\n            this._jflowInstance.addEventListener(event, func);\n        })\n    },\n    \n    methods: {\n        /**\n         * 绘制之前，vnode渲染之后\n         * @name preCallback\n         * @function\n         */\n        /**\n         * 重排\n         * @param {preCallback} preCallback - JFlow 绘制之前，vnode渲染之后\n         */\n        reflow(preCallback) {\n            const layoutNodes = this._jflowInstance._layout.flowStack.map(meta => {\n                return {\n                    type: meta.type,\n                    configs: meta.configs,\n                    meta: meta.layoutMeta,\n                }\n            });\n            const freeNodes = []\n            this.nodes.forEach(n => {\n                if(!layoutNodes.find(ln => ln.configs.id === n.configs.id)){\n                    freeNodes.push(n)\n                }\n            })\n            this.nodes = layoutNodes.concat(freeNodes);\n            this.links = this._jflowInstance._layout.flowLinkStack.slice();\n            this.$nextTick(() => {\n                if(preCallback) {\n                    preCallback();\n                }\n                this._jflowInstance.recalculate();\n                this._jflowInstance._render();\n                console.log(this._jflowInstance.bounding_box)\n            })\n        },\n        /**\n         * 获取单签 JFlow 实例\n         * @return {Jflow} - JFlow对象\n         */\n        getInstance() {\n            return this._jflowInstance;\n        },\n        /**\n         * 手动触发绘制\n         */\n        renderJFlow() {\n            this._jflowInstance._render();\n        },\n        addNameToRootStack(instance, name) {\n             this.stack.push({\n                name,\n                instance,\n            });\n        }\n    }\n}","import * as JFlowInstance from '../../core/flow';\nimport diff from 'object-diff';\nexport default function (nameNode) {\n    const bulder =  typeof nameNode === 'string' \n        ? JFlowInstance[nameNode] \n        : nameNode;\n    /**\n     * JFlow {@link Node} 的 vue 封装 \n     * @module JFlowNode\n     *\n     * @vue-prop {Configs} configs - 传给 Instance 的配置\n     * @vue-event {drop} dropEvent -  {@link Node#event:drop} 事件\n     * @vue-event {click} click - {@link Node#event:click} 事件\n     * @vue-event {pressStart} pressStartEvent - {@link Node#event:pressStart} 事件\n     * @vue-event {pressEnd} pressEndEvent - {@link Node#event:pressEnd} 事件\n     */\n    return {\n        inject: ['addToStack', 'removeFromStack','addNameToRootStack'],\n        props: {\n            configs: {\n                type: Object,\n                default: function () {\n                    return {};\n                },\n            },\n            name: {\n                type: String,\n            }\n        },\n        watch: {\n            configs(val, oldVal) {\n                if(JSON.stringify(val) === JSON.stringify(oldVal)){\n                    return;\n                }\n                const diffed = diff(val, oldVal);\n                const reflowKeys = Object.keys(diffed).filter(k => {\n                    const lk = k.toLowerCase();\n                    return !(lk.endsWith('color') || k.endsWith('style'));\n                });\n                this._jflowInstance.setConfig(val);\n                if(reflowKeys.length) {\n                    this._jflowInstance._belongs.recalculate();\n                } \n                this._jflowInstance._jflow._render();\n            },\n            '$listeners' (val, oldVal) {\n                let news = [];\n                let deletes = [];\n                const vnew = Object.keys(val).map(e => ({ event: e, handler: val[e] }));\n                const vold = Object.keys(oldVal).map(e => ({ event: e, handler: oldVal[e] }));\n                vnew.forEach((v) => {\n                    const hnew = v.handler;\n                    if(!vold.find((q) => q.handler === hnew)) {\n                        news.push(v);\n                    }\n                });\n                vold.forEach((v) => {\n                    const hold = v.handler;\n                    if(!vnew.find((q) => q.handler === hold)) {\n                        deletes.push(v);\n                    }\n                });\n\n                news.forEach((v) => {\n                    this._jflowInstance.addEventListener(v.event, v.handler);\n                });\n                deletes.forEach((v) => {\n                    this._jflowInstance.removeEventListener(v.event, v.handler);\n                });\n            }\n        },\n        render: function (createElement) {\n            return null;\n        },\n        created() { \n            this._jflowInstance =  new bulder(this.configs);\n            this.bindListeners();\n            this.addToStack(this._jflowInstance, this.name);\n        },\n        destroyed() {\n            this.removeFromStack(this._jflowInstance);\n        },\n        methods: {\n            bindListeners() {\n                Object.keys(this.$listeners).map(event => {\n                    const func = this.$listeners[event];\n                    this._jflowInstance.addEventListener(event, func);\n                })\n            }\n        }\n    }\n}","import * as JFlowInstance from '../../core/flow';\n\nexport default function (nameNode, isLink) {\n    /**\n     * JFlow {@link BaseLink} 的 vue 封装 \n     * @module JFlowLink\n     *\n     * @vue-prop {Configs} configs - 传给 Instance 的配置\n     * @vue-event {drop} dropEvent -  {@link BaseLink#event:drop} 事件\n     * @vue-event {pressEnd} pressEndEvent - {@link BaseLink#event:pressEnd} 事件\n     * @vue-event {pressStart} pressStartEvent - {@link BaseLink#event:pressStart} 事件\n     */\n    return {\n        inject: [ 'addToLinkStack', 'removeFromLinkStack', 'getInstanceByName' ],\n        props: {\n            configs: {\n                type: Object,\n                default: function () {\n                    return {};\n                },\n            },\n            from: String,\n            to: String,\n        },\n        watch: {\n            from(){\n                this.resetLink();\n            },\n            to() {\n                this.resetLink();\n            }\n        },\n        render: function (createElement) {\n            return null;\n        },\n        created() {\n            const fromInstance = this.getInstanceByName(this.from);\n            const toInstance = this.getInstanceByName(this.to);\n            const key = this.$vnode.key;\n            if(fromInstance && toInstance) {\n                this._jflowInstance =  new JFlowInstance[nameNode]({\n                    ...this.configs,\n                    key,\n                    from: fromInstance,\n                    to: toInstance,\n                });\n                this.addToLinkStack(this._jflowInstance); \n                Object.keys(this.$listeners).map(event => {\n                    const func = this.$listeners[event].bind(this);\n                    this._jflowInstance.addEventListener(event, func);\n                })               \n            }\n        },\n        methods: {\n            resetLink() {\n                const fromInstance = this.getInstanceByName(this.from);\n                const toInstance = this.getInstanceByName(this.to);\n                this._jflowInstance.from = fromInstance;\n                this._jflowInstance.to = toInstance;\n            }\n        },\n        destroyed() {\n            if(this._jflowInstance) {\n                this.removeFromLinkStack(this._jflowInstance);\n            }\n        }\n    }\n}","import { Group } from '../../core/flow';\nimport StackMixin from './StackMixin';\n/**\n * JFlow {@link Group} 的 vue 封装 \n * @vue-prop {GroupConfigs} configs - 传给 Group 的配置\n * @vue-event {drop} dropEvent -  {@link Group#event:drop} 事件\n * @vue-event {pressEnd} pressEndEvent - {@link Group#event:pressEnd} 事件\n * @vue-event {click} click - {@link Group#event:click} 事件\n * @vue-event {pressStart} pressStartEvent - {@link Group#event:pressStart} 事件\n */\nexport default {\n    mixins: [StackMixin],\n    inject: {\n        addToBelongStack: {\n            from: 'addToStack',\n        },\n        removeFromBelongStack: {\n            from: 'removeFromStack',\n        },\n        renderJFlow: {\n            from: 'renderJFlow',\n        },\n        addNameToRootStack: {\n            from: 'addNameToRootStack',\n        }\n    },\n    render: function (createElement) {\n        return createElement('template', this.$slots.default);\n    },\n    props: {\n        configs: {\n            type: Object,\n            default: function () {\n                return {};\n            },\n        },\n        name: {\n            type: String,\n        }\n    },\n     watch: {\n        configs(val, oldVal) {\n            if(JSON.stringify(val) === JSON.stringify(oldVal)){\n                return;\n            }\n            this._jflowInstance.setConfig(val);\n        },\n        '$listeners' (val, oldVal) {\n            let news = [];\n            let deletes = [];\n            const vnew = Object.keys(val).map(e => ({ event: e, handler: val[e] }));\n            const vold = Object.keys(oldVal).map(e => ({ event: e, handler: oldVal[e] }));\n            vnew.forEach((v) => {\n                const hnew = v.handler;\n                if(!vold.find((q) => q.handler === hnew)) {\n                    news.push(v);\n                }\n            });\n            vold.forEach((v) => {\n                const hold = v.handler;\n                if(!vnew.find((q) => q.handler === hold)) {\n                    deletes.push(v);\n                }\n            });\n\n            news.forEach((v) => {\n                this._jflowInstance.addEventListener(v.event, v.handler);\n            });\n            deletes.forEach((v) => {\n                this._jflowInstance.removeEventListener(v.event, v.handler);\n            });\n        }\n    },\n    created() {\n        this._jflowInstance =  new Group(this.configs);\n        Object.keys(this.$listeners).map(event => {\n            const func = this.$listeners[event].bind(this);\n            this._jflowInstance.addEventListener(event, func);\n        })\n        // console.log(this.name, this.)\n        this.addToBelongStack(this._jflowInstance, this.name);\n        this.addNameToRootStack(this._jflowInstance, this.name);\n    },\n    mounted(){\n        this._jflowInstance.recalculate();\n    },\n    destroyed() {\n        this.removeFromBelongStack(this._jflowInstance);\n    },\n}","// import JFlowComponent from './components/JFlow';\nimport JFlowComponent from './components-template/JFlow';\nimport JFlowInstance from './components/JFlowInstance';\nimport JFlowLink from './components/JFlowLink';\nimport JFLowGroup from './components/JFlowGroup';\nconst JFLOW_NODES = [\n    'Point',\n    'Rectangle',\n    'Text',\n    'Icon',\n];\nconst JFLOW_LINKS = [\n    'Link',\n    'PolylineLink',\n    'BezierLink'\n]\n\nconst components = [\n    {\n        name: 'Jflow',\n        component: JFlowComponent,\n    },\n    {\n        name: 'Group',\n        component: JFLowGroup,\n    },\n    ...JFLOW_NODES.map(name => ({\n        name,\n        component: JFlowInstance(name)\n    })),\n    ...JFLOW_LINKS.map(name => ({\n        name,\n        component: JFlowLink(name)\n    })),\n];\nconst componentPrefix = 'j';\n\n/**\n * @module JFlowVuePlugin \n */\nexport default {\n    /**\n     * 安装 JFlowVuePlugin\n     * @function\n     * @param {Vue} Vue - Vue\n     * @param {Object} options - Vue plugin 配置\n     * @param {string} options.prefix - 组件前缀，默认是 j\n     * @param {Object} options.custom - 自定义组件，形式为 { key: {@link:Instance} }\n     */\n    install: (Vue, options = {}) => {\n        let prefixToUse = componentPrefix;\n        if(options && options.prefix){\n            prefixToUse = options.prefix;\n        };\n        components.forEach(k => {\n            Vue.component(`${prefixToUse}${k.name}`, k.component);\n        });\n\n        if(options.custom) {\n            Object.keys(options.custom).forEach(name => {\n                Vue.component(`${prefixToUse}${name}`, JFlowInstance(options.custom[name]));\n            })\n        }\n        \n    }\n}\n\n// export { * as JFlowInstance } from './components/JFlowInstance'; \n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:_vm.$style.body,attrs:{\"id\":\"app\"}},[_c('div',{class:_vm.$style.sidebar},[_c('div',[_c('div',{class:_vm.$style.part,attrs:{\"draggable\":\"true\",\"type\":\"IfStatement\"},on:{\"dragstart\":_vm.onDragStartRectangle}},[_vm._v(\"IfStatement\")])]),_c('div',[_c('div',{class:_vm.$style.part,attrs:{\"draggable\":\"true\",\"type\":\"variable\"},on:{\"dragstart\":_vm.onDragStartPoint}},[_vm._v(\"Variable\")])])]),_c('div',{staticStyle:{\"position\":\"relative\"}},[_c('j-jflow',{ref:\"jflow\",class:_vm.$style.wrapper,attrs:{\"configs\":_vm.configs},on:{\"click\":_vm.onClickNoWhere,\"drop\":_vm.onDrop,\"pressEnd\":_vm.onPressEnd},scopedSlots:_vm._u([{key:\"start\",fn:function(ref){\nvar configs = ref.configs;\nreturn [_c('j-start',{attrs:{\"node\":{ name: configs.id }}})]}},{key:\"end\",fn:function(ref){\nvar configs = ref.configs;\nreturn [_c('j-end',{attrs:{\"node\":{ name: configs.id }}})]}},{key:\"variable\",fn:function(ref){\nvar configs = ref.configs;\nvar meta = ref.meta;\nreturn [_c('j-variable',{attrs:{\"node\":{ name: configs.id, content: configs.content }},on:{\"pressStart\":function($event){return _vm.onPressStart(configs)},\"outOfFlow\":function($event){return _vm.onOutOfFlow($event, meta)},\"change\":function($event){return _vm.onChangeContent($event, configs)}}})]}},{key:\"IfStatement\",fn:function(ref){\nvar configs = ref.configs;\nvar meta = ref.meta;\nreturn [_c('j-ifstatement',{attrs:{\"node\":{ name: configs.id, content: configs.content }},on:{\"pressStart\":function($event){return _vm.onPressStart(configs)},\"outOfFlow\":function($event){return _vm.onOutOfFlow($event, meta)}}})]}},{key:\"SwitchStatement\",fn:function(ref){\nvar configs = ref.configs;\nvar meta = ref.meta;\nreturn [_c('j-switch',{attrs:{\"node\":{ name: configs.id, content: configs.id, cases: configs.cases }},on:{\"pressStart\":function($event){return _vm.onPressStart(configs)},\"outOfFlow\":function($event){return _vm.onOutOfFlow($event, meta)}}})]}},{key:\"WhileStatement\",fn:function(ref){\nvar configs = ref.configs;\nvar meta = ref.meta;\nreturn [_c('j-whilestatement',{attrs:{\"node\":{ name: configs.id, content: configs.content }},on:{\"pressStart\":function($event){return _vm.onPressStart(configs)},\"outOfFlow\":function($event){return _vm.onOutOfFlow($event, meta)}}})]}},{key:\"endpoint\",fn:function(ref){\nvar configs = ref.configs;\nreturn [_c('j-endpoint',{attrs:{\"node\":{ name: configs.id }}})]}},{key:\"CallLogic\",fn:function(ref){\nvar configs = ref.configs;\nvar meta = ref.meta;\nreturn [_c('j-calllogic',{attrs:{\"node\":{ name: configs.id, content: configs.content, params: configs.params, }},on:{\"toggle-select\":function($event){return _vm.onToggleSelect($event, configs)},\"pressStart\":function($event){return _vm.onPressStart(configs)},\"outOfFlow\":function($event){return _vm.onOutOfFlow($event, meta)}}})]}},{key:\"plainlink\",fn:function(ref){\nvar configs = ref.configs;\nreturn [_c('jBezierLink',{attrs:{\"configs\":configs,\"from\":configs.from,\"to\":configs.to},on:{\"drop\":function($event){return _vm.onDropToLink($event, configs)}}})]}}])}),(_vm.isHover)?_c('div',{ref:\"hoverblock\",class:_vm.$style.hoverblock,style:((\"transform: translate(\" + _vm.offsetX + \"px, \" + _vm.offsetY + \"px)\"))},[_c('ul',_vm._l((_vm.logics),function(l){return _c('li',{key:l.content,on:{\"click\":function($event){return _vm.onSelectLogic(l)}}},[_vm._v(_vm._s(l.content))])}),0)]):_vm._e()],1),_c('div',{class:_vm.$style.ast},[_c('pre',{domProps:{\"innerHTML\":_vm._s(_vm.prettyJson(_vm.ast))}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',_vm._g({attrs:{\"name\":_vm.node.name,\"configs\":_vm.groupConfig}},_vm.$listeners),[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: '#585c63',\n        content: _vm.node.content,\n        lineHeight: 26,\n        editable: true\n    }},on:{\"change\":_vm.onContentChange}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group\n        :name=\"node.name\" \n        :configs=\"groupConfig\"\n        v-on=\"$listeners\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor: '#585c63',\n            content: node.content,\n            lineHeight: 26,\n            editable: true\n        }\"\n        @change=\"onContentChange\"/>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n    },\n    computed: {\n        groupConfig() {\n            return  {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0,\n                }),\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 5,\n                padding: 10,\n                hasShrink: false,\n                lock: true,\n                anchor: this.initialAnchor, \n            }\n        }\n    },\n    methods: {\n        onContentChange(event){\n            console.log(event.detail)\n            this.$emit('change', {\n                val: event.detail.val,\n                oldVal: event.detail.oldVal,\n            });\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./variable.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./variable.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./variable.vue?vue&type=template&id=3a41fc26&\"\nimport script from \"./variable.vue?vue&type=script&lang=js&\"\nexport * from \"./variable.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',_vm._g({attrs:{\"name\":_vm.node.name,\"configs\":_vm.groupConfig}},_vm.$listeners),[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: '#585c63',\n        content: 'ifstatement' + _vm.node.name,\n        lineHeight: 26,\n        indent: 10,\n    }}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group\n        :name=\"node.name\" \n        :configs=\"groupConfig\"\n        v-on=\"$listeners\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor: '#585c63',\n            content: 'ifstatement' + node.name,\n            lineHeight: 26,\n            indent: 10,\n        }\"/>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n        initialAnchor: Array,\n    },\n    computed: {\n        groupConfig() {\n            return  {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0,\n                }),\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 5,\n                hasShrink: false,\n                lock: true,\n                anchor: this.initialAnchor, \n            }\n        }\n    },\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ifstatement.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ifstatement.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ifstatement.vue?vue&type=template&id=06b0f589&\"\nimport script from \"./ifstatement.vue?vue&type=script&lang=js&\"\nexport * from \"./ifstatement.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',{attrs:{\"name\":_vm.node.name,\"configs\":_vm.configs},on:{\"mouseenter\":_vm.onMouseEnter,\"mouseleave\":_vm.onMouseLeave}},[_c('j-text',{ref:\"start\",attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: _vm.textColor,\n        content: '开始',\n    }}}),_c('j-point',{attrs:{\"configs\":{\n        color: '#99dbc5',\n        radius: 11,\n    }}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group \n        :name=\"node.name\" \n        @mouseenter=\"onMouseEnter\"\n        @mouseleave=\"onMouseLeave\" \n        :configs=\"configs\">\n        <j-text ref=\"start\" :configs=\"{\n            fontSize: '12px',\n            textColor,\n            content: '开始',\n        }\">\n        </j-text>\n        <j-point :configs=\"{\n            color: '#99dbc5',\n            radius: 11,\n        }\"></j-point>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n    },\n    data() {\n        return {\n            textColor: '#585c63',\n            configs: {\n                layout: new LinearLayout({\n                    direction: 'vertical',\n                    gap: 0,\n                }),\n                borderColor: 'transparent',\n                borderWidth: 0,\n                hoverStyle: 'transparent',\n                color: 'transparent',\n                hasShrink: false,\n                lock: true,\n            }\n        }\n    },\n    methods: {\n        onMouseEnter(){\n            this.textColor = 'red'\n        },\n        onMouseLeave() {\n             this.textColor = '#585c63'\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./start.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./start.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./start.vue?vue&type=template&id=219d6759&\"\nimport script from \"./start.vue?vue&type=script&lang=js&\"\nexport * from \"./start.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',{attrs:{\"name\":_vm.node.name,\"configs\":_vm.configs}},[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: '#585c63',\n        content: '结束',\n    }}}),_c('j-rectangle',{attrs:{\"configs\":{\n        color: '#faaaaa',\n        width: 20,\n        height: 20,\n        borderRadius: 2,\n    }}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group :name=\"node.name\" :configs=\"configs\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor: '#585c63',\n            content: '结束',\n        }\">\n        </j-text>\n        <j-rectangle :configs=\"{\n            color: '#faaaaa',\n            width: 20,\n            height: 20,\n            borderRadius: 2,\n        }\"></j-rectangle>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n    },\n    data() {\n        return {\n            configs: {\n                layout: new LinearLayout({\n                    direction: 'vertical',\n                    gap: 0,\n                }),\n                borderColor: 'transparent',\n                borderWidth: 0,\n                hoverStyle: 'translate',\n                color: 'transparent',\n                hasShrink: false,\n                lock: true,\n            }\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./end.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./end.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./end.vue?vue&type=template&id=159a39ee&\"\nimport script from \"./end.vue?vue&type=script&lang=js&\"\nexport * from \"./end.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-point',{attrs:{\"name\":_vm.node.name,\"configs\":{\n        color: '#fff',\n        strokeColor: '#000',\n        borderWidth: 1,\n        radius: 5,\n        ignoreHit: true,\n    }}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-point \n        :name=\"node.name\" \n        :configs=\"{\n            color: '#fff',\n            strokeColor: '#000',\n            borderWidth: 1,\n            radius: 5,\n            ignoreHit: true,\n        }\">\n    </j-point>\n</template>\n\n<script>\nexport default {\n    props: {\n        node: Object,\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./endpoint.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./endpoint.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./endpoint.vue?vue&type=template&id=53e5085a&\"\nimport script from \"./endpoint.vue?vue&type=script&lang=js&\"\nexport * from \"./endpoint.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',_vm._g({attrs:{\"name\":_vm.node.name,\"configs\":_vm.configs}},_vm.$listeners),[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: _vm.textColor,\n        content: _vm.node.content,\n    }}}),_vm._l((_vm.node.cases),function(switchcase){return [_c('j-switchcase',{key:switchcase.id,attrs:{\"node\":{ content: switchcase.id, name: switchcase.id }}})]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',_vm._g({attrs:{\"name\":_vm.node.name,\"configs\":_vm.groupConfig,\"rootLink\":true}},_vm.$listeners),[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: '#585c63',\n        content: _vm.node.name,\n        lineHeight: 26,\n        indent: 10,\n    }}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group\n        :name=\"node.name\" \n        :configs=\"groupConfig\"\n        :rootLink=\"true\"\n        v-on=\"$listeners\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor: '#585c63',\n            content: node.name,\n            lineHeight: 26,\n            indent: 10,\n        }\"/>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n    },\n    computed: {\n        groupConfig() {\n            return  {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0,\n                }),\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 5,\n                hasShrink: false,\n                lock: true,\n                anchor: this.initialAnchor, \n            }\n        }\n    },\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./switchcase.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./switchcase.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./switchcase.vue?vue&type=template&id=0c519d73&\"\nimport script from \"./switchcase.vue?vue&type=script&lang=js&\"\nexport * from \"./switchcase.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n    <j-group \n        :name=\"node.name\" \n        :configs=\"configs\"\n        v-on=\"$listeners\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor,\n            content: node.content,\n        }\">\n        </j-text>\n        <template v-for=\"switchcase in node.cases\">\n            <j-switchcase :node=\"{ content: switchcase.id, name: switchcase.id }\" :key=\"switchcase.id\" />\n        </template>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nimport switchCase from './switchcase.vue';\nexport default {\n    components: {\n        // 'j-variable': variable,\n        'j-switchcase': switchCase,\n    },\n    props: {\n        node: Object,\n    },\n    data() {\n        return {\n            textColor: '#585c63',\n            configs: {\n                layout: new LinearLayout({\n                    direction: 'vertical',\n                    gap: 0,\n                }),\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 5,\n                hoverStyle: 'transparent',\n                color: 'transparent',\n                hasShrink: false,\n                lock: true,\n            }\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./switch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./switch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./switch.vue?vue&type=template&id=7c42a376&\"\nimport script from \"./switch.vue?vue&type=script&lang=js&\"\nexport * from \"./switch.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',_vm._g({attrs:{\"name\":_vm.node.name,\"configs\":_vm.groupConfig}},_vm.$listeners),[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: '#585c63',\n        content: _vm.node.name,\n        lineHeight: 26,\n        indent: 10,\n    }}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group\n        :name=\"node.name\" \n        :configs=\"groupConfig\"\n        v-on=\"$listeners\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor: '#585c63',\n            content: node.name,\n            lineHeight: 26,\n            indent: 10,\n        }\"/>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n    },\n    computed: {\n        groupConfig() {\n            return  {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0,\n                }),\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 5,\n                hasShrink: false,\n                lock: true,\n            }\n        }\n    },\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./whilestatement.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./whilestatement.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./whilestatement.vue?vue&type=template&id=27ba0e14&\"\nimport script from \"./whilestatement.vue?vue&type=script&lang=js&\"\nexport * from \"./whilestatement.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',_vm._g({attrs:{\"name\":_vm.node.name,\"configs\":_vm.configs}},_vm.$listeners),[_c('j-group',{attrs:{\"configs\":_vm.headerConfigs}},[_c('j-icon',{attrs:{\"configs\":_vm.imageConfig}}),_c('j-text',{attrs:{\"configs\":{\n            fontSize: '16px',\n            textColor: '#585c63',\n            content: '调用逻辑',\n        }}})],1),_c('j-group',{attrs:{\"configs\":_vm.contentConfigs},on:{\"click\":_vm.onClick}},[_c('j-text',{attrs:{\"configs\":{\n            fontSize: '12px',\n            textColor: '#585c63',\n            content: _vm.node.content || '请选择接口' ,\n            lineHeight: 26,\n            indent: 10,\n        }}})],1),(_vm.node.params && _vm.node.params.length)?[_c('j-text',{attrs:{\"configs\":{\n            fontSize: '16px',\n            textColor: '#585c63',\n            content: '参数',\n        }}}),_c('j-group',{ref:\"paramGroup\",attrs:{\"configs\":_vm.paramsConfigs}},_vm._l((_vm.node.params),function(param){return _c('j-text',{key:param.content,attrs:{\"configs\":{\n                fontSize: '16px',\n                textColor: '#585c63',\n                content: param.content,\n            }}})}),1)]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group v-on=\"$listeners\" :name=\"node.name\" :configs=\"configs\">\n        <j-group :configs=\"headerConfigs\">\n            <j-icon :configs=\"imageConfig\" />\n            <j-text :configs=\"{\n                fontSize: '16px',\n                textColor: '#585c63',\n                content: '调用逻辑',\n            }\" />\n        </j-group>\n        <j-group @click=\"onClick\" :configs=\"contentConfigs\">\n            <j-text :configs=\"{\n                fontSize: '12px',\n                textColor: '#585c63',\n                content: node.content || '请选择接口' ,\n                lineHeight: 26,\n                indent: 10,\n            }\" />\n        </j-group>\n        <template v-if=\"node.params && node.params.length\">\n            <j-text :configs=\"{\n                fontSize: '16px',\n                textColor: '#585c63',\n                content: '参数',\n            }\" />\n            <j-group ref=\"paramGroup\" :configs=\"paramsConfigs\">\n                <j-text v-for=\"param in node.params\" \n                    :key=\"param.content\"\n                    :configs=\"{\n                    fontSize: '16px',\n                    textColor: '#585c63',\n                    content: param.content,\n                }\" />\n            </j-group>\n        </template>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nimport logicIcon from '../assets/logic.svg';\nconst p = new Image();\np.src = logicIcon;\nexport default {\n    props: {\n        node: Object,\n    },\n    data() {\n        return {\n            configs: {\n                layout: new LinearLayout({\n                    direction: 'vertical',\n                    gap: 0,\n                    alignment: 'start'\n                }),\n                padding: 10,\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 12,\n                width: 220,\n                hoverStyle: 'transparent',\n                hasShrink: false,\n                lock: true,\n            },\n            headerConfigs: {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0\n                }),\n                borderRadius: 10,\n                borderColor: '#ccc',\n                hoverStyle: '#517cff',\n                borderWidth: 0,\n                lock: true,\n            },\n            contentConfigs: {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0,\n                }),\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 5,\n                width: 200,\n                hoverStyle: 'transparent',\n                hasShrink: false,\n                lock: true,\n            },\n            paramsConfigs: {\n                layout: new LinearLayout({\n                    direction: 'vertical',\n                    gap: 0,\n                    alignment: 'start'\n                }),\n                borderColor: 'transparent',\n                hoverStyle: 'transparent',\n                hasShrink: false,\n                lock: true,\n            },\n            imageConfig: {\n                image: p,\n                width: 30,\n                height: 30,\n            }\n        }\n    },\n    watch: {\n        'node.params'() {\n            this.$nextTick(() => {\n                const instance = this.$refs.paramGroup._jflowInstance;\n                instance.recalculateUp();\n                instance._jflow._render();  \n            })\n        }\n    },\n    methods: {\n        onClick(event) {\n            console.log(event)\n            event.detail.bubbles = false; \n            const { currentTarget } = event;\n            const p = [ 0, currentTarget.height/2 ];\n            const gp = currentTarget.calculateToRealWorld(p)\n            // const [ offsetX, offsetY ] = gp;\n            this.$emit('toggle-select', gp);\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./callLogic.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./callLogic.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./callLogic.vue?vue&type=template&id=07c42fa4&\"\nimport script from \"./callLogic.vue?vue&type=script&lang=js&\"\nexport * from \"./callLogic.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\" :class=\"$style.body\">\n      <div :class=\"$style.sidebar\">\n        <div>\n            <div draggable=\"true\" :class=\"$style.part\" type=\"IfStatement\" @dragstart=\"onDragStartRectangle\">IfStatement</div>\n        </div>\n        <div>\n            <div draggable=\"true\" :class=\"$style.part\" type=\"variable\" @dragstart=\"onDragStartPoint\">Variable</div>\n        </div>\n      </div>\n      <div style=\"position: relative;\">\n        <j-jflow ref=\"jflow\" \n            :class=\"$style.wrapper\" \n            :configs=\"configs\"\n            @click=\"onClickNoWhere\"\n            @drop=\"onDrop\"\n            @pressEnd=\"onPressEnd\">\n                <template #start=\"{ configs }\">\n                    <j-start :node=\"{ name: configs.id }\"></j-start>\n                </template>\n                <template #end=\"{ configs }\">\n                    <j-end :node=\"{ name: configs.id }\"></j-end>\n                </template>\n                <template #variable=\"{ configs, meta }\">\n                    <j-variable :node=\"{ name: configs.id, content: configs.content }\" \n                    @pressStart=\"onPressStart(configs)\" \n                    @outOfFlow=\"onOutOfFlow($event, meta)\"\n                    @change=\"onChangeContent($event, configs)\"></j-variable>\n                </template>\n                <template #IfStatement=\"{ configs, meta }\">\n                    <j-ifstatement :node=\"{ name: configs.id, content: configs.content }\" \n                    @pressStart=\"onPressStart(configs)\" \n                    @outOfFlow=\"onOutOfFlow($event, meta)\"></j-ifstatement>\n                </template>\n                <template #SwitchStatement=\"{ configs, meta }\" >\n                    <j-switch :node=\"{ name: configs.id, content: configs.id, cases: configs.cases }\" \n                    @pressStart=\"onPressStart(configs)\" \n                    @outOfFlow=\"onOutOfFlow($event, meta)\"/>\n                </template>\n                <template #WhileStatement=\"{ configs, meta }\">\n                    <j-whilestatement :node=\"{ name: configs.id, content: configs.content }\" \n                    @pressStart=\"onPressStart(configs)\" \n                    @outOfFlow=\"onOutOfFlow($event, meta)\"></j-whilestatement>\n                </template>\n                <template #endpoint=\"{ configs }\">\n                    <j-endpoint :node=\"{ name: configs.id }\"></j-endpoint>\n                </template>\n                <template #CallLogic=\"{ configs, meta }\" >\n                    <j-calllogic \n                        :node=\"{ name: configs.id, content: configs.content, params: configs.params, }\"\n                        @toggle-select=\"onToggleSelect($event, configs)\"\n                        @pressStart=\"onPressStart(configs)\" \n                        @outOfFlow=\"onOutOfFlow($event, meta)\">\n                    </j-calllogic>\n                </template>\n                <template #plainlink=\"{ configs }\">\n                    <jBezierLink\n                        :configs=\"configs\"\n                        :from=\"configs.from\"\n                        :to=\"configs.to\"\n                        @drop=\"onDropToLink($event, configs)\">\n                    </jBezierLink>\n                </template>\n        </j-jflow>\n        <div ref=\"hoverblock\" \n            :style=\"`transform: translate(${offsetX}px, ${offsetY}px)`\" \n            :class=\"$style.hoverblock\"\n             v-if=\"isHover\">\n            <ul>\n                <li v-for=\"l in logics\" :key=\"l.content\"\n                    @click=\"onSelectLogic(l)\">{{l.content}}</li>\n            </ul>\n        </div>\n      </div>\n      <div :class=\"$style.ast\">\n          <pre v-html=\"prettyJson(ast)\"></pre>\n      </div>\n  </div>\n</template>\n\n<script>\nimport { prettyPrintJson } from 'pretty-print-json';\nimport { LinearLayout, Lowcodelayout, Rectangle, Point } from '@joskii/jflow';\n// import './logic-components/assignment.vue'; // resolve Circular dependencies with logic-node!!!\n// import logicNode from './logic-components/logic-node';\nimport variable from './components/variable.vue';\nimport ifStatement from './components/ifstatement.vue';\nimport start from './components/start.vue';\nimport end from './components/end.vue';\nimport endPoint from './components/endpoint.vue';\nimport switchComp from './components/switch.vue'; \nimport whileComp from './components/whilestatement.vue';\nimport CallLogicComp from './components/callLogic.vue';\nfunction getRandomColor() {\n    var letters = '0123456789ABCDEF';\n    var color = '#';\n    for (var i = 0; i < 6; i++) {\n        color += letters[Math.floor(Math.random() * 16)];\n    }\n    return color;\n}\nfunction getPath(object, condition) {\n\n    function iter(o, p) {\n        if (typeof o === 'object') {\n            return Object.keys(o).some(function (k) {\n                return iter(o[k], p.concat(k));\n            });\n        }\n        if (condition(p[p.length - 1])) {\n            path = p;\n            return true;\n        }\n    }\n\n    var path = [];\n    iter(object, []);\n    return path.join('.');\n}\nlet uniqueId = 0;\nexport default {\n    components: {\n        'j-variable': variable,\n        'j-start': start,\n        'j-end': end,\n        'j-endpoint': endPoint,\n        'j-switch': switchComp,\n        'j-ifstatement': ifStatement,\n        'j-whilestatement': whileComp,\n        'j-calllogic': CallLogicComp,\n    },\n    data() {\n        const ast = {\n            type: 'Root',\n            body: [\n                {\n                    type: 'start',\n                    id: 'start',\n                }, \n                {\n                    type: 'IfStatement',\n                    content: 'aaaa',\n                    id: 'logic1',\n                    consequent: [\n                        {\n                            type: 'variable',\n                            content: 'vvvkjhkjhvvvv',\n                            id: 'logic5',\n                        },\n                    ], \n                    alternate: [\n                        {\n                            type: 'IfStatement',\n                            content: 'ggggggg',\n                            id: 'logic6',\n                            consequent: [\n                                {\n                                    type: 'variable',\n                                    content: 'jkhvvvv',\n                                    id: 'logic77',\n                                },\n                            ], \n                            alternate: [\n                                {\n                                    type: 'variable',\n                                    content: 'yuuo',\n                                    id: 'logic88',\n                                },\n                            ]\n                        },\n                        {\n                            type: 'CallLogic',\n                            id: 'CallLogic1',\n                            content: '',\n                            params: [],\n                        }\n                    ]\n                },\n                {\n                    type: 'SwitchStatement',\n                    id: 'swtch1',\n                    cases: [\n                        {\n                            type: 'SwitchCase',\n                            id: 'switchcase11',\n                            content: 'switchcase11',\n                            alternate: [\n                                {\n                                    type: 'variable',\n                                    content: 'yuuo',\n                                    id: 'sc1111122',\n                                },\n                            ]\n                        },\n                        {\n                            type: 'SwitchCase',\n                            id: 'switchcase12',\n                            content: 'switchcase12',\n                            alternate: [\n                                {\n                                    type: 'variable',\n                                    content: 'asdfag',\n                                    id: 'sc12344455',\n                                },\n                            ],\n                            consequent: [\n                                {\n                                    type: 'variable',\n                                    content: 'dfhsdfg',\n                                    id: 'sc125444',\n                                },\n                            ],\n                        }\n                    ]\n                },\n                {\n                    type: 'WhileStatement',\n                    id: 'while1',\n                    content: 'while1',\n                    body: [\n                        // {\n                        //     type: 'variable',\n                        //     content: 'dfhsdfg',\n                        //     id: 'whiel1body1',\n                        // },\n                    ]\n                },\n                {\n                    type: 'end',\n                    id: 'end',\n                },\n            ],\n            playground: [],\n        };\n        const layout = new Lowcodelayout({\n            linkLength: 30,\n            ast,\n        });\n        return {\n            ast,\n            configs: {\n                allowDrop: true,\n                layout,\n            },\n            isHover: false,\n            offsetX: 0,\n            offsetY: 0,\n            currentTarget: null,\n            prepareBody: [],\n            logics: [{\n                content: 'aaa',\n                params: [{\n                    content: 'p1',\n                }],\n            }, {\n                content: 'vvvv',\n                params: [{\n                    content: 'p1',\n                }, {\n                    content: 'p2',\n                }],\n            }, {\n                content: 'sadasdf',\n                params: [{\n                    content: 'p1',\n                }],\n            },{\n                content: 'ggggg',\n                params: [{\n                    content: 'p1',\n                },{\n                    content: 'p2',\n                },{\n                    content: 'p3',\n                }],\n            }],\n            currentEditingTarget: null,\n        }\n    },\n    computed: {\n        inflowInstances() {\n            return this.ast.body.filter(b => !b.outflow)\n        }\n    },\n    mounted() {\n        console.log(this.$refs.jflow.getInstance())\n    },\n    methods: {\n        prettyJson() {\n            return prettyPrintJson.toHtml(this.ast);\n        },\n        onDragStartRectangle() {\n            const jflowInstance = this.$refs.jflow.getInstance();\n            jflowInstance.sendMessage({ \n                instance: {\n                    type: 'IfStatement',\n                    content: `IfStatement-rec${uniqueId ++}`,\n                    id: `IfStatement-rec${uniqueId ++}`,\n                    consequent: [], \n                    alternate: [],\n                    \n                }\n            })\n        },\n        onDragStartPoint() {\n            const jflowInstance = this.$refs.jflow.getInstance();\n            jflowInstance.sendMessage({ \n                instance: {\n                    type: 'variable',\n                    content: 'vvvvvvdasdfasfd',\n                    id: `logic-point${uniqueId ++}`,\n                }\n            })\n        },\n        onOutOfFlow(e, meta) {\n            const type = meta.parentIterateType;\n            const idx = meta.idx;\n            const [astnode] = meta.parent.source[type].splice(idx, 1);\n            this.ast.playground.push(astnode);\n            this.configs.layout.reOrder(this.ast);\n            this.$refs.jflow.reflow();\n            meta.getJflowInstance().anchor = e.detail.point;    \n        },\n        onDrop(e) {\n            const astblock = e.detail.instance;\n            this.ast.playground.push(astblock);\n            this.configs.layout.reOrder(this.ast);\n            this.$refs.jflow.reflow(() => {\n                const meta = this.configs.layout.findLayoutNode(astblock);\n                if(meta) {\n                     meta.getJflowInstance().anchor = e.detail.point;\n                }\n            });\n        },\n        onClick(e) {\n            const { currentTarget } = e;\n            const p = [ 0, currentTarget.height/2 ];\n            const gp = currentTarget.calculateToRealWorld(p)\n            const [ offsetX, offsetY ] = gp;\n            this.isHover = !this.isHover;\n            this.offsetX = offsetX;\n            this.offsetY = offsetY;\n        },\n        onPressStart(configs) {\n            console.log('pressStart')\n            console.log(configs);\n            this.currentTarget = configs;\n        },\n        onPressEnd() {\n            console.log('pressEnd')\n            this.currentTarget = null;\n        },\n        onDropToLink(e, linkConfigs) {\n            console.log(e, linkConfigs);\n            let node = e.detail.instance;\n            if(this.currentTarget) {\n                node.removeFromLayoutSource();\n                node = this.currentTarget;\n            }\n\n            linkConfigs.meta.from.linkSource(node, linkConfigs);\n            this.configs.layout.reOrder(this.ast);\n            this.$refs.jflow.reflow();\n        },\n        onToggleSelect(event, configs) {\n            const [offsetX, offsetY] = event;\n            this.offsetX = offsetX;\n            this.offsetY = offsetY;\n            this.isHover = !this.isHover;\n            if(this.isHover) {\n                this.currentEditingTarget = configs\n            } else {\n                this.currentEditingTarget = null;\n            } \n        },\n        onSelectLogic(c) {\n            this.isHover = false\n            console.log(this.currentEditingTarget)\n            this.currentEditingTarget.content = c.content;\n            this.currentEditingTarget.params = c.params;\n        },\n        onClickNoWhere() {\n            this.isHover = false\n            this.currentEditingTarget = null;\n        },\n        onChangeContent($event, configs){\n            configs.content = $event.val;\n        }\n    }\n}\n</script>\n\n<style module>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n.wrapper{\n    width: 800px;\n    height: 600px;\n    border: 1px solid #ccc;\n}\n.body{\n    display: flex;\n    flex-direction: horizontal;\n}\n.sidebar{\n    width: 180px;\n    border: 2px solid gold;\n}\n.sidebar > div {\n    padding: 16px;\n    display: flex;\n    justify-content: center;\n}\n\n.sidebar > div > div {\n    cursor: move;\n}\n\n.sidebar > div > .rect {\n    width: 80px;\n    height: 50px;\n    background-color: green;\n    text-align: center;\n    line-height: 50px;\n}\n\n.sidebar > div > .part {\n    width: 80px;\n    height: 50px;\n    border: 2px solid #517cff;\n    border-radius: 8ox;\n    text-align: center;\n    line-height: 50px;\n}\n\n.sidebar > div > .circle {\n    width: 80px;\n    height: 80px;\n    border-radius: 100%;\n    background-color: hotpink;\n    text-align: center;\n    line-height: 80px;\n}\n.ast {\n    flex: 1;\n    border: 2px solid gold;\n}\n.hide{\n    -webkit-user-drag: none;\n    -khtml-user-drag: none;\n    -moz-user-drag: none;\n    -o-user-drag: none;\n    -ms-user-drag: none;\n    user-drag: none;\n}\n.hoverblock{\n    position: absolute;\n    background: #fff;\n    width: 300px;\n    height: 300px;\n    border: 3px solid gold;\n    left: 0;\n    top: 0;\n    transform: translate(0, 0);\n}\n.hoverblock > ul > li{\n    cursor: pointer;\n}\n.hoverblock > ul > li:hover{\n    background: #eee;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=4ba6129e&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&module=true&lang=css&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport { JFlowVuePlugin } from '@joskii/jflow';\nimport App from './App.vue'\n\nVue.config.productionTip = false\nVue.use(JFlowVuePlugin);\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n","export { default } from  \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&module=true&lang=css&\"; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&module=true&lang=css&\"","module.exports = __webpack_public_path__ + \"img/logic.17805d7a.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app_3cl75\",\"wrapper\":\"App_wrapper_pE_0j\",\"body\":\"App_body_1uhyl\",\"sidebar\":\"App_sidebar_3dMLz\",\"rect\":\"App_rect_2g-OE\",\"part\":\"App_part_1uPSl\",\"circle\":\"App_circle_2pifB\",\"ast\":\"App_ast_3JyD2\",\"hide\":\"App_hide_1hYJ-\",\"hoverblock\":\"App_hoverblock_rjKeE\"};"],"sourceRoot":""}
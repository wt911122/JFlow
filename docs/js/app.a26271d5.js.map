{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/utils/canvas.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/utils/constance.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/utils/functions.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/stack.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/instance.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/polyline-link.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/stackMixin.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/layoutMixin.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/messageMixin.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/events/index.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/node.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/base-link.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/shapes/point.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/shapes/rectangle.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/groupMixin.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/shapes/rectangle-group.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/shapes/capsule.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/shapes/capsule-group.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/shapes/diamond.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/shapes/diamond-group.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/text.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/image.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/link.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/instance/bezier-link.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/layout/linear-layout.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/layout/low-code-types/baseNode.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/layout/low-code-layout.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/layout/er-layout/er-node.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/layout/er-layout/er-layout.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/core/flow/index.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/components/StackMixin.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/components/JFlow.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/components/JFlowInstance.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/components/JFlowLink.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/components/JFlowGroup.js","webpack:////Users/wangtao/Documents/My Workspace/JFlow/src/vue-plugin/JFlowPlugin.js","webpack:///./src/App.vue?9623","webpack:///./src/components/variable.vue?e7c5","webpack:///src/components/variable.vue","webpack:///./src/components/variable.vue?635d","webpack:///./src/components/variable.vue","webpack:///./src/components/ifstatement.vue?1bb1","webpack:///src/components/ifstatement.vue","webpack:///./src/components/ifstatement.vue?d165","webpack:///./src/components/ifstatement.vue","webpack:///./src/components/start.vue?9fac","webpack:///src/components/start.vue","webpack:///./src/components/start.vue?989d","webpack:///./src/components/start.vue","webpack:///./src/components/end.vue?0630","webpack:///src/components/end.vue","webpack:///./src/components/end.vue?df4a","webpack:///./src/components/end.vue","webpack:///./src/components/endpoint.vue?2d25","webpack:///src/components/endpoint.vue","webpack:///./src/components/endpoint.vue?fad3","webpack:///./src/components/endpoint.vue","webpack:///./src/components/switch.vue?9ee7","webpack:///./src/components/switchcase.vue?dc47","webpack:///src/components/switchcase.vue","webpack:///./src/components/switchcase.vue?48a4","webpack:///./src/components/switchcase.vue","webpack:///src/components/switch.vue","webpack:///./src/components/switch.vue?8fad","webpack:///./src/components/switch.vue","webpack:///./src/components/whilestatement.vue?749e","webpack:///src/components/whilestatement.vue","webpack:///./src/components/whilestatement.vue?e5d2","webpack:///./src/components/whilestatement.vue","webpack:///./src/components/callLogic.vue?0156","webpack:///src/components/callLogic.vue","webpack:///./src/components/callLogic.vue?735a","webpack:///./src/components/callLogic.vue","webpack:///./src/components/instance-link.vue?45a1","webpack:///src/components/instance-link.vue","webpack:///./src/components/instance-link.vue?2627","webpack:///./src/components/instance-link.vue","webpack:///src/App.vue","webpack:///./src/App.vue?4c4f","webpack:///./src/App.vue","webpack:///./src/main.js","webpack:///./src/App.vue?fd8d","webpack:///./src/assets/logic.svg","webpack:///./src/App.vue?8544"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","createCanvas","wrapper","canvas","document","createElement","ctx","getContext","getBoundingClientRect","width","height","left","top","style","userSelect","scale","devicePixelRatio","Math","floor","position","append","raw_width","raw_height","caheCanvas","caheCanvasctx","requestCacheCanvas","render","clearRect","save","restore","DIRECTION","RIGHT","BOTTOM","LEFT","TOP","APPROXIMATE","bounding_box","points","min_x","Infinity","min_y","max_x","max_y","idx","item","max","x","y","sqr","dist2","v","w","distToSegmentSquared","l2","min","_resolveControlPoint","dir","spanx","spany","bezierPoints","p1","p2","start_dir","end_dir","minSpanX","minSpanY","abs","cp1","cp2","arrowspan","includes","isVerticalEnd","endX","endY","bezierPoint","P","q","u","angle","atan2","distToBezierSegmentSquared","b","Bezier","point","project","getBezierAngle","sx","sy","cp1x","cp1y","cp2x","cp2y","ex","ey","dx","pow","dy","PI","InstanceStack","movingTarget","this","forEach","instance","_isMoving","visible","condition","ignoreHit","ishit","isHit","_isHit","getBoundingRect","Array","ishitKey","Instance","configs","assign","_belongs","undefined","_layoutNode","borderWidth","borderColor","backgroundColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","_jflow","_target","link","_getMovingTarget","dispatchEvent","CustomEvent","detail","uniqueName","keys","k","anchor","rect","customEvent","bubbles","bubbleEvent","calculateToRealWorld","remove","belongs","recalculateUp","EventTarget","LinkPolyline","from","to","conrolNodes","controlPoint","defaultStyle","hoverStyle","start","calculateIntersectionInFourDimension","getCenter","end","status","hover","_calculateAnchorPoints","diffDIR","mid","fillStyle","strokeStyle","getColor","beginPath","moveTo","lineTo","stroke","endP","closePath","fill","lx","rx","by","ty","StackMixin","instances","links","_stack","_linkStack","initStack","addToStack","replaceFromStack","target","index","findIndex","addToLinkStack","removeFromStack","removeFromLinkStack","emptyLink","resetChildrenPosition","addInstanceToLink","targetLink","_constuctor","__proto__","constructor","l1","interateNodeStack","callback","LayoutMixin","_layout","initLayout","layout","dirty","getBoundingDimension","wold","hold","_getBoundingGroupRect","reflow","wnow","hnow","recalculate","staticCheck","MessageMixin","_message","sendMessage","msg","consumeMessage","readMessage","JFlowEvent","event","originEvent","jflow","Node","_rawConfigs","C","BaseLink","fromDir","toDir","_cachePoints","Point","type","radius","radiusExpo2","globalAlpha","arc","lineWidth","ltx","lty","rbx","rby","x1","y1","x2","y2","vecx","vecy","dist","sqrt","ratio","allIntersections","interDir","Rectangle","borderRadius","_setBorder","border","color","enable","right","bottom","xt","yt","quadraticCurveTo","clip","h","theta1","theta2","dirx","diry","calculateToCoordination","GroupMixin","initGroup","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","definedWidth","minWidth","definedHeight","lock","setConfig","getBoundingRectPoints","bbox","renderGroup","centerX","centerY","translate","_calculatePointBack","gx","gy","isHitGroup","_currentp","checkHit","cx","cy","clone","RectangleGroup","Capsule","hw","hh","leftCenter","rightCenter","ww","rr","CapsuleGroup","Diamond","side","_cacheSide","sinSIDE","sin","cosSIDE","cos","xx","inside","len","xi","yi","xj","yj","intersect","backsqrt3","DiamondGroup","createInputElement","input","setAttribute","TEXT_ALIGN","CENTER","Text","content","fontFamily","fontSize","textColor","textAlign","textBaseline","lineHeight","indent","editable","acceptPatten","editStatus","editting","renderShadowText","_makeEditable","addEventListener","exec","offsetX","offsetY","inputElement","DOMwrapper","oldVal","transform","calculateToRealWorldWithScalar","textIndent","_render","outline","blurHandler","val","removeEventListener","removeChild","keyUpHandler","e","keyCode","preventDefault","focus","font","measureText","actualBoundingBoxLeft","actualBoundingBoxRight","fontBoundingBoxAscent","fontBoundingBoxDescent","_textWidth","fillText","Icon","image","onload","requestAnimationFrame","imageBounding","imageWidth","imageHeight","drawImage","Link","controlPoints","_isTargeting","calculateIntersection","startX","startY","a","PIINRATIO","BezierLink","approximate","lineDash","doubleLink","dmsfrom","getIntersectionsInFourDimension","dmsto","_cacheAngle","meta","fromP","toP","distMin","df","pf","dt","pt","beginAngle","rotate","bezierCurveTo","setLineDash","LinearLayout","direction","gap","alignment","justify","group","stack","filter","outOfFlow","groupWidth","reduceHeight","lastInstanceHeight","maxWidth","allHeight","reduceWidth","lastInstanceWidth","maxHeight","allWidth","withdraw","gapAverage","BaseNode","source","id","isDraggable","getJflowInstance","level","sequence","isLocked","isFree","parent","parentIterateType","_getAstNode","spanX","spanY","console","log","nodes","traverse","Root","isroot","body","map","mapFunc","playgrounditerator","playground","reflowPreCalculate","preCallback","node","last","part","makeLink","IfStatement","consequent","alternate","c_spanX","c_spanY","a_spanX","a_spanY","nextSequeence","Endpoint","lastc","lasta","makeAST","linkMeta","unshift","SwitchStatement","cases","lastCase","cc","s_spanX","s_spanY","ca","ForEachStatement","WhileStatement","anticlock","SwitchCase","TYPE_MAPPING","other","makeEndpoint","Constructor","LowcodeLayout","linkLength","treeItemDraggable","reOrder","ast","static","flowStack","flowLinkStack","root","layoutMeta","currentTopNodeId","layoutMapping","vertical","horizontal","playgroundLayoutMapping","reflowBodyPreCalculate","reflowPlaygroundPreCalculate","topNode","finded","find","nowAnchor","currentAnchor","verticalMapping","horizontalMapping","columnNumber","column","rowWidth","rows","rowNumber","row","rowHeight","columns","reflowByMapping","values","mapping","ERProperty","isNavigation","ref","association","_selfLink","parentPropertyRef","doubleRef","ERNode","propertyList","navigationPropertyList","idProperty","nodeMap","idRef","isParentRef","parentRef","objectRef","targetProperty","toProperty","isObjectRef","makeER","_traverseProperty","ERLayout","erNodes","entityRelationship","er","idMap","id1","id2","fromMeta","lineMapping","size","computeNodeAnchor","recorded","relativeAnchor","diagramWeight","nx","ny","JFlow","dpr","maxZoom","minZoom","offeset","_lastState","dragging","processing","_lastDragState","moving","isInstanceDirty","isLinkDirty","cache","initialX","initialY","dragovering","_focus","_dragOverTarget","allowDrop","_tempInstance","dom","c_width","c_height","canvasMeta","actual_width","actual_height","_createEventHandler","p_width","p_height","contentBox","w_ratio","h_ratio","align","scaleRatio","nowx","nowy","destroyListener","zoomHandler","_onZoom","pressStartHandler","_onPressStart","pressMoveHandler","_onPressMove","pressUpHandler","_onPressUp","pressUpDocument","_onPressUpDocument","contextmenuHandler","_onContextMenu","destroyPlainEventListener","dragoverHandler","_onDragover","dropHandler","_onDrop","destroy","offsetPoint","topLayerPoint","linkStack","movingtarget","getNodes","oldIns","_targetLockOn","_processDragOver","payload","clientX","clientY","_zooming","deltaY","newScale","amount","deltaScale","currentWidth","currentHeight","deltaWidth","deltaHeight","tX","tY","pX","pY","button","cursor","deltaX","_recalculatePosition","isDocument","stopPropagation","_clearTarget","checkresult","removeTempDraggingInstance","setTransform","_resetTransform","provide","getInstanceByJFlowId","methods","jflowId","obj","_jflowInstance","onStackChangeHandler","mixins","renderJFlow","addNameToRootStack","props","default","vnodes","$scopedSlots","vnode","componentInstance","$children","vlinks","$slots","created","mounted","$nextTick","$mount","$el","$listeners","func","layoutNodes","getInstance","nameNode","bulder","JFlowInstance","inject","Boolean","String","watch","JSON","stringify","news","deletes","vnew","handler","vold","hnew","bindListeners","destroyed","isLink","resetLink","fromInstance","toInstance","$vnode","addToBelongStack","removeFromBelongStack","updated","JFLOW_NODES","JFLOW_LINKS","JFLOW_GROUPS","components","component","JFlowComponent","JFLowGroup","JFlowLink","componentPrefix","install","Vue","options","prefixToUse","prefix","custom","_vm","_h","$createElement","_c","_self","class","$style","attrs","sidebar","on","onDragStartRectangle","_v","onDragStartPoint","staticStyle","onClickNoWhere","onDrop","onPressEnd","scopedSlots","_u","fn","$event","onPressStart","onOutOfFlow","onChangeContent","onToggleSelect","onDropToLink","hoverblock","_l","onSelectLogic","_s","_e","domProps","prettyJson","staticRenderFns","_g","groupConfig","onContentChange","switchcase","headerConfigs","imageConfig","contentConfigs","onClick","params","paramsConfigs","param","onDragOver","onDragOverEnd","injectStyles","context","locals","config","productionTip","use","JFlowVuePlugin","App"],"mappings":"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","file":"js/app.a26271d5.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","\n/**\n * @typedef {Object} CanvasMeta\n * @property {Element} canvas - canvas 元素\n * @property {number} width - 画布宽度\n * @property {number} height - 画布高度\n * @property {number} raw_width - 画布元素宽度\n * @property {number} raw_height - 画布元素高度\n * @property {number} left - 画布距离左端距离\n * @property {number} top - 画布距离顶端距离\n * @property {Context2d} ctx - Context2d\n * @property {number} scale - 当前的像素设备比\n */\n/**\n * 创建一个 canvas 元素\n * @param  {Element} wrapper - dom元素\n * @return {CanvasMeta}\n */\nexport function createCanvas(wrapper) {\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n    const { width, height, left, top } = wrapper.getBoundingClientRect();\n    canvas.style.width = width + \"px\";\n    canvas.style.height = height + \"px\";\n    canvas.style.userSelect = 'none';\n    const scale = window.devicePixelRatio;\n    canvas.width = Math.floor(width * scale);\n    canvas.height = Math.floor(height * scale);\n\n    if(wrapper) {\n        wrapper.style.position = 'relative';\n        wrapper.append(canvas);\n    }\n    return {\n        canvas,\n        width,\n        height,\n        raw_width: canvas.width,\n        raw_height: canvas.height,\n        left,\n        top,\n        ctx,\n        scale,\n    }\n}\n\nconst caheCanvas = document.createElement('canvas');\ncaheCanvas.width = 1;\ncaheCanvas.height = 1;\nconst caheCanvasctx = caheCanvas.getContext('2d');\nconst scale = window.devicePixelRatio;\ncaheCanvasctx.scale(scale, scale);\n\n/**\n * 在离线canvas上绘制元素\n * @param  {render} render - 绘图函数\n */\nexport function requestCacheCanvas(render) {\n    caheCanvasctx.clearRect(0,0,5,5);\n    caheCanvasctx.save();\n    render(caheCanvasctx);\n    caheCanvasctx.restore();\n    caheCanvasctx.clearRect(0,0,5,5);\n}","/**\n * 方向\n * @readonly\n * @enum {number}\n */\nexport const DIRECTION = {\n    /** RIGHT */\n    RIGHT: 0,\n    /** BOTTOM */\n    BOTTOM: 1,\n    /** LEFT */\n    LEFT: 2,\n    /** TOP */\n    TOP: 3\n}\n\nexport function nextDirection(direction, clockwise) {\n    const nextDir = (direction + (clockwise ? 1 : -1)) % 4;\n    return nextDir;\n}\n\nexport function oppositeDirection(direction) {\n    return (direction + 2) % 4\n}\n\nexport const APPROXIMATE = 6;","import {\n    Bezier,\n} from 'bezier-js';\nimport { DIRECTION } from './constance';\n\n/**\n * 根据点计算最小外接矩形\n * @param {number[][]} points - 点集合\n * @return {Object} demension 宽高，坐标\n */\nexport function bounding_box(points) {\n    let min_x = Infinity; \n    let min_y = Infinity; \n    let max_x = -Infinity; \n    let max_y = -Infinity; \n    for(let idx in points) {\n        const item = points[idx];\n        if(item[0] < min_x){\n            min_x = item[0]\n        }\n\n        if (item[0] > max_x) {\n            max_x = item[0]\n        } \n\n        if (item[1] < min_y) {\n            min_y = item[1]\n        }\n\n        if (item[1] > max_y) {\n            max_y = item[1]\n        }\n    }\n    return {\n        // points: [(min_x,min_y),(max_x,min_y),(max_x,max_y),(min_x,max_y)],\n        width: Math.max(max_x - min_x, 10),\n        height: Math.max(max_y - min_y, 10),\n        x: min_x,\n        y: min_y,\n    }\n}\n\nfunction sqr(x) {\n    return x * x;\n}\nexport function dist2(v, w) {\n    return sqr(v[0] - w[0]) + sqr(v[1] - w[1]);\n}\n\n// p - point\n// v - start point of segment\n// w - end point of segment\nexport function distToSegmentSquared(p, v, w) {\n    const l2 = dist2(v, w);\n    if (l2 === 0) return dist2(p, v);\n    let t = ((p[0] - v[0]) * (w[0] - v[0]) + (p[1] - v[1]) * (w[1] - v[1])) / l2;\n    t = Math.max(0, Math.min(1, t));\n    return dist2(p, [ v[0] + t * (w[0] - v[0]), v[1] + t * (w[1] - v[1]) ]);\n}\n\n\n// export function bezierPoints(p1, p2, start_dir = DIRECTION.TOP, end_dir = DIRECTION.TOP, anticlock = false) {\n//     const isSameDirection = start_dir === end_dir;\n//     const isVerticalStart = [DIRECTION.TOP, DIRECTION.BOTTOM].includes(start_dir);   \n//     const isVerticalEnd = [DIRECTION.TOP, DIRECTION.BOTTOM].includes(end_dir);\n//     const arrowspan = [DIRECTION.TOP, DIRECTION.LEFT].includes(end_dir) ? -5 : 5;\n//     const endX = isVerticalEnd ? p2[0] : p2[0] + arrowspan;\n//     const endY = isVerticalEnd ? p2[1] + arrowspan : p2[1];\n//     if(isSameDirection) {\n//         let span = Math.abs(isVerticalStart ? (endY - p1[1]) : (endX - p1[0]))\n//         span = Math.min(span, 50);\n//         const symb = [DIRECTION.RIGHT, DIRECTION.BOTTOM].includes(end_dir)\n//         span = symb ? span : - span;\n//         const cp1 = isVerticalStart ? [p1[0], p1[1] + span] : [p1[0] + span, p1[1]];\n//         const cp2 = isVerticalEnd ? [endX, endY + span] : [endX + span, endY];\n//         return [ \n//             ...cp1,\n//             ...cp2,\n//             endX, endY ];\n//     }\n//     let spanStart = (anticlock ? -5 : 1) * (isVerticalStart ? (endY - p1[1]) / 2 : (endX - p1[0]) / 2)\n//     let spanEnd = (anticlock ? -4 : 1) * (isVerticalEnd ? (p1[1] - endY) / 2 : (p1[0] - endX) / 2)\n//     let u1 = spanStart / Math.abs(spanStart);\n//     spanStart = u1 * Math.min(Math.abs(spanStart), 50);\n//     let u2 = spanEnd / Math.abs(spanEnd);\n//     spanEnd = u2 * Math.min(Math.abs(spanEnd), 50);\n//     const cp1 = isVerticalStart ? [p1[0], p1[1] + spanStart] : [p1[0] + spanStart, p1[1]];\n//     const cp2 = isVerticalEnd ? [endX, endY + spanEnd] : [endX + spanEnd, endY];\n//     return [ \n//         ...cp1,\n//         ...cp2,\n//         endX, endY ];\n// }\nfunction _resolveControlPoint(p, dir, spanx, spany){\n    if(dir === DIRECTION.TOP){\n        return [p[0], p[1]-spany]\n    }\n    if(dir === DIRECTION.BOTTOM){\n        return [p[0], p[1]+spany]\n    }\n    if(dir === DIRECTION.LEFT){\n        return [p[0]-spanx, p[1]]\n    }\n    if(dir === DIRECTION.RIGHT){\n        return [p[0]+spanx, p[1]]\n    }\n}\n\nexport function bezierPoints(p1, p2, start_dir = DIRECTION.TOP, end_dir = DIRECTION.TOP, minSpanX = 0, minSpanY = 0) {\n    const spanx = Math.max(Math.abs((p1[0] - p2[0])/2), minSpanX);\n    const spany = Math.max(Math.abs((p1[1] - p2[1])/2), minSpanY);\n    const cp1 = _resolveControlPoint(p1, start_dir, spanx, spany);\n    const cp2 = _resolveControlPoint(p2, end_dir, spanx, spany);\n    const arrowspan = [DIRECTION.TOP, DIRECTION.LEFT].includes(end_dir) ? -5 : 5;\n    const isVerticalEnd = [DIRECTION.TOP, DIRECTION.BOTTOM].includes(end_dir);\n    const endX = isVerticalEnd ? p2[0] : p2[0] + arrowspan;\n    const endY = isVerticalEnd ? p2[1] + arrowspan : p2[1];\n    return [ \n        ...cp1,\n        ...cp2,\n        endX, endY];\n}\n\nexport function bezierPoint(t, P) {\n    const q = 1-t;\n    const x = q*q*q*P[0] + 3*q*q*t*P[2] + 3*q*t*t*P[4] + t*t*t*P[6];\n    const y = q*q*q*P[1] + 3*q*q*t*P[3] + 3*q*t*t*P[5] + t*t*t*P[7];\n    const u = q*q*(P[2]-P[0]) + 2*t*q*(P[4]-P[2]) + t*t*(P[6]-P[4]);\n    const v = q*q*(P[3]-P[1]) + 2*t*q*(P[5]-P[3]) + t*t*(P[7]-P[5]);\n    let angle = Math.atan2(v, u);\n    // console.log(angle * 180)\n    // if(angle < 0) {\n    //     angle = Math.PI + angle;\n    // }\n    return [x, y, angle];\n}\n\nexport function polylinePoints(p1, p2, start_dir = DIRECTION.RIGHT, end_dir = DIRECTION.TOP) {\n\n}\n\n// export function bezierPoints(p1, p2, start_vec, end_vec) {\n\n// }\n\nexport function distToBezierSegmentSquared(p, points) {\n    const b = new Bezier(...points);\n\n    const point = b.project({ x: p[0], y: p[1] });\n    const d = dist2(p, [ point.x, point.y ]);\n    return d;\n}\n\nexport function getBezierAngle(t, sx, sy, cp1x, cp1y, cp2x, cp2y, ex, ey) {\n  var dx = Math.pow(1-t, 2)*(cp1x-sx) + 2*t*(1-t)*(cp2x-cp1x) + t * t * (ex - cp2x);\n  var dy = Math.pow(1-t, 2)*(cp1y-sy) + 2*t*(1-t)*(cp2y-cp1y) + t * t * (ey - cp2y);\n  return -Math.atan2(dx, dy) + 0.5*Math.PI;\n}\n\n\nexport function getInstanceHeight(instance) {\n    const rect = instance.getBoundingRect();\n    let min_y = Infinity;\n    let max_y = -Infinity;\n    let min_x = Infinity;\n    let max_x = -Infinity;\n    rect.forEach(point => {\n        max_y = Math.max(max_y, point[1]);\n        min_y = Math.min(min_y, point[1]);\n        max_x = Math.max(max_x, point[0]);\n        min_x = Math.min(min_x, point[0]);\n    });\n    return {\n        height: max_y - min_y,\n        width: max_x - min_x,\n    }\n}","/**\n * 绘图栈\n * @extends Array\n */\nclass InstanceStack extends Array {\n    constructor() {\n        super();\n    }\n    /**\n     * 绘制当前栈\n     * @param {Context2d} ctx - canvas context2d\n     */\n    render(ctx) {\n        let movingTarget;\n        this.forEach(instance => {\n            if(instance._isMoving) {\n                movingTarget = instance;\n                return;\n            }\n            if(instance.visible) {\n                ctx.save();\n                // if(instance.reflow && !instance._reflowed) {\n                //     instance.reflow();\n                //     instance._reflowed = true;\n                // }\n                instance.render(ctx);\n                ctx.restore();\n            }\n        });\n        if(movingTarget) {\n            ctx.save();\n            // if(movingTarget.reflow && !movingTarget._reflowed) {\n            //     movingTarget.reflow();\n            //     movingTarget._reflowed = true;\n            // }\n            movingTarget.render(ctx);\n            ctx.restore();\n        }\n    }\n\n    /**\n     * 碰撞对象过滤条件\n     * @name InstanceStack~InstanceFilter\n     * @function\n     * @param {Instance} instance - 当前对象\n    */\n    /**\n     * 碰撞检测\n     * @param {number[]} point - 碰撞点\n     * @param {InstanceStack~InstanceFilter} condition - 碰撞对象过滤条件\n     * @return {Instance}\n     */\n    checkHit(point, condition){\n        let i = this.length - 1;\n        while(i >= 0) {\n            const instance = this[i];\n            \n            if(instance.visible && !instance.ignoreHit) {\n                if(condition && condition(instance)) {\n                    i--\n                    continue;\n                }\n                const ishit = instance.isHit(point, condition);\n                instance._isHit = !!ishit;\n                if(ishit) {\n                    if(typeof ishit !== 'boolean') {\n                        return ishit;\n                    }\n                    return instance;\n                }\n                \n            }\n            i--\n        }\n\n        return null;\n    }\n    /**\n     * 获取当前层栈的最小外接矩形\n     * @return {number[][]} - 外接矩形坐标\n     */\n    getBoundingRectPoints() {\n        const points = [];\n        this.forEach(instance => {\n            if(instance.visible) {\n                points.splice(points.length, 0, ...instance.getBoundingRect());\n            }\n        });\n        return points;\n    }\n}\n\nexport default InstanceStack;\n","import { setUniqueId, getUniqueId } from '../utils/functions';\nimport { nextDirection } from '../utils/constance';\nconst margin = 5;\nconst ishitKey = Symbol('ishit');\n/**\n * @typedef Instance~Configs\n * @type {object}\n * @property {number} borderWidth      - 边的宽度 默认是 2\n * @property {string} borderColor      - 边框颜色 默认 black\n * @property {string} color            - 填充颜色 默认 white\n * @property {string} shadowColor      - 阴影颜色\n * @property {string} shadowBlur       - 阴影扩散范围\n * @property {string} shadowOffsetX    - 阴影偏移 X\n * @property {string} shadowOffsetX    - 阴影偏移 Y\n */\n\n/** \n * 图中的最小单元\n * @constructor Instance\n * @extends EventTarget\n * @param {Instance~Configs} configs - 最小单元的一些通用属性配置\n */\nclass Instance extends EventTarget{\n    constructor(configs = {}) {\n        super();\n        Object.assign(this, configs);\n        // this.anchor = configs.anchor || [0, 0];\n        // this.belongs = undefined;\n        /** \n         * @property {number} visible      - 元素可见 默认 true\n         */\n        this.visible = true;\n        // this._jflow = undefined;\n        this._belongs = undefined;\n        this[ishitKey] = false; \n\n        /** layout 抽象节点关联属性 */\n        this._layoutNode = undefined;\n\n        /**\n         * 通用样式属性\n         * @property {number} borderWidth      - 边的宽度 默认是 2\n         * @property {string} borderColor      - 边框颜色 默认 black\n         * @property {string} backgroundColor  - 填充颜色 默认 white\n         * @property {string} shadowColor      - 阴影颜色\n         * @property {string} shadowBlur       - 阴影扩散范围\n         * @property {string} shadowOffsetX    - 阴影偏移 X\n         * @property {string} shadowOffsetX    - 阴影偏移 Y\n         */\n        this.borderWidth =      configs.borderWidth || 0;\n        this.borderColor =      configs.borderColor || 'transparent';\n        // this.hoverStyle =       configs.hoverStyle || 'transparent';\n        this.backgroundColor =  configs.backgroundColor || 'transparent';\n        this.shadowColor =      configs.shadowColor;\n        this.shadowBlur  =      configs.shadowBlur || 5;\n        this.shadowOffsetX =    configs.shadowOffsetX || 0;\n        this.shadowOffsetY =    configs.shadowOffsetY || 0;\n\n    }\n    /**\n     * @property {boolean} _isTargeting - 当前单元选中状态\n     */\n    get _isTargeting() {\n        return this === (this._jflow._target.instance || this._jflow._target.link);\n    }\n    /**\n     * @property {boolean} _isMoving - 当前单元移动状态\n     */\n    get _isMoving() {\n        return this === this._jflow._getMovingTarget();\n    }\n    /**\n     * @property {boolean} _isHit  - 当前单元碰撞检测状态\n     */\n    get _isHit() {\n        return this[ishitKey];\n    }\n    /**\n     * @property {JFlow} _jflow -     * canvas上 jflow 实体\n     */\n    get _jflow() {\n        return this._belongs.uniqueName === 'jflow' ? this._belongs : this._belongs._jflow;\n    }\n\n    set _isHit(ishit) {\n        if(this[ishitKey] !== ishit) {\n            /**\n             * 鼠标移入事件\n             *\n             * @event Instance#mouseenter\n             * @type {object}\n             * @property {Instance} instance      - 移入的对象 \n             */\n            /**\n             * 鼠标移出事件\n             *\n             * @event Instance#mouseleave\n             * @type {object}\n             * @property {Instance} instance      - 移入的对象 \n             */\n            this.dispatchEvent(new CustomEvent(ishit ? 'mouseenter': 'mouseleave' , {\n                detail: {\n                    instance: this,\n                }\n            }));\n        }\n        this[ishitKey] = ishit; // validation could be checked here such as only allowing non numerical values\n    }\n\n    /**\n     * 改变当前配置\n     * @param {Configs} configs - The string containing two comma-separated numbers.\n     */\n    setConfig(configs) {\n        Object.keys(configs).forEach(k => {\n            if(configs[k] !== undefined && configs[k] !== null) {\n                this[k] = configs[k]\n            }\n        })\n    }\n    /**\n     * 绘制单元\n     * @param {Context2d} ctx \n     */\n    render(ctx) {\n        throw 'require render implement'\n    }\n    /**\n     * 判断当前单元是否被命中\n     * @param {number[]} point \n     * @return {Boolean}\n     */\n    isHit(point) {\n        throw 'require isHit implement'\n    }\n    /**\n     * 计算当前的最大外接矩形的\n     * @return {number[][]} [lefttop: [number,number], rightbottom: [number, number]]\n     */\n    getBoundingRect() {\n        throw 'require getBoundingRect implement'\n    }\n    calculateIntersection() {\n        throw 'require calculateIntersection implement'\n    }\n    /**\n     * 计算当前连线接入点的位置\n     * @return {Object} intersection 交叉点\n     * @return {number} intersection[DIRECTION.TOP] 上\n     * @return {number} intersection[DIRECTION.BOTTOM] 下\n     * @return {number} intersection[DIRECTION.LEFT] 上\n     * @return {number} intersection[DIRECTION.RIGHT] 右\n     */\n    getIntersectionsInFourDimension() {\n        throw 'require getIntersectionsInFourDimension implement'\n    }\n\n\n    /**\n     * 获取当前所在层级的坐标\n     * @return {Number[]} 坐标\n     */\n    getCenter() {\n        return this.anchor;\n    }\n    /**\n     * 获取宽高\n     * @return {Object} demension 宽高\n     * @return {number} demension.width 宽\n     * @return {number} demension.height 高\n     */\n    getBoundingDimension() {\n        const rect = instance.getBoundingRect();\n        let min_y = Infinity;\n        let max_y = -Infinity;\n        let min_x = Infinity;\n        let max_x = -Infinity;\n        rect.forEach(point => {\n            max_y = Math.max(max_y, point[1]);\n            min_y = Math.min(min_y, point[1]);\n            max_x = Math.max(max_x, point[0]);\n            min_x = Math.min(min_x, point[0]);\n        });\n        return {\n            height: max_y - min_y,\n            width: max_x - min_x,\n        }\n    }\n    /**\n     * 冒泡事件\n     * @param {JFlowEvent} customEvent 自定义事件\n     */\n    bubbleEvent(customEvent){\n        this.dispatchEvent(customEvent);\n        if(customEvent.detail.bubbles){\n            if(this._belongs.bubbleEvent) {\n                this._belongs.bubbleEvent(customEvent);\n            } else {\n                this._belongs.dispatchEvent(customEvent); \n            }\n            \n        }\n    }\n    /**\n     * 反算回页面的像素坐标\n     * @param {Number[]} point\n     * @return {Number[]} 世界坐标\n     */\n    calculateToRealWorld(point) {\n        if(this._belongs && this._belongs.calculateToRealWorld) {\n            return this._belongs.calculateToRealWorld(point);\n        } else {\n            return point;\n        }\n    }\n\n    calculateToRealWorldWithScalar(length){\n        return this._jflow.scale * length;\n    }\n\n    /**\n     * 从当前布局中删除虚拟布局节点\n     */\n    removeFromLayoutSource() {\n        if(this._layoutNode) {\n            this._layoutNode.remove();\n        }\n    }\n\n    recalculateUp() {\n        if(this.belongs) {\n            this.belongs.recalculateUp();\n        }\n    }\n}\n\nexport default Instance;","import Instance from './instance';\nimport { DIRECTION, APPROXIMATE } from '../utils/constance';\nclass LinkPolyline extends Instance {\n    constructor(configs) {\n        super(configs);\n        this.from   = configs.from; // Instance\n        this.to     = configs.to;   // Instance\n        this.conrolNodes = [];\n        this.controlPoint = [];\n        this.defaultStyle = 'black';\n        this.hoverStyle = 'cornflowerblue';\n    }\n\n\n    _calculateAnchorPoints() {\n        const start = this.from.calculateIntersectionInFourDimension(this.to.getCenter());\n        const end = this.to.calculateIntersectionInFourDimension(this.from.getCenter());\n        return {\n            start,\n            end\n        }\n    }\n\n    getColor() {\n        if(this.status.hover) {\n            return this.hoverStyle;\n        }\n        return this.defaultStyle;\n    }\n\n    render(ctx) {\n        const { start, end } = this._calculateAnchorPoints();\n        const diffDIR = Math.abs(start.dir - end.dir);\n        let controlPoint = [start.p];\n        if(diffDIR === 1 || diffDIR === 3) {\n            // 证明只需要一个控制点\n            if(start.dir % 2 === 1) {\n                controlPoint.push([end.p[0], start.p[1]]);\n            } else {\n                controlPoint.push([start.p[0], end.p[1]]);\n            }\n\n        } else {\n            if(start.dir % 2 === 1) {\n                if(start.p[1] !== end.p[1] ) {\n                    const mid = (start.p[0] - end.p[0]) /2 + end.p[0]\n                    controlPoint.push([ mid, start.p[1] ]);\n                    controlPoint.push([ mid, end.p[1] ]);\n                }\n            } else {\n                if(start.p[0] !== end.p[0] ) {\n                    const mid = (start.p[1] - end.p[1]) /2 + end.p[1]\n                    controlPoint.push([ start.p[0], mid ]);\n                    controlPoint.push([ end.p[0], mid ]);\n                }\n            }\n        }\n        controlPoint.push(end.p);\n        this.controlPoint = controlPoint;\n        ctx.fillStyle = ctx.strokeStyle = this.getColor();\n        ctx.beginPath();\n        for (let i = 0; i < controlPoint.length; i ++) {\n            const [x, y] = controlPoint[i];\n            if (i === 0) ctx.moveTo(x, y);\n            else ctx.lineTo(x, y);\n        }\n        ctx.stroke();\n        ctx.beginPath();\n        const endP = end.p;\n        ctx.moveTo(endP[0], endP[1]);\n\n        switch (end.dir) {\n            case DIRECTION.TOP:\n                ctx.lineTo(endP[0] - 5, endP[1] - 10)\n                ctx.lineTo(endP[0] + 5, endP[1] - 10)\n                break;\n            case DIRECTION.BOTTOM:\n                ctx.lineTo(endP[0] + 5, endP[1] + 10)\n                ctx.lineTo(endP[0] - 5, endP[1] + 10)\n                break;\n            case DIRECTION.RIGHT:\n                ctx.lineTo(endP[0] + 10, endP[1] + 5)\n                ctx.lineTo(endP[0] + 10, endP[1] - 5)\n                break;\n            case DIRECTION.LEFT:\n                ctx.lineTo(endP[0] - 10, endP[1] - 5)\n                ctx.lineTo(endP[0] - 10, endP[1] + 5)\n                break;\n            default:\n                break;\n        }\n        ctx.closePath();\n        ctx.fill();\n        ctx.stroke();\n    }\n\n    isHit(point) {\n        const controlPoint = this.controlPoint;\n        let [sx, sy] = controlPoint[0];\n        for (let i = 1; i < controlPoint.length; i ++) {\n\n            const [ex, ey] = controlPoint[i];\n            let lx, rx, by, ty;\n            if(sx === ex) {\n                lx = sx - APPROXIMATE;\n                rx = sx + APPROXIMATE;\n                by = Math.max(sy, ey);\n                ty = Math.min(sy, ey);\n            }\n            if(sy === ey) {\n                ty = sy - APPROXIMATE;\n                by = sy + APPROXIMATE;\n                rx = Math.max(sx, ex);\n                lx = Math.min(sx, ex);\n            }\n            if(point[0] > lx \n                && point[0] < rx \n                && point[1] > ty \n                && point[1] < by) {\n                    return true;\n                }\n            sx = ex;\n            sy = ey;\n        } \n        return false;\n    }\n\n    getBoundingRect() {\n        const { start, end } = this._calculateAnchorPoints(); \n        return [start.p, end.p]\n    }\n}\n\nexport default LinkPolyline;","import InstanceStack from './stack';\n// import Link from './link';\nimport Link from './polyline-link';\nimport { setUniqueId, getUniqueId } from '../utils/functions';\n/**\n * 对象栈 mixin 用于方便控制节点栈和连线栈\n *\n * @mixin\n */\nconst StackMixin = {\n    instances: [],\n    links: [],\n    _stack: null,\n    _linkStack: null,\n    /**\n     * 初始化对象栈\n     * @param {JflowConfigs} configs - 配置\n     */\n    initStack({ data }) {\n        this._stack = new InstanceStack();\n        this._linkStack = new InstanceStack();\n        if(!data) return;\n        this.instances = data.instances;\n        this.links = data.links;\n        this.instances.forEach(i => { \n            this._stack.push(i);\n            i._belongs = this;\n        })\n        this.links.forEach((link) => {\n            this._linkStack.push(link);\n            link._belongs = this;\n        });\n    },\n    /**\n     * 加入节点对象\n     * @param {Node} instance - 节点对象\n     */\n    addToStack(instance) {\n        instance._belongs = this;\n        this._stack.push(instance);\n        // this.recalculate()\n    },\n    /**\n     * 替换对象\n     * @param {Instance} target - 被替换的对象\n     * @param {Instance} instance - 替换对象\n     */\n    replaceFromStack(target, instance) {\n        const index = this._stack.findIndex(i => i === target);\n        this._stack.splice(index, 1, instance);\n        target._belongs = null;\n        instance._belongs = this;\n        // this.recalculate()\n    },\n    /**\n     * 加入连线对象\n     * @param {BaseLink} instance - 连线对象\n     */\n    addToLinkStack(link) {\n        link._belongs = this;\n        this._linkStack.push(link);\n    },\n    /**\n     * 删除节点对象\n     * @param {Node} target - 节点对象\n     */\n    removeFromStack(target) {\n        // this.removeLinkOnInstance(target);\n        const index = this._stack.findIndex(i => i === target);\n        this._stack.splice(index, 1);\n        // this.recalculate()\n    },\n    /**\n     * 删除连线对象\n     * @param {Node} target - 连线对象\n     */\n    removeFromLinkStack(target) {\n        const index = this._linkStack.findIndex(i => i === target);\n        this._linkStack.splice(index, 1);\n    },\n   \n    emptyLink() {\n        this._linkStack = new InstanceStack();\n    },\n    /**\n     * 重置当前栈中对象的位置\n     */\n    resetChildrenPosition() {\n        this._stack.forEach(i => {\n            i.anchor = [0,0]\n        });\n    },\n    /* \n        还是丢给实现方去处理，这个不属于框架自带的通用逻辑\n    removeLinkOnInstance(target) {\n        const fromInstances = [];\n        const toInstances = [];\n        const removelinks = [];\n        let _constuctor;\n        this._linkStack.forEach(l => {\n            if(l.from === target){\n                toInstances.push(l.to);\n                _constuctor = l.__proto__.constructor;\n                removelinks.push(l);\n            }\n            if(l.to === target){\n                fromInstances.push(l.from);\n                _constuctor = l.__proto__.constructor;\n                removelinks.push(l);\n            }  \n        })\n        \n        removelinks.forEach(l => {\n            this.removeFromLinkStack(l);\n        });\n        // 暂且全连接吧\n        fromInstances.forEach(f => {\n            toInstances.forEach(t => {\n                this.addToLinkStack(new _constuctor({\n                    from: f, \n                    to: t\n                }))\n            });\n        });\n        return {\n            fromInstances,\n            toInstances,\n            removelinks,\n        }\n    }, */ \n\n    addInstanceToLink(targetLink, instance) {\n        this.addToStack(instance);\n        const { from, to } = targetLink;\n        const index = this._linkStack.findIndex(l => l === targetLink);\n        const _constuctor = targetLink.__proto__.constructor;\n        const l1 = new _constuctor({\n            from, \n            to: instance,\n        });\n        l1._belongs = this;\n        const l2 = new _constuctor({\n            from: instance, \n            to,\n        });\n        l2._belongs = this;\n\n        this._linkStack.splice(index, 1, l1, l2);\n    },\n    // reLayout() {\n    //     this.reflow();\n    //     this._getBoundingGroupRect();\n    //     if(this._belongs) {\n    //         this._belongs.reLayout();\n    //     }\n    // }\n    // addToTempStack(instance) {\n    //     this._tempStack.push(instance);\n    // },\n\n    // truncateTempStack() {\n    //     let temp;\n    //     if(this._tempStack) {\n    //         temp = this._tempStack.slice();\n    //     }\n    //     this._tempStack = new InstanceStack();\n    //     return temp;\n    // }\n\n    /**\n     * 循环当前栈中节点\n     * @property {stackIteratorCallback} 循环访问栈中每个节点\n     */\n    interateNodeStack(callback) {\n        this._stack.forEach(instance => {\n            callback(instance);\n        })\n    }   \n    /**\n    * 循环访问栈中每个节点\n    * @callback stackIteratorCallback\n    * @param {Node} instance 栈中节点\n    */\n}\n\nexport default StackMixin;","/**\n * Layout mixin 配置\n * @typedef {Object} LayoutMixin~LayoutConfigs\n * @property {Layout} layout             - 布局对象 \n */\n/**\n * 布局 mixin 用于注册和方便控制布局\n *\n * @mixin\n */\nconst LayoutMixin = {\n    _layout: null,\n    // _reflowed: false,\n    /**\n     * 初始化布局\n     * @param {LayoutMixin~LayoutConfigs} configs - 配置\n     */\n    initLayout(configs) {\n        this._layout = configs.layout;\n    },\n    /**\n     * 从当前层出发，向上层递归重排\n     */\n    recalculateUp() {\n        let dirty = true;\n        if(this.getBoundingDimension) {\n            const { width: wold, height: hold } = this.getBoundingDimension();\n            if(this.resetChildrenPosition) {\n                this.resetChildrenPosition();\n            }\n            if(this._getBoundingGroupRect){\n                this._getBoundingGroupRect();\n            }\n            this.reflow();\n            if(this._getBoundingGroupRect){\n                this._getBoundingGroupRect();\n            }\n            const { width: wnow, height: hnow } = this.getBoundingDimension();\n            dirty = (wold !== wnow || hold !== hnow)\n        } else {\n            this.reflow();\n        }\n        if(this._belongs && dirty) {\n            this._belongs.recalculateUp();\n        }\n    },\n    /**\n     * 重新计算布局，相当于浏览器里面重排，并重算当前布局下的最小外接矩形\n     */\n    recalculate() {\n        // this._reflowed = true;\n        this.reflow();\n        if(this._getBoundingGroupRect){\n            this._getBoundingGroupRect();\n        }\n        // 这个地方到底是手动还是自动？自动时机再试试看好了\n        // if(this._belongs) {\n        //     this._belongs.recalculate();\n        // }\n    },\n    /**\n     * 布局静态检查\n     * @param {Instance} instance - 检查单元\n     * @return {Boolean} - 检查结果 \n     */\n    staticCheck(instance) {\n        if(this._layout) {\n            return this._layout.staticCheck(instance, this);\n        }\n        return false;\n    },\n    /**\n     * 重新计算布局，相当于浏览器里面重排\n     */\n    reflow() {\n        if(this._layout) {\n            this._layout.reflow(this);\n        }\n    },\n}\n\nexport default LayoutMixin;","/**\n * 消息 mixin 用于给Jflow传递消息\n *\n * @mixin\n */\nconst MessageMixin = {\n    _message: null,\n    /**\n     * 发送消息\n     * @param {Object} msg - 消息体\n     */\n    sendMessage(msg) {\n        this._message = msg;\n    },\n    /**\n     * 接收消息\n     * @return {Object} msg - 消息体\n     */\n    consumeMessage() {\n        const msg = this._message;\n        this._message = null;\n        return msg;\n    },\n    readMessage() {\n        return this._message;\n    }\n}\n\nexport default MessageMixin;","/**\n * JFlow 抛出事件\n * @extends CustomEvent\n * @property {Event}  originEvent      - 原始事件\n * @property {Instance} target         - 事件触发对象\n * @property {JFlow} jflow             - JFlow 对象\n * @property {boolean} bubbles         - 冒泡标识\n */\nclass JFlowEvent extends CustomEvent{\n    constructor(event, configs = {}) {\n        const detail = {\n            ...configs,\n            originEvent: configs.event,\n            target: configs.target,\n            jflow: configs.jflow,\n            bubbles: configs.bubbles || false,    \n        }\n        super(event, {\n            detail\n        });\n    }\n}\n\nexport default JFlowEvent;","import Instance from './instance';\nimport { nextDirection } from '../utils/constance';\n\n/**\n * 节点基类\n * @constructor Node\n * @extends Instance\n * @param {Instance~Configs} configs - 节点配置\n * @param {Number[]} configs.anchor - 坐标\n */\nclass Node extends Instance {\n    constructor(configs = {}) {\n        super(configs);\n        this._rawConfigs = configs;\n        // for layout\n        // this._intersections = [];\n        this.anchor =   configs.anchor || [0, 0];\n        // this.margin =   configs.margin || 5;\n    }\n\n    setConfig(configs) {\n        Object.keys(configs).forEach(k => {\n            if(configs[k] !== undefined && configs[k] !== null) {\n                this[k] = configs[k]\n                this._rawConfigs[k] = configs[k];\n            }\n        });\n    }\n\n    // end: from | to\n    // from 逆时针, to 顺时针\n    // checkLinked(interDir, end) {\n    //     if(this._intersections.find(i => i === interDir)) {\n    //         interDir = nextDirection(interDir, end === 'to');\n    //     } else {\n    //         this._intersections.push(interDir)\n    //     }\n    //     return interDir;\n    // }\n\n    /* renderFocus(ctx) {\n        const points = this.getBoundingRect();\n        if(points.length !== 4) return;\n        const margin = this.margin;\n        const [p0, p1, p2, p3] = points;\n        const width = p1[0] - p0[0];\n        const height = p3[1] - p0[1];\n        const w = width * 0.2;\n        const h = height * 0.2;\n        ctx.save();\n        ctx.beginPath();\n        ctx.moveTo(p0[0] - margin, p0[1] - margin + h);\n        ctx.lineTo(p0[0] - margin, p0[1] - margin);\n        ctx.lineTo(p0[0] - margin + w, p0[1] - margin);\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.moveTo(p1[0] + margin - w, p1[1] - margin);\n        ctx.lineTo(p1[0] + margin, p1[1] - margin);\n        ctx.lineTo(p1[0] + margin, p1[1] - margin + h);\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.moveTo(p2[0] + margin, p2[1] + margin - h);\n        ctx.lineTo(p2[0] + margin, p2[1] + margin);\n        ctx.lineTo(p2[0] + margin - w, p2[1] + margin);\n        ctx.stroke();\n\n        ctx.beginPath();\n        ctx.moveTo(p3[0] - margin + w, p3[1] + margin);\n        ctx.lineTo(p3[0] - margin, p3[1] + margin);\n        ctx.lineTo(p3[0] - margin, p3[1] + margin - h);\n        ctx.stroke();\n        ctx.restore();\n    } */\n\n    /**\n     * 克隆当前节点.\n     * @return {Node} 当前节点的副本\n     */\n    clone() {\n        const C = this.constructor;\n        const t = new C(this._rawConfigs);\n        return t;\n    }\n}\n\nexport default Node;","import Instance from './instance';\n\n/**\n * @typedef {Instance~Configs} BaseLink~Configs\n * @property {Instance} from   - 起始单元\n * @property {Instance} to     - 终止单元\n * @property {String} fromDir  - 起始方向 \n * @property {String} toDir    - 终止方向 \n * @property {String} key      - 连线唯一键值\n * @property {String} backgroundColor    - 线条颜色 \n */\n/**\n * 连线基类\n * @constructor BaseLink\n * @extends Instance\n * @param {BaseLink~Configs} configs - 配置\n */\nclass BaseLink extends Instance{\n    constructor(configs = {}) {\n        super();\n        this.from     = configs.from; // Instance\n        this.to       = configs.to;   // Instance\n        this.fromDir  = configs.fromDir;\n        this.toDir    = configs.toDir;\n        this.key      = configs.key;\n        this._cachePoints = null;\n        this.backgroundColor = configs.backgroundColor || '#000';\n    }\n}\n\nexport default BaseLink;","import Node from '../node';\nimport { DIRECTION } from '../../utils/constance';\n/**\n * 圆形单元 配置\n * @typedef {Instance~Configs} Point~PointConfigs\n * @property {number} radius  - 半径\n */\n/**\n * 圆形节点\n * @constructor Point\n * @extends Node\n * @param {Point~PointConfigs} configs - 配置\n */\nclass Point extends Node {\n    constructor(configs) {\n        super(configs);\n        this.type =             'Point';\n        this.radius =           configs.radius || 10;\n        this.radiusExpo2 =      this.radius * this.radius;\n    }\n\n    render(ctx) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n        ctx.beginPath();\n        ctx.arc(this.anchor[0], this.anchor[1], this.radius, 0, 2 * Math.PI);\n        ctx.fillStyle = this.backgroundColor;\n        ctx.fill();   \n        if(this.borderWidth) {\n            ctx.lineWidth = this.borderWidth;\n            ctx.strokeStyle = this.borderColor;\n            ctx.stroke();\n        }\n        // if(this._isTargeting) {\n        //     this.renderFocus(ctx);\n        // }\n        ctx.restore();\n    }\n\n    isHit(point) {\n        const anchor = this.anchor;\n        return Math.pow(point[0] - anchor[0], 2) + Math.pow(point[1] - anchor[1], 2) < this.radiusExpo2\n    }\n\n    getBoundingRect() {\n        const anchor = this.anchor;\n        const r = this.radius;\n        const ltx = anchor[0] - r;\n        const lty = anchor[1] - r;\n        const rbx = anchor[0] + r;\n        const rby = anchor[1] + r;\n        return [\n            [ltx, lty],\n            [rbx, lty],\n            [rbx, rby],\n            [ltx, rby],\n        ]\n    }\n\n    calculateIntersection(point) {\n        const [x1, y1] = point;\n        const [x2, y2] = this.anchor;\n        const vecx = x2 - x1;\n        const vecy = y2 - y1;\n        const dist = Math.sqrt(vecx * vecx + vecy * vecy);\n\n        const ratio = this.radius / dist;\n        return [x2 - ratio * vecx, y2 - ratio * vecy];\n    }\n\n    getIntersectionsInFourDimension() {\n        const [x2, y2] = this.anchor;\n        const r = this.radius;\n        return {\n            [DIRECTION.RIGHT]:  [x2 + r, y2],\n            [DIRECTION.LEFT]:   [x2 - r, y2],\n            [DIRECTION.BOTTOM]: [x2, y2+r],\n            [DIRECTION.TOP]:    [x2, y2-r],\n        }\n    }\n\n    calculateIntersectionInFourDimension(point, end) {\n        const [x1, y1] = point;\n        const [x2, y2] = this.anchor;\n        const r = this.radius;\n        const vecx = x2 - x1;\n        const vecy = y2 - y1;\n        const allIntersections = {\n            [DIRECTION.RIGHT]:  [x2 + r, y2],\n            [DIRECTION.LEFT]:   [x2 - r, y2],\n            [DIRECTION.BOTTOM]: [x2, y2+r],\n            [DIRECTION.TOP]:    [x2, y2-r],\n        }\n        // console.log(Math.abs(vecx) > Math.abs(vecy), vecx, r)\n        // if() {\n        //     return {\n        //         p: [x2 + (vecx<0?r:-r), y2],\n        //         dir: vecx<0 ? DIRECTION.RIGHT : DIRECTION.LEFT,\n        //     }\n        // } else {\n        //     return {\n        //         p: [x2, y2+(vecy<0?r:-r)],\n        //         dir: vecy<0 ? DIRECTION.BOTTOM : DIRECTION.TOP,\n        //     }\n        // }\n        let interDir = (Math.abs(vecy) > Math.abs(vecx)\n            ? (vecy < 0 ? DIRECTION.BOTTOM : DIRECTION.TOP) \n            : (vecx < 0 ? DIRECTION.RIGHT : DIRECTION.LEFT));\n\n        // interDir = this.checkLinked(interDir, end);\n        return {\n            p: allIntersections[interDir],\n            dir: interDir,\n        }\n    }\n\n    getBoundingDimension() {\n        return {\n            width: this.radius * 2,\n            height: this.radius * 2,\n        }\n    }\n    \n}\n\nexport default Point;","import Node from '../node';\nimport { DIRECTION, oppositeDirection } from '../../utils/constance';\n/**\n * 矩形单元 配置\n * @typedef {Instance~Configs} Rectangle~RectangleConfigs\n * @property {number} width - 宽\n * @property {number} height - 高\n * @property {number} borderRadius - 圆角矩形半径\n * @property {string} borderColor - 边框颜色, 默认 transparent\n * @property {string} borderWidth - 边框宽度, 默认 0\n * @property {Object} border      - 边框设置\n * @property {Object} border.top      - 上边框设置\n * @property {string} border.top.borderColor - 边框颜色, 默认 transparent\n * @property {number} border.top.borderWidth - 边框宽度, 默认 0\n * @property {Object} border.right    - 右边框设置\n * @property {string} border.right.borderColor - 边框颜色, 默认 transparent\n * @property {number} border.right.borderWidth - 边框宽度, 默认 0\n * @property {Object} border.bottom   - 下边框设置\n * @property {string} border.bottom.borderColor - 边框颜色, 默认 transparent\n * @property {number} border.bottom.borderWidth - 边框宽度, 默认 0\n * @property {Object} border.left     - 左边框设置\n * @property {string} border.left.borderColor - 边框颜色, 默认 transparent\n * @property {number} border.left.borderWidth - 边框宽度, 默认 0\n */\n/**\n * 矩形单元\n * @constructor Rectangle\n * @extends Node\n * @param {Rectangle~RectangleConfigs} configs\n */\nclass Rectangle extends Node {\n    constructor(configs = {}) {\n        super(configs);\n        this.type =             'Rectangle';\n        this.width =            configs.width || 10;\n        this.height =           configs.height || 10;\n        this.borderRadius =     configs.borderRadius || 0;\n        this._setBorder(configs);\n    }\n\n    _setBorder(configs){\n        this.border = {\n            top: {\n                color: configs.border?.top?.borderColor || configs.borderColor || 'transparent',\n                width: configs.border?.top?.borderWidth || configs.borderWidth || 0,\n                enable: configs.border?.top?.borderWidth,\n            },\n            right: {\n                color: configs.border?.right?.borderColor || configs.borderColor || 'transparent',\n                width: configs.border?.right?.borderWidth || configs.borderWidth || 0,\n                enable: configs.border?.right?.borderWidth,\n            },\n            bottom: {\n                color: configs.border?.bottom?.borderColor || configs.borderColor || 'transparent',\n                width: configs.border?.bottom?.borderWidth || configs.borderWidth || 0,\n                enable: configs.border?.bottom?.borderWidth,\n            },\n            left: {\n                color: configs.border?.left?.borderColor || configs.borderColor || 'transparent',\n                width: configs.border?.left?.borderWidth || configs.borderWidth || 0,\n                enable: configs.border?.left?.borderWidth,\n            }\n        };\n        this.borderColor = configs.borderColor || 'transparent';\n        this.borderWidth = configs.borderWidth || 0;\n    }\n\n    setConfig(configs) {\n        Object.keys(configs).forEach(k => {\n            if(configs[k] !== undefined && configs[k] !== null) {\n                this[k] = configs[k];\n                this._rawConfigs[k] = configs[k];\n            }\n        });\n        this._setBorder(configs);\n    }\n\n    render(ctx) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n       \n        const {\n            borderRadius: radius, anchor, width, height\n        } = this;\n        const x = this.anchor[0] - this.width / 2;\n        const y = this.anchor[1] - this.height / 2;\n        const xt = this.anchor[0] + this.width / 2;\n        const yt = this.anchor[1] + this.height / 2;\n        if(this.borderRadius) {\n            ctx.beginPath();\n            ctx.moveTo(x + radius, y);\n            ctx.lineTo(x + width - radius, y);\n            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\n            ctx.lineTo(x + width, y + height - radius);\n            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n            ctx.lineTo(x + radius, y + height);\n            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\n            ctx.lineTo(x, y + radius);\n            ctx.quadraticCurveTo(x, y, x + radius, y);\n            ctx.closePath();\n            if(this.borderWidth) {\n                ctx.lineWidth = this.borderWidth;\n                ctx.strokeStyle = this.borderColor;\n                ctx.stroke();\n            }\n        } else {\n            ctx.beginPath();\n            ctx.rect(this.anchor[0] - this.width / 2, this.anchor[1] - this.height / 2, this.width, this.height);\n        }\n        ctx.fillStyle = this.backgroundColor;\n        if(this.shadowColor) {\n            ctx.shadowColor = this.shadowColor;\n            ctx.shadowBlur = this.shadowBlur;\n            ctx.shadowOffsetX = this.shadowOffsetX;\n            ctx.shadowOffsetY = this.shadowOffsetY;\n        }\n        ctx.fill(); \n        if(this.borderRadius) {\n            if(this.border.top.enable) {\n                ctx.save();\n                ctx.beginPath();\n                ctx.moveTo(x, y + radius);\n                ctx.quadraticCurveTo(x, y, x + radius, y);\n                ctx.lineTo(x + width - radius, y);\n                ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\n                ctx.closePath();\n                \n                // ctx.fill();\n                ctx.clip();\n                \n                ctx.beginPath();\n                ctx.rect(x, y, this.width, this.border.top.width);\n                ctx.fillStyle = this.border.top.color;\n                ctx.fill();\n                ctx.restore();\n            }\n\n            // if(this.border.right.enable) {\n            //     ctx.beginPath();\n            //     ctx.moveTo(x + width, y + radius);\n            //     ctx.lineTo(x + width, y + height - radius);\n            //     ctx.strokeStyle = this.border.right.color;\n            //     ctx.lineWidth = this.border.right.width;\n            //     ctx.stroke();\n            // }\n\n            // if(this.border.bottom.enable) {\n            //     ctx.beginPath();\n            //     ctx.moveTo(x + width - radius, y + height);\n            //     ctx.lineTo(x + radius, y + height);\n            //     ctx.strokeStyle = this.border.bottom.color;\n            //     ctx.lineWidth = this.border.bottom.width;\n            //     ctx.stroke();\n            // }\n\n            // if(this.border.left.enable) {\n            //     ctx.beginPath();\n            //     ctx.moveTo(x, y + height - radius);\n            //     ctx.lineTo(x, y + radius);\n            //     ctx.strokeStyle = this.border.left.color;\n            //     ctx.lineWidth = this.border.left.width;\n            //     ctx.stroke();\n            // }\n        } else {\n            if(this.border.top.width) {\n                ctx.beginPath();\n                ctx.moveTo(x, y);\n                ctx.lineTo(xt, y);\n                ctx.strokeStyle = this.border.top.color;\n                ctx.lineWidth = this.border.top.width;\n                ctx.stroke();\n            }\n\n            if(this.border.right.width) {\n                ctx.beginPath();\n                ctx.moveTo(xt, y);\n                ctx.lineTo(xt, yt);\n                ctx.strokeStyle = this.border.right.color;\n                ctx.lineWidth = this.border.right.width;\n                ctx.stroke();\n            }\n\n            if(this.border.bottom.width) {\n                ctx.beginPath();\n                ctx.moveTo(xt, yt);\n                ctx.lineTo(x, yt);\n                ctx.strokeStyle = this.border.bottom.color;\n                ctx.lineWidth = this.border.bottom.width;\n                ctx.stroke();\n            }\n\n            if(this.border.left.width) {\n                ctx.beginPath();\n                ctx.moveTo(x, yt);\n                ctx.lineTo(x, y);\n                ctx.strokeStyle = this.border.left.color;\n                ctx.lineWidth = this.border.left.width;\n                ctx.stroke();\n            }\n        }\n        ctx.restore();\n    }\n\n    isHit(point) {\n        const anchor = this.anchor;\n        const w = this.width /2;\n        const h = this.height/2;\n        return point[0] > anchor[0] - w \n            && point[0] < anchor[0] + w \n            && point[1] > anchor[1] - h \n            && point[1] < anchor[1] + h;\n    }\n\n    getBoundingRect() {\n        const anchor = this.anchor;\n        const w = this.width /2;\n        const h = this.height/2;\n        const ltx = anchor[0] - w;\n        const lty = anchor[1] - h;\n        const rbx = anchor[0] + w;\n        const rby = anchor[1] + h;\n        return [\n            [ltx, lty],\n            [rbx, lty],\n            [rbx, rby],\n            [ltx, rby],\n        ]\n    }\n\n    getBoundingDimension() {\n        return {\n            height: this.height,\n            width: this.width,\n        }\n    }\n\n    calculateIntersection(point) {\n        const [x1, y1] = point;\n        const [x2, y2] = this.anchor;\n        const w = this.width/2;\n        const h = this.height/2;\n        const vecx = x2 - x1;\n        const vecy = y2 - y1;\n        const theta1 = h/w;\n        const theta2 = Math.abs(vecy/vecx);\n        const dirx = x1 > x2;\n        const diry = y1 > y2;\n        let x, y;\n        if(theta2 < theta1) {\n            x = x2 + (dirx?w:-w);\n            y = w * (diry?theta2:-theta2) + y2;\n        } else {\n            y = y2 + (diry?h:-h);\n            x = h / (dirx?theta2:-theta2) + x2;\n        }\n        return [x, y];\n    }\n\n    getIntersectionsInFourDimension() {\n        let p2 = this.anchor;\n        if(this._belongs && this._belongs.calculateToCoordination) {\n            p2 = this._belongs.calculateToCoordination(p2);\n        }\n        \n        const [x2, y2] = p2;\n        const w = this.width/2;\n        const h = this.height/2;\n        return {\n            [DIRECTION.RIGHT]:  [x2+w, y2],\n            [DIRECTION.LEFT]:   [x2-w, y2],\n            [DIRECTION.BOTTOM]: [x2, y2+h],\n            [DIRECTION.TOP]:    [x2, y2-h],\n        }\n    }\n  \n    calculateIntersectionInFourDimension(point, end) {\n        const [x1, y1] = point;\n        let p2 = this.anchor;\n        if(this._belongs && this._belongs.calculateToCoordination) {\n            p2 = this._belongs.calculateToCoordination(p2);\n        }\n        \n        const [x2, y2] = p2;\n        const w = this.width/2;\n        const h = this.height/2;\n        const allIntersections = {\n            [DIRECTION.RIGHT]:  [x2+w, y2],\n            [DIRECTION.LEFT]:   [x2-w, y2],\n            [DIRECTION.BOTTOM]: [x2, y2+h],\n            [DIRECTION.TOP]:    [x2, y2-h],\n        }\n        const vecx = x2 - x1;\n        const vecy = y2 - y1;\n        const theta1 = h/w;\n        const theta2 = Math.abs(vecy/vecx);\n        const dirx = x1 > x2;\n        const diry = y1 > y2;\n        let interDir = (theta2 > theta1 \n            ? (diry ? DIRECTION.BOTTOM : DIRECTION.TOP) \n            : (dirx ? DIRECTION.RIGHT : DIRECTION.LEFT));\n\n        // if(this._belongs && this._belongs.calculateToCoordination) {\n        //     console.log(JSON.stringify(this._intersections));\n        //     console.log(interDir)\n        // }\n        // interDir = this.checkLinked(interDir, end);\n        // if(this._belongs && this._belongs.calculateToCoordination) {\n        //     console.log(interDir)\n        // }\n        \n        // if(!interDir) {\n        //     debugger\n        // }\n        // let endDir = interDir;\n        // if(end === 'to') {\n        //     endDir = oppositeDirection(endDir)\n        // }\n        return {\n            p: allIntersections[interDir],\n            dir: interDir,\n        }\n    }\n}\n\nexport default Rectangle;","import StackMixin from './stackMixin';\nimport LayoutMixin from './layoutMixin';\nimport { bounding_box } from '../utils/functions';\nimport { DIRECTION } from '../utils/constance';\n\n/**\n * Group mixin 配置\n * @typedef {Object} GroupMixin~GroupConfigs\n * @property {number} width             - 设定宽度 \n * @property {number} minWidth          - 最小宽度 \n * @property {number} height            - 设定高度 \n * @property {number} padding          - 内边距\n * @property {number} paddingTop          - 内上边距\n * @property {number} paddingRight         - 内右边距\n * @property {number} paddingBottom        - 内下边距\n * @property {number} paddingLeft          - 内左边距\n * @property {boolean} lock            - 布局锁定状态 默认 true\n */\n\n /**\n * Group mixin 配置\n * @typedef {GroupMixin~GroupConfigs | LayoutMixin~LayoutConfigs} GroupMixin~LayoutGroupConfigs\n */\n\n/**\n * Group mixin 用于在形状上加上 Group 特性\n *\n * @mixin\n * @mixes LayoutMixin\n * @mixes StackMixin\n */\n \nconst GroupMixin = {\n    ...StackMixin,\n    ...LayoutMixin,\n    /**\n     * 配置 mixin\n     * @param {GroupMixin~LayoutGroupConfigs} configs - 配置 Group\n     */\n    initGroup(configs) {\n        this.initStack(configs);\n        this.initLayout(configs);\n        // this.padding =          configs.padding || 2;\n        this.padding = {\n            top: configs.paddingTop || configs.padding || 0,\n            right: configs.paddingRight || configs.padding || 0,\n            bottom: configs.paddingBottom || configs.padding || 0,\n            left: configs.paddingLeft || configs.padding || 0,\n        };\n        this.definedWidth =     configs.width;\n        this.minWidth =         configs.minWidth;\n        this.definedHeight =    configs.height;\n        this.lock =             configs.lock ?? true ;\n        // this.offsetY = 0;\n        // this.offsetX = 0;\n        this._getBoundingGroupRect();\n        this.reflow();\n        this._getBoundingGroupRect();\n    },\n    setConfig(configs) {\n        Object.keys(configs).forEach(k => {\n            if(configs[k] !== undefined && configs[k] !== null) {\n                this[k] = configs[k]\n                this._rawConfigs[k] = configs[k];\n            }\n        });\n        this.padding = {\n            top: configs.paddingTop || configs.padding || 0,\n            right: configs.paddingRight || configs.padding || 0,\n            bottom: configs.paddingBottom || configs.padding || 0,\n            left: configs.paddingLeft || configs.padding || 0,\n        };\n    },\n    _getBoundingGroupRect() {\n        const points = this._stack.getBoundingRectPoints();\n        const bbox = bounding_box(points);\n        const padding = this.padding;\n        const minWidth = this.minWidth - padding.left - padding.right;\n        const definedWidth = this.definedWidth - padding.left - padding.right;\n        const w = bbox.width + padding.left + padding.right;\n        const h = bbox.height + padding.top + padding.bottom;\n        this.width = minWidth ? Math.max(minWidth, w) : definedWidth || w;\n        this.height = this.definedHeight || h;\n        // this.offsetY = bbox.y;\n        // this.offsetX = bbox.x;\n    },\n    renderGroup(ctx, callback) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n        // this._getBoundingGroupRect();\n        const anchor = this.anchor;\n        ctx.save();\n        callback(ctx);\n        ctx.restore();\n\n        // const height = this.height;\n        // const width = this.width;\n        const padding = this.padding;\n        // const spanV = height / 2 + this.offsetY - padding.top\n        // const spanH = width / 2 + this.offsetX - padding.left\n        const centerX = (padding.left - padding.right)/2;\n        const centerY = (padding.top - padding.bottom)/2;\n        ctx.translate(anchor[0] + centerX, anchor[1] + centerY);\n        this._stack.render(ctx);\n        this._linkStack.render(ctx);\n        ctx.translate(-anchor[0] - centerX, -anchor[1] - centerY);\n        \n        // if(this._isTargeting) {\n        //     this.renderFocus(ctx);\n        // }\n        ctx.restore();\n    },\n    _calculatePointBack(point) {\n        const [gx, gy] = point;\n        // const height = this.height;\n        // const width = this.width;\n        // const padding = this.padding;\n        const padding = this.padding;\n        const centerX = (padding.left - padding.right)/2;\n        const centerY = (padding.top - padding.bottom)/2;\n        // const spanV = height / 2 + this.offsetY - padding.top\n        // const spanH = width / 2 + this.offsetX -  padding.left\n        const anchor = this.anchor;\n        // const p = [gx - anchor[0] + spanH, gy - anchor[1] +spanV ];\n        const p = [gx - anchor[0] - centerX, gy - anchor[1] - centerY]\n        return p\n    },\n    isHitGroup(point, condition) {\n        const p = this._calculatePointBack(point);\n        this._currentp = p; // 暂存，为了后续计算别的位置\n        const target = this._stack.checkHit(p, condition);\n        if(target) return target;\n        return false;\n    },\n     /**\n     * 反算回 canvas 顶层坐标\n     * @param {Number[]} point\n     * @return {Number[]} 世界坐标\n     */\n    calculateToCoordination(point) {\n        const [cx, cy] = point;\n        // const height = this.height;\n        // const width = this.width;\n        // const padding = this.padding;\n        // const spanV = height / 2 + this.offsetY - padding.top\n        // const spanH = width / 2 + this.offsetX - padding.left\n        const padding = this.padding;\n        const centerX = (padding.left - padding.right)/2;\n        const centerY = (padding.top - padding.bottom)/2;\n        const anchor = this.anchor;\n        // const p = [cx + anchor[0] - spanH, cy + anchor[1] - spanV];\n        const p = [cx + anchor[0] + centerX, cy + anchor[1] + centerY]\n        if(this._belongs && this._belongs.calculateToCoordination) {\n            return this._belongs.calculateToCoordination(p);\n        } else {\n            return p;\n        }\n    },\n    calculateToRealWorld(point) {\n        const [cx, cy] = point;\n        // const height = this.height;\n        // const width = this.width;\n        // const padding = this.padding;\n        // const spanV = height / 2 + this.offsetY - padding.top\n        // const spanH = width / 2 + this.offsetX - padding.left\n        const padding = this.padding;\n        const centerX = (padding.left - padding.right)/2;\n        const centerY = (padding.top - padding.bottom)/2;\n        const anchor = this.anchor;\n        // const p = [cx + anchor[0] - spanH, cy + anchor[1] - spanV];\n        const p = [cx + anchor[0] + centerX, cy + anchor[1] + centerY]\n        if(this._belongs && this._belongs.calculateToRealWorld) {\n            return this._belongs.calculateToRealWorld(p);\n        }\n    },\n    clone() {\n        const C = this.constructor;\n        const configs = Object.assign({}, this._rawConfigs, {\n            layout: this._layout && this._layout.clone(),\n        })\n        const t = new C(configs);\n        this.interateNodeStack((instance) => {\n            t.addToStack(instance.clone());\n        })\n        t.recalculate();\n        return t;\n    }\n}\n\nexport default GroupMixin;","import Rectangle from './rectangle';\nimport GroupMixin from '../groupMixin';\n\n /**\n * 矩形组单元配置\n * @typedef {GroupMixin~LayoutGroupConfigs | Rectangle~RectangleConfigs} RectangleGroup~RectangleGroupConfigs\n */\n\n/**\n * 矩形组单元\n * @description 组单元包含绘图栈，能够包裹内部单元，具有独立的坐标系，目前为中心对齐的坐标系\n * @constructor RectangleGroup\n * @param {RectangleGroup~RectangleGroupConfigs} configs\n * @mixes GroupMixin\n * @extends Rectangle\n */\nclass RectangleGroup extends Rectangle {\n    constructor(configs) {\n        super(configs)\n        this.initGroup(configs);\n    }\n\n    render(ctx) {\n        this.renderGroup(ctx, () => {\n            Rectangle.prototype.render.call(this, ctx);\n            // this.backgroundColor = 'rgba(0,0,0,0.2)';\n            // Rectangle.prototype.render.call(this, ctx);\n        })\n    }\n\n    isHit(point, condition) {\n        const result = this.isHitGroup(point, condition);\n        if(result) {\n            return result;\n        }\n        return Rectangle.prototype.isHit.call(this, point);\n    }\n}\nObject.assign(RectangleGroup.prototype, GroupMixin);\nObject.assign(RectangleGroup.prototype, {\n    setConfig(configs) {\n        Object.keys(configs).forEach(k => {\n            if(configs[k] !== undefined && configs[k] !== null) {\n                this[k] = configs[k];\n                this._rawConfigs[k] = configs[k];\n            }\n        });\n        this.padding = {\n            top: configs.paddingTop || configs.padding || 0,\n            right: configs.paddingRight || configs.padding || 0,\n            bottom: configs.paddingBottom || configs.padding || 0,\n            left: configs.paddingLeft || configs.padding || 0,\n        };\n        this._setBorder(configs);\n    }\n});\n\nexport default RectangleGroup;","import Node from '../node';\nimport { DIRECTION, oppositeDirection } from '../../utils/constance';\n/**\n * 胶囊单元 配置\n * @typedef {Instance~Configs} Capsule~CapsuleConfigs\n * @property {number} width  - 内部矩形宽\n * @property {number} height - 内部矩形高\n */\n/**\n * 胶囊单元\n * @constructor Capsule\n * @extends Node\n * @param {Capsule~CapsuleConfigs} configs - 配置\n */\nclass Capsule extends Node {\n    constructor(configs = {}) {\n        super(configs);\n        this.type =             'Capsule';\n        this.width =            configs.width || 20;\n        this.height =           configs.height || 10;\n    }\n\n    render(ctx) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n        ctx.beginPath();\n        const [x, y] = this.anchor;\n        const hw = this.width/2;\n        const hh = this.height/2;\n        const leftCenter = x - hw + hh;\n        const rightCenter = x + hw - hh;\n        const top = y - hh;\n        const bottom = y + hh;\n\n        ctx.moveTo(leftCenter, top);\n        ctx.lineTo(rightCenter, top);\n        ctx.arc(rightCenter, y, hh, -Math.PI/2, Math.PI/2);\n        ctx.lineTo(leftCenter, bottom);\n        ctx.arc(leftCenter, y, hh, Math.PI/2, Math.PI/2*3);\n\n        ctx.fillStyle = this.backgroundColor;\n        ctx.fill();     \n        if(this.borderWidth) {\n            ctx.lineWidth = this.borderWidth;\n            ctx.strokeStyle = this.borderColor;\n            ctx.stroke();\n        }\n        // ctx.fillStyle = 'rgba(0,0,0,0.3)';\n        // ctx.fillRect(x-hw, y-hh, this.width, this.height)\n\n        ctx.restore();\n    }\n\n    isHit(point) {\n        const anchor = this.anchor;\n        const hw = this.width/2;\n        const hh = this.height/2;\n        const ww =  Math.abs(hw - hh);\n        const leftCenter = anchor[0] - hw + hh;\n        const rightCenter = anchor[0] + hw - hh;\n        const rr = hh * hh;\n        return (point[0] > anchor[0] - ww \n            && point[0] < anchor[0] + ww \n            && point[1] > anchor[1] - hh \n            && point[1] < anchor[1] + hh) \n            || ( Math.pow(point[0] - leftCenter, 2) + Math.pow(point[1] - anchor[1], 2) < rr)\n            || ( Math.pow(point[0] - rightCenter, 2) + Math.pow(point[1] - anchor[1], 2) < rr)\n    }\n\n    getBoundingRect() {\n        const anchor = this.anchor;\n        const w = this.width /2;\n        const h = this.height/2;\n        const ltx = anchor[0] - w;\n        const lty = anchor[1] - h;\n        const rbx = anchor[0] + w;\n        const rby = anchor[1] + h;\n        return [\n            [ltx, lty],\n            [rbx, lty],\n            [rbx, rby],\n            [ltx, rby],\n        ]\n    }\n\n    getBoundingDimension() {\n        return {\n            height: this.height,\n            width: this.width,\n        }\n    }\n\n    getIntersectionsInFourDimension() {\n        let p2 = this.anchor;\n        if(this._belongs && this._belongs.calculateToCoordination) {\n            p2 = this._belongs.calculateToCoordination(p2);\n        }\n        \n        const [x2, y2] = p2;\n        const w = this.width/2;\n        const h = this.height/2;\n        return {\n            [DIRECTION.RIGHT]:  [x2+w, y2],\n            [DIRECTION.LEFT]:   [x2-w, y2],\n            [DIRECTION.BOTTOM]: [x2, y2+h],\n            [DIRECTION.TOP]:    [x2, y2-h],\n        }\n    }\n}\n\nexport default Capsule;","import Capsule from './capsule';\nimport GroupMixin from '../groupMixin';\n/**\n * 钻石形组单元配置\n * @typedef {GroupMixin~LayoutGroupConfigs | Capsule~CapsuleConfigs } CapsuleGroup~CapsuleGroupConfigs\n */\n/**\n * 胶囊组单元\n * @description 组单元包含绘图栈，能够包裹内部单元，具有独立的坐标系，目前为中心对齐的坐标系\n * @constructor CapsuleGroup\n * @extends Capsule\n * @param {CapsuleGroup~CapsuleGroupConfigs} configs - 配置\n * @mixes GroupMixin\n */\nclass CapsuleGroup extends Capsule {\n    constructor(configs) {\n        super(configs)\n        this.initGroup(configs);\n    }\n\n    render(ctx) {\n        this.renderGroup(ctx, () => {\n            Capsule.prototype.render.call(this, ctx);\n        })\n    }\n\n    isHit(point, condition) {\n        const result = this.isHitGroup(point, condition);\n        if(result) {\n            return result;\n        }\n        return Capsule.prototype.isHit.call(this, point);\n    }\n}\nObject.assign(CapsuleGroup.prototype, GroupMixin);\nexport default CapsuleGroup;","import Node from '../node';\nimport { DIRECTION, oppositeDirection } from '../../utils/constance';\nimport { makeBezierPoints } from '../../utils/functions';\n/**\n * 钻石形单元 配置\n * @typedef {Instance~Configs} Diamond~DiamondConfigs\n * @property {number} width  - 内部矩形宽\n * @property {number} height - 内部矩形高\n * @property {number} side   - 两侧三角形的宽\n */\n/**\n * 钻石形单元\n * @constructor Diamond\n * @param {Diamond~DiamondConfigs} configs - 配置\n * @extends Node\n */\nclass Diamond extends Node {\n    constructor(configs = {}) {\n        super(configs);\n        this.type =             'Capsule';\n        this.width =            configs.width || 20;\n        this.height =           configs.height || 10;\n        this.side =             configs.side || 6;\n        this._cacheSide();\n    }\n\n    setConfig(configs) {\n        Object.keys(configs).forEach(k => {\n            if(configs[k] !== undefined && configs[k] !== null) {\n                this[k] = configs[k];\n                this._rawConfigs[k] = configs[k];\n            }\n        });\n        this._cacheSide();\n    }\n\n    _cacheSide() {\n        this.sinSIDE = Math.sin(Math.PI/3) * this.side;\n        this.cosSIDE = Math.cos(Math.PI/3) * this.side;\n        // console.log(this.sinSIDE, this.cosSIDE);\n    }\n\n    render(ctx) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n        ctx.beginPath();\n        const [x, y] = this.anchor;\n        const hw = this.width/2;\n        const hh = this.height/2;\n        const xx = hh / 1.732\n        const leftCenter = x - hw + xx;\n        const rightCenter = x + hw - xx;\n        const right = x + hw;\n        const left = x - hw;\n        const top = y - hh;\n        const bottom = y + hh;\n        // const angle = Math.PI / 6;\n        // const radius = 6;\n        const {\n            side, sinSIDE, cosSIDE\n        } = this;\n        ctx.moveTo(x, top);\n        ctx.lineTo(rightCenter - side, top);\n        ctx.quadraticCurveTo(rightCenter, top, rightCenter + cosSIDE, top + sinSIDE);\n        ctx.lineTo(right - cosSIDE, y - sinSIDE);\n        ctx.quadraticCurveTo(right, y, right - cosSIDE, y + sinSIDE);\n        ctx.lineTo(rightCenter + cosSIDE, bottom - sinSIDE);\n        ctx.quadraticCurveTo(rightCenter, bottom, rightCenter - side, bottom);\n\n        ctx.lineTo(leftCenter + side, bottom);\n        ctx.quadraticCurveTo(leftCenter, bottom, leftCenter - cosSIDE, bottom - sinSIDE);\n        ctx.lineTo(left + cosSIDE, y + sinSIDE);\n        ctx.quadraticCurveTo(left, y, left + cosSIDE, y - sinSIDE);\n        ctx.lineTo(leftCenter - cosSIDE, top + sinSIDE);\n        ctx.quadraticCurveTo(leftCenter, top, leftCenter + side, top);\n        \n        ctx.closePath();\n\n        ctx.fillStyle = this.backgroundColor;\n        ctx.fill();     \n        if(this.borderWidth) {\n            ctx.lineWidth = this.borderWidth;\n            ctx.strokeStyle = this.borderColor;\n            ctx.stroke();\n        }\n       \n        // if(this._isTargeting) {\n        //     this.renderFocus(ctx);\n        // }\n        // ctx.fillStyle = 'rgba(0,0,0,0.3)';\n        // ctx.fillRect(x-hw, y-hh, this.width, this.height)\n\n        ctx.restore();\n\n        this._cachePoints = [\n            [rightCenter, top],\n            [right, y],\n            [rightCenter, bottom],\n            [leftCenter, bottom],\n            [left, y],\n            [leftCenter, top]\n        ];\n    }\n\n    isHit(point) {\n        const points = this._cachePoints;\n        const [x, y] = point;\n        let inside = false;\n        var len = points.length/2;\n        for (var i = 0, j = len - 1; i < len; j = i++) {\n            var xi = points[i*2+0], yi = points[i*2+1];\n            var xj = points[j*2+0], yj = points[j*2+1];\n            var intersect = ((yi > y) !== (yj > y))\n                && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);\n            if (intersect) inside = !inside;\n        }\n        return inside;\n    }\n\n    getBoundingRect() {\n        const anchor = this.anchor;\n        const w = this.width /2;\n        const h = this.height/2;\n        const ltx = anchor[0] - w;\n        const lty = anchor[1] - h;\n        const rbx = anchor[0] + w;\n        const rby = anchor[1] + h;\n        return [\n            [ltx, lty],\n            [rbx, lty],\n            [rbx, rby],\n            [ltx, rby],\n        ]\n    }\n\n    getBoundingDimension() {\n        return {\n            height: this.height,\n            width: this.width,\n        }\n    }\n\n    getIntersectionsInFourDimension() {\n        let p2 = this.anchor;\n        if(this._belongs && this._belongs.calculateToCoordination) {\n            p2 = this._belongs.calculateToCoordination(p2);\n        }\n        \n        const [x2, y2] = p2;\n        const w = this.width/2;\n        const h = this.height/2;\n        return {\n            [DIRECTION.RIGHT]:  [x2+w, y2],\n            [DIRECTION.LEFT]:   [x2-w, y2],\n            [DIRECTION.BOTTOM]: [x2, y2+h],\n            [DIRECTION.TOP]:    [x2, y2-h],\n        }\n    }\n}\n\nexport default Diamond;","import Diamond from './diamond';\nimport GroupMixin from '../groupMixin';\nimport { bounding_box } from '../../utils/functions';\nconst backsqrt3 = 1/Math.sqrt(3)\n\n /**\n * 钻石形组单元配置\n * @typedef {GroupMixin~LayoutGroupConfigs | Diamond~DiamondConfigs } DiamondGroup~DiamondGroupConfigs\n */\n/**\n * 钻石形组单元\n * @description 组单元包含绘图栈，能够包裹内部单元，具有独立的坐标系，目前为中心对齐的坐标系\n * @constructor DiamondGroup\n * @param {DiamondGroup~DiamondGroupConfigs} configs - 配置\n * @extends Diamond\n * @mixes GroupMixin\n */\nclass DiamondGroup extends Diamond {\n    constructor(configs) {\n        super(configs)\n        this.initGroup(configs);\n    }\n\n\n    render(ctx) {\n        this.renderGroup(ctx, () => {\n\n            Diamond.prototype.render.call(this, ctx);\n        // ctx.save();\n        // ctx.fillStyle = 'rgba(255,0,0,0.3)';\n        // ctx.fillRect(this.anchor[0] - this.width/2, this.anchor[1] - this.height/2, this.width, this.height)\n        // ctx.restore();\n        })\n    }\n\n    isHit(point, condition) {\n        const result = this.isHitGroup(point, condition);\n        if(result) {\n            return result;\n        }\n        return Diamond.prototype.isHit.call(this, point);\n    }\n}\nObject.assign(DiamondGroup.prototype, GroupMixin);\nObject.assign(DiamondGroup.prototype, {\n    _getBoundingGroupRect() {\n        const points = this._stack.getBoundingRectPoints();\n        const bbox = bounding_box(points);\n        const padding = this.padding;\n        const minWidth = this.minWidth - padding.left - padding.right;\n        const definedWidth = this.definedWidth - padding.left - padding.right;\n        const w = bbox.width + padding.left + padding.right + bbox.height * backsqrt3 / 2;\n        const h = bbox.height + padding.top + padding.bottom;\n        this.width = minWidth ? Math.max(minWidth, w) : definedWidth || w;\n        this.height = this.definedHeight || h;\n        // this.offsetY = bbox.y;\n        // this.offsetX = bbox.x;\n    },\n    setConfig(configs) {\n        Object.keys(configs).forEach(k => {\n            if(configs[k] !== undefined && configs[k] !== null) {\n                this[k] = configs[k];\n                this._rawConfigs[k] = configs[k];\n            }\n        });\n        this.padding = {\n            top: configs.paddingTop || configs.padding || 0,\n            right: configs.paddingRight || configs.padding || 0,\n            bottom: configs.paddingBottom || configs.padding || 0,\n            left: configs.paddingLeft || configs.padding || 0,\n        };\n        this._cacheSide();\n    }\n})\nexport default DiamondGroup;","import Rectangle from './shapes/rectangle';\nimport { DIRECTION } from '../utils/constance';\nimport { requestCacheCanvas } from '../utils/canvas';\nimport JFlowEvent from '../events';\nfunction createInputElement() {\n    const input = document.createElement('input');\n    input.setAttribute('style',`\n        position: absolute;\n        left: 0;\n        top: 0;\n        border:none;\n        background-image:none;\n        background-color:transparent;\n        -webkit-box-shadow: none;\n        -moz-box-shadow: none;\n        box-shadow: none;`);\n    return input;\n}\n/**\n * 文字对齐方式\n * @readonly\n * @enum {string}\n */\nconst TEXT_ALIGN = {\n    CENTER: 'center',\n    LEFT: 'left',\n    RIGHT: 'right',    \n};\n/**\n * 文字单元 配置\n * @typedef {Rectangle~RectangleConfigs} Text~TextConfigs\n * @property {String} fontFamily    - 字体\n * @property {Number} fontSize      - 字号\n * @property {String} content       - 内容\n * @property {String} textColor     - 字体颜色\n * @property {TEXT_ALIGN} textAlign     - 文字对齐方式\n * @property {String} backgroundColor     - 背景颜色\n * @property {number} lineHeight    - 行高\n * @property {number} indent        - 缩进\n * @property {number} editable      - 是否可编辑\n * @property {number} minWidth      - 最小宽度\n */\n/**\n * 文字对象\n * @description 可以绘制文字\n * @constructor Text\n * @extends Rectangle\n * @param {Text~TextConfigs} configs - 配置\n */\nclass Text extends Rectangle {\n    constructor(configs) {\n        super(configs);\n        this.type =             'Text';\n        this.content =          configs.content || '';\n        this.fontFamily =       configs.fontFamily = '-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'\n        this.fontSize =         configs.fontSize || '28px';\n        this.textColor =        configs.textColor || 'white';\n        this.textAlign =        configs.textAlign || TEXT_ALIGN.CENTER;\n        this.textBaseline =     configs.textBaseline || 'middle';\n        this.lineHeight =       configs.lineHeight ;\n        this.indent =           configs.indent || 0;\n        this.backgroundColor =  configs.backgroundColor;\n        this.editable =         configs.editable;\n        this.acceptPatten =     configs.acceptPatten;\n        this.minWidth =         configs.minWidth || 0;\n        this.editStatus = {\n            editting: false,\n        }\n        requestCacheCanvas((ctx) => {\n            this.renderShadowText(ctx);\n        });\n        this._makeEditable();\n    }\n\n\n    _makeEditable() {\n        if(this.editable) {\n            this.addEventListener('click', (event) => {\n                let x;\n                const hw = this.width / 2;\n                if(this.textAlign === TEXT_ALIGN.LEFT){\n                    x = this.anchor[0] - hw + this.indent / 2;\n                } else if(this.textAlign === TEXT_ALIGN.RIGHT) {\n                    x = this.anchor[0] + hw;\n                } else {\n                    x = this.anchor[0] + this.indent / 2;\n                }\n                const p = [ x, -this.height/2 ];\n                const fontSize = +/(\\d+)/.exec(this.fontSize)[1];\n                const [offsetX, offsetY] = this.calculateToRealWorld(p);\n                let inputElement = createInputElement();\n                const wrapper = this._jflow.DOMwrapper;\n                const oldVal = this.content;\n                inputElement.style.transform =`translate(${offsetX}px, ${offsetY}px)`;\n                inputElement.style.width = this.calculateToRealWorldWithScalar(this.width) + 'px';\n                inputElement.style.height = this.calculateToRealWorldWithScalar(this.height) + 'px';\n                inputElement.style.fontFamily = this.fontFamily;\n                wrapper.style.fontSize = `${fontSize * this._jflow.scale}px`;\n                inputElement.style.fontSize = `${fontSize * this._jflow.scale}px`;\n                inputElement.style.lineHeight = `${this.lineHeight * this._jflow.scale}px`;\n                inputElement.style.textIndent = `${this.indent * this._jflow.scale}px`;\n                inputElement.value = this.content;\n                inputElement.style.color = this.textColor;\n                inputElement.addEventListener(\"focus\",  () => {\n                    this.content = '';\n                    this._jflow._render();\n                    inputElement.style.outline = \"none\";  \n                });\n                let blurHandler = () => {\n                    if(this.acceptPatten){\n                        \n                    } else {\n                        const val = inputElement.value;\n                        /**\n                         * 文字改变事件\n                         * @event Text#change\n                         * @type {object}\n                         * @property {Text} target           - 当前文字对象 \n                         * @property {String} oldVal         - 原始文字 \n                         * @property {String} val            - 当前文字 \n                         */\n                        this.dispatchEvent(new JFlowEvent('change', {\n                            target: this,\n                            oldVal,\n                            val,\n                        }))\n                        this.content = oldVal;\n                        inputElement.removeEventListener('blur', blurHandler)\n                        wrapper.removeChild(inputElement);\n                        inputElement = null;\n                        blurHandler = null;\n                    }\n                };\n                inputElement.addEventListener('blur', blurHandler);\n                const keyUpHandler = (e) => {\n                    if (e.key === 'Enter' || e.keyCode === 13) {\n                        e.preventDefault();\n                        inputElement.removeEventListener('keypress', keyUpHandler)\n                        blurHandler();\n                    }\n                };\n                inputElement.addEventListener('keypress', keyUpHandler)\n                wrapper.append(inputElement);\n                inputElement.focus();\n            })\n        }\n    }\n\n    renderShadowText(ctx) {\n        ctx.beginPath();\n        ctx.font = `${this.fontSize} ${this.fontFamily}`;\n        ctx.textAlign = this.textAlign;\n        ctx.textBaseline = this.textBaseline;\n        ctx.fillStyle = this.textColor;\n        const {\n            actualBoundingBoxLeft,\n            actualBoundingBoxRight,\n            fontBoundingBoxAscent,\n            fontBoundingBoxDescent\n        } = ctx.measureText(this.content);\n        this._textWidth = this.indent + Math.abs(actualBoundingBoxLeft) + Math.abs(actualBoundingBoxRight);\n\n        this.width = Math.max(this.minWidth, this._textWidth);\n        const height = Math.abs(fontBoundingBoxAscent) + Math.abs(fontBoundingBoxDescent);\n        if(this.lineHeight) {\n            this.height = this.lineHeight;\n        } else {\n            this.height = height;\n        }\n        \n    }\n\n    setConfig(configs) {\n        Object.keys(configs).forEach(k => {\n            if(configs[k] !== undefined && configs[k] !== null) {\n                this[k] = configs[k];\n                this._rawConfigs[k] = configs[k];\n            }\n        });\n        requestCacheCanvas((ctx) => {\n            this.renderShadowText(ctx);\n        });\n    }\n\n    render(ctx) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n        // this.renderShadowText(ctx);\n\n\n        // const {\n        //     borderRadius: radius, anchor, width, height\n        // } = this;\n        // if(this.backgroundColor || this.borderColor){\n        //     ctx.save();\n        //     ctx.beginPath();\n        //     if(this.borderRadius) {\n        //         const x = this.anchor[0] - this.width / 2;\n        //         const y = this.anchor[1] - this.height / 2;\n        //         ctx.moveTo(x + radius, y);\n        //         ctx.lineTo(x + width - radius, y);\n        //         ctx.quadraticCurveTo(x + width, y, x + width, y + radius);\n        //         ctx.lineTo(x + width, y + height - radius);\n        //         ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);\n        //         ctx.lineTo(x + radius, y + height);\n        //         ctx.quadraticCurveTo(x, y + height, x, y + height - radius);\n        //         ctx.lineTo(x, y + radius);\n        //         ctx.quadraticCurveTo(x, y, x + radius, y);\n        //         ctx.closePath();\n        //     } else {\n        //         ctx.rect(this.anchor[0] - this.width / 2, this.anchor[1] - this.height / 2, this.width, this.height);\n        //     }\n        //     if (this.backgroundColor){\n        //         ctx.fillStyle = this.backgroundColor;\n        //         ctx.fill();\n        //     }\n        //     if(this.borderColor) {\n        //         ctx.strokeStyle = this.borderColor;\n        //         ctx.stroke();\n        //     }\n        //     ctx.restore();\n        // }\n\n        ctx.beginPath();\n        ctx.font = `${this.fontSize} ${this.fontFamily}`;\n        ctx.textAlign = this.textAlign;\n        ctx.textBaseline = this.textBaseline;\n        ctx.fillStyle = this.textColor;\n        if(this.textAlign === TEXT_ALIGN.LEFT){\n            const hw = this.width / 2;\n            ctx.fillText(this.content, this.anchor[0] - hw + this.indent / 2, this.anchor[1]);\n        } else if(this.textAlign === TEXT_ALIGN.RIGHT) {\n            const hw = this.width / 2;\n            ctx.fillText(this.content, this.anchor[0] + hw, this.anchor[1]);\n        } else {\n            ctx.fillText(this.content, this.anchor[0] + this.indent / 2, this.anchor[1]);\n        }\n        // ctx.rect(this.anchor[0] - this.width / 2, this.anchor[1] - this.height / 2, this.width, this.height);\n        // ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';\n        ctx.fill();\n        ctx.restore();\n    }\n}\n\nexport default Text;","import Rectangle from './shapes/rectangle';\nimport StackMixin from './stackMixin';\nimport LayoutMixin from './layoutMixin';\nimport { bounding_box } from '../utils/functions';\nimport { DIRECTION } from '../utils/constance';\n\n/**\n * 图片单元 配置\n * @typedef {Rectangle~RectangleConfigs} Icon~IconConfigs\n * @property {number} image   - 图片地址\n * @property {number} imageWidth   - 图片宽度\n * @property {number} imageHeight   - 图片高度\n */\n\n/**\n * 图片单元\n * @description 图片单元可以绘制图片，图片加载后会自动重新绘制\n * @constructor Icon\n * @extends Rectangle\n * @param {Icon~IconConfigs} configs - 配置\n */\nclass Icon extends Rectangle {\n    constructor(configs) {\n        super(configs)\n        this.image = configs.image;\n        this.image.onload = () => {\n            requestAnimationFrame(() => {\n                this._jflow._render();\n            })\n        }\n        this.imageBounding = {\n            width: configs.imageWidth || configs.width,\n            height: configs.imageHeight ||  configs.height,\n        }\n    }\n\n    render(ctx) {\n        ctx.save();\n        if(this._isMoving){\n            ctx.globalAlpha = 0.5;\n        }\n        Rectangle.prototype.render.call(this, ctx);\n        const x = this.anchor[0] - this.width / 2;\n        const y = this.anchor[1] - this.height / 2;\n        ctx.drawImage(this.image, x, y, this.imageBounding.width, this.imageBounding.height);\n        ctx.restore();\n    }\n}\nexport default Icon;","import BaseLink from './base-link';\nimport { distToSegmentSquared } from '../utils/functions';\nimport { APPROXIMATE } from '../utils/constance';\nclass Link extends BaseLink {\n    constructor(configs) {\n        super(configs);\n        this.from   = configs.from; // Instance\n        this.to     = configs.to;   // Instance\n        this.controlPoints = [0, 1, -10, 1, -10, 5];\n        this._cachePoints = null;\n        this.defaultStyle = 'black';\n        this.hoverStyle = 'cornflowerblue';\n    }\n\n    getColor() {\n        if(this._isTargeting) {\n            return this.hoverStyle;\n        }\n        return this.defaultStyle;\n    }\n\n    _calculateAnchorPoints() {\n        const start = this.from.calculateIntersection(this.to.getCenter());\n        const end = this.to.calculateIntersection(this.from.getCenter());\n        this._cachePoints = [start, end];\n        return {\n            startX: start[0], \n            startY: start[1],\n            endX  : end[0],\n            endY  : end[1],\n        }\n    }\n\n    render(ctx) {\n        const { startX, startY, endX, endY } = this._calculateAnchorPoints();\n        const controlPoints = this.controlPoints;\n        var dx = endX - startX;\n        var dy = endY - startY;\n        var len = Math.sqrt(dx * dx + dy * dy);\n        var sin = dy / len;\n        var cos = dx / len;\n        var a = [];\n        a.push(0, 0);\n        for (var i = 0; i < controlPoints.length; i += 2) {\n            var x = controlPoints[i];\n            var y = controlPoints[i + 1];\n            a.push(x < 0 ? len + x : x, y);\n        }\n        a.push(len, 0);\n        for (var i = controlPoints.length; i > 0; i -= 2) {\n            var x = controlPoints[i - 2];\n            var y = controlPoints[i - 1];\n            a.push(x < 0 ? len + x : x, -y);\n        }\n        a.push(0, 0);\n        ctx.fillStyle = ctx.strokeStyle = this.getColor();\n        ctx.beginPath();\n        for (var i = 0; i < a.length; i += 2) {\n            var x = a[i] * cos - a[i + 1] * sin + startX;\n            var y = a[i] * sin + a[i + 1] * cos + startY;\n            if (i === 0) ctx.moveTo(x, y);\n            else ctx.lineTo(x, y);\n        }\n        ctx.fill();\n    }\n\n    isHit(point) {\n        if(!this._cachePoints) return false;\n        const [ start, end ] = this._cachePoints;\n        const dist = distToSegmentSquared(point, start, end)\n        return dist < APPROXIMATE;\n    }\n\n    getBoundingRect() {\n        const { startX, startY, endX, endY } = this._calculateAnchorPoints(); \n        return [[startX, startY], [endX, endY]]\n    }\n}\n\nexport default Link;","import BaseLink from './base-link';\nimport { bezierPoints, distToBezierSegmentSquared, getBezierAngle } from '../utils/functions';\nimport { APPROXIMATE } from '../utils/constance';\nimport { dist2, bezierPoint } from '../utils/functions';\nconst PIINRATIO = Math.PI / 180\n/**\n * @typedef {BaseLink~Configs} BezierLink~Configs\n * @property {Number} approximate   - 点击响应范围\n * @property {Number} minSpanX      - 起点终点在 x 方向最小的跨度\n * @property {Number} minSpanY      - 起点终点在 y 方向最小的跨度\n * @property {number[]} lineDash    - 虚线数组\n * @property {Boolean} doubleLink   - 双向箭头\n * @property {String} fontFamily    - 连线上的文字字体\n * @property {Number} fontSize      - 连线上的文字大小\n * @property {String} content       - 连线上的文字\n */\n/**\n * 贝塞尔曲线\n * @constructor BezierLink\n * @extends BaseLink\n * @param {BezierLink~Configs} configs - 配置\n */\nclass BezierLink extends BaseLink {\n     /**\n     * 创建贝塞尔曲线.\n     * @param {BezierLink~Configs} configs - 配置\n     **/\n    constructor(configs) {\n        super(configs);\n        this.approximate   = configs.approximate || APPROXIMATE;\n        this.minSpanX      = configs.minSpanX || 0;\n        this.minSpanY      = configs.minSpanY || 0;\n        this.lineDash      = configs.lineDash;\n        this.doubleLink    = configs.doubleLink;\n        this.fontFamily    = configs.fontFamily = '-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji'\n        this.fontSize      = configs.fontSize || '12px';\n        this.content       = configs.content || '';\n\n    }\n    \n    // getColor() {\n    //     if(this._isTargeting) {\n    //         return this.hoverStyle;\n    //     }\n    //     return this.defaultStyle;\n    // }\n    \n    // _calculateAnchorPoints() {\n    //     let start;\n    //     let end;\n    //     if(this.fromDir !== undefined) {\n    //         start = {\n    //             dir: this.fromDir,\n    //             p: this.from.getIntersectionsInFourDimension()[this.fromDir],\n    //         }\n    //     } else {\n    //         start = this.from.calculateIntersectionInFourDimension(this.to.getCenter(), 'from');\n    //     }\n    //     if(this.toDir !== undefined) {\n    //         end = {\n    //             dir: this.toDir,\n    //             p: this.to.getIntersectionsInFourDimension()[this.toDir],\n    //         }\n    //     } else {\n    //         end = this.to.calculateIntersectionInFourDimension(this.from.getCenter(), 'to');\n    //     }\n        \n        \n    //     // const start = this.from.calculateIntersectionInFourDimension(this.to.getCenter(), 'from');\n    //     // const end = this.to.calculateIntersectionInFourDimension(this.from.getCenter(), 'to');\n    //     const p1 = start.p;\n    //     const p2 = end.p;\n    //     const points = bezierPoints(p1, p2, start.dir, end.dir, this.anticlock);\n\n    //     this._cachePoints = [...p1, ...points]\n    // }\n\n    _calculateAnchorPoints() {\n\n        const dmsfrom = this.from.getIntersectionsInFourDimension();\n        const dmsto = this.to.getIntersectionsInFourDimension();\n        if(this.fromDir !== undefined && this.toDir !== undefined) {\n            const points = bezierPoints(\n                dmsfrom[this.fromDir],\n                dmsto[this.toDir],\n                this.fromDir,\n                this.toDir, this.minSpanX , this.minSpanY);\n            this._cachePoints = [...dmsfrom[this.fromDir], ...points] \n            this._cacheAngle = [this.fromDir, this.toDir]\n            return;\n        }\n        const meta = {\n            fromDir: null,\n            fromP: null,\n            toDir: null,\n            toP: null,\n            distMin: Infinity\n        }\n        Object.keys(dmsfrom).forEach(df => {\n            let pf = dmsfrom[df];\n            // if(this.from._belongs && this.from._belongs.calculateToCoordination) {\n            //     debugger\n            //     pf = this.from._belongs.calculateToCoordination(pf);\n            // }\n            Object.keys(dmsto).forEach(dt => {\n                let pt = dmsto[dt];\n                // if(this.to._belongs && this.to._belongs.calculateToCoordination) {\n                //     pt = this.to._belongs.calculateToCoordination(pt);\n                // }\n                const dist = dist2(pf, pt);\n                if(dist < meta.distMin) {\n                    Object.assign(meta, {\n                        distMin: dist,\n                        fromDir: +df,\n                        fromP: pf,\n                        toDir: +dt,\n                        toP: pt,\n                    })\n                }\n            })\n        });\n        const points = bezierPoints(\n            meta.fromP,\n            meta.toP,\n            meta.fromDir,\n            meta.toDir);\n\n        this._cachePoints = [...meta.fromP, ...points];\n        this._cacheAngle = [meta.fromDir, meta.toDir];\n    }\n\n    render(ctx) {\n        this._calculateAnchorPoints();\n        const points = this._cachePoints;\n        const angle = getBezierAngle.apply(null, [1, ...points])\n        ctx.fillStyle = ctx.strokeStyle = this.backgroundColor;\n        if(this.doubleLink) {\n            const beginAngle = ((this._cacheAngle[0] + 2) % 4) * 90 * PIINRATIO;\n            ctx.beginPath();\n            ctx.translate(points[0], points[1]);\n            ctx.rotate(beginAngle);\n            ctx.moveTo(5, 0);\n            ctx.lineTo(0, -4);\n            ctx.lineTo(0, 4);\n            ctx.lineTo(5, 0);\n            ctx.fill();\n            ctx.rotate(-beginAngle);\n            ctx.translate(-points[0], -points[1]);\n        }\n        ctx.beginPath();\n        ctx.moveTo(points[0], points[1])\n        ctx.bezierCurveTo(...points.slice(2));\n        if(this.lineDash) {\n            ctx.save();\n            ctx.setLineDash(this.lineDash);\n        }\n        ctx.stroke();\n        if(this.lineDash) {\n            ctx.restore();\n        }\n        ctx.beginPath();\n        ctx.translate(points[6], points[7]);\n        ctx.rotate(angle);\n        ctx.moveTo(5, 0);\n        ctx.lineTo(0, -4);\n        ctx.lineTo(0, 4);\n        ctx.lineTo(5, 0);\n        ctx.fill();\n        ctx.rotate(-angle);\n        ctx.translate(-points[6], -points[7]);\n        if(this.content) {\n            ctx.beginPath();\n            const [x, y, angle] = bezierPoint(0.5, points);\n            ctx.translate(x, y);\n            ctx.rotate(angle);\n            ctx.font = `${this.fontSize} ${this.fontFamily}`;\n            ctx.textAlign = 'center';\n            ctx.fillText(this.content, 0, 10);\n            ctx.rotate(-angle);\n            ctx.translate(-x, -y);\n        }\n    }\n\n    isHit(point) {\n        if(!this._cachePoints) return false;\n        const points = this._cachePoints;\n        const dist = distToBezierSegmentSquared(point, points)\n        return dist < this.approximate;\n    }\n\n    getBoundingRect() {\n        const { startX, startY, endX, endY } = this._calculateAnchorPoints(); \n        return [[startX, startY], [endX, endY]]\n    }\n}\n\nexport default BezierLink;","/**\n    线性布局\n\n    排列方向\n    direction:\n        + vertical 从上至下排布\n        + horizontal 从左至右排布\n    \n    不重叠，中线对齐\n    只针对当前的 group\n\n    对齐方式\n    alignment: \n        + start 主轴左侧对齐\n        + center 主轴对齐\n        + end   主轴右侧对齐\n    justify: \n        + start 开始时对齐\n        + center 居中对齐\n        + end   末尾对齐\n        + space-between 平均分配空间对齐\n\n * @implements {Layout}\n */\n\nclass LinearLayout {\n    constructor(configs = {}) {\n        /**\n         * 通用样式属性\n         * @property {string} direction     - 排列方向 默认 vertical\n         * @property {number} gap           - 边距, 默认是 5\n         * @property {string} alignment     - 垂直排列方向对齐方式 默认 center\n         * @property {string} justify       - 排列方向对齐方式 默认 center\n         */\n        this.direction =     configs.direction || 'vertical';\n        this.gap =           configs.gap ?? 5;\n        this.alignment =     configs.alignment || 'center';\n        this.justify =       configs.justify || 'center';\n        // this.widthSetByParent =  configs.width === '100%'\n        this._rawConfigs = configs;\n    }\n\n\n    reflow(group) {\n        const stack = group._stack.filter(instance => instance.visible && !instance.outOfFlow);\n        const groupWidth = group.width - group.padding.left - group.padding.right;\n        // console.log(groupWidth, group.height, group)\n        if(this.direction === 'vertical') {\n            let reduceHeight = 0;\n            let lastInstanceHeight = 0;\n            let maxWidth = 0;\n            let allHeight = 0;\n            stack.forEach((instance, idx) =>  {\n                const { width, height } = instance.getBoundingDimension();\n                // console.log(height, instance.type);\n                const gap = (idx > 0 ? this.gap : 0);\n                maxWidth = Math.max(width, maxWidth);\n                allHeight += (height + gap);\n                reduceHeight += (height/2 + gap + lastInstanceHeight)\n                lastInstanceHeight = height / 2;\n                instance.anchor = [0, reduceHeight];\n            });\n            maxWidth = Math.max(groupWidth, maxWidth);\n            \n            allHeight = allHeight/2;\n            if(this.alignment === 'start') {\n                stack.forEach((instance, idx) =>  {\n                    const { width } = instance.getBoundingDimension();\n                    instance.anchor[0] = -(maxWidth - width) / 2;\n                    instance.anchor[1] -= allHeight;\n                    // console.log(maxWidth, width, instance.anchor[0])\n                })\n            }\n            if(this.alignment === 'end') {\n                stack.forEach((instance, idx) =>  {\n                    const { width } = instance.getBoundingDimension();\n                    instance.anchor[0] = (maxWidth - width) / 2;\n                    instance.anchor[1] -= allHeight;\n                })\n            }\n            if(this.alignment === 'center') {\n                stack.forEach((instance, idx) =>  {\n                    const { width } = instance.getBoundingDimension();\n                    instance.anchor[1] -= allHeight;\n                })\n            }\n\n        } \n        if(this.direction === 'horizontal') {\n            let reduceWidth = 0;\n            let lastInstanceWidth = 0;\n            let maxHeight = 0;\n            let allWidth = 0;\n            let allPureWidth = 0;\n            \n            stack.forEach((instance, idx) =>  {\n                const { width, height } = instance.getBoundingDimension();\n                const gap = (idx > 0 ? this.gap : 0);\n                maxHeight = Math.max(height, maxHeight);\n                allWidth += (width+gap);\n                allPureWidth += width;\n                reduceWidth += (width/2 + gap + lastInstanceWidth)\n                lastInstanceWidth = width / 2;\n                instance.anchor = [reduceWidth, 0]\n            });\n            if(this.justify === 'start') {\n                const withdraw = groupWidth/2;\n                stack.forEach((instance, idx) => {\n                    instance.anchor[0] -= withdraw;\n                });  \n            }\n            if(this.justify === 'end') {\n                const withdraw = groupWidth/2 - allWidth;\n                stack.forEach((instance, idx) => {\n                    instance.anchor[0] += withdraw;\n                });  \n            }\n            if(this.justify === 'center') { \n                const withdraw = allWidth / 2;\n                stack.forEach((instance, idx) => {\n                    instance.anchor[0] -= withdraw;\n                })                \n            }\n            if(this.justify === 'space-between' && stack.length > 1) {\n                const width = Math.max(groupWidth, allWidth);\n                const gapAverage = (width - allWidth) / (stack.length - 1);\n                const withdraw = width/2;\n                stack.forEach((instance, idx) => {\n                    instance.anchor[0] += ((gapAverage * idx) - withdraw);\n                });  \n            }\n            if(this.alignment === 'start') {\n                stack.forEach((instance, idx) => {\n                    const { height } = instance.getBoundingDimension();\n                    instance.anchor[1] = -(maxHeight - height) / 2;\n                })\n            }\n            if(this.alignment === 'end') {\n                stack.forEach((instance, idx) => {\n                    const { height } = instance.getBoundingDimension();\n                    instance.anchor[1] = (maxHeight - height) / 2;\n                })\n            }\n        }\n    }\n\n    clone() {\n        return new LinearLayout(this._rawConfigs);\n    }\n}\n\nexport default LinearLayout;","\n// import EventEmitter from '../../utils/EventEmitter';\nimport { DIRECTION } from '../../utils/constance';\nclass BaseNode {\n    constructor(source) {\n        this.source = source;\n        this.id = source.id;\n        this.type = source.type;\n        this.isDraggable = true;\n        this.getJflowInstance = undefined;\n        this.level = undefined;\n        this.sequence = undefined;\n        this.isLocked = false;\n        this.isFree = false;\n        this.parent = undefined;\n        this.idx = undefined;\n        this.parentIterateType = undefined;\n        source._getAstNode = () => this;\n    }\n\n    reflowPreCalculate(level = 0, sequence = 0, callback) {\n        this.level = level;\n        this.sequence = sequence;\n        this.spanX = 1;\n        this.spanY = 1;\n        if(callback) {\n            console.log(level, sequence, this.id)\n            callback(level, sequence, this);\n        }\n        return {\n            spanX: this.spanX, \n            spanY: this.spanY, \n            level, sequence,\n        }\n    }\n\n    makeLink(callback) {\n        return this;\n    }\n\n    makeEndpoint() { }\n\n    traverse(callback) {\n        callback(this);\n    }\n\n    getNodes() {\n        const nodes = [];\n        this.traverse(n => {\n            if(n.getJflowInstance)\n                nodes.push(n.getJflowInstance());\n        })\n        return nodes;\n    }\n\n    linkSource(source) {\n        this.parent.source[this.parentIterateType].splice(this.idx + 1, 0, source);\n    }\n\n    remove() {\n        this.parent.source[this.parentIterateType].splice(this.idx, 1);\n    }\n}\n\nclass Root extends BaseNode {\n    constructor(source) {\n        super(source);\n        this.isroot = true;\n        this.body = (source.body || []).map(mapFunc('body').bind(this));\n        const playgrounditerator = mapFunc('playground').bind(this)\n        this.playground = (source.playground || []).map((s, idx) => {\n            const n = playgrounditerator(s, idx);\n            n.isFree = true;\n            return n;\n        });\n    }\n\n    reflowBodyPreCalculate(level = 0, sequence = 0, callback) {\n        let spanX = 1;\n        let spanY = 1;\n        this.level = level;\n        this.sequence = sequence;\n        if(callback) {\n            callback(level, sequence, this);\n        }\n        this.body.forEach((b) => {\n            const { spanX: sx, spanY: sy } = b.reflowPreCalculate(level + 1, sequence, callback);\n            spanX = Math.max(sx, spanX);\n            spanY += sy;\n            level += sy;\n        });\n\n        this.spanX = spanX;\n        this.spanY = spanY;\n        return {\n            spanX, spanY, level, sequence\n        }\n    }\n\n    reflowPlaygroundPreCalculate(preCallback, callback) {\n        this.playground.forEach(node => {\n            preCallback(node)\n            node.reflowPreCalculate(0, 0, callback)\n        })\n    }\n\n\n    makeLink(callback) {\n        let last;\n        this.body.forEach(b => {\n            if(!last) {\n                last = b;\n                return;\n            }\n            callback({\n                from: last.id,\n                to: b.id,\n                part: 'body',\n                fromDir: DIRECTION.BOTTOM,\n                toDir: DIRECTION.TOP,\n                meta: {\n                    from: last,\n                    to: b\n                }\n            })\n            \n            b = b.makeLink(callback);\n            last = b;\n        });\n\n        this.playground.forEach(n => {\n            n.makeLink(callback);\n        });\n        return this;\n    }\n\n    traverse(callback) {\n        this.body.forEach(n => {\n            n.traverse(callback);\n        });\n\n        this.playground.forEach(n => {\n            n.traverse(callback);\n        })\n    }\n}\n\nclass IfStatement extends BaseNode {\n    constructor(source) {\n        super(source);\n        this.consequent = (source.consequent || []).map(mapFunc('consequent').bind(this));\n        this.alternate = (source.alternate || []).map(mapFunc('alternate').bind(this));\n        this.isLocked = true;\n    }\n    \n    reflowPreCalculate(level = 0, sequence = 0, callback) {\n        let spanX = 1;\n        let spanY = 1;\n        this.level = level;\n        this.sequence = sequence;\n        if(callback) {\n            callback(level, sequence, this);\n        }\n        let c_spanX = 1;\n        let c_spanY = 0;\n        let a_spanX = 0;\n        let a_spanY = 0;\n        this.consequent.forEach((c, idx) => {   \n            const { spanX: sx, spanY: sy } = c.reflowPreCalculate(level + 1, sequence, callback);\n            c_spanX = Math.max(c_spanX, sx);\n            c_spanY += sy;\n            level += sy;\n        });\n        const nextSequeence = sequence + c_spanX;\n        level = this.level;\n        this.alternate.forEach((a, idx) => {\n            const { spanX: sx, spanY: sy } = a.reflowPreCalculate(level + 1, nextSequeence, callback);\n            a_spanX = Math.max(a_spanX, sx);\n            a_spanY += sy;\n            level += sy;\n        });\n        spanX = Math.max(1, c_spanX + a_spanX);\n        spanY += Math.max(c_spanY, a_spanY);\n        level = this.level + spanY - 1;\n        const { spanY: sy } = this.Endpoint.reflowPreCalculate(level + 1, sequence, callback);\n        spanY += sy;\n        this.spanX = spanX;\n        this.spanY = spanY;\n        return {\n            spanX, spanY, level, sequence\n        }\n    }\n\n    makeLink(callback) {\n        let lastc = this;\n        this.consequent.forEach(c => {\n            callback({\n                from: lastc.id,\n                to: c.id,\n                part: 'consequent',\n                fromDir: DIRECTION.BOTTOM,\n                toDir: DIRECTION.TOP,\n                meta: {\n                    from: lastc,\n                    to: c\n                }\n            });\n\n            c = c.makeLink(callback)\n            lastc = c;\n        })\n\n        callback({\n            from: lastc.id,\n            to: this.Endpoint.id,\n            fromDir: DIRECTION.BOTTOM,\n            toDir: DIRECTION.TOP,\n            part: 'consequent',\n            meta: {\n                from: lastc,\n                to: this.Endpoint\n            }\n        });\n\n        let lasta = this;\n        this.alternate.forEach(a => {\n            callback({\n                from: lasta.id,\n                to: a.id,\n                fromDir: lasta === this ? DIRECTION.RIGHT : DIRECTION.BOTTOM,\n                toDir: DIRECTION.TOP,\n                part: 'alternate',\n                meta: {\n                    from: lasta,\n                    to: a\n                }\n            })\n            a = a.makeLink(callback)\n            lasta = a;\n        });\n        callback({\n            from: lasta.id,\n            to: this.Endpoint.id,\n            fromDir: lasta === this ? DIRECTION.RIGHT : DIRECTION.BOTTOM,\n            toDir: DIRECTION.RIGHT,\n            part: 'alternate',\n            meta: {\n                from: lasta,\n                to: this.Endpoint\n            }\n        });\n\n        return this.Endpoint;\n    }\n\n    makeEndpoint() {\n        this.Endpoint = makeAST({\n            type: 'endpoint',\n            id: `${this.id}-endpoint`,\n        });\n        this.Endpoint.parent = this.parent;\n        this.Endpoint.idx = this.idx;\n        this.Endpoint.parentIterateType = this.parentIterateType;     \n    }\n\n    traverse(callback) {\n        callback(this);\n        this.consequent.forEach(n => {\n            n.traverse(callback);\n        });\n        this.alternate.forEach(n => {\n            n.traverse(callback);\n        });\n        callback(this.Endpoint);\n    }\n\n    linkSource(source, linkMeta) {\n        this.source[linkMeta.part].unshift(source);\n    }\n}\n\nclass SwitchStatement extends BaseNode {\n    constructor(source) {\n        super(source);\n        this.cases = (source.cases || []).map(mapFunc('case').bind(this))\n        if(this.cases.length) {\n            this.cases[this.cases.length - 1].lastCase = true;\n        }\n        this.isLocked = true;\n    }\n\n    reflowPreCalculate(level = 0, sequence = 0, callback) {\n        let spanX = 1;\n        let spanY = 1;\n        this.level = level;\n        this.sequence = sequence;\n        if(callback) {\n            callback(level, sequence, this);\n        }\n\n        let c_spanX = 1;\n        let c_spanY = 0;\n        if(this.cases.length) {\n            const consequent = this.cases[this.cases.length - 1].consequent;\n            level = this.level;\n            consequent.forEach(cc => {\n                const { spanX: sx, spanY: sy } = cc.reflowPreCalculate(level + 1, sequence, callback);\n                c_spanX = Math.max(c_spanX, sx);\n                c_spanY += sy;\n                level += sy;\n            });\n        }\n        \n        \n        let s_spanX = c_spanX;\n        let s_spanY = 0;\n        this.cases.forEach((c, idx) => {\n            const nextSequeence = sequence + s_spanX;\n            let a_spanX = 0;\n            let a_spanY = 0;\n            level = this.level;\n            c.alternate.forEach(ca => {\n                const { spanX: sx, spanY: sy } = ca.reflowPreCalculate(level + 1, nextSequeence, callback);\n                a_spanX = Math.max(a_spanX, sx);\n                a_spanY += sy;\n                level += sy;\n            });\n            s_spanX += a_spanX;\n            s_spanY = Math.max(s_spanY, a_spanY);\n        });\n       \n        \n        spanX = Math.max(1, s_spanX);\n        spanY = Math.max(c_spanY, s_spanY);\n        level = this.level + spanY;\n        const { spanY: sy } = this.Endpoint.reflowPreCalculate(level + 1, sequence, callback);\n        spanY += sy;\n        spanY += 1 // 要算上自己\n        this.spanX = spanX;\n        this.spanY = spanY;\n        return {\n            spanX, spanY, level, sequence\n        }       \n    }\n\n    makeLink(callback) {\n        let lastc = this;\n        if(this.cases.length) {\n            const consequent = this.cases[this.cases.length - 1].consequent;\n            consequent.forEach(c => {\n                callback({\n                    from: lastc.id,\n                    to: c.id,\n                    fromDir: DIRECTION.BOTTOM,\n                    toDir: DIRECTION.TOP,\n                    part: 'consequent',\n                    meta: {\n                        from: lastc,\n                        to: c\n                    }\n                });\n                lastc = c.makeLink(callback)\n            });\n        }\n        callback({\n            from: lastc.id,\n            to: this.Endpoint.id,\n            fromDir: DIRECTION.BOTTOM,\n            toDir: DIRECTION.TOP,\n            part: 'alternate',\n            meta: {\n                from: lastc,\n                to: this.Endpoint\n            }\n        });\n\n        this.cases.forEach(c => {\n            let lasta = c;\n            c.alternate.forEach(a => {\n                callback({\n                    from: lasta.id,\n                    to: a.id,\n                    fromDir: lasta === c ? DIRECTION.RIGHT : DIRECTION.BOTTOM,\n                    toDir: DIRECTION.TOP,\n                    part: 'alternate',\n                    meta: {\n                        from: lasta,\n                        to: a\n                    }\n                });\n                lasta = a.makeLink(callback)\n            })\n            \n            callback({\n                from: lasta.id,\n                to: this.Endpoint.id,\n                fromDir: lasta === c ? DIRECTION.RIGHT : DIRECTION.BOTTOM,\n                toDir: DIRECTION.RIGHT,\n                part: 'alternate',\n                meta: {\n                    from: lasta,\n                    to: this.Endpoint\n                }\n            });\n        });\n\n        return this.Endpoint;\n    }\n\n    makeEndpoint() {\n        this.Endpoint = makeAST({\n            type: 'endpoint',\n            id: `${this.id}-endpoint`,\n        });\n        this.Endpoint.parent = this.parent;\n        this.Endpoint.parentIterateType = this.parentIterateType;     \n        this.Endpoint.idx = this.idx;\n    }\n\n    traverse(callback) {\n        callback(this);\n        this.cases.forEach(n => {\n            n.traverse(callback);\n        });\n        callback(this.Endpoint);\n    }\n}\n\nclass ForEachStatement extends BaseNode {\n    \n}\n\nclass WhileStatement extends BaseNode {\n    constructor(source) {\n        super(source);\n        this.body = (source.body || []).map(mapFunc('body').bind(this));\n        console.log(this.body)\n        this.isLocked = true\n    }\n\n    reflowPreCalculate(level = 0, sequence = 0, callback) {\n        let spanX = 1;\n        let spanY = 1;\n        this.level = level;\n        this.sequence = sequence;\n        if(callback) {\n            callback(level, sequence, this);\n        }\n        const nextSequeence = sequence + 1;\n        // level--;\n        this.body.forEach((b) => {\n            const { spanX: sx, spanY: sy } = b.reflowPreCalculate(level + 1, nextSequeence, callback);\n            spanX = Math.max(sx, spanX);\n            spanY += sy;\n            level += sy;\n        });\n\n        this.spanX = spanX + 1;\n        this.spanY = spanY;\n        return {\n            spanX, spanY, level, sequence\n        }\n    }\n\n    makeLink(callback) {\n        let last = this;\n        // const lastIdx = this.body.length - 1;\n        this.body.forEach((b, idx) => {\n            callback({\n                from: last.id,\n                to: b.id,\n                part: 'body',\n                fromDir: last === this ? DIRECTION.RIGHT: DIRECTION.BOTTOM,\n                toDir: DIRECTION.TOP,\n                meta: {\n                    from: last,\n                    to: b\n                }\n            })\n            \n            b = b.makeLink(callback);\n            last = b;\n        });\n        console.log(last === this)\n        callback({\n            from: last.id,\n            to: this.id,\n            part: 'body',\n            fromDir: last === this ? DIRECTION.RIGHT : DIRECTION.BOTTOM,\n            anticlock: last === this,\n            toDir: DIRECTION.BOTTOM,\n            meta: {\n                from: last,\n                to: this\n            }\n        });\n        return this;\n    }\n\n    traverse(callback) {\n        callback(this);\n        this.body.forEach(n => {\n            n.traverse(callback);\n        });\n    }\n\n    linkSource(source, linkMeta) {\n        this.source[linkMeta.part].unshift(source);\n    }\n}\n\nclass SwitchCase extends BaseNode {\n    constructor(source) {\n        super(source);\n        this.consequent = (source.consequent || []).map(mapFunc('consequent').bind(this));\n        this.alternate = (source.alternate || []).map(mapFunc('alternate').bind(this));\n        this.lastCase = false;\n    }\n\n    reflowPreCalculate(level = 0, sequence = 0, callback) {\n        let spanX = 1;\n        let spanY = 1;\n        this.level = level;\n        this.sequence = sequence;\n        if(callback) {\n            callback(level, sequence, this);\n        }\n        \n        let c_spanX = 0;\n        let c_spanY = 0;\n        let a_spanX = 0;\n        let a_spanY = 0;\n        if(this.lastCase) {\n            this.consequent.forEach((c, idx) => {\n                const { spanX: sx, spanY: sy } = c.reflowPreCalculate(level + 1, sequence, callback);\n                c_spanX = Math.max(c_spanX, sx);\n                c_spanY += sy;\n                level += sy;\n            });\n        }\n        \n        const nextSequeence = sequence + Math.max(c_spanX, 1);\n        level = this.level;\n        this.alternate.forEach((a, idx) => {\n            const { spanX: sx, spanY: sy } = a.reflowPreCalculate(level + 1, nextSequeence, callback);\n            a_spanX = Math.max(a_spanX, sx);\n            a_spanY += sy;\n            level += sy;\n        });\n        spanX = Math.max(1, c_spanX + a_spanX);\n        spanY += Math.max(c_spanY, a_spanY);\n\n        this.spanX = spanX;\n        this.spanY = spanY;\n        return {\n            spanX, spanY, level, sequence\n        }       \n    }\n\n    traverse(callback) {\n        callback(this);\n        this.consequent.forEach(n => {\n            n.traverse(callback);\n        });\n        this.alternate.forEach(n => {\n            n.traverse(callback);\n        });\n    }\n\n    linkSource(source, linkMeta) {\n        this.source[linkMeta.part].unshift(source);\n    }\n}\n \nconst TYPE_MAPPING = {\n    IfStatement,\n    SwitchStatement,\n    SwitchCase,\n    ForEachStatement,\n    WhileStatement,\n    Root,\n    other: BaseNode,\n}\n\nfunction mapFunc(type)  {\n    return function(n, idx) {\n        const p = makeAST(n);\n        p.parent = this;\n        p.idx = idx;\n        p.parentIterateType = type;\n        p.makeEndpoint();\n        return p;\n    }\n}\nfunction makeAST(source) {\n    const type = source.type;\n    const Constructor = TYPE_MAPPING[type] || TYPE_MAPPING.other;\n    console.log(type)\n    const node = new Constructor(source);\n    return node;\n}\nexport { \n    makeAST,\n}\n\n","import JFlowEvent from '../events'; \nimport { DIRECTION } from '../utils/constance';\nimport { makeAST } from './low-code-types/baseNode';\n\nfunction sqr(x) {\n    return x * x;\n}\nfunction dist2(v, w) {\n    return sqr(v[0] - w[0]) + sqr(v[1] - w[1]);\n}\n\n/**\n    lowcode layout\n\n    type: \n        + IfStatement,\n        + SwitchStatement,\n        + SwitchCase,\n        + ForEachStatement,\n        + WhileStatement,\n        + Root,\n        + other,\n    \n    * @implements {Layout}\n */\nclass LowcodeLayout {\n    constructor(configs) {\n        this.linkLength = configs.linkLength || 18;\n        this.gap = configs.gap || 30;\n        this.treeItemDraggable = configs.treeItemDraggable ?? true;\n        this.reOrder(configs.ast);\n        this.static = true;\n    }\n    /**\n     * 从 ast 计算布局\n     * @param {AstNode} ast - ASL 树\n     */\n    reOrder(ast) {\n        this.ast = ast;\n        this.flowStack = [];\n        this.flowLinkStack = [];\n\n        this.root = makeAST(this.ast)// new AstNode(this.ast, this.flowStack, true);\n        this.root.traverse((node) => {\n            if(node.parentIterateType !== 'playground') {\n                node.isDraggable = this.treeItemDraggable\n            }\n            this.flowStack.push({\n                type: node.type,\n                configs: node.source,\n                layoutMeta: node,\n            });\n        });\n\n        const layoutMapping = {\n            vertical: {},\n            horizontal: {},\n        };\n        const playgroundLayoutMapping = {}\n        this.root.reflowBodyPreCalculate(0, 0, (level, sequence, node) => {\n            if(!node.isroot) {\n                if(!layoutMapping.vertical[level]){\n                    layoutMapping.vertical[level] = {};\n                }\n                layoutMapping.vertical[level][sequence] = node;\n                \n                if(!layoutMapping.horizontal[sequence]){\n                    layoutMapping.horizontal[sequence] = {};\n                }\n                layoutMapping.horizontal[sequence][level] = node;\n            }\n        });\n\n        let currentTopNodeId;\n        this.root.reflowPlaygroundPreCalculate(\n            (topNode) => {\n                currentTopNodeId = topNode.id;\n                playgroundLayoutMapping[topNode.id] = {\n                    vertical: {},\n                    horizontal: {},\n                    node: topNode,\n                }\n            },\n            (level, sequence, node) => {\n                const layoutMapping = playgroundLayoutMapping[currentTopNodeId];\n                if(!layoutMapping.vertical[level]){\n                    layoutMapping.vertical[level] = {};\n                }\n                layoutMapping.vertical[level][sequence] = node;\n                \n                if(!layoutMapping.horizontal[sequence]){\n                    layoutMapping.horizontal[sequence] = {};\n                }\n                layoutMapping.horizontal[sequence][level] = node;\n            })\n\n        this.layoutMapping = layoutMapping;\n        this.playgroundLayoutMapping = playgroundLayoutMapping;\n        this.root.makeLink((configs) => {\n            this.flowLinkStack.push(configs)\n        })\n    }\n\n    staticCheck(instance, jflow) {\n\n        if(instance._layoutNode && instance._layoutNode.isFree) {\n            return false;\n        }\n        const finded = jflow._linkStack.find(l => l.from === instance || l.to === instance);\n        if(!finded) {\n            return false;\n        }\n        const nowAnchor = instance.anchor.slice();\n        jflow.reflow();\n        if(jflow._linkStack.length < 2) return;\n        const currentAnchor = instance.anchor;\n        const d = dist2(nowAnchor, currentAnchor);\n        if(d > 1000) {\n            instance.dispatchEvent(new JFlowEvent('outOfFlow', {\n                anchor: nowAnchor,\n                instance,\n                jflow,\n                point: nowAnchor,\n            }))\n            return true;\n        }\n        return false;\n    }\n\n    reflowByMapping(layoutMapping, x = 0, y = 0) {\n        const linkLength = this.linkLength;\n        const gap = this.gap;\n        const {\n            vertical: verticalMapping,\n            horizontal: horizontalMapping,\n        } = layoutMapping;\n\n        let reduceWidth = x;\n        Object.keys(horizontalMapping).forEach((columnNumber, idx) => {\n            const column = horizontalMapping[columnNumber];\n            let rowWidth = 0;\n            const rows = Object.keys(column)\n            rows.forEach(rowNumber => {\n                const ast = column[rowNumber];\n                const instance = ast.getJflowInstance();\n                const { width } = instance.getBoundingDimension();\n                rowWidth = Math.max(width, rowWidth);\n            });\n            reduceWidth += idx === 0 ? 0: rowWidth/2\n            rows.forEach(rowNumber => {\n                const ast = column[rowNumber];\n                const instance = ast.getJflowInstance();\n                instance.anchor[0] = reduceWidth;\n            });\n            reduceWidth += (rowWidth/2 + gap) ;\n        });\n\n        let reduceHeight = y;\n        // console.log(verticalMapping)\n        Object.keys(verticalMapping).forEach((rowNumber, idx) => {\n            const row = verticalMapping[rowNumber];\n            let rowHeight = 0;\n            const columns = Object.keys(row)\n            columns.forEach(columnNumber => {\n                const ast = row[columnNumber];\n                const instance = ast.getJflowInstance();\n                const { height, width } = instance.getBoundingDimension();\n                rowHeight = Math.max(height, rowHeight);\n            });\n            reduceHeight += idx === 0 ? 0 : rowHeight/2;\n            columns.forEach(columnNumber => {\n                const ast = row[columnNumber];\n                const instance = ast.getJflowInstance();\n                instance.anchor[1] = reduceHeight;\n            });\n            reduceHeight += (rowHeight/2 + linkLength) ;\n        });\n        \n    }\n\n    findLayoutNode(configs) {\n        const finded = this.flowStack.find(node => node.configs === configs);\n        if(finded) {\n            return finded.layoutMeta;\n        }\n        return null;\n    }\n\n    reflow(jflow){\n        this.reflowByMapping(this.layoutMapping);\n        Object.values(this.playgroundLayoutMapping).forEach(mapping => {\n            const node = mapping.node.getJflowInstance();\n            this.reflowByMapping(mapping, node.anchor[0], node.anchor[1]);\n        })\n    }\n}\n\nexport default LowcodeLayout;","import { DIRECTION } from '../../utils/constance';\nfunction getRelationShip(p1, p2) {\n    if(p1.type === 'Array' && p2.type !== 'Array') {\n        return '多对一'\n    }\n    if(p2.type === 'Array' && p1.type !== 'Array') {\n        return '一对多'\n    }\n    if(p1.type === 'Array' && p2.type === 'Array') {\n        return '多对多'\n    }\n    if(p1.type !== 'Array' && p2.type !== 'Array') {\n        return '一对一'\n    }\n}\nclass ERProperty {\n    constructor(source, node, isNavigation) {\n        this.type = 'ERProperty';\n        this.source = source;\n        this.node = node;\n        this.ref = source.ref;\n        this.type = source.type;\n        this.association = source.association;\n        this.id = isNavigation ? `${node.id}-${source.name}-navigation` : `${node.id}-${source.name}`\n        this._selfLink = false;\n        this.parentPropertyRef = undefined;\n        this.getJflowInstance = undefined;\n\n        this.doubleRef = undefined;\n    }\n}\n\nclass ERNode { \n    constructor(source) {\n        this.type = 'ERNode';\n        this.source = source;\n        this.id = source.name;\n        this.isDraggable = true;\n        this.getJflowInstance = undefined;\n        // this.adjacencyList = []\n        this.propertyList = source.propertyList.map(p => new ERProperty(p, this));\n        this.navigationPropertyList = source.navigationPropertyList.map(p => new ERProperty(p, this, true))\n        this.idProperty = this.propertyList.find(p => p.source.name === 'id');\n        // this.VertexNameProperty = this.propertyList.find(p => p.source.type === 'VertexName');\n    }\n\n    _traverseProperty(nodeMap) {\n        this.propertyList.forEach(property => {\n            const idRef = property.source.idRef; // 决定链接的对象\n            const isParentRef = property.source.isParentRef; // 决定连接的性质\n            if(idRef && property.source.type !== 'Array' && nodeMap[idRef]) {\n                const parentRef = nodeMap[idRef];\n                if (property.source.isParentRef) {\n                    this.parentRef = parentRef;\n                }\n                if (parentRef === this) {\n                    property._selfLink = true;\n                }\n                property.parentPropertyRef = parentRef.idProperty;\n            }\n        });\n        this.navigationPropertyList.forEach(property => {\n            const objectRef = property.source.objectRef;\n            if(objectRef && nodeMap[objectRef]) {\n                const node = nodeMap[objectRef];\n                const targetProperty = node.navigationPropertyList.find(n => n.source.objectRef === this.id)\n                if (node === this) {\n                    property._selfLink = true;\n                }\n                property.doubleRef = targetProperty;\n            }\n        })\n        \n    }\n\n    traverse(callback) {\n        callback(this);\n        this.propertyList.forEach(property => {\n            if(property.ref instanceof ERNode) {\n                callback(property);\n            }\n        })\n    }\n\n    makeLink(callback) {\n        this.propertyList.forEach(property => {\n            if(property.parentPropertyRef instanceof ERProperty) {\n                const toProperty = property.parentPropertyRef;\n                if(property._selfLink) {\n                    callback({\n                        from: property.id,\n                        to: toProperty.id,\n                        part: 'property',\n                        fromDir: DIRECTION.LEFT,\n                        toDir: DIRECTION.LEFT,\n                        content: property.association,\n                        minSpanX: 80,\n                        meta: {\n                            from: property,\n                            to: toProperty,\n                        }\n                    });\n                } else {\n                    callback({\n                        from: property.id,\n                        to: toProperty.id,\n                        part: 'property',\n                        content: property.association,\n                        meta: {\n                            from: property,\n                            to: toProperty,\n                        }\n                    });\n                }\n            }\n        });\n\n        \n        this.navigationPropertyList.forEach(property => {\n            if(property.doubleRef instanceof ERProperty) {\n                const toProperty = property.doubleRef;\n                if(property._selfLink) {\n                    callback({\n                        from: property.id,\n                        to: toProperty.id,\n                        part: 'property',\n                        fromDir: DIRECTION.LEFT,\n                        toDir: DIRECTION.TOP,\n                        lineDash: [10, 5],\n                        doubleLink: true,\n                        content: property.association,\n                        minSpanX: 80,\n                        minSpanY: 80,\n                        meta: {\n                            from: property,\n                            to: toProperty,\n                        }\n                    });\n                } else {\n                    callback({\n                        from: property.id,\n                        to: toProperty.id,\n                        part: 'property',\n                        lineDash: [10, 5],\n                        doubleLink: true,\n                        content: property.association,\n                        meta: {\n                            from: property,\n                            to: toProperty,\n                            isObjectRef: true,\n                        }\n                    });\n                }\n            }\n        })\n    }\n}\n\nfunction makeER(source) {\n    const nodeMap = {};\n    const nodes = source.map(s => {\n        const node = new ERNode(s);\n        nodeMap[s.name] = node\n        return node;\n    });\n    nodes.forEach(node => {\n        node._traverseProperty(nodeMap);\n    });\n    return nodes;\n}\nexport { \n    makeER,\n}","\nimport { makeER } from './er-node';\n/**\n    ER layout\n\n    Entity Relationship Structure\n    tree = [\n        {\n            type: 'node',\n            id: 'uniqueID',\n            properties: [\n                {\n                    name: 'xxxx',\n                    ref: someUniqueId,\n                    description: 'xxxxxx',\n                },\n                ...\n            ]\n        },\n        ...\n    ]\n    \n    * @implements {Layout}\n */\n\nclass ERLayout {\n    constructor(configs) {\n        this.static = false;\n        this.flowStack = [];\n        this.flowLinkStack = [];\n        this.erNodes = [];\n        this.reOrder(configs.entityRelationship);\n    }\n    /**\n     * 从 tree 计算布局\n     * @param {AstNode} tree - ER 树\n     */\n    reOrder(er, root) {\n        this.er = er;\n        this.flowStack = [];\n        this.flowLinkStack = [];\n        const nodes = makeER(this.er);\n        const idMap = [];\n        nodes.forEach(node => {\n            node.traverse((n) => {\n                this.flowStack.push({\n                    type: n.type,\n                    configs: n.source,\n                    layoutMeta: n,\n                })\n            });\n            node.makeLink(configs => {\n                const {\n                    from: property,\n                    to: toProperty,\n                    meta,\n                } = configs;\n                if(meta.isObjectRef) {\n                    const id1 = `${property}-${toProperty}`;\n                    const id2 = `${toProperty}-${property}`;\n                    \n                    const fromMeta = meta.from;\n                    if(idMap.includes(id1) || idMap.includes(id2)) {\n                        return;\n                    }\n                    if(!fromMeta.source.isParentRef) {  \n                        idMap.push(id1);\n                        idMap.push(id2);\n                        this.flowLinkStack.push(configs)\n                    }\n                } else {\n                    this.flowLinkStack.push(configs)\n                }\n               \n            })\n        });\n        this.erNodes = nodes;\n    }\n\n    staticCheck(instance, jflow) {\n        return false;\n    }\n\n    reflow(jflow){\n        const links = this.flowLinkStack;\n        const nodes = this.erNodes;\n        let x = 0;\n        const lineMapping = {};\n        const size = 1000;\n        function computeNodeAnchor(node, recorded = []) {\n            let relativeAnchor = [0, 0];\n            \n            \n            if (node.parentRef) {\n                if(recorded.includes(node.parentRef)) {\n                    // debugger;\n                    return [\n                        relativeAnchor[0] - (size/2) + node.source.diagramWeight * size,\n                        relativeAnchor[1]\n                    ];\n                }\n                recorded.push(node.parentRef);\n                \n                relativeAnchor = computeNodeAnchor(node.parentRef, recorded);\n                return [\n                    relativeAnchor[0] - (size/2) + node.source.diagramWeight * size,\n                    relativeAnchor[1] + 600,\n                ];\n            } else {\n                return relativeAnchor;\n            }\n        }\n        this.erNodes.forEach(node => {\n            const instance = node.getJflowInstance();\n            const [nx, ny] = computeNodeAnchor(node);\n            if(!lineMapping[ny]) {\n                lineMapping[ny] = [];\n            }\n            lineMapping[ny].push(node);\n            instance.anchor = [nx + lineMapping[ny].length * 500, ny];\n            x+=300\n        });\n        // debugger\n        // // Kahn’s Algorithm\n        // // Calcuate the incoming degree of each vertex\n        // const vertices = nodes.slice();\n        // debugger\n        // const inDegree = {};\n        // vertices.forEach(v => {\n        //     v.adjacencyList.forEach(p => {\n        //         const name = p.name;\n        //         inDegree[name] = inDegree[name] + 1 || 1;\n        //     })\n            \n        // })\n        // console.log(inDegree)\n        // debugger\n\n        // // Create a queue which stores the vertex without dependencies\n        // const queue = vertices.filter((v) => !inDegree[v.name]);\n        // console.log(queue)\n        // debugger\n        // const topNums = {};\n        // let index = 0;\n        // while (queue.length) {\n        //     const v = queue.shift();\n        //     topNums[v.name] = index++;\n        //     v.adjacencyList.forEach(neighbor => {\n        //         const name = neighbor.name;\n        //         inDegree[name]--;\n        //         if (inDegree[name] === 0) {\n        //             queue.push(neighbor);\n        //         }\n        //     });\n        // }\n        // if (index !== vertices.length) {\n        //     console.log(\"Detect a cycle\");\n        // }\n        // console.log(topNums);\n    }\n}\n\nexport default ERLayout;","import { createCanvas } from '../utils/canvas';\nimport { bounding_box } from '../utils/functions';\nimport StackMixin from '../instance/stackMixin';\nimport InstanceStack from '../instance/stack';\nimport LayoutMixin from '../instance/layoutMixin';\nimport MessageMixin from '../instance/messageMixin';\nimport { setUniqueId, getUniqueId } from '../utils/functions';\nimport JFlowEvent from '../events';\n/**\n * @typedef JFlow~JFlowConfigs\n * @type {object}\n * @property {Boolean} allowDrop      - 是否允许 dragdrop\n * @property {Number} maxZoom         - 最大缩放\n * @property {Number} minZoom         - 最小缩放\n */\n\n/**\n * @typedef {JFlowConfigs | LayoutMixin~LayoutConfigs} JFlow~JFlowLayoutConfigs\n */\n/** \n * JFlow 对象\n * JFlow 是 canvas 上面封装的一个顶层对象，具有处理事件和绘制的功能\n * @constructor JFlow\n * @mixes LayoutMixin\n * @mixes StackMixin\n * @mixes MessageMixin\n */\nclass JFlow extends EventTarget{\n    /**\n     * 创建一个JFlow对象\n     * @param {JFlowLayoutConfigs} configs - 配置项\n     */\n    constructor(configs) {\n        super();\n        this.uniqueName = 'jflow';\n        this.initStack(configs);\n        this.initLayout(configs);\n        /**\n         * @property {Context2d} ctx        - Context2d 对象\n         * @property {Element} canvas       - canvas 元素\n         * @property {number} dpr           - 设备DPR\n         * @property {number} padding       - 内边距\n         */\n        // TODO 引入 plugin 拓展\n        // this.plugins = [];\n        this.ctx = null;\n        this.canvas = null;\n        this.dpr = 1;\n        this.padding = 20;\n        /**\n         * for zoom and pinch\n         * @property {Context2d} position       - 平移位置\n         * @property {Element} scale            - 当前缩放比\n         * @property {number} maxZoom           - 最大缩放比\n         * @property {number} minZoom           - 最小缩放比\n         */\n        this.position = null;\n\t\tthis.scale = null;\n        this.maxZoom = configs.maxZoom || 3;\n        this.minZoom = configs.minZoom || .5;\n\t\t// this.initScale = 1;\n\t\t// this.initPosition = null\n\t\tthis.offeset = null;\n        this._lastState = {\n            x: null,\n            y: null,\n            dragging: false,\n            processing: false\n        };\n        this._lastDragState = {\n            target: null,\n            targetLink: null,\n            processing: false,\n        }\n\n        this._target = {\n            instance: null,\n            link: null,\n            moving: null,\n            isInstanceDirty: false, \n            isLinkDirty: false, \n            // isMovingDirty: false, \n            cache: {\n                stack: null,\n                belongs: null,\n                point: null,\n            },\n            meta: {\n                x: undefined,\n                y: undefined,\n                initialX: undefined,\n                initialY: undefined, \n            },\n            status: {\n                dragovering: false,\n                dragging: false,\n                processing: false,\n            }\n        }\n\n        this._focus = {\n            instance: null,\n        }\n\n        this._dragOverTarget = null;\n        // this.lock = configs.lock;\n\n        // this._belongs = \n        this.allowDrop = configs.allowDrop;\n        this._tempInstance = null;\n    }\n\n    // use(plugin) {\n    //     this.plugins.push(plugin)\n    // }\n\n    /**\n     * 设置当前拖动的 JFlow 对象\n     * @param {Instance} instance - JFlow 对象\n     */\n    setTempDraggingInstance(instance) {\n        instance._belongs = this;\n        this._tempInstance = instance;\n        Object.assign(this._target, {\n            moving: [this._tempInstance],\n            dragging: true,\n        })\n        // this.addToStack(instance);\n    }\n\n    /**\n     * 取消当前拖动的 JFlow 对象\n     * @return {number[]} point - JFlow 坐标\n     */\n    removeTempDraggingInstance() {\n        if(this._tempInstance) {\n            // this.removeFromStack(this._tempInstance);\n            const anchor = this._tempInstance.anchor;\n            this._tempInstance = null;\n            return anchor;\n        }\n    }\n    /**\n     * 在 Document 元素上初始化实例\n     * @param {Element} dom \n     */\n    $mount(dom) {\n        const { \n            canvas, \n            ctx, \n            scale: dpr, \n            width: c_width, \n            height: c_height, \n            raw_width,\n            raw_height,\n            left, top \n        } = createCanvas(dom);\n        this.reflow();\n        this.ctx = ctx;\n        this.DOMwrapper = dom;\n        this.canvas = canvas;\n        this.canvasMeta = {\n            width: raw_width,\n            height: raw_height,\n            actual_width: c_width,\n            actual_height: c_height\n        }\n        this.dpr = dpr;\n        this._createEventHandler();\n        this._getBoundingGroupRect();\n\n        const padding = this.padding;\n        const { width: p_width, height: p_height, x, y } = this.bounding_box;\n        const contentBox = {\n            x: padding,\n            y: padding,\n            width: c_width - padding * 2,\n            height: c_height - padding * 2,\n        }\n        const position = { x: 0, y: 0, offsetX: 0, offsetY: 0 };\n        const w_ratio = contentBox.width / p_width;\n        const h_ratio = contentBox.height / p_height;\n        const align = w_ratio <= h_ratio ? 'x' : 'y';\n        const scaleRatio = Math.min(w_ratio, h_ratio);\n        this.scale = scaleRatio;\n        if(scaleRatio > this.maxZoom) {\n            this.maxZoom = scaleRatio;\n        }\n        if(scaleRatio < this.minZoom) {\n            this.minZoom = scaleRatio;\n        }\n        // this.initScale = scaleRatio;\n        position.x = align === 'x' ? contentBox.x : (contentBox.width - p_width * scaleRatio) / 2 + padding\n        position.y = align === 'y' ? contentBox.y : (contentBox.height - p_height * scaleRatio) / 2 + padding\n        position.offsetX = position.x - x * scaleRatio;\n        position.offsetY = position.y - y * scaleRatio;\n        this.position = position;\n        this._render();\n    }\n    // _resetPosition() {\n    //     const padding = this.padding;\n    //     const {\n    //         c_width,\n    //         c_height,\n    //     } =  this.canvasMeta;\n    //     const { width: p_width, height: p_height, x, y } = this.bounding_box;\n    //     console.log(this.bounding_box)\n    //     const contentBox = {\n    //         x: padding,\n    //         y: padding,\n    //         width: c_width - padding * 2,\n    //         height: c_height - padding * 2,\n    //     }\n    //     const position = { x: 0, y: 0, offsetX: 0, offsetY: 0 };\n    //     const w_ratio = contentBox.width / p_width;\n    //     const h_ratio = contentBox.height / p_height;\n    //     const align = w_ratio <= h_ratio ? 'x' : 'y';\n    //     const scaleRatio = Math.min(w_ratio, h_ratio);\n    //     this.scale = scaleRatio;\n    //     if(scaleRatio > this.maxZoom) {\n    //         this.maxZoom = scaleRatio;\n    //     }\n    //     if(scaleRatio < this.minZoom) {\n    //         this.minZoom = scaleRatio;\n    //     }\n    //     // this.initScale = scaleRatio;\n    //     position.x = align === 'x' ? contentBox.x : (contentBox.width - p_width * scaleRatio) / 2 + padding\n    //     position.y = align === 'y' ? contentBox.y : (contentBox.height - p_height * scaleRatio) / 2 + padding\n    //     position.offsetX = position.x - x * scaleRatio;\n    //     position.offsetY = position.y - y * scaleRatio;\n    //     this.position = position;\n    // }\n    \n    _getBoundingGroupRect() {\n        const points = this._stack.getBoundingRectPoints();\n        if(this.bounding_box) {\n            this.bounding_box = bounding_box(points);\n            const {\n                x: nowx,\n                y: nowy,\n            } = this.bounding_box;\n            const scale = this.scale;\n            this.position.x = this.position.offsetX + nowx * scale;\n            this.position.y = this.position.offsetY + nowy * scale;\n        } else {\n            this.bounding_box = bounding_box(points);\n        }\n    }\n\n    // $setFocus(instance) {\n    //     if(this._lastFocus.processing) return;\n    //     this._lastFocus.processing = true;\n    //     if(this._lastFocus.instance){\n    //         this._lastFocus.instance.status.focus = false;\n    //     }\n        \n    //     this._lastFocus.instance = instance;\n    //     if(instance) {\n    //         instance.status.focus = true;\n    //         instance.bubbleEvent(new JFlowEvent('focus'))\n    //     }\n\n    //     requestAnimationFrame(() => {\n    //         this._render();\n    //         this._lastFocus.processing = false;\n    //     })\n\n    // }\n\n    _createEventHandler() { \n        const canvas = this.canvas;\n        const zoomHandler = this._onZoom.bind(this);\n        const pressStartHandler = this._onPressStart.bind(this);\n        const pressMoveHandler = this._onPressMove.bind(this);\n        const pressUpHandler = this._onPressUp.bind(this);\n        const pressUpDocument = this._onPressUpDocument.bind(this);\n        const contextmenuHandler = this._onContextMenu.bind(this);\n        canvas.addEventListener('wheel', zoomHandler );\n        canvas.addEventListener('contextmenu', e => {\n            e.preventDefault();\n        });\n        canvas.addEventListener('pointerdown', pressStartHandler );\n        canvas.addEventListener('pointermove', pressMoveHandler );\n        canvas.addEventListener('pointerup', pressUpHandler );\n        canvas.addEventListener('contextmenu', contextmenuHandler)\n        document.addEventListener('pointerup', pressUpDocument);\n        let destroyListener;\n        const destroyPlainEventListener = () => {\n            canvas.removeEventListener('wheel', zoomHandler );\n            canvas.removeEventListener('pointerdown', pressStartHandler );\n            canvas.removeEventListener('pointermove', pressMoveHandler );\n            canvas.removeEventListener('pointerup', pressUpHandler );\n            document.removeEventListener('pointerup', pressUpDocument);\n        }\n        destroyListener = destroyPlainEventListener;\n\n        if(this.allowDrop) {\n            const dragoverHandler = this._onDragover.bind(this);\n            const dropHandler = this._onDrop.bind(this);\n            canvas.addEventListener('dragover', dragoverHandler);\n            canvas.addEventListener('drop', dropHandler);\n            destroyListener = () => {\n                destroyPlainEventListener();\n                canvas.removeEventListener('dragover', dragoverHandler);\n                canvas.removeEventListener('drop', dropHandler);\n            }\n        } \n        this.destroy = destroyListener;\n    }\n\n    _targetLockOn(offsetPoint, event) {\n        let point = this._calculatePointBack(offsetPoint);\n        const topLayerPoint = point;\n        this._currentp = point;\n        let stack = this._stack;\n        const target = stack.checkHit(point, (instance) => {\n            return this._target.status.dragging && (instance === this._getMovingTarget())\n        });\n        let linkStack = this._linkStack;\n        let belongs = this;\n        if(target) {\n            linkStack = target._belongs._linkStack;\n            point = target._belongs._currentp;\n            stack = target._belongs._stack;\n            belongs = target._belongs\n        }\n        const targetLink = linkStack.checkHit(point, (link) => {\n            if(!this._target.status.dragging) {\n                return false;\n            }\n            const movingtarget = this._getMovingTarget();\n            return link.from === movingtarget || link.to === movingtarget;\n        });\n\n        Object.assign(this._target, {\n            instance: target,\n            link: targetLink, \n            isInstanceDirty: target === this._target.instance,\n            isLinkDirty: targetLink === this._target.link,\n        });\n        Object.assign(this._target.cache, {\n            stack,\n            belongs,\n            point,\n            topLayerPoint,\n        })\n        Object.assign(this._target.meta, {\n            x: offsetPoint[0],\n            y: offsetPoint[1],\n        });\n\n        if(event === 'pressStart' && !this._target.status.dragging && !this._target.status.dragovering) {\n            let movingtarget = target;\n            while (movingtarget && movingtarget._belongs.lock && movingtarget !== this) {\n                movingtarget = movingtarget._belongs;\n            }\n            // if(movingtarget === this) {\n            //     movingtarget = undefined;\n            // }\n            if(movingtarget) {\n                if(movingtarget._layoutNode) {\n                    if(movingtarget._layoutNode.isLocked) {\n                        movingtarget = movingtarget._layoutNode.getNodes()\n                    } else if(!movingtarget._layoutNode.isDraggable) {\n                        movingtarget = undefined;\n                    } else {\n                        movingtarget = [movingtarget];\n                    }\n                } else {\n                    movingtarget = [movingtarget];\n                }\n            } \n            Object.assign(this._target, {\n                moving: movingtarget,\n                // isMovingDirty: movingtarget[0] === this._target.moving[0],\n            })\n        }\n        return this._target;\n    }\n\n    _getMovingTarget() {\n        return this._target.moving && this._target.moving[0];\n    }\n\n    _processDragOver(instance) {\n        if(this._dragOverTarget !== instance) {\n            const target = this.readMessage()?.instance;\n            if(instance) {\n                /**\n                * dragover 进入事件\n                * @event Instance#dragover\n                * @type {object}\n                * @property {Event} event           - 原始事件 \n                * @property {Object} instance       - dragover的对象 \n                * @property {target} target         - drag 携带的对象（特指从外面拖进canvas的对象） \n                */\n                instance.dispatchEvent(new JFlowEvent('dragover', {\n                    event,\n                    instance,\n                    target,\n                }));\n            }\n            if(this._dragOverTarget) {\n                const oldIns = this._dragOverTarget;\n                /**\n                * dragover 退出事件\n                * @event Instance#dragoverend\n                * @type {object}\n                * @property {Event} event           - 原始事件 \n                * @property {Object} instance       - dragover的对象 \n                * @property {target} target         - drag 携带的对象（特指从外面拖进canvas的对象） \n                */\n                oldIns.dispatchEvent(new JFlowEvent('dragoverend', {\n                    event,\n                    instance: oldIns,\n                    target\n                }));\n            }\n            this._dragOverTarget = instance;\n        }\n    }\n\n    _onDragover(event) {\n        event.preventDefault();\n        if(this._lastDragState.processing) return;\n        this._lastDragState.processing = true;\n        const { offsetX, offsetY } = event\n        Object.assign(this._target.status, {\n            dragovering: true,\n        })\n        this._targetLockOn([offsetX, offsetY])\n        const instance = this._target.instance || this._target.link;\n        this._processDragOver(instance);\n        // if(this._dragOverTarget !== instance) {\n        //     if(instance) {\n        //         instance.dispatchEvent(new JFlowEvent('dragover', {\n        //             event,\n        //             instance,\n        //         }));\n        //     }\n        //     if(this._dragOverTarget) {\n        //         const oldIns = this._dragOverTarget;\n        //         oldIns.dispatchEvent(new JFlowEvent('dragoverend', {\n        //             event,\n        //             instance: oldIns,\n        //         }));\n        //     }\n        //     this._dragOverTarget = instance;\n        // }\n        \n        if(this._target.isLinkDirty || this._target.isInstanceDirty) {\n            requestAnimationFrame(() => {\n                this._render();    \n                this._target.isLinkDirty = false; \n                this._target.isInstanceDirty = false;\n                this._lastDragState.processing = false;\n            })\n        } else {\n            this._lastDragState.processing = false;\n        } \n    }\n\n    _onDrop(event) {\n        const { offsetX, offsetY, clientX, clientY } = event\n        const payload = this.consumeMessage();\n        const instance = payload.instance;\n        if(this._dragOverTarget) {\n            const oldIns = this._dragOverTarget;\n            oldIns.dispatchEvent(new JFlowEvent('dragoverend', {\n                event,\n                instance: oldIns,\n            }));\n            this._dragOverTarget = null;\n        }\n        const {\n            link,\n            instance: target,\n        } = this._target;\n        const {\n            point, belongs\n        } = this._target.cache;\n        if(link) {   \n            /**\n             * 丢在线上事件\n             *\n             * @event BaseLink#drop\n             * @type {object}\n             * @property {Event} event           - 原始事件 \n             * @property {Object} instance       - 拖动的对象 \n             * @property {BaseLink} link         - 目标连线 \n             * @property {JFlow} jflow           - 当前JFlow对象 \n             * @property {Group|JFlow} belongs   - 连线所在的绘图栈的对象\n             * @property {number[]} point        - 已经计算到绘图栈对应坐标系下的坐标\n             */\n            instance.anchor = point;\n            link.dispatchEvent(new JFlowEvent('drop', {\n                event,\n                instance,\n                link,\n                jflow: this,\n                belongs,\n                point\n            }))\n        } else if(target) {\n            /**\n             * 丢在节点上事件\n             *\n             * @event Node#drop\n             * @type {object}\n             * @property {Event} event           - 原始事件 \n             * @property {Object} instance       - 拖动的对象 \n             * @property {JFlow} jflow           - 当前JFlow对象 \n             * @property {Node} target           - 目标节点\n             * @property {number[]} point        - 已经计算到绘图栈对应坐标系下的坐标\n             */\n            target.dispatchEvent(new JFlowEvent('drop', {\n                event,\n                instance,\n                jflow: this,\n                target,\n                point\n            }));\n        } else {\n            /**\n            * 丢在主图上事件\n            *\n            * @event JFlow#drop\n            * @type {object}\n            * @property {Event} event           - 原始事件 \n            * @property {Object} instance       - 拖动的对象 \n            * @property {JFlow} jflow           - 当前JFlow对象 \n            * @property {number[]} point        - 已经计算到绘图栈对应坐标系下的坐标\n            */\n            this.dispatchEvent(new JFlowEvent('drop', {\n                event,\n                instance,\n                jflow: this,\n                target,\n                point,\n            }))\n        }\n        \n        requestAnimationFrame(() => {\n            // this.recalculate();\n            this._target.instance = null;\n            this._target.link = null;\n            Object.assign(this._target.status, {\n               dragovering: false,\n            })\n            // this._render();\n        })\n    }\n\n    _onZoom(event) {\n        event.preventDefault();\n        if(this._zooming) return;\n        this._zooming = true;\n        const { offsetX, offsetY, deltaY } = event\n        const { width: p_width, height: p_height, x, y } = this.bounding_box;\n        let newScale = this.scale;\n        const amount = deltaY > 0 ? 1.1 : 1 / 1.1;\n        newScale *= amount;\n\n        if (this.maxZoom && newScale > this.maxZoom){\n            // could just return but then won't stop exactly at maxZoom\n            newScale = this.maxZoom;\n        }\n\n        if(this.minZoom && newScale < this.minZoom) {\n            newScale = this.minZoom;\n        }\n\n        var deltaScale    = newScale - this.scale;\n        var currentWidth  = p_width * this.scale;\n        var currentHeight = p_height * this.scale;\n        var deltaWidth    = p_width * deltaScale;\n        var deltaHeight   = p_height * deltaScale;\n\n        var tX = offsetX - this.position.x;\n        var tY = offsetY - this.position.y;\n        var pX = -tX / currentWidth;\n        var pY = -tY / currentHeight;\n\n        this.scale = newScale;\n        this.position.x += pX * deltaWidth;\n\t\tthis.position.y += pY * deltaHeight;\n        this.position.offsetX = this.position.x - x * newScale;\n        this.position.offsetY = this.position.y - y * newScale;\n        /**\n         * 缩放平移事件\n         *\n         * @event JFlow#zoompan\n        */\n        this.dispatchEvent(new JFlowEvent('zoompan'));\n        requestAnimationFrame(() => {\n            this._render();\n            this._zooming = false;\n        })\n    }\n\n    _onPressStart(event) { \n        const { offsetX, offsetY, deltaY, button } = event\n        if(button !== 0) return;\n        this._targetLockOn([offsetX, offsetY], 'pressStart');\n        Object.assign(this._target.meta, {\n            initialX: offsetX,\n            initialY: offsetY,\n        })\n        Object.assign(this._target.status, {\n            dragging: true,\n            processing: false,\n        });\n        if(this._target.moving) {\n            const moving = this._getMovingTarget();\n            /**\n             * 开始拖动组的事件（特指lock的顶层组）\n             *\n             * @event Node#pressStart\n             * @type {object}\n             * @property {Event} event           - 原始事件 \n             * @property {Node} instance       - 拖动的对象 \n             * @property {JFlow} jflow           - 当前JFlow对象 \n             */\n            moving.dispatchEvent(new JFlowEvent('pressStart', {\n                event,\n                instance: moving,\n                jflow: this,\n            }))\n        }\n\n        if(this._target.instance) {\n            /**\n             * 开始拖动对象事件（就是目标对象的拖动事件，事件支持冒泡）\n             *\n             * @event Node#instancePressStart\n             * @type {object}\n             * @property {Event} event           - 原始事件 \n             * @property {Node} instance     - 拖动的对象 \n             * @property {JFlow} jflow           - 当前JFlow对象 \n             * @property {Boolean} bubbles       - 冒泡\n             */\n            const t = this._target.instance;\n            t.bubbleEvent(new JFlowEvent('instancePressStart', {\n                event,\n                target: t,\n                jflow: this,\n                bubbles: true,\n            }))\n        }\n\n    }\n\n    _onPressMove(event) {\n        // console.log('_onPressMove')\n        const {\n            dragging, processing\n        } = this._target.status;\n        const { x, y } = this._target.meta;\n\n        const { offsetX, offsetY, clientX, clientY } = event\n        /**\n         * canvas pressmove 原生事件\n         *\n         * @event JFlow#canvasmousemove\n         * @type {object}\n         * @property {Event} event           - 原始事件\n         * @property {JFlow} jflow           - 当前JFlow对象 \n         */\n        this.dispatchEvent(new JFlowEvent('canvasmousemove', {\n            event,\n            jflow: this,\n        }))\n\n        if(!dragging && !processing) {\n            const {\n                link,\n                instance\n            } = this._targetLockOn([offsetX, offsetY]);\n            if(instance || link) {\n                this.canvas.style.cursor = 'move';\n            } else {\n                this.canvas.style.cursor = 'default';\n            }\n        }\n        if(!dragging) return;\n        if(processing) return;\n        \n        const movingtarget = this._target.moving;// this._tempInstance ? [this._tempInstance] : this._target.moving;\n\n        this._target.status.processing = true;\n        const deltaX = offsetX - x;\n        const deltaY = offsetY - y;\n\n        if(movingtarget) {\n            movingtarget.forEach(t => {\n                t.anchor[0] += deltaX / this.scale;\n                t.anchor[1] += deltaY / this.scale;\n            })\n        } else {\n            this._recalculatePosition(deltaX, deltaY);    \n            this.dispatchEvent(new JFlowEvent('zoompan'));\n        }\n        const { instance, link } = this._targetLockOn([offsetX, offsetY]);\n        // console.log(instance);\n        this._processDragOver(instance || link);\n            \n        // this._target.meta.x = offsetX;\n        // this._target.meta.y = offsetY;\n        \n        requestAnimationFrame(() => {\n            this._render();\n            this._target.isLinkDirty = false; \n            this._target.isInstanceDirty = false;\n            this._target.status.processing = false;\n        })\n        \n    }\n\n    _onPressUp(event, isDocument) {\n        event.preventDefault();\n        event.stopPropagation();\n        const { button } = event\n        if(button !== 0) return;\n        const meta = this._target.meta;\n        // if(meta.initialX === undefined && isDocument) {\n        //     this.dispatchEvent(new JFlowEvent('click', {\n        //         event,\n        //         jflow: this,\n        //     }));\n        //     return;\n        // }\n        \n        // if(this._tempInstance) {\n        //     this.dispatchEvent(new JFlowEvent('canvasmouseup', {\n        //         event,\n        //         jflow: this,\n        //     }));\n        //     this._clearTarget();\n        //     return;\n        // } else {\n        //     // 没有设置也需要触发事件\n        //     this.dispatchEvent(new JFlowEvent('canvasmouseup', {\n        //         event,\n        //         jflow: this,\n        //     }));\n        // }\n        \n        \n        if(meta.initialX === meta.x\n            && meta.initialY === meta.y) {\n                if(event.target !== this.canvas){\n                    this._clearTarget();\n                    return;\n                }\n                if(this._target.instance && !isDocument) {\n                    const t = this._target.instance;\n                    /**\n                    * 点击事件（冒泡）\n                    *\n                    * @event Node#click\n                    * @type {object}\n                    * @property {Event} event          - 原始事件 \n                    * @property {Instance} target      - 点击的对象 \n                    * @property {JFlow} jflow          - 当前JFlow对象 \n                    * @property {Boolean} bubbles      - 冒泡\n                    */\n                    t.bubbleEvent(new JFlowEvent('click', {\n                        event,\n                        target: t,\n                        jflow: this,\n                        bubbles: true,\n                    }))\n                    this._clearTarget();\n                    this._render();\n                    return;\n                } else {\n                    /**\n                    * 点击事件\n                    *\n                    * @event JFlow#click\n                    * @type {object}\n                    * @property {Event} event          - 原始事件 \n                    * @property {JFlow} jflow          - 当前JFlow对象 \n                    */\n                    this.dispatchEvent(new JFlowEvent('click', {\n                        event,\n                        jflow: this,\n                    }));\n                    this._clearTarget();\n                    this._render();\n                    return\n                }\n            \n        } else if(this._target.moving) {\n            let checkresult = false;\n            if(this._layout.static) {\n                checkresult = this.staticCheck(this._getMovingTarget());\n            }\n\n            if(!checkresult && this._target.link) {\n                const {\n                    point, belongs\n                } = this._target.cache;\n                const link = this._target.link;\n                const instance = this._getMovingTarget();\n                // instance.anchor = point;\n                // belongs.addInstanceToLink(this._target.link, instance);\n                // belongs.dispatchEvent(new JFlowEvent('drop', {\n                //     event,\n                //     instance,\n                //     link: ,\n                //     jflow: this,\n                //     target,\n                // }))\n                /**\n                 * 拖动到线上事件\n                 *\n                 * @event BaseLink#drop\n                 * @type {object}\n                 * @property {Event} event           - 原始事件 \n                 * @property {Object} instance     - 拖动的对象 \n                 * @property {BaseLink} link         - 目标连线 \n                 * @property {JFlow} jflow           - 当前JFlow对象 \n                 * @property {Group|JFlow} belongs   - 连线所在的绘图栈的对象\n                 */\n                link.dispatchEvent(new JFlowEvent('drop', {\n                    event,\n                    instance,\n                    link,\n                    jflow: this,\n                    belongs,\n                    // reflowCallback: () => {\n                    //     debugger\n                    //     belongs.recalculate();\n                    //     belongs.reflow();\n                    //     this._render();\n                    // }\n                }));\n                this._target.link = null;\n                this._target.instance = null;\n                // link.dispatchEvent(new JFlowEvent('dragover', {\n                //     event,\n                //     instance,\n                //     link,\n                //     jflow: this,\n                //     belongs,\n                // }))\n                // this.recalculate();\n            }\n            if(this._target.moving) {\n                if(this._target.instance) {\n                    /**\n                     * 拖动后放置到 Instance 上的事件\n                     *\n                     * @event Instance#pressEnd\n                     * @type {object}\n                     * @property {Event} event           - 原始事件 \n                     * @property {Instance} instance     - 拖动的对象 \n                     * @property {JFlow} jflow           - 当前JFlow对象 \n                     * @property {Instance} target       - 拖动到的对象\n                     * @property {boolean} bubbles       - 冒泡\n                     */\n                     console.log('pressEnd', this._target.instance)\n                    this._target.instance.bubbleEvent(new JFlowEvent('pressEnd', {\n                        event,\n                        instance: this._getMovingTarget(),\n                        jflow: this,\n                        target: this._target.instance,\n                        bubbles: true\n                    }));\n                } else {\n                    /**\n                     * 拖动后放置到主图上的事件\n                     *\n                     * @event JFlow#pressEnd\n                     * @type {object}\n                     * @property {Event} event           - 原始事件 \n                     * @property {Instance} instance       - 拖动的对象 \n                     * @property {JFlow} jflow           - 当前JFlow对象 \n                     */\n                    this.dispatchEvent(new JFlowEvent('pressEnd', {\n                        event,\n                        instance: this._getMovingTarget(),\n                        jflow: this,\n                    }))\n                }\n            }\n            this._target.moving = null;\n            this.removeTempDraggingInstance()\n            // this._target.isMovingDirty = false;\n            this._render();\n        }\n        this._clearTarget();\n    }\n\n    _clearTarget(){\n        Object.assign(this._target.meta, {\n            x: undefined,\n            y: undefined,\n            initialX: undefined,\n            initialY: undefined, \n        })\n        Object.assign(this._target.status, {\n            dragging: false,\n            processing: false,\n        });\n        Object.assign(this._target, {\n            instance: null,\n            link: null,\n            moving: null,\n        });\n    }\n\n    _onPressUpDocument(event) {\n        this._onPressUp(event, true);\n    }\n\n    _onClick(event) {\n        const { offsetX, offsetY } = event;\n        const point = this._calculatePointBack([offsetX, offsetY]);\n        const target = this._stack.checkHit(point);\n    }\n\n    _onContextMenu(event) {\n        event.preventDefault();\n        event.stopPropagation();\n        const { offsetX, offsetY } = event;\n        const {\n            link,\n            instance\n        } = this._targetLockOn([offsetX, offsetY]);\n        const { topLayerPoint } = this._target.cache\n        if(instance || link) {\n            const target = (instance || link);\n            /**\n             * 右键事件（冒泡）\n             *\n             * @event instance#contextclick\n             * @type {object}\n             * @property {Event} event           - 原始事件 \n             * @property {Instance} target       - 右键对象 \n             * @property {JFlow} jflow           - 当前JFlow对象\n             * @property {number[]} topLayerPoint  - jflow坐标系上的位置\n             * @property {Boolean} bubbles       - 冒泡\n             */\n            target.bubbleEvent(new JFlowEvent('contextclick', {\n                event,\n                jflow: this,\n                target,\n                topLayerPoint,\n                bubbles: true\n            }));\n        } else {\n            /**\n             * 右键事件\n             *\n             * @event JFlow#contextclick\n             * @type {object}\n             * @property {Event} event           - 原始事件 \n             * @property {JFlow} jflow           - 当前JFlow对象\n             * @property {number[]} topLayerPoint  - jflow坐标系上的位置\n             */\n            this.dispatchEvent(new JFlowEvent('contextclick', {\n                event,\n                jflow: this,\n                topLayerPoint,\n            }));\n        }\n    }\n\n    _recalculatePosition(deltaX, deltaY, scale) {\n        const { x, y } = this.bounding_box;\n        if(scale === undefined) {\n            scale = this.scale;\n        }\n        this.position.x += deltaX;\n\t\tthis.position.y += deltaY;\n        this.position.offsetX = this.position.x - x * scale;\n        this.position.offsetY = this.position.y - y * scale;\n    }\n\n    calculateToRealWorld(p) {\n        const scale = this.scale;\n        const position = this.position;\n        return [p[0] * scale + position.offsetX, p[1] * scale + position.offsetY]\n    }\n\n    _calculatePointBack(p) {\n        const scale = this.scale;\n        const position = this.position;\n        return [(p[0] - position.offsetX)/scale, (p[1] - position.offsetY) / scale];\n    }\n\n    _calculateDistance(l) {\n        const scale = this.scale;\n        return scale * l;\n    }\n\n    _resetTransform() {\n        const { width: c_width, height: c_height } = this.canvasMeta;\n        const position = this.position;\n        const scale = this.scale;\n        const ctx = this.ctx;\n        ctx.setTransform();\n        ctx.clearRect(0, 0, c_width, c_height);\n        ctx.scale(this.dpr, this.dpr);\n        ctx.transform(scale, 0, 0, scale, position.offsetX, position.offsetY);\n    }\n     /**\n     * 绘制画布\n     */\n    _render() {\n        this._resetTransform();\n        // this._stack.forEach(instance => {\n        //     instance._intersections = [];\n        // });\n        // let linkStack = this._linkStack;\n        // if(this._layout.alignLinkOrder) {\n        //     const p = new InstanceStack();\n        //     this._layout.alignLinkOrder(linkStack, p);\n        //     linkStack = p;\n        // }\n        const ctx = this.ctx;\n        \n        this._stack.render(ctx);\n        this._linkStack.render(ctx);\n        if(this._tempInstance) {\n            ctx.save();\n            this._tempInstance.render(ctx)\n            ctx.restore();\n        }\n        \n    }\n}\nObject.assign(JFlow.prototype, MessageMixin);\nObject.assign(JFlow.prototype, StackMixin);\nObject.assign(JFlow.prototype, LayoutMixin);\n\nexport default JFlow;\nexport { default as JFlowEvent } from '../events';\nexport { default as Instance } from '../instance/instance';\nexport { default as Node } from '../instance/node';\nexport { default as BaseLink } from '../instance/base-link';\nexport { default as Point } from '../instance/shapes/point';\nexport { default as Rectangle } from '../instance/shapes/rectangle';\nexport { default as Group } from '../instance/shapes/rectangle-group';\nexport { default as Capsule } from '../instance/shapes/capsule';\nexport { default as CapsuleGroup } from '../instance/shapes/capsule-group';\nexport { default as Diamond } from '../instance/shapes/diamond';\nexport { default as DiamondGroup } from '../instance/shapes/diamond-group';\nexport { default as Text } from '../instance/text';\nexport { default as Icon } from '../instance/image';\nexport { default as Link } from '../instance/link';\nexport { default as PolylineLink } from '../instance/polyline-link';\nexport { default as BezierLink } from '../instance/bezier-link';\nexport { default as LinearLayout} from '../layout/linear-layout';\n// export { default as TreeLayout } from '../ler-layouta;yout/tree-layout';\nexport { default as Lowcodelayout } from '../layout/low-code-layout';\nexport { default as ERLayout } from '../layout/er-layout/er-layout';\n","export default {\n    provide(){\n        return {\n            addToStack: this.addToStack,\n            addToLinkStack: this.addToLinkStack,\n            removeFromStack: this.removeFromStack,\n            removeFromLinkStack: this.removeFromLinkStack,\n            getInstanceByJFlowId: this.getInstanceByJFlowId,\n        }\n    },\n    data() {\n        return {\n            stack: [], // 主要是为了连线\n        }\n    },\n    methods: {\n        getInstanceByJFlowId(jflowId) {\n            const obj = this.stack.find(i => i.jflowId === jflowId);\n            if(obj) {\n                return obj.instance;\n            }\n            return null;\n        },\n        addToStack(instance, jflowId) {\n            this._jflowInstance.addToStack(instance);\n            if(!jflowId) return;\n            this.stack.push({\n                jflowId,\n                instance,\n            });\n            // this.$nextTick(this.onStackChangeHandler)\n        },\n        addToLinkStack(link) {\n            this._jflowInstance.addToLinkStack(link);\n            // this.$nextTick(this.onStackChangeHandler)\n        },\n        removeFromStack(instance) {\n            this._jflowInstance.removeFromStack(instance);\n            // this.$nextTick(this.onStackChangeHandler)\n        },\n        removeFromLinkStack(link) {\n            this._jflowInstance.removeFromLinkStack(link);\n            // this.$nextTick(this.onStackChangeHandler)\n        },\n        onStackChangeHandler() {\n            this._jflowInstance.recalculate();\n            this._jflowInstance.reflow();\n            // this.$nextTick(this.renderJFlow)\n        }\n    }\n}","import JFlow from '../../core/flow';\nimport StackMixin from './StackMixin';\nexport default {\n    mixins: [StackMixin],\n    provide(){\n        return {\n            renderJFlow: this.renderJFlow,\n            addNameToRootStack: this.addNameToRootStack\n        }\n    },\n    props: {\n        configs: {\n            type: Object,\n            default: function () {\n                return {};\n            },\n        },\n    },\n    data() {\n        return {\n            nodes: [],\n            links: [],\n        }\n    },\n    render: function (createElement) {\n        if(!this.nodes.length) {\n            return createElement('div', this.$slots.default);\n        } else {\n            const vnodes = this.nodes.map(({ type, configs, meta }) => {\n                if(!this.$scopedSlots[type]) {\n                    if(this.$scopedSlots['jflowcommon']){\n                        type = 'jflowcommon';\n                    } else {\n                        return\n                    }\n                }\n                const [vnode] = this.$scopedSlots[type]({ configs, meta });\n                meta.getJflowInstance = function() {\n                    // 只支持一个元素\n                    let instance = vnode.componentInstance;\n                    while(instance && !instance._jflowInstance)  {\n                        instance = instance.$children[0];\n                    }\n                    // TODO 优化下这里的逻辑\n                    instance._jflowInstance._layoutNode = meta;\n                    return instance._jflowInstance;\n                }\n                vnode.key = configs.id;\n                return vnode;\n            });\n            const vlinks = this.links.map(meta => {\n                let type = meta.type || 'plainlink'\n                if(!this.$scopedSlots[type]) {\n                    return null;\n                }\n                const [vnode] = this.$scopedSlots[type]({ configs: meta });\n                vnode.key = `${meta.from}-${meta.to}-${meta.part}`\n                return vnode\n            })\n\n            return createElement('div', [...vnodes, ...vlinks]);\n        }\n        \n    },\n    created() {\n        this._jflowInstance = new JFlow(this.configs);\n    },\n    mounted() {\n        console.log(this);\n        // this._jflowInstance = new JFlow(this.configs);\n        this.nodes = this._jflowInstance._layout.flowStack.map(meta => {\n            return {\n                type: meta.type,\n                configs: meta.configs,\n                meta: meta.layoutMeta,\n            }\n        });\n        \n        this.links = this._jflowInstance._layout.flowLinkStack.slice();\n        this.$nextTick(() => {\n            this._jflowInstance.$mount(this.$el);\n            // this._jflowInstance.addEventListener('drop', (e) => {\n            //     const astblock = e.detail.instance;\n            //     const node = {\n            //         type: astblock.type,\n            //         configs: astblock,\n            //         meta: {},\n            //     };\n            //     this.nodes.push(node);\n            //     this.$nextTick(() => {\n            //         node.meta.getJflowInstance().anchor = e.detail.point\n            //         this.renderJFlow();\n            //     })\n            // })\n        });\n        Object.keys(this.$listeners).map(event => {\n            console.log(event)\n            const func = this.$listeners[event].bind(this);\n            this._jflowInstance.addEventListener(event, func);\n        })\n    },\n    \n    methods: {\n        /**\n         * 绘制之前，vnode渲染之后\n         * @name j-jflow~preCallback\n         * @function\n         */\n        /**\n         * 重排\n         * @param {j-jflow~preCallback} preCallback - JFlow 绘制之前，vnode渲染之后\n         */\n        reflow(preCallback) {\n            const layoutNodes = this._jflowInstance._layout.flowStack.map(meta => {\n                return {\n                    type: meta.type,\n                    configs: meta.configs,\n                    meta: meta.layoutMeta,\n                }\n            });\n            /* no free Nodes\n            const freeNodes = []\n            this.nodes.forEach(n => {\n                if(!layoutNodes.find(ln => ln.configs.id === n.configs.id)){\n                    freeNodes.push(n)\n                }\n            })\n            this.nodes = layoutNodes.concat(freeNodes);\n            */\n            this.nodes = layoutNodes;\n            this.links = this._jflowInstance._layout.flowLinkStack.slice();\n            this.$nextTick(() => {\n                if(preCallback) {\n                    preCallback();\n                }\n                this._jflowInstance.recalculate();\n                this._jflowInstance._render();\n                console.log(this.nodes);\n                console.log(this._jflowInstance.bounding_box)\n            })\n        },\n        /**\n         * 获取单签 JFlow 实例\n         * @return {Jflow} - JFlow对象\n         */\n        getInstance() {\n            return this._jflowInstance;\n        },\n        /**\n         * 手动触发绘制\n         */\n        renderJFlow() {\n            this._jflowInstance._render();\n        },\n        addNameToRootStack(instance, jflowId) {\n            console.log(jflowId, ' addNameToRootStack')\n             this.stack.push({\n                jflowId,\n                instance,\n            });\n        }\n    }\n}","import * as JFlowInstance from '../../core/flow';\nimport diff from 'object-diff';\nexport default function (nameNode) {\n    const bulder =  typeof nameNode === 'string' \n        ? JFlowInstance[nameNode] \n        : nameNode;\n    return {\n        inject: ['addToStack', 'removeFromStack','addNameToRootStack'],\n        props: {\n            configs: {\n                type: Object,\n                default: function () {\n                    return {};\n                },\n            },\n            visible: {\n                type: Boolean,\n                default: true,\n            },\n            jflowId: {\n                type: String,\n            }\n        },\n        watch: {\n            configs(val, oldVal) {\n                if(JSON.stringify(val) === JSON.stringify(oldVal)){\n                    return;\n                }\n                // const diffed = diff(val, oldVal);\n                // const reflowKeys = Object.keys(diffed).filter(k => {\n                //     const lk = k.toLowerCase();\n                //     return !(lk.endsWith('color') || k.endsWith('style'));\n                // });\n                this._jflowInstance.setConfig(val);\n                // console.log('recalculateUp')\n                // this._jflowInstance.recalculateUp();\n                // console.log(reflowKeys.length, val)\n                // if(reflowKeys.length) {\n                //     this._jflowInstance._belongs.recalculateUp();\n                // } \n                // this._jflowInstance._jflow._render();\n            },\n            '$listeners' (val, oldVal) {\n                let news = [];\n                let deletes = [];\n                const vnew = Object.keys(val).map(e => ({ event: e, handler: val[e] }));\n                const vold = Object.keys(oldVal).map(e => ({ event: e, handler: oldVal[e] }));\n                vnew.forEach((v) => {\n                    const hnew = v.handler;\n                    if(!vold.find((q) => q.handler === hnew)) {\n                        news.push(v);\n                    }\n                });\n                vold.forEach((v) => {\n                    const hold = v.handler;\n                    if(!vnew.find((q) => q.handler === hold)) {\n                        deletes.push(v);\n                    }\n                });\n\n                news.forEach((v) => {\n                    this._jflowInstance.addEventListener(v.event, v.handler);\n                });\n                deletes.forEach((v) => {\n                    this._jflowInstance.removeEventListener(v.event, v.handler);\n                });\n            },\n            visible(val) {\n                this._jflowInstance.visible = val;\n                // this._jflowInstance._belongs.recalculateUp();\n                // this._jflowInstance._jflow._render();\n            }\n        },\n        render: function (createElement) {\n            return null;\n        },\n        created() { \n            this._jflowInstance =  new bulder(this.configs);\n            this._jflowInstance.visible = this.visible;\n            this.bindListeners();\n            this.addToStack(this._jflowInstance, this.jflowId);\n        },\n        // updated() {\n        //     console.log('recalculateUp')\n            \n        // },\n        destroyed() {\n            this.removeFromStack(this._jflowInstance);\n        },\n        methods: {\n            bindListeners() {\n                Object.keys(this.$listeners).map(event => {\n                    const func = this.$listeners[event];\n                    this._jflowInstance.addEventListener(event, func);\n                })\n            }\n        }\n    }\n}","import * as JFlowInstance from '../../core/flow';\n\nexport default function (nameNode, isLink) {\n    return {\n        inject: [ 'addToLinkStack', 'removeFromLinkStack', 'getInstanceByJFlowId' ],\n        props: {\n            configs: {\n                type: Object,\n                default: function () {\n                    return {};\n                },\n            },\n            from: String,\n            to: String,\n        },\n        watch: {\n            from(){\n                this.resetLink();\n            },\n            to() {\n                this.resetLink();\n            },\n            configs(val, oldVal) {\n                if(val.backgroundColor !== oldVal.backgroundColor) {\n                    this._jflowInstance.backgroundColor = val.backgroundColor;\n                }\n            },\n        },\n        render: function (createElement) {\n            return null;\n        },\n        created() {\n            const fromInstance = this.getInstanceByJFlowId(this.from);\n            const toInstance = this.getInstanceByJFlowId(this.to);\n            const key = this.$vnode.key;\n            if(fromInstance && toInstance) {\n                this._jflowInstance =  new JFlowInstance[nameNode]({\n                    ...this.configs,\n                    key,\n                    from: fromInstance,\n                    to: toInstance,\n                });\n                this.bindListeners();\n                this.addToLinkStack(this._jflowInstance);\n               \n            }\n        },\n        methods: {\n            resetLink() {\n                const fromInstance = this.getInstanceByJFlowId(this.from);\n                const toInstance = this.getInstanceByJFlowId(this.to);\n                this._jflowInstance.from = fromInstance;\n                this._jflowInstance.to = toInstance;\n            },\n            bindListeners() {\n                Object.keys(this.$listeners).map(event => {\n                    const func = this.$listeners[event];\n                    this._jflowInstance.addEventListener(event, func);\n                })\n            }\n        },\n        destroyed() {\n            if(this._jflowInstance) {\n                this.removeFromLinkStack(this._jflowInstance);\n            }\n        }\n    }\n}","import * as JFlowInstance from '../../core/flow';\nimport StackMixin from './StackMixin';\nexport default function (nameNode) {\n    const bulder =  typeof nameNode === 'string' \n        ? JFlowInstance[nameNode] \n        : nameNode;\n    return {\n        mixins: [StackMixin],\n        inject: {\n            addToBelongStack: {\n                from: 'addToStack',\n            },\n            removeFromBelongStack: {\n                from: 'removeFromStack',\n            },\n            renderJFlow: {\n                from: 'renderJFlow',\n            },\n            addNameToRootStack: {\n                from: 'addNameToRootStack',\n            }\n        },\n        render: function (createElement) {\n            return createElement('template', this.$slots.default);\n        },\n        props: {\n            configs: {\n                type: Object,\n                default: function () {\n                    return {};\n                },\n            },\n            visible: {\n                type: Boolean,\n                default: true,\n            },\n            jflowId: {\n                type: String,\n            }\n        },\n        watch: {\n            configs(val, oldVal) {\n                if(JSON.stringify(val) === JSON.stringify(oldVal)){\n                    return;\n                }\n                this._jflowInstance.setConfig(val);\n                // this._jflowInstance._jflow._render();\n            },\n            '$listeners' (val, oldVal) {\n                let news = [];\n                let deletes = [];\n                const vnew = Object.keys(val).map(e => ({ event: e, handler: val[e] }));\n                const vold = Object.keys(oldVal).map(e => ({ event: e, handler: oldVal[e] }));\n                vnew.forEach((v) => {\n                    const hnew = v.handler;\n                    if(!vold.find((q) => q.handler === hnew)) {\n                        news.push(v);\n                    }\n                });\n                vold.forEach((v) => {\n                    const hold = v.handler;\n                    if(!vnew.find((q) => q.handler === hold)) {\n                        deletes.push(v);\n                    }\n                });\n\n                news.forEach((v) => {\n                    this._jflowInstance.addEventListener(v.event, v.handler);\n                });\n                deletes.forEach((v) => {\n                    this._jflowInstance.removeEventListener(v.event, v.handler);\n                });\n            },\n            visible(val) {\n                this._jflowInstance.visible = val;\n                // this._jflowInstance._belongs.recalculateUp();\n                // this._jflowInstance._jflow._render();\n            },\n        },\n        created() {\n            this._jflowInstance =  new bulder(this.configs);\n            this._jflowInstance.visible = this.visible;\n            Object.keys(this.$listeners).map(event => {\n                const func = this.$listeners[event].bind(this);\n                this._jflowInstance.addEventListener(event, func);\n            })\n            // console.log(this.name, this.)\n            this.addToBelongStack(this._jflowInstance, this.jflowId);\n            this.addNameToRootStack(this._jflowInstance, this.jflowId);\n        },\n        mounted(){\n            this._jflowInstance.recalculate();\n        },\n        updated() {\n            this._jflowInstance.recalculateUp();\n        },\n        destroyed() {\n            this.removeFromBelongStack(this._jflowInstance);\n        },\n    }\n}","// import JFlowComponent from './components/JFlow';\nimport JFlowComponent from './components/JFlow';\nimport JFlowInstance from './components/JFlowInstance';\nimport JFlowLink from './components/JFlowLink';\nimport JFLowGroup from './components/JFlowGroup';\n \nconst JFLOW_NODES = [\n    /**\n     * JFlow {@link Point} 的 vue 封装 \n     * @module j-point\n     * @property {Point~PointConfigs} configs - 传给 Point 的配置\n     * @property {Boolean} visible - 可见状态\n     * @property {String} jflowId - 全局唯一ID，用于连线单元\n     */\n    'Point',\n    /**\n     * JFlow {@link Rectangle} 的 vue 封装 \n     * @module j-rectangle\n     * @property {Rectangle~RectangleConfigs} configs - 传给 Rectangle 的配置\n     * @property {Boolean} visible - 可见状态\n     * @property {String} jflowId - 全局唯一ID，用于连线单元\n     */\n    'Rectangle',\n    /**\n     * JFlow {@link Capsule} 的 vue 封装 \n     * @module j-capsule\n     * @property {Capsule~CapsuleConfigs} configs - 传给 Capsule 的配置\n     * @property {Boolean} visible - 可见状态\n     * @property {String} jflowId - 全局唯一ID，用于连线单元\n     */\n    'Capsule',\n    /**\n     * JFlow {@link Diamond} 的 vue 封装 \n     * @module j-diamond\n     * @property {Diamond~DiamondConfigs} configs - 传给 Diamond 的配置\n     * @property {Boolean} visible - 可见状态\n     * @property {String} jflowId - 全局唯一ID，用于连线单元\n     */\n    'Diamond',\n    /**\n     * JFlow {@link Text} 的 vue 封装 \n     * @module j-text\n     * @property {Text~TextConfigs} configs - 传给 Text 的配置\n     * @property {Boolean} visible - 可见状态\n     * @property {String} jflowId - 全局唯一ID，用于连线单元\n     */\n    'Text',\n    /**\n     * JFlow {@link Icon} 的 vue 封装 \n     * @module j-icon\n     * @property {Icon~IconConfigs} configs - 传给 Icon 的配置\n     * @property {Boolean} visible - 可见状态\n     * @property {String} jflowId - 全局唯一ID，用于连线单元\n     */\n    'Icon',\n];\n/**\n * @typedef {BezierLink~Configs} j-bezier-link~Configs\n * @property {String} from   - 起始单元 jflowId\n * @property {String} to     - 终止单元 jflowId\n */\nconst JFLOW_LINKS = [\n    'Link',\n    'PolylineLink',\n    \n    /**\n     * JFlow {@link BezierLink} 的 vue 封装 \n     * @module j-bezier-link\n     * @property {j-bezier-link~Configs} configs - 传给 Icon 的配置\n     * @property {Boolean} visible - 可见状态\n     * @property {String} jflowId - 全局唯一ID，用于连线单元\n     */\n    'BezierLink'\n]\nconst JFLOW_GROUPS = [\n    /**\n     * JFlow {@link CapsuleGroup} 的 vue 封装 \n     * @module j-capsule-group\n     * @property {CapsuleGroup~CapsuleGroupConfigs} configs - 传给 RectangleGroup 的配置\n     * @property {Boolean} visible - 可见状态\n     * @property {String}} jflowId - 全局唯一ID，用于连线单元\n     */\n    'CapsuleGroup',\n    /**\n     * JFlow {@link DiamondGroup} 的 vue 封装 \n     * @module j-diamond-group\n     * @property {Diamond~DiamondConfigs} configs - 传给 RectangleGroup 的配置\n     * @property {Boolean} visible - 可见状态\n     * @property {String}} jflowId - 全局唯一ID，用于连线单元\n     */\n    'DiamondGroup',\n]\n\nconst components = [\n    {\n        /**\n         * JFlow {@link JFlow} 的 vue 封装 \n         * @module j-jflow\n         * @property {JFlow~JFlowConfigs} configs - 传给 JFlow 的配置\n         */\n        name: 'Jflow',\n        component: JFlowComponent,\n    },\n    {\n        /**\n         * JFlow {@link RectangleGroup} 的 vue 封装 \n         * @module j-group\n         * @property {RectangleGroup~RectangleGroupConfigs} configs - 传给 RectangleGroup 的配置\n         */\n        name: 'Group',\n        component: JFLowGroup('Group'),\n    }, \n    ...JFLOW_GROUPS.map(name => ({\n        name,\n        component: JFLowGroup(name)\n    })),\n    ...JFLOW_NODES.map(name => ({\n        name,\n        component: JFlowInstance(name)\n    })),\n    ...JFLOW_LINKS.map(name => ({\n        name,\n        component: JFlowLink(name)\n    })),\n];\nconst componentPrefix = 'j';\n\n/**\n * @module JFlowVuePlugin \n */\nexport default {\n    /**\n     * 安装 JFlowVuePlugin\n     * @function\n     * @param {Vue} Vue - Vue\n     * @param {Object} options - Vue plugin 配置\n     * @param {string} options.prefix - 组件前缀，默认是 j\n     * @param {Object} options.custom - 自定义组件，形式为 { key: {@link:Instance} }\n     */\n    install: (Vue, options = {}) => {\n        let prefixToUse = componentPrefix;\n        if(options && options.prefix){\n            prefixToUse = options.prefix;\n        };\n        components.forEach(k => {\n            Vue.component(`${prefixToUse}${k.name}`, k.component);\n        });\n\n        if(options.custom) {\n            Object.keys(options.custom).forEach(name => {\n                Vue.component(`${prefixToUse}${name}`, JFlowInstance(options.custom[name]));\n            })\n        }\n        \n    }\n}\n\n// export { * as JFlowInstance } from './components/JFlowInstance'; \n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{class:_vm.$style.body,attrs:{\"id\":\"app\"}},[_c('div',{class:_vm.$style.sidebar},[_c('div',[_c('div',{class:_vm.$style.part,attrs:{\"draggable\":\"true\",\"type\":\"IfStatement\"},on:{\"dragstart\":_vm.onDragStartRectangle}},[_vm._v(\"IfStatement\")])]),_c('div',[_c('div',{class:_vm.$style.part,attrs:{\"draggable\":\"true\",\"type\":\"variable\"},on:{\"dragstart\":_vm.onDragStartPoint}},[_vm._v(\"Variable\")])])]),_c('div',{staticStyle:{\"position\":\"relative\"}},[_c('j-jflow',{ref:\"jflow\",class:_vm.$style.wrapper,attrs:{\"configs\":_vm.configs},on:{\"click\":_vm.onClickNoWhere,\"drop\":_vm.onDrop,\"pressEnd\":_vm.onPressEnd},scopedSlots:_vm._u([{key:\"start\",fn:function(ref){\nvar configs = ref.configs;\nreturn [_c('j-start',{attrs:{\"node\":configs}})]}},{key:\"end\",fn:function(ref){\nvar configs = ref.configs;\nreturn [_c('j-end',{attrs:{\"node\":configs}})]}},{key:\"variable\",fn:function(ref){\nvar configs = ref.configs;\nvar meta = ref.meta;\nreturn [_c('j-variable',{attrs:{\"node\":configs},on:{\"pressStart\":function($event){return _vm.onPressStart(configs)},\"outOfFlow\":function($event){return _vm.onOutOfFlow($event, meta)},\"change\":function($event){return _vm.onChangeContent($event, configs)}}})]}},{key:\"IfStatement\",fn:function(ref){\nvar configs = ref.configs;\nvar meta = ref.meta;\nreturn [_c('j-ifstatement',{attrs:{\"node\":configs},on:{\"pressStart\":function($event){return _vm.onPressStart(configs)},\"outOfFlow\":function($event){return _vm.onOutOfFlow($event, meta)}}})]}},{key:\"SwitchStatement\",fn:function(ref){\nvar configs = ref.configs;\nvar meta = ref.meta;\nreturn [_c('j-switch',{attrs:{\"node\":configs},on:{\"pressStart\":function($event){return _vm.onPressStart(configs)},\"outOfFlow\":function($event){return _vm.onOutOfFlow($event, meta)}}})]}},{key:\"WhileStatement\",fn:function(ref){\nvar configs = ref.configs;\nvar meta = ref.meta;\nreturn [_c('j-whilestatement',{attrs:{\"node\":configs},on:{\"pressStart\":function($event){return _vm.onPressStart(configs)},\"outOfFlow\":function($event){return _vm.onOutOfFlow($event, meta)}}})]}},{key:\"endpoint\",fn:function(ref){\nvar configs = ref.configs;\nreturn [_c('j-endpoint',{attrs:{\"node\":configs}})]}},{key:\"CallLogic\",fn:function(ref){\nvar configs = ref.configs;\nvar meta = ref.meta;\nreturn [_c('j-calllogic',{attrs:{\"node\":configs},on:{\"toggle-select\":function($event){return _vm.onToggleSelect($event, configs)},\"pressStart\":function($event){return _vm.onPressStart(configs)},\"outOfFlow\":function($event){return _vm.onOutOfFlow($event, meta)}}})]}},{key:\"plainlink\",fn:function(ref){\nvar configs = ref.configs;\nreturn [_c('instance-link',{attrs:{\"linkConfigs\":configs},on:{\"drop\":function($event){return _vm.onDropToLink($event, configs)}}})]}}])}),(_vm.isHover)?_c('div',{ref:\"hoverblock\",class:_vm.$style.hoverblock,style:((\"transform: translate(\" + _vm.offsetX + \"px, \" + _vm.offsetY + \"px)\"))},[_c('ul',_vm._l((_vm.logics),function(l){return _c('li',{key:l.content,on:{\"click\":function($event){return _vm.onSelectLogic(l)}}},[_vm._v(_vm._s(l.content))])}),0)]):_vm._e()],1),_c('div',{class:_vm.$style.ast},[_c('pre',{domProps:{\"innerHTML\":_vm._s(_vm.prettyJson(_vm.ast))}})])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',_vm._g({attrs:{\"jflowId\":_vm.node.id,\"configs\":_vm.groupConfig}},_vm.$listeners),[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: '#585c63',\n        content: _vm.node.content,\n        lineHeight: 26,\n        editable: true\n    }},on:{\"change\":_vm.onContentChange}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group\n        :jflowId=\"node.id\" \n        :configs=\"groupConfig\"\n        v-on=\"$listeners\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor: '#585c63',\n            content: node.content,\n            lineHeight: 26,\n            editable: true\n        }\"\n        @change=\"onContentChange\"/>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n    },\n    computed: {\n        groupConfig() {\n            return  {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0,\n                }),\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 5,\n                padding: 10,\n            }\n        }\n    },\n    methods: {\n        onContentChange(event){\n            console.log(event.detail)\n            this.$emit('change', {\n                val: event.detail.val,\n                oldVal: event.detail.oldVal,\n            });\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./variable.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./variable.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./variable.vue?vue&type=template&id=f36965b4&\"\nimport script from \"./variable.vue?vue&type=script&lang=js&\"\nexport * from \"./variable.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-capsule-group',_vm._g({attrs:{\"jflowId\":_vm.node.id,\"configs\":_vm.groupConfig}},_vm.$listeners),[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: '#585c63',\n        content: 'ifstatement ' + _vm.node.id,\n        lineHeight: 26,\n        indent: 10,\n    }}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-capsule-group\n        :jflowId=\"node.id\" \n        :configs=\"groupConfig\"\n        v-on=\"$listeners\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor: '#585c63',\n            content: 'ifstatement ' + node.id,\n            lineHeight: 26,\n            indent: 10,\n        }\"/>\n    </j-capsule-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n    },\n    computed: {\n        groupConfig() {\n            return  {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0,\n                }),\n                borderColor: '#517cff',\n                shadowColor: '#517cff',\n                shadowBlur: 15,\n                borderWidth: 2,\n                borderRadius: 5,\n            }\n        }\n    },\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ifstatement.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ifstatement.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ifstatement.vue?vue&type=template&id=774a60ed&\"\nimport script from \"./ifstatement.vue?vue&type=script&lang=js&\"\nexport * from \"./ifstatement.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',{attrs:{\"jflowId\":_vm.node.id,\"configs\":_vm.configs}},[_c('j-text',{ref:\"start\",attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: '#000',\n        content: 'Start',\n    }}}),_c('j-point',{attrs:{\"configs\":{\n        backgroundColor: '#99DBC5',\n        radius: 20,\n        borderColor: '#33B88C',\n        borderWidth: 2,\n        shadowBlur: 8,\n        shadowColor: 'rgba(0, 0, 0, 0.1)',\n        shadowOffsetY: 2,\n        shadowOffsetX: 0,\n    }}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group \n        :jflowId=\"node.id\" \n        :configs=\"configs\">\n        <j-text ref=\"start\" :configs=\"{\n            fontSize: '12px',\n            textColor: '#000',\n            content: 'Start',\n        }\">\n        </j-text>\n        <j-point :configs=\"{\n            backgroundColor: '#99DBC5',\n            radius: 20,\n            borderColor: '#33B88C',\n            borderWidth: 2,\n            shadowBlur: 8,\n            shadowColor: 'rgba(0, 0, 0, 0.1)',\n            shadowOffsetY: 2,\n            shadowOffsetX: 0,\n        }\"></j-point>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n    },\n    data() {\n        return {\n            configs: {\n                layout: new LinearLayout({\n                    direction: 'vertical',\n                    gap: 10,\n                }),\n                borderColor: 'transparent',\n                borderWidth: 0,\n            },\n        }\n    },\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./start.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./start.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./start.vue?vue&type=template&id=705727a3&\"\nimport script from \"./start.vue?vue&type=script&lang=js&\"\nexport * from \"./start.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',{attrs:{\"jflowId\":_vm.node.id,\"configs\":_vm.configs}},[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: '#000',\n        content: 'End',\n    }}}),_c('j-rectangle',{attrs:{\"configs\":{\n        backgroundColor: '#FAAAAA',\n        width: 36,\n        height: 36,\n        borderRadius: 8,\n        borderWidth: 2,\n        borderColor: '#F55656',\n        shadowBlur: 8,\n        shadowColor: 'rgba(0, 0, 0, 0.1)',\n        shadowOffsetY: 2,\n        shadowOffsetX: 0,\n    }}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group :jflowId=\"node.id\" :configs=\"configs\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor: '#000',\n            content: 'End',\n        }\">\n        </j-text>\n        <j-rectangle :configs=\"{\n            backgroundColor: '#FAAAAA',\n            width: 36,\n            height: 36,\n            borderRadius: 8,\n            borderWidth: 2,\n            borderColor: '#F55656',\n            shadowBlur: 8,\n            shadowColor: 'rgba(0, 0, 0, 0.1)',\n            shadowOffsetY: 2,\n            shadowOffsetX: 0,\n        }\"></j-rectangle>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n    },\n    data() {\n        return {\n            configs: {\n                layout: new LinearLayout({\n                    direction: 'vertical',\n                    gap: 0,\n                }),\n                borderColor: 'transparent',\n                borderWidth: 0,\n            }\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./end.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./end.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./end.vue?vue&type=template&id=d2d62c68&\"\nimport script from \"./end.vue?vue&type=script&lang=js&\"\nexport * from \"./end.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-point',{attrs:{\"jflowId\":_vm.node.id,\"configs\":{\n        backgroundColor: '#fff',\n        borderColor: '#000',\n        borderWidth: 1,\n        radius: 5,\n        ignoreHit: true,\n    }}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-point \n        :jflowId=\"node.id\" \n        :configs=\"{\n            backgroundColor: '#fff',\n            borderColor: '#000',\n            borderWidth: 1,\n            radius: 5,\n            ignoreHit: true,\n        }\">\n    </j-point>\n</template>\n\n<script>\nexport default {\n    props: {\n        node: Object,\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./endpoint.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./endpoint.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./endpoint.vue?vue&type=template&id=46429645&\"\nimport script from \"./endpoint.vue?vue&type=script&lang=js&\"\nexport * from \"./endpoint.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',_vm._g({attrs:{\"jflowId\":_vm.node.id,\"configs\":_vm.configs}},_vm.$listeners),[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: _vm.textColor,\n        content: _vm.node.id,\n    }}}),_vm._l((_vm.node.cases),function(switchcase){return [_c('j-switchcase',{key:switchcase.id,attrs:{\"node\":switchcase}})]})],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-diamond-group',_vm._g({attrs:{\"jflowId\":_vm.node.id,\"configs\":_vm.groupConfig,\"rootLink\":true}},_vm.$listeners),[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: '#585c63',\n        content: _vm.node.content,\n        lineHeight: 26,\n    }}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-diamond-group\n        :jflowId=\"node.id\" \n        :configs=\"groupConfig\"\n        :rootLink=\"true\"\n        v-on=\"$listeners\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor: '#585c63',\n            content: node.content,\n            lineHeight: 26,\n        }\"/>\n    </j-diamond-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n    },\n    computed: {\n        groupConfig() {\n            return  {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0,\n                }),\n                borderColor: '#517cff',\n                paddingTop: 2,\n                paddingBottom: 2,\n                padding: 10,\n                borderWidth: 2,\n                borderRadius: 5,\n            }\n        }\n    },\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./switchcase.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./switchcase.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./switchcase.vue?vue&type=template&id=376765b1&\"\nimport script from \"./switchcase.vue?vue&type=script&lang=js&\"\nexport * from \"./switchcase.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n    <j-group \n        :jflowId=\"node.id\" \n        :configs=\"configs\"\n        v-on=\"$listeners\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor,\n            content: node.id,\n        }\">\n        </j-text>\n        <template v-for=\"switchcase in node.cases\">\n            <j-switchcase :node=\"switchcase\" :key=\"switchcase.id\" />\n        </template>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nimport switchCase from './switchcase.vue';\nexport default {\n    components: {\n        // 'j-variable': variable,\n        'j-switchcase': switchCase,\n    },\n    props: {\n        node: Object,\n    },\n    data() {\n        return {\n            textColor: '#585c63',\n            configs: {\n                layout: new LinearLayout({\n                    direction: 'vertical',\n                    gap: 0,\n                }),\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 5,\n            }\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./switch.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./switch.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./switch.vue?vue&type=template&id=fb4670f6&\"\nimport script from \"./switch.vue?vue&type=script&lang=js&\"\nexport * from \"./switch.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',_vm._g({attrs:{\"jflowId\":_vm.node.id,\"configs\":_vm.groupConfig}},_vm.$listeners),[_c('j-text',{attrs:{\"configs\":{\n        fontSize: '12px',\n        textColor: '#585c63',\n        content: _vm.node.content,\n        lineHeight: 26,\n        indent: 10,\n    }}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group\n        :jflowId=\"node.id\" \n        :configs=\"groupConfig\"\n        v-on=\"$listeners\">\n        <j-text :configs=\"{\n            fontSize: '12px',\n            textColor: '#585c63',\n            content: node.content,\n            lineHeight: 26,\n            indent: 10,\n        }\"/>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nexport default {\n    props: {\n        node: Object,\n    },\n    computed: {\n        groupConfig() {\n            return  {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0,\n                }),\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 5,\n            }\n        }\n    },\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./whilestatement.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./whilestatement.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./whilestatement.vue?vue&type=template&id=5f25fbe1&\"\nimport script from \"./whilestatement.vue?vue&type=script&lang=js&\"\nexport * from \"./whilestatement.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('j-group',_vm._g({attrs:{\"jflowId\":_vm.node.id,\"configs\":_vm.configs}},_vm.$listeners),[_c('j-group',{attrs:{\"configs\":_vm.headerConfigs}},[_c('j-icon',{attrs:{\"configs\":_vm.imageConfig}}),_c('j-text',{attrs:{\"configs\":{\n            fontSize: '16px',\n            textColor: '#585c63',\n            content: '调用逻辑',\n        }}})],1),_c('j-group',{attrs:{\"configs\":_vm.contentConfigs},on:{\"click\":_vm.onClick}},[_c('j-text',{attrs:{\"configs\":{\n            fontSize: '12px',\n            textColor: '#585c63',\n            content: _vm.node.content || '请选择接口' ,\n        }}})],1),(_vm.node.params && _vm.node.params.length)?[_c('j-group',{ref:\"paramGroup\",attrs:{\"configs\":_vm.paramsConfigs}},[_c('j-text',{attrs:{\"configs\":{\n                fontSize: '16px',\n                textColor: '#585c63',\n                content: '参数',\n            }}}),_vm._l((_vm.node.params),function(param){return _c('j-text',{key:param.content,attrs:{\"configs\":{\n                fontSize: '16px',\n                textColor: '#585c63',\n                content: param.content,\n            }}})})],2)]:_vm._e()],2)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <j-group v-on=\"$listeners\" :jflowId=\"node.id\" :configs=\"configs\">\n        <j-group :configs=\"headerConfigs\">\n            <j-icon :configs=\"imageConfig\" />\n            <j-text :configs=\"{\n                fontSize: '16px',\n                textColor: '#585c63',\n                content: '调用逻辑',\n            }\" />\n        </j-group>\n        <j-group @click=\"onClick\" :configs=\"contentConfigs\">\n            <j-text :configs=\"{\n                fontSize: '12px',\n                textColor: '#585c63',\n                content: node.content || '请选择接口' ,\n            }\" />\n            <!-- <j-text :configs=\"{\n                fontSize: '12px',\n                textColor: '#585c63',\n                content: node.content || 'sss接口' ,\n            }\" />\n            <j-text :configs=\"{\n                fontSize: '12px',\n                textColor: '#585c63',\n                content: node.content || '接口' ,\n            }\" /> -->\n        </j-group>\n        <template v-if=\"node.params && node.params.length\">\n            <j-group ref=\"paramGroup\" :configs=\"paramsConfigs\">\n                <j-text :configs=\"{\n                    fontSize: '16px',\n                    textColor: '#585c63',\n                    content: '参数',\n                }\" />\n                <j-text v-for=\"param in node.params\" \n                    :key=\"param.content\"\n                    :configs=\"{\n                    fontSize: '16px',\n                    textColor: '#585c63',\n                    content: param.content,\n                }\" />\n            </j-group>\n        </template>\n    </j-group>\n</template>\n\n<script>\nimport { LinearLayout } from '@joskii/jflow';\nimport logicIcon from '../assets/logic.svg';\nconst p = new Image();\np.src = logicIcon;\nexport default {\n    props: {\n        node: Object,\n    },\n    data() {\n        return {\n            configs: {\n                layout: new LinearLayout({\n                    direction: 'vertical',\n                    gap: 0,\n                    alignment: 'start'\n                }),\n                padding: 10,\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 12,\n            },\n            headerConfigs: {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0\n                }),\n                borderRadius: 10,\n                borderColor: '#ccc',\n                borderWidth: 0,\n            },\n            contentConfigs: {\n                layout: new LinearLayout({\n                    direction: 'horizontal',\n                    gap: 0,\n                    justify: 'start',\n                }),\n                borderColor: '#517cff',\n                borderWidth: 2,\n                borderRadius: 5,\n                width: 200,\n                height: 36,\n            },\n            paramsConfigs: {\n                layout: new LinearLayout({\n                    direction: 'vertical',\n                    gap: 0,\n                    alignment: 'end'\n                }),\n                borderColor: 'transparent',\n                hoverStyle: 'transparent',\n            },\n            imageConfig: {\n                image: p,\n                width: 30,\n                height: 30,\n            }\n        }\n    },\n    watch: {\n        'node.params'(val) {\n            this.$nextTick(() => {\n                if(this.$refs.paramGroup) {\n                    const instance = this.$refs.paramGroup._jflowInstance;\n                    instance.recalculateUp();\n                    instance._jflow._render();  \n                }  \n            })\n        }\n    },\n    methods: {\n        onClick(event) {\n            console.log(event)\n            event.detail.bubbles = false; \n            const { currentTarget } = event;\n            const p = [ -currentTarget.width/2, currentTarget.height/2 ];\n            console.log(p)\n            const gp = currentTarget.calculateToRealWorld(p)\n            // const [ offsetX, offsetY ] = gp;\n            this.$emit('toggle-select', gp);\n        }\n    }\n}\n</script>\n\n<style>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./callLogic.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./callLogic.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./callLogic.vue?vue&type=template&id=19201d96&\"\nimport script from \"./callLogic.vue?vue&type=script&lang=js&\"\nexport * from \"./callLogic.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('jBezierLink',{attrs:{\"configs\":_vm.configs,\"from\":_vm.configs.from,\"to\":_vm.configs.to},on:{\"dragover\":_vm.onDragOver,\"dragoverend\":_vm.onDragOverEnd,\"drop\":_vm.onDropToLink}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <jBezierLink\n        :configs=\"configs\"\n        :from=\"configs.from\"\n        :to=\"configs.to\"\n        @dragover=\"onDragOver\"\n        @dragoverend=\"onDragOverEnd\"\n        @drop=\"onDropToLink\">\n    </jBezierLink>\n</template>\n\n<script>\nexport default {\n    props: {\n        linkConfigs: Object,\n    },\n    data() {\n        return {\n            isDragOver: false,\n        };\n    },\n    computed: {\n        configs() {\n            return {\n                ...this.linkConfigs,\n                approximate: 400,\n                backgroundColor: this.isDragOver ? 'rgba(81, 124, 255, 0.5)' : '#000',\n            };\n        },\n    },\n    methods: {\n        onDropToLink($event) {\n            this.$emit('drop', $event);\n        },\n        onDragOver($event) {\n            this.isDragOver = true;\n        },\n        onDragOverEnd() {\n            this.isDragOver = false;\n        },\n    },\n};\n</script>\n\n<style>\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./instance-link.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./instance-link.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./instance-link.vue?vue&type=template&id=7fd3cfc1&\"\nimport script from \"./instance-link.vue?vue&type=script&lang=js&\"\nexport * from \"./instance-link.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\" :class=\"$style.body\">\n      <div :class=\"$style.sidebar\">\n        <div>\n            <div draggable=\"true\" :class=\"$style.part\" type=\"IfStatement\" @dragstart=\"onDragStartRectangle\">IfStatement</div>\n        </div>\n        <div>\n            <div draggable=\"true\" :class=\"$style.part\" type=\"variable\" @dragstart=\"onDragStartPoint\">Variable</div>\n        </div>\n      </div>\n      <div style=\"position: relative;\">\n        <j-jflow ref=\"jflow\" \n            :class=\"$style.wrapper\" \n            :configs=\"configs\"\n            @click=\"onClickNoWhere\"\n            @drop=\"onDrop\"\n            @pressEnd=\"onPressEnd\">\n                <template #start=\"{ configs }\">\n                    <j-start :node=\"configs\"></j-start>\n                </template>\n                <template #end=\"{ configs }\">\n                    <j-end :node=\"configs\"></j-end>\n                </template>\n                <template #variable=\"{ configs, meta }\">\n                    <j-variable :node=\"configs\" \n                    @pressStart=\"onPressStart(configs)\" \n                    @outOfFlow=\"onOutOfFlow($event, meta)\"\n                    @change=\"onChangeContent($event, configs)\"></j-variable>\n                </template>\n                <template #IfStatement=\"{ configs, meta }\">\n                    <j-ifstatement :node=\"configs\" \n                    @pressStart=\"onPressStart(configs)\" \n                    @outOfFlow=\"onOutOfFlow($event, meta)\"></j-ifstatement>\n                </template>\n                <template #SwitchStatement=\"{ configs, meta }\" >\n                    <j-switch :node=\"configs\" \n                    @pressStart=\"onPressStart(configs)\" \n                    @outOfFlow=\"onOutOfFlow($event, meta)\"/>\n                </template>\n                <template #WhileStatement=\"{ configs, meta }\">\n                    <j-whilestatement :node=\"configs\" \n                    @pressStart=\"onPressStart(configs)\" \n                    @outOfFlow=\"onOutOfFlow($event, meta)\"></j-whilestatement>\n                </template>\n                <template #endpoint=\"{ configs }\">\n                    <j-endpoint :node=\"configs\"></j-endpoint>\n                </template>\n                <template #CallLogic=\"{ configs, meta }\" >\n                    <j-calllogic \n                        :node=\"configs\"\n                        @toggle-select=\"onToggleSelect($event, configs)\"\n                        @pressStart=\"onPressStart(configs)\" \n                        @outOfFlow=\"onOutOfFlow($event, meta)\">\n                    </j-calllogic>\n                </template>\n                <template #plainlink=\"{ configs }\">\n                    <instance-link\n                        :linkConfigs=\"configs\"\n                        @drop=\"onDropToLink($event, configs)\">\n                    </instance-link>\n                </template>\n        </j-jflow>\n        <div ref=\"hoverblock\" \n            :style=\"`transform: translate(${offsetX}px, ${offsetY}px)`\" \n            :class=\"$style.hoverblock\"\n             v-if=\"isHover\">\n            <ul>\n                <li v-for=\"l in logics\" :key=\"l.content\"\n                    @click=\"onSelectLogic(l)\">{{l.content}}</li>\n            </ul>\n        </div>\n      </div>\n      <div :class=\"$style.ast\">\n          <pre v-html=\"prettyJson(ast)\"></pre>\n      </div>\n  </div>\n</template>\n\n<script>\nimport { prettyPrintJson } from 'pretty-print-json';\nimport { LinearLayout, Lowcodelayout, Rectangle, Point } from '@joskii/jflow';\n// import './logic-components/assignment.vue'; // resolve Circular dependencies with logic-node!!!\n// import logicNode from './logic-components/logic-node';\nimport variable from './components/variable.vue';\nimport ifStatement from './components/ifstatement.vue';\nimport start from './components/start.vue';\nimport end from './components/end.vue';\nimport endPoint from './components/endpoint.vue';\nimport switchComp from './components/switch.vue'; \nimport whileComp from './components/whilestatement.vue';\nimport CallLogicComp from './components/callLogic.vue';\nimport instanceLink from './components/instance-link.vue';\nfunction getRandomColor() {\n    var letters = '0123456789ABCDEF';\n    var color = '#';\n    for (var i = 0; i < 6; i++) {\n        color += letters[Math.floor(Math.random() * 16)];\n    }\n    return color;\n}\nfunction getPath(object, condition) {\n\n    function iter(o, p) {\n        if (typeof o === 'object') {\n            return Object.keys(o).some(function (k) {\n                return iter(o[k], p.concat(k));\n            });\n        }\n        if (condition(p[p.length - 1])) {\n            path = p;\n            return true;\n        }\n    }\n\n    var path = [];\n    iter(object, []);\n    return path.join('.');\n}\nlet uniqueId = 0;\nexport default {\n    components: {\n        'j-variable': variable,\n        'j-start': start,\n        'j-end': end,\n        'j-endpoint': endPoint,\n        'j-switch': switchComp,\n        'j-ifstatement': ifStatement,\n        'j-whilestatement': whileComp,\n        'j-calllogic': CallLogicComp,\n        instanceLink,\n    },\n    data() {\n        const ast = {\n            type: 'Root',\n            body: [\n                {\n                    type: 'start',\n                   \n                    id: 'start',\n                }, \n                {\n                    type: 'IfStatement',\n                    content: 'aaaa',\n                    id: 'logic1',\n                    consequent: [\n                        {\n                            type: 'variable',\n                            content: 'vvvkjhkjhvvvv',\n                            id: 'logic5',\n                        },\n                    ], \n                    alternate: [\n                        {\n                            type: 'IfStatement',\n                            content: 'ggggggg',\n                            id: 'logic6',\n                            consequent: [\n                                {\n                                    type: 'variable',\n                                    content: 'jkhvvvv',\n                                    id: 'logic77',\n                                },\n                            ], \n                            alternate: [\n                                {\n                                    type: 'variable',\n                                    content: 'yuuo',\n                                    id: 'logic88',\n                                },\n                            ]\n                        },\n                        {\n                            type: 'CallLogic',\n                            id: 'CallLogic1',\n                            content: '',\n                            params: [],\n                        }\n                    ]\n                },\n                {\n                    type: 'SwitchStatement',\n                    id: 'swtch1',\n                    cases: [\n                        {\n                            type: 'SwitchCase',\n                            id: 'switchcase11',\n                            content: 'switchcase11',\n                            alternate: [\n                                {\n                                    type: 'variable',\n                                    content: 'yuuo',\n                                    id: 'sc1111122',\n                                },\n                            ]\n                        },\n                        {\n                            type: 'SwitchCase',\n                            id: 'switchcase12',\n                            content: 'switchcase12',\n                            alternate: [\n                                {\n                                    type: 'variable',\n                                    content: 'asdfag',\n                                    id: 'sc12344455',\n                                },\n                            ],\n                            consequent: [\n                                {\n                                    type: 'variable',\n                                    content: 'dfhsdfg',\n                                    id: 'sc125444',\n                                },\n                            ],\n                        }\n                    ]\n                },\n                {\n                    type: 'WhileStatement',\n                    id: 'while1',\n                    content: 'while1',\n                    body: [\n                        // {\n                        //     type: 'variable',\n                        //     content: 'dfhsdfg',\n                        //     id: 'whiel1body1',\n                        // },\n                    ]\n                },\n                {\n                    type: 'end',\n                    id: 'end',\n                },\n            ],\n            playground: [],\n        };\n        const layout = new Lowcodelayout({\n            linkLength: 30,\n            ast,\n        });\n        return {\n            ast,\n            configs: {\n                allowDrop: true,\n                layout,\n            },\n            isHover: false,\n            offsetX: 0,\n            offsetY: 0,\n            currentTarget: null,\n            prepareBody: [],\n            logics: [{\n                content: 'aaa',\n                params: [{\n                    content: 'p1',\n                }],\n            }, {\n                content: 'vvvv',\n                params: [{\n                    content: 'p1',\n                }, {\n                    content: 'p2',\n                }],\n            }, {\n                content: 'sadasdf',\n                params: [{\n                    content: 'p1',\n                }],\n            },{\n                content: 'ggggg',\n                params: [{\n                    content: 'p1',\n                },{\n                    content: 'p2',\n                },{\n                    content: 'p3',\n                }],\n            }],\n            currentEditingTarget: null,\n        }\n    },\n    computed: {\n        inflowInstances() {\n            return this.ast.body.filter(b => !b.outflow)\n        }\n    },\n    mounted() {\n        console.log(this.$refs.jflow.getInstance())\n    },\n    methods: {\n        prettyJson() {\n            return prettyPrintJson.toHtml(this.ast);\n        },\n        onDragStartRectangle() {\n            const jflowInstance = this.$refs.jflow.getInstance();\n            jflowInstance.sendMessage({ \n                instance: {\n                    type: 'IfStatement',\n                    content: `IfStatement-rec${uniqueId ++}`,\n                    id: `IfStatement-rec${uniqueId ++}`,\n                    consequent: [], \n                    alternate: [],\n                    \n                }\n            })\n        },\n        onDragStartPoint() {\n            const jflowInstance = this.$refs.jflow.getInstance();\n            jflowInstance.sendMessage({ \n                instance: {\n                    type: 'variable',\n                    content: 'vvvvvvdasdfasfd',\n                    id: `logic-point${uniqueId ++}`,\n                }\n            })\n        },\n        onOutOfFlow(e, meta) {\n            const type = meta.parentIterateType;\n            const idx = meta.idx;\n            const [astnode] = meta.parent.source[type].splice(idx, 1);\n            this.ast.playground.push(astnode);\n            this.configs.layout.reOrder(this.ast);\n            this.$refs.jflow.reflow();\n            meta.getJflowInstance().anchor = e.detail.point;    \n        },\n        onDrop(e) {\n            const astblock = e.detail.instance;\n            this.ast.playground.push(astblock);\n            this.configs.layout.reOrder(this.ast);\n            this.$refs.jflow.reflow(() => {\n                const meta = this.configs.layout.findLayoutNode(astblock);\n                if(meta) {\n                     meta.getJflowInstance().anchor = e.detail.point;\n                }\n            });\n        },\n        onClick(e) {\n            const { currentTarget } = e;\n            const p = [ 0, currentTarget.height/2 ];\n            const gp = currentTarget.calculateToRealWorld(p)\n            const [ offsetX, offsetY ] = gp;\n            this.isHover = !this.isHover;\n            this.offsetX = offsetX;\n            this.offsetY = offsetY;\n        },\n        onPressStart(configs) {\n            console.log('pressStart')\n            console.log(configs);\n            this.currentTarget = configs;\n        },\n        onPressEnd() {\n            console.log('pressEnd')\n            this.currentTarget = null;\n        },\n        onDropToLink(e, linkConfigs) {\n            console.log(e, linkConfigs);\n            let node = e.detail.instance;\n            if(this.currentTarget) {\n                node.removeFromLayoutSource();\n                node = this.currentTarget;\n            }\n\n            linkConfigs.meta.from.linkSource(node, linkConfigs);\n            this.configs.layout.reOrder(this.ast);\n            this.$refs.jflow.reflow();\n        },\n        onToggleSelect(event, configs) {\n            const [offsetX, offsetY] = event;\n            this.offsetX = offsetX;\n            this.offsetY = offsetY;\n            this.isHover = !this.isHover;\n            if(this.isHover) {\n                this.currentEditingTarget = configs\n            } else {\n                this.currentEditingTarget = null;\n            } \n        },\n        onSelectLogic(c) {\n            this.isHover = false\n            console.log(this.currentEditingTarget)\n            this.currentEditingTarget.content = c.content;\n            this.currentEditingTarget.params = c.params;\n        },\n        onClickNoWhere() {\n            this.isHover = false\n            this.currentEditingTarget = null;\n        },\n        onChangeContent($event, configs){\n            configs.content = $event.val;\n        }\n    }\n}\n</script>\n\n<style module>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n.wrapper{\n    width: 800px;\n    height: 600px;\n    border: 1px solid #ccc;\n}\n.body{\n    display: flex;\n    flex-direction: horizontal;\n}\n.sidebar{\n    width: 180px;\n    border: 2px solid gold;\n}\n.sidebar > div {\n    padding: 16px;\n    display: flex;\n    justify-content: center;\n}\n\n.sidebar > div > div {\n    cursor: move;\n}\n\n.sidebar > div > .rect {\n    width: 80px;\n    height: 50px;\n    background-color: green;\n    text-align: center;\n    line-height: 50px;\n}\n\n.sidebar > div > .part {\n    width: 80px;\n    height: 50px;\n    border: 2px solid #517cff;\n    border-radius: 8ox;\n    text-align: center;\n    line-height: 50px;\n}\n\n.sidebar > div > .circle {\n    width: 80px;\n    height: 80px;\n    border-radius: 100%;\n    background-color: hotpink;\n    text-align: center;\n    line-height: 80px;\n}\n.ast {\n    flex: 1;\n    border: 2px solid gold;\n}\n.hide{\n    -webkit-user-drag: none;\n    -khtml-user-drag: none;\n    -moz-user-drag: none;\n    -o-user-drag: none;\n    -ms-user-drag: none;\n    user-drag: none;\n}\n.hoverblock{\n    position: absolute;\n    background: #fff;\n    width: 300px;\n    height: 300px;\n    border: 3px solid gold;\n    left: 0;\n    top: 0;\n    transform: translate(0, 0);\n}\n.hoverblock > ul > li{\n    cursor: pointer;\n}\n.hoverblock > ul > li:hover{\n    background: #eee;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--13-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=04353ce0&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&module=true&lang=css&\"\n\n\n\n\nfunction injectStyles (context) {\n  \n  this[\"$style\"] = (style0.locals || style0)\n\n}\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from 'vue'\nimport { JFlowVuePlugin } from '@joskii/jflow';\nimport App from './App.vue'\n\nVue.config.productionTip = false\nVue.use(JFlowVuePlugin);\nnew Vue({\n  render: h => h(App),\n}).$mount('#app')\n","export { default } from  \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&module=true&lang=css&\"; export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-0-0!../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-0-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--7-oneOf-0-2!../node_modules/cache-loader/dist/cjs.js??ref--1-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&module=true&lang=css&\"","module.exports = __webpack_public_path__ + \"img/logic.17805d7a.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app_3cl75\",\"wrapper\":\"App_wrapper_pE_0j\",\"body\":\"App_body_1uhyl\",\"sidebar\":\"App_sidebar_3dMLz\",\"rect\":\"App_rect_2g-OE\",\"part\":\"App_part_1uPSl\",\"circle\":\"App_circle_2pifB\",\"ast\":\"App_ast_3JyD2\",\"hide\":\"App_hide_1hYJ-\",\"hoverblock\":\"App_hoverblock_rjKeE\"};"],"sourceRoot":""}
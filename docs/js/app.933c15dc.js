(function(t){function e(e){for(var i,r,s=e[0],c=e[1],l=e[2],u=0,f=[];u<s.length;u++)r=s[u],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&f.push(o[r][0]),o[r]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);h&&h(e);while(f.length)f.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(i=!1)}i&&(a.splice(e--,1),t=r(r.s=n[0]))}return t}var i={},o={app:0},a=[];function r(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=i,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var h=c;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"default",(function(){return Et})),n.d(i,"JFlowEvent",(function(){return Z})),n.d(i,"Point",(function(){return N})),n.d(i,"Rectangle",(function(){return V})),n.d(i,"Group",(function(){return Q})),n.d(i,"Text",(function(){return nt})),n.d(i,"Icon",(function(){return ot})),n.d(i,"Link",(function(){return ct})),n.d(i,"PolylineLink",(function(){return D})),n.d(i,"BezierLink",(function(){return ht})),n.d(i,"LinearLayout",(function(){return ft})),n.d(i,"Lowcodelayout",(function(){return St}));n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),a=n("d4ec"),r=n("bee2"),s=n("262e"),c=n("2caf"),l=n("9072");n("9911"),n("18a5"),n("d3b7"),n("159b");function h(t){var e=document.createElement("canvas"),n=e.getContext("2d"),i=t.getBoundingClientRect(),o=i.width,a=i.height,r=i.left,s=i.top;e.style.width=o+"px",e.style.height=a+"px";var c=window.devicePixelRatio;return e.width=Math.floor(o*c),e.height=Math.floor(a*c),t&&(t.style.position="relative",t.append(e)),{canvas:e,width:o,height:a,raw_width:e.width,raw_height:e.height,left:r,top:s,ctx:n,scale:c}}var u=document.createElement("canvas");u.width=1,u.height=1;var f=u.getContext("2d"),d=window.devicePixelRatio;function g(t){f.clearRect(0,0,5,5),f.save(),t(f),f.restore(),f.clearRect(0,0,5,5)}f.scale(d,d);var v=n("4478"),p=n("2909"),m=(n("caad"),n("2532"),n("99af"),n("bb46")),b={RIGHT:0,BOTTOM:1,LEFT:2,TOP:3};var k=6;function y(t){var e=1/0,n=1/0,i=-1/0,o=-1/0;for(var a in t){var r=t[a];r[0]<e&&(e=r[0]),r[0]>i&&(i=r[0]),r[1]<n&&(n=r[1]),r[1]>o&&(o=r[1])}return{width:Math.max(i-e,10),height:Math.max(o-n,10),x:e,y:n}}function _(t){return t*t}function j(t,e){return _(t[0]-e[0])+_(t[1]-e[1])}function w(t,e,n){var i=j(e,n);if(0===i)return j(t,e);var o=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/i;return o=Math.max(0,Math.min(1,o)),j(t,[e[0]+o*(n[0]-e[0]),e[1]+o*(n[1]-e[1])])}function O(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b.TOP,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:b.TOP,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=n===i,r=[b.TOP,b.BOTTOM].includes(n),s=[b.TOP,b.BOTTOM].includes(i),c=[b.TOP,b.LEFT].includes(i)?-5:5,l=s?e[0]:e[0]+c,h=s?e[1]+c:e[1];if(a){var u=Math.abs(r?h-t[1]:l-t[0]);u=Math.min(u,50);var f=[b.RIGHT,b.BOTTOM].includes(i);u=f?u:-u;var d=r?[t[0],t[1]+u]:[t[0]+u,t[1]],g=s?[l,h+u]:[l+u,h];return[].concat(d,g,[l,h])}var v=(o?-5:1)*(r?(h-t[1])/2:(l-t[0])/2),p=(o?-4:1)*(s?(t[1]-h)/2:(t[0]-l)/2),m=v/Math.abs(v);v=m*Math.min(Math.abs(v),50);var k=p/Math.abs(p);p=k*Math.min(Math.abs(p),50);var y=r?[t[0],t[1]+v]:[t[0]+v,t[1]],_=s?[l,h+p]:[l+p,h];return[].concat(y,_,[l,h])}function T(t,e){var n=Object(v["a"])(m["Bezier"],Object(p["a"])(e)),i=n.project({x:t[0],y:t[1]}),o=j(t,[i.x,i.y]);return o}function S(t,e,n,i,o,a,r,s,c){var l=Math.pow(1-t,2)*(i-e)+2*t*(1-t)*(a-i)+t*t*(s-a),h=Math.pow(1-t,2)*(o-n)+2*t*(1-t)*(r-o)+t*t*(c-r);return-Math.atan2(l,h)+.5*Math.PI}n("c740"),n("a434");var x=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(){return Object(a["a"])(this,n),e.call(this)}return Object(r["a"])(n,[{key:"render",value:function(t){var e;this.forEach((function(n){n._isMoving?e=n:n.visible&&(t.save(),n.reflow&&!n._reflowed&&(n.reflow(),n._reflowed=!0),n.render(t),t.restore())})),e&&(t.save(),e.reflow&&!e._reflowed&&(e.reflow(),e._reflowed=!0),e.render(t),t.restore())}},{key:"checkHit",value:function(t,e){var n=this.length-1;while(n>=0){var i=this[n];if(i.visible&&!i.ignoreHit){if(e&&e(i)){n--;continue}var o=i.isHit(t,e);if(i._isHit=!!o,o)return"boolean"!==typeof o?o:i}n--}return null}},{key:"getBoundingRectPoints",value:function(){var t=[];return this.forEach((function(e){e.visible&&t.splice.apply(t,[t.length,0].concat(Object(p["a"])(e.getBoundingRect())))})),t}}]),n}(Object(l["a"])(Array)),E=x,C=n("3835"),I=(n("cb29"),n("257e")),P=(n("a4d3"),n("e01a"),n("b64b"),Symbol("ishit")),M=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["a"])(this,n),t=e.call(this),Object.assign(Object(I["a"])(t),i),t.visible=!0,t.status={hover:!1,focus:!1,moving:!1},t._belongs=void 0,t[P]=!1,t._layoutNode=void 0,t.borderWidth=void 0!==i.borderWidth?i.borderWidth:2,t.borderColor=i.borderColor,t.hoverStyle=i.hoverStyle||"transparent",t.content=i.content||"",t.color=i.color||"white",t.strokeColor=i.strokeColor||"white",t.fontFamily=i.fontFamily="-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji",t.fontSize=i.fontSize||"28px",t.textColor=i.textColor||"white",t.textAlign=i.textAlign||"center",t.textBaseline=i.textBaseline||"middle",t}return Object(r["a"])(n,[{key:"_isTargeting",get:function(){return this===(this._jflow._target.instance||this._jflow._target.link)}},{key:"_isMoving",get:function(){return this===this._jflow._getMovingTarget()}},{key:"_isHit",get:function(){return this[P]},set:function(t){this[P]!==t&&this.dispatchEvent(new CustomEvent(t?"mouseenter":"mouseleave",{detail:{instance:this}})),this[P]=t}},{key:"_jflow",get:function(){return"jflow"===this._belongs.uniqueName?this._belongs:this._belongs._jflow}},{key:"setConfig",value:function(t){var e=this;Object.keys(t).forEach((function(n){void 0!==t[n]&&null!==t[n]&&(e[n]=t[n])}))}},{key:"render",value:function(t){throw"require render implement"}},{key:"isHit",value:function(t){throw"require isHit implement"}},{key:"getBoundingRect",value:function(){throw"require getBoundingRect implement"}},{key:"calculateIntersection",value:function(){throw"require calculateIntersection implement"}},{key:"getIntersectionsInFourDimension",value:function(){throw"require getIntersectionsInFourDimension implement"}},{key:"getCenter",value:function(){return this.anchor}},{key:"getBoundingDimension",value:function(){var t=instance.getBoundingRect(),e=1/0,n=-1/0,i=1/0,o=-1/0;return t.forEach((function(t){n=Math.max(n,t[1]),e=Math.min(e,t[1]),o=Math.max(o,t[0]),i=Math.min(i,t[0])})),{height:n-e,width:o-i}}},{key:"bubbleEvent",value:function(t){this.dispatchEvent(t),console.log(t),t.detail.bubbles&&this._belongs.bubbleEvent&&(console.log(t.type),this._belongs.bubbleEvent(t))}},{key:"calculateToRealWorld",value:function(t){return this._belongs&&this._belongs.calculateToRealWorld?this._belongs.calculateToRealWorld(t):t}},{key:"calculateToRealWorldWithScalar",value:function(t){return this._jflow.scale*t}},{key:"removeFromLayoutSource",value:function(){this._layoutNode&&this._layoutNode.remove()}}]),n}(Object(l["a"])(EventTarget)),L=M,B=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this,t),i.from=t.from,i.to=t.to,i.conrolNodes=[],i.controlPoint=[],i.defaultStyle="black",i.hoverStyle="cornflowerblue",i}return Object(r["a"])(n,[{key:"_calculateAnchorPoints",value:function(){var t=this.from.calculateIntersectionInFourDimension(this.to.getCenter()),e=this.to.calculateIntersectionInFourDimension(this.from.getCenter());return{start:t,end:e}}},{key:"getColor",value:function(){return this.status.hover?this.hoverStyle:this.defaultStyle}},{key:"render",value:function(t){var e=this._calculateAnchorPoints(),n=e.start,i=e.end,o=Math.abs(n.dir-i.dir),a=[n.p];if(1===o||3===o)n.dir%2===1?a.push([i.p[0],n.p[1]]):a.push([n.p[0],i.p[1]]);else if(n.dir%2===1){if(n.p[1]!==i.p[1]){var r=(n.p[0]-i.p[0])/2+i.p[0];a.push([r,n.p[1]]),a.push([r,i.p[1]])}}else if(n.p[0]!==i.p[0]){var s=(n.p[1]-i.p[1])/2+i.p[1];a.push([n.p[0],s]),a.push([i.p[0],s])}a.push(i.p),this.controlPoint=a,t.fillStyle=t.strokeStyle=this.getColor(),t.beginPath();for(var c=0;c<a.length;c++){var l=Object(C["a"])(a[c],2),h=l[0],u=l[1];0===c?t.moveTo(h,u):t.lineTo(h,u)}t.stroke(),t.beginPath();var f=i.p;switch(t.moveTo(f[0],f[1]),i.dir){case b.TOP:t.lineTo(f[0]-5,f[1]-10),t.lineTo(f[0]+5,f[1]-10);break;case b.BOTTOM:t.lineTo(f[0]+5,f[1]+10),t.lineTo(f[0]-5,f[1]+10);break;case b.RIGHT:t.lineTo(f[0]+10,f[1]+5),t.lineTo(f[0]+10,f[1]-5);break;case b.LEFT:t.lineTo(f[0]-10,f[1]-5),t.lineTo(f[0]-10,f[1]+5);break;default:break}t.closePath(),t.fill(),t.stroke()}},{key:"isHit",value:function(t){for(var e=this.controlPoint,n=Object(C["a"])(e[0],2),i=n[0],o=n[1],a=1;a<e.length;a++){var r=Object(C["a"])(e[a],2),s=r[0],c=r[1],l=void 0,h=void 0,u=void 0,f=void 0;if(i===s&&(l=i-k,h=i+k,u=Math.max(o,c),f=Math.min(o,c)),o===c&&(f=o-k,u=o+k,h=Math.max(i,s),l=Math.min(i,s)),t[0]>l&&t[0]<h&&t[1]>f&&t[1]<u)return!0;i=s,o=c}return!1}},{key:"getBoundingRect",value:function(){var t=this._calculateAnchorPoints(),e=t.start,n=t.end;return[e.p,n.p]}}]),n}(L),D=B,F={instances:[],links:[],_stack:null,_linkStack:null,initStack:function(t){var e=this,n=t.data;this._stack=new E,this._linkStack=new E,n&&(this.instances=n.instances,this.links=n.links,this.instances.forEach((function(t){e._stack.push(t),t._belongs=e})),this.links.forEach((function(t){e._linkStack.push(t),t._belongs=e})))},addToStack:function(t){t._belongs=this,this._stack.push(t)},replaceFromStack:function(t,e){var n=this._stack.findIndex((function(e){return e===t}));this._stack.splice(n,1,e),t._belongs=null,e._belongs=this},addToLinkStack:function(t){t._belongs=this,this._linkStack.push(t)},removeFromStack:function(t){var e=this._stack.findIndex((function(e){return e===t}));this._stack.splice(e,1)},removeFromLinkStack:function(t){var e=this._linkStack.findIndex((function(e){return e===t}));this._linkStack.splice(e,1)},emptyLink:function(){this._linkStack=new E},addInstanceToLink:function(t,e){this.addToStack(e);var n=t.from,i=t.to,o=this._linkStack.findIndex((function(e){return e===t})),a=t.__proto__.constructor,r=new a({from:n,to:e});r._belongs=this;var s=new a({from:e,to:i});s._belongs=this,this._linkStack.splice(o,1,r,s)}},R=F,H={_layout:null,_reflowed:!1,initLayout:function(t){this._layout=t.layout},recalculateUp:function(){this.recalculate(),this._belongs&&this._belongs.recalculateUp()},recalculate:function(){this._reflowed=!0,this.reflow(),this._getBoundingGroupRect&&this._getBoundingGroupRect()},staticCheck:function(t){return!!this._layout&&this._layout.staticCheck(t,this)},reflow:function(){this._layout&&this._layout.reflow(this)}},Y=H,X={_message:null,sendMessage:function(t){this._message=t},consumeMessage:function(){var t=this._message;return this._message=null,t}},$=X,q=n("ade3"),A=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["a"])(this,n),t=e.call(this,i),t.anchor=i.anchor||[0,0],t.margin=i.margin||5,t}return Object(r["a"])(n,[{key:"renderFocus",value:function(t){var e=this.getBoundingRect();if(4===e.length){var n=this.margin,i=Object(C["a"])(e,4),o=i[0],a=i[1],r=i[2],s=i[3],c=a[0]-o[0],l=s[1]-o[1],h=.2*c,u=.2*l;t.save(),t.beginPath(),t.moveTo(o[0]-n,o[1]-n+u),t.lineTo(o[0]-n,o[1]-n),t.lineTo(o[0]-n+h,o[1]-n),t.stroke(),t.beginPath(),t.moveTo(a[0]+n-h,a[1]-n),t.lineTo(a[0]+n,a[1]-n),t.lineTo(a[0]+n,a[1]-n+u),t.stroke(),t.beginPath(),t.moveTo(r[0]+n,r[1]+n-u),t.lineTo(r[0]+n,r[1]+n),t.lineTo(r[0]+n-h,r[1]+n),t.stroke(),t.beginPath(),t.moveTo(s[0]-n+h,s[1]+n),t.lineTo(s[0]-n,s[1]+n),t.lineTo(s[0]-n,s[1]+n-u),t.stroke(),t.restore()}}}]),n}(L),z=A,W=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this,t),i.type="Point",i.radius=t.radius||10,i.radiusExpo2=i.radius*i.radius,i}return Object(r["a"])(n,[{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.5),t.beginPath(),t.arc(this.anchor[0],this.anchor[1],this.radius,0,2*Math.PI),t.fillStyle=this.color,t.fill(),t.strokeStyle=this.strokeColor,t.stroke(),this._isTargeting&&this.renderFocus(t),t.restore()}},{key:"isHit",value:function(t){var e=this.anchor;return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)<this.radiusExpo2}},{key:"getBoundingRect",value:function(){var t=this.anchor,e=this.radius,n=t[0]-e,i=t[1]-e,o=t[0]+e,a=t[1]+e;return[[n,i],[o,i],[o,a],[n,a]]}},{key:"calculateIntersection",value:function(t){var e=Object(C["a"])(t,2),n=e[0],i=e[1],o=Object(C["a"])(this.anchor,2),a=o[0],r=o[1],s=a-n,c=r-i,l=Math.sqrt(s*s+c*c),h=this.radius/l;return[a-h*s,r-h*c]}},{key:"getIntersectionsInFourDimension",value:function(){var t,e=Object(C["a"])(this.anchor,2),n=e[0],i=e[1],o=this.radius;return t={},Object(q["a"])(t,b.RIGHT,[n+o,i]),Object(q["a"])(t,b.LEFT,[n-o,i]),Object(q["a"])(t,b.BOTTOM,[n,i+o]),Object(q["a"])(t,b.TOP,[n,i-o]),t}},{key:"calculateIntersectionInFourDimension",value:function(t,e){var n,i=Object(C["a"])(t,2),o=i[0],a=i[1],r=Object(C["a"])(this.anchor,2),s=r[0],c=r[1],l=this.radius,h=s-o,u=c-a,f=(n={},Object(q["a"])(n,b.RIGHT,[s+l,c]),Object(q["a"])(n,b.LEFT,[s-l,c]),Object(q["a"])(n,b.BOTTOM,[s,c+l]),Object(q["a"])(n,b.TOP,[s,c-l]),n),d=Math.abs(u)>Math.abs(h)?u<0?b.BOTTOM:b.TOP:h<0?b.RIGHT:b.LEFT;return d=this.checkLinked(d,e),{p:f[d],dir:d}}},{key:"getBoundingDimension",value:function(){return{width:2*this.radius,height:2*this.radius}}}]),n}(z),N=W,G=n("5530"),J=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(a["a"])(this,n);var o=Object(G["a"])(Object(G["a"])({},i),{},{originEvent:i.event,target:i.target,jflow:i.jflow,bubbles:i.bubbles||!1});return e.call(this,t,{detail:o})}return n}(Object(l["a"])(CustomEvent)),Z=J,U=(n("e9c4"),function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["a"])(this,n),t=e.call(this,i),t.type="Rectangle",t.width=i.width||10,t.height=i.height||10,t.borderRadius=i.borderRadius||0,t}return Object(r["a"])(n,[{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.5),t.beginPath();var e=this.borderRadius,n=(this.anchor,this.width),i=this.height;if(this.borderRadius){var o=this.anchor[0]-this.width/2,a=this.anchor[1]-this.height/2;t.moveTo(o+e,a),t.lineTo(o+n-e,a),t.quadraticCurveTo(o+n,a,o+n,a+e),t.lineTo(o+n,a+i-e),t.quadraticCurveTo(o+n,a+i,o+n-e,a+i),t.lineTo(o+e,a+i),t.quadraticCurveTo(o,a+i,o,a+i-e),t.lineTo(o,a+e),t.quadraticCurveTo(o,a,o+e,a),t.closePath()}else t.rect(this.anchor[0]-this.width/2,this.anchor[1]-this.height/2,this.width,this.height);t.fillStyle=this.color,t.fill(),this.borderWidth&&(this.status.hover?t.strokeStyle=this.hoverStyle:t.strokeStyle=this.borderColor,t.stroke()),this._isTargeting&&this.renderFocus(t),t.restore()}},{key:"isHit",value:function(t){var e=this.anchor,n=this.width/2,i=this.height/2;return t[0]>e[0]-n&&t[0]<e[0]+n&&t[1]>e[1]-i&&t[1]<e[1]+i}},{key:"getBoundingRect",value:function(){var t=this.anchor,e=this.width/2,n=this.height/2,i=t[0]-e,o=t[1]-n,a=t[0]+e,r=t[1]+n;return[[i,o],[a,o],[a,r],[i,r]]}},{key:"getBoundingDimension",value:function(){return{height:this.height,width:this.width}}},{key:"calculateIntersection",value:function(t){var e,n,i=Object(C["a"])(t,2),o=i[0],a=i[1],r=Object(C["a"])(this.anchor,2),s=r[0],c=r[1],l=this.width/2,h=this.height/2,u=s-o,f=c-a,d=h/l,g=Math.abs(f/u),v=o>s,p=a>c;return g<d?(e=s+(v?l:-l),n=l*(p?g:-g)+c):(n=c+(p?h:-h),e=h/(v?g:-g)+s),[e,n]}},{key:"getIntersectionsInFourDimension",value:function(){var t,e=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(e=this._belongs.calculateToCoordination(e));var n=e,i=Object(C["a"])(n,2),o=i[0],a=i[1],r=this.width/2,s=this.height/2;return t={},Object(q["a"])(t,b.RIGHT,[o+r,a]),Object(q["a"])(t,b.LEFT,[o-r,a]),Object(q["a"])(t,b.BOTTOM,[o,a+s]),Object(q["a"])(t,b.TOP,[o,a-s]),t}},{key:"calculateIntersectionInFourDimension",value:function(t,e){var n,i=Object(C["a"])(t,2),o=i[0],a=i[1],r=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(r=this._belongs.calculateToCoordination(r));var s=r,c=Object(C["a"])(s,2),l=c[0],h=c[1],u=this.width/2,f=this.height/2,d=(n={},Object(q["a"])(n,b.RIGHT,[l+u,h]),Object(q["a"])(n,b.LEFT,[l-u,h]),Object(q["a"])(n,b.BOTTOM,[l,h+f]),Object(q["a"])(n,b.TOP,[l,h-f]),n),g=l-o,v=h-a,p=f/u,m=Math.abs(v/g),k=o>l,y=a>h,_=m>p?y?b.BOTTOM:b.TOP:k?b.RIGHT:b.LEFT;return this._belongs&&this._belongs.calculateToCoordination&&(console.log(JSON.stringify(this._intersections)),console.log(_)),_=this.checkLinked(_,e),this._belongs&&this._belongs.calculateToCoordination&&console.log(_),{p:d[_],dir:_}}}]),n}(z)),V=U,K=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this,t),i.initStack(t),i.initLayout(t),i.definedWidth=t.width,i.definedHeight=t.height,i.type="Group",i.padding=t.padding||2,i.hoverStyle=t.hoverStyle||"cornflowerblue",i.hasShrink=t.hasShrink,i.lock=t.lock,i.status.shrink=!1,i.offsetY=0,i.offsetX=0,i._getBoundingGroupRect(),i.reflow(),i._getBoundingGroupRect(),i}return Object(r["a"])(n,[{key:"_getBoundingGroupRect",value:function(){var t=this._stack.getBoundingRectPoints(),e=y(t),n=this.padding,i=e.width+2*n,o=e.height+2*n;this.width=this.definedWidth||i,this.height=this.definedHeight||o,this.offsetY=e.y,this.offsetX=e.x}},{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.5);var e=this.anchor;t.save(),V.prototype.render.call(this,t),t.restore();var n=this.height,i=this.width,o=this.padding,a=n/2+this.offsetY-o,r=i/2+this.offsetX-o;t.translate(e[0]-r,e[1]-a),this._stack.render(t),this._linkStack.render(t),t.translate(-e[0]+r,-e[1]+a),this._isTargeting&&this.renderFocus(t),t.restore()}},{key:"_calculatePointBack",value:function(t){var e=Object(C["a"])(t,2),n=e[0],i=e[1],o=this.height,a=this.width,r=this.padding,s=o/2+this.offsetY-r,c=a/2+this.offsetX-r,l=this.anchor,h=[n-l[0]+c,i-l[1]+s];return h}},{key:"isHit",value:function(t,e){var n=this._calculatePointBack(t);this._currentp=n;var i=this._stack.checkHit(n,e);return i||V.prototype.isHit.call(this,t)}},{key:"calculateToCoordination",value:function(t){var e=Object(C["a"])(t,2),n=e[0],i=e[1],o=this.height,a=this.width,r=this.padding,s=o/2+this.offsetY-r,c=a/2+this.offsetX-r,l=this.anchor,h=[n+l[0]-c,i+l[1]-s];return this._belongs&&this._belongs.calculateToCoordination?this._belongs.calculateToCoordination(h):h}},{key:"calculateToRealWorld",value:function(t){var e=Object(C["a"])(t,2),n=e[0],i=e[1],o=this.height,a=this.width,r=this.padding,s=o/2+this.offsetY-r,c=a/2+this.offsetX-r,l=this.anchor,h=[n+l[0]-c,i+l[1]-s];if(this._belongs&&this._belongs.calculateToRealWorld)return this._belongs.calculateToRealWorld(h)}}]),n}(V);Object.assign(K.prototype,R),Object.assign(K.prototype,Y);var Q=K;n("ac1f");function tt(){var t=document.createElement("input");return t.setAttribute("style","\n        position: absolute;\n        left: 0;\n        top: 0;\n        border:none;\n        background-image:none;\n        background-color:transparent;\n        -webkit-box-shadow: none;\n        -moz-box-shadow: none;\n        box-shadow: none;"),t}var et=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this,t),i.type="Text",i.lineHeight=t.lineHeight,i.indent=t.indent||0,i.backgroundColor=t.backgroundColor,i.editable=t.editable,i.acceptPatten=t.acceptPatten,i.editStatus={editting:!1},g((function(t){i.renderShadowText(t)})),i._makeEditable(),i}return Object(r["a"])(n,[{key:"_makeEditable",value:function(){var t=this;this.editable&&this.addEventListener("click",(function(e){var n=[0,-t.height/2],i=+/(\d+)/.exec(t.fontSize)[1],o=t.calculateToRealWorld(n),a=Object(C["a"])(o,2),r=a[0],s=a[1],c=tt(),l=t._jflow.DOMwrapper,h=t.content;c.style.transform="translate(".concat(r,"px, ").concat(s,"px)"),c.style.width=t.calculateToRealWorldWithScalar(t.width)+"px",c.style.height=t.calculateToRealWorldWithScalar(t.height)+"px",c.style.fontFamily=t.fontFamily,l.style.fontSize="".concat(i*t._jflow.scale,"px"),c.style.fontSize="".concat(i*t._jflow.scale,"px"),c.style.lineHeight="".concat(t.lineHeight*t._jflow.scale,"px"),c.style.textIndent="".concat(t.indent*t._jflow.scale,"px"),c.value=t.content,c.style.color=t.textColor,c.addEventListener("focus",(function(){t.content="",t._jflow._render(),c.style.outline="none"}));var u=function(){if(t.acceptPatten);else{var e=c.value;t.dispatchEvent(new Z("change",{target:t,oldVal:h,val:e})),t.content=h,c.removeEventListener("blur",u),l.removeChild(c),c=null,u=null}};c.addEventListener("blur",u);var f=function t(e){"Enter"!==e.key&&13!==e.keyCode||(c.removeEventListener("keyup",t),u())};c.addEventListener("keyup",f),l.append(c),c.focus()}))}},{key:"renderShadowText",value:function(t){t.beginPath(),t.font="".concat(this.fontSize," ").concat(this.fontFamily),t.textAlign=this.textAlign,t.textBaseline=this.textBaseline,t.fillStyle=this.textColor;var e=t.measureText(this.content),n=e.actualBoundingBoxLeft,i=e.actualBoundingBoxRight,o=e.fontBoundingBoxAscent,a=e.fontBoundingBoxDescent;this.width=this.indent+Math.abs(n)+Math.abs(i);var r=Math.abs(o)+Math.abs(a);this.lineHeight?this.height=this.lineHeight:this.height=r}},{key:"setConfig",value:function(t){var e=this;Object.keys(t).forEach((function(n){void 0!==t[n]&&null!==t[n]&&(e[n]=t[n])})),g((function(t){e.renderShadowText(t)}))}},{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.5),this.renderShadowText(t);var e=this.borderRadius,n=(this.anchor,this.width),i=this.height;if(this.backgroundColor||this.borderColor){if(t.save(),t.beginPath(),this.borderRadius){var o=this.anchor[0]-this.width/2,a=this.anchor[1]-this.height/2;t.moveTo(o+e,a),t.lineTo(o+n-e,a),t.quadraticCurveTo(o+n,a,o+n,a+e),t.lineTo(o+n,a+i-e),t.quadraticCurveTo(o+n,a+i,o+n-e,a+i),t.lineTo(o+e,a+i),t.quadraticCurveTo(o,a+i,o,a+i-e),t.lineTo(o,a+e),t.quadraticCurveTo(o,a,o+e,a),t.closePath()}else t.rect(this.anchor[0]-this.width/2,this.anchor[1]-this.height/2,this.width,this.height);this.backgroundColor&&(t.fillStyle=this.backgroundColor,t.fill()),this.borderColor&&(t.strokeStyle=this.borderColor,t.stroke()),t.restore()}t.beginPath(),t.fillText(this.content,this.anchor[0]+this.indent/2,this.anchor[1]),t.restore()}}]),n}(V),nt=et,it=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this,t),i.borderWidth=0,i.image=t.image,i.image.onload=function(){requestAnimationFrame((function(){i._jflow._render()}))},i.imageBounding={width:t.imageWidth||t.width,height:t.imageHeight||t.height},i}return Object(r["a"])(n,[{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.5),V.prototype.render.call(this,t);var e=this.anchor[0]-this.width/2,n=this.anchor[1]-this.height/2;t.drawImage(this.image,e,n,this.imageBounding.width,this.imageBounding.height),t.restore()}}]),n}(V),ot=it,at=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a["a"])(this,n),t=e.call(this),t.from=i.from,t.to=i.to,t.fromDir=i.fromDir,t.toDir=i.toDir,t.key=i.key,t._cachePoints=null,t.defaultStyle="black",t.hoverStyle="cornflowerblue",t}return n}(L),rt=at,st=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this,t),i.from=t.from,i.to=t.to,i.controlPoints=[0,1,-10,1,-10,5],i._cachePoints=null,i.defaultStyle="black",i.hoverStyle="cornflowerblue",i}return Object(r["a"])(n,[{key:"getColor",value:function(){return this._isTargeting?this.hoverStyle:this.defaultStyle}},{key:"_calculateAnchorPoints",value:function(){var t=this.from.calculateIntersection(this.to.getCenter()),e=this.to.calculateIntersection(this.from.getCenter());return this._cachePoints=[t,e],{startX:t[0],startY:t[1],endX:e[0],endY:e[1]}}},{key:"render",value:function(t){var e=this._calculateAnchorPoints(),n=e.startX,i=e.startY,o=e.endX,a=e.endY,r=this.controlPoints,s=o-n,c=a-i,l=Math.sqrt(s*s+c*c),h=c/l,u=s/l,f=[];f.push(0,0);for(var d=0;d<r.length;d+=2){var g=r[d],v=r[d+1];f.push(g<0?l+g:g,v)}f.push(l,0);for(d=r.length;d>0;d-=2){g=r[d-2],v=r[d-1];f.push(g<0?l+g:g,-v)}f.push(0,0),t.fillStyle=t.strokeStyle=this.getColor(),t.beginPath();for(d=0;d<f.length;d+=2){g=f[d]*u-f[d+1]*h+n,v=f[d]*h+f[d+1]*u+i;0===d?t.moveTo(g,v):t.lineTo(g,v)}t.fill()}},{key:"isHit",value:function(t){if(!this._cachePoints)return!1;var e=Object(C["a"])(this._cachePoints,2),n=e[0],i=e[1],o=w(t,n,i);return o<k}},{key:"getBoundingRect",value:function(){var t=this._calculateAnchorPoints(),e=t.startX,n=t.startY,i=t.endX,o=t.endY;return[[e,n],[i,o]]}}]),n}(rt),ct=st,lt=(n("fb6a"),function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this,t),i.anticlock=t.anticlock,i}return Object(r["a"])(n,[{key:"getColor",value:function(){return this._isTargeting?this.hoverStyle:this.defaultStyle}},{key:"_calculateAnchorPoints",value:function(){var t,e;void 0!==this.fromDir&&(t={dir:this.fromDir,p:this.from.getIntersectionsInFourDimension()[this.fromDir]}),void 0!==this.toDir&&(e={dir:this.toDir,p:this.to.getIntersectionsInFourDimension()[this.toDir]});var n=t.p,i=e.p,o=O(n,i,t.dir,e.dir,this.anticlock);this._cachePoints=[].concat(Object(p["a"])(n),Object(p["a"])(o))}},{key:"render",value:function(t){this._calculateAnchorPoints();var e=this._cachePoints,n=S.apply(null,[1].concat(Object(p["a"])(e)));t.fillStyle=t.strokeStyle=this.getColor(),t.beginPath(),t.moveTo(e[0],e[1]),t.bezierCurveTo.apply(t,Object(p["a"])(e.slice(2))),t.stroke(),t.beginPath(),t.translate(e[6],e[7]),t.rotate(n),t.moveTo(5,0),t.lineTo(0,-4),t.lineTo(0,4),t.lineTo(5,0),t.fill(),t.rotate(-n),t.translate(-e[6],-e[7])}},{key:"isHit",value:function(t){if(!this._cachePoints)return!1;var e=this._cachePoints,n=T(t,e);return n<k}},{key:"getBoundingRect",value:function(){var t=this._calculateAnchorPoints(),e=t.startX,n=t.startY,i=t.endX,o=t.endY;return[[e,n],[i,o]]}}]),n}(rt)),ht=lt,ut=(n("4de4"),function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(a["a"])(this,t),this.direction=e.direction||"vertical",this.gap=e.gap||5,this.alignment=e.alignment||"center"}return Object(r["a"])(t,[{key:"reflow",value:function(t){var e=this,n=t._stack.filter((function(t){return t.visible&&!t.outOfFlow}));if("vertical"===this.direction){var i=0,o=0,a=0;n.forEach((function(t,n){var r=t.getBoundingDimension(),s=r.width,c=r.height;a=Math.max(s,a),i+=c/2+(n>0?e.gap:0)+o,o=c/2,t.anchor=[0,i]})),"start"===this.alignment&&n.forEach((function(t,e){var n=t.getBoundingDimension(),i=n.width;t.anchor[0]=-(a-i)/2})),"end"===this.alignment&&n.forEach((function(t,e){var n=t.getBoundingDimension(),i=n.width;t.anchor[0]=(a-i)/2}))}if("horizontal"===this.direction){var r=0,s=0,c=0;n.forEach((function(t,n){var i=t.getBoundingDimension(),o=i.width,a=i.height;c=Math.max(a,c),r+=o/2+(n>0?e.gap:0)+s,s=o/2,t.anchor=[r,0]})),"start"===this.alignment&&n.forEach((function(t,e){var n=t.getBoundingDimension(),i=n.height;t.anchor[1]=-(c-i)/2})),"end"===this.alignment&&n.forEach((function(t,e){var n=t.getBoundingDimension(),i=n.height;t.anchor[1]=(c-i)/2}))}}}]),t}()),ft=ut,dt=(n("7db0"),n("07ac"),n("d81d"),function(){function t(e){Object(a["a"])(this,t),this.source=e,this.id=e.id,this.type=e.type,this.getJflowInstance=void 0,this.level=void 0,this.sequence=void 0,this.isLocked=!1,this.isFree=!1,this.parent=void 0,this.idx=void 0,this.parentIterateType=void 0}return Object(r["a"])(t,[{key:"reflowPreCalculate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return this.level=t,this.sequence=e,this.spanX=1,this.spanY=1,n&&(console.log(t,e,this.id),n(t,e,this)),{spanX:this.spanX,spanY:this.spanY,level:t,sequence:e}}},{key:"makeLink",value:function(t){return this}},{key:"makeEndpoint",value:function(){}},{key:"traverse",value:function(t){t(this)}},{key:"getNodes",value:function(){var t=[];return this.traverse((function(e){e.getJflowInstance&&t.push(e.getJflowInstance())})),t}},{key:"linkSource",value:function(t){this.parent.source[this.parentIterateType].splice(this.idx+1,0,t)}},{key:"remove",value:function(){this.parent.source[this.parentIterateType].splice(this.idx,1)}}]),t}()),gt=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;Object(a["a"])(this,n),i=e.call(this,t),i.isroot=!0,i.body=(t.body||[]).map(_t("body").bind(Object(I["a"])(i)));var o=_t("playground").bind(Object(I["a"])(i));return i.playground=(t.playground||[]).map((function(t,e){var n=o(t,e);return n.isFree=!0,n})),i}return Object(r["a"])(n,[{key:"reflowBodyPreCalculate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=1,o=1;return this.level=t,this.sequence=e,n&&n(t,e,this),this.body.forEach((function(a){var r=a.reflowPreCalculate(t+1,e,n),s=r.spanX,c=r.spanY;i=Math.max(s,i),o+=c,t+=c})),this.spanX=i,this.spanY=o,{spanX:i,spanY:o,level:t,sequence:e}}},{key:"reflowPlaygroundPreCalculate",value:function(t,e){this.playground.forEach((function(n){t(n),n.reflowPreCalculate(0,0,e)}))}},{key:"makeLink",value:function(t){var e;return this.body.forEach((function(n){e?(t({from:e.id,to:n.id,part:"body",fromDir:b.BOTTOM,toDir:b.TOP,meta:{from:e,to:n}}),n=n.makeLink(t),e=n):e=n})),this.playground.forEach((function(e){e.makeLink(t)})),this}},{key:"traverse",value:function(t){this.body.forEach((function(e){e.traverse(t)})),this.playground.forEach((function(e){e.traverse(t)}))}}]),n}(dt),vt=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this,t),i.consequent=(t.consequent||[]).map(_t("consequent").bind(Object(I["a"])(i))),i.alternate=(t.alternate||[]).map(_t("alternate").bind(Object(I["a"])(i))),i.isLocked=!0,i}return Object(r["a"])(n,[{key:"reflowPreCalculate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=1,o=1;this.level=t,this.sequence=e,n&&n(t,e,this);var a=1,r=0,s=0,c=0;this.consequent.forEach((function(i,o){var s=i.reflowPreCalculate(t+1,e,n),c=s.spanX,l=s.spanY;a=Math.max(a,c),r+=l,t+=l}));var l=e+a;t=this.level,this.alternate.forEach((function(e,i){var o=e.reflowPreCalculate(t+1,l,n),a=o.spanX,r=o.spanY;s=Math.max(s,a),c+=r,t+=r})),i=Math.max(1,a+s),o+=Math.max(r,c),t=this.level+o-1;var h=this.Endpoint.reflowPreCalculate(t+1,e,n),u=h.spanY;return o+=u,this.spanX=i,this.spanY=o,{spanX:i,spanY:o,level:t,sequence:e}}},{key:"makeLink",value:function(t){var e=this,n=this;this.consequent.forEach((function(e){t({from:n.id,to:e.id,part:"consequent",fromDir:b.BOTTOM,toDir:b.TOP,meta:{from:n,to:e}}),e=e.makeLink(t),n=e})),t({from:n.id,to:this.Endpoint.id,fromDir:b.BOTTOM,toDir:b.TOP,part:"consequent",meta:{from:n,to:this.Endpoint}});var i=this;return this.alternate.forEach((function(n){t({from:i.id,to:n.id,fromDir:i===e?b.RIGHT:b.BOTTOM,toDir:b.TOP,part:"alternate",meta:{from:i,to:n}}),n=n.makeLink(t),i=n})),t({from:i.id,to:this.Endpoint.id,fromDir:i===this?b.RIGHT:b.BOTTOM,toDir:b.RIGHT,part:"alternate",meta:{from:i,to:this.Endpoint}}),this.Endpoint}},{key:"makeEndpoint",value:function(){this.Endpoint=jt({type:"endpoint",id:"".concat(this.id,"-endpoint")}),this.Endpoint.parent=this.parent,this.Endpoint.idx=this.idx,this.Endpoint.parentIterateType=this.parentIterateType}},{key:"traverse",value:function(t){t(this),this.consequent.forEach((function(e){e.traverse(t)})),this.alternate.forEach((function(e){e.traverse(t)})),t(this.Endpoint)}},{key:"linkSource",value:function(t,e){this.source[e.part].unshift(t)}}]),n}(dt),pt=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this,t),i.cases=(t.cases||[]).map(_t("case").bind(Object(I["a"])(i))),i.cases.length&&(i.cases[i.cases.length-1].lastCase=!0),i.isLocked=!0,i}return Object(r["a"])(n,[{key:"reflowPreCalculate",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,o=1,a=1;this.level=e,this.sequence=n,i&&i(e,n,this);var r=1,s=0;if(this.cases.length){var c=this.cases[this.cases.length-1].consequent;e=this.level,c.forEach((function(t){var o=t.reflowPreCalculate(e+1,n,i),a=o.spanX,c=o.spanY;r=Math.max(r,a),s+=c,e+=c}))}var l=r,h=0;this.cases.forEach((function(o,a){var r=n+l,s=0,c=0;e=t.level,o.alternate.forEach((function(t){var n=t.reflowPreCalculate(e+1,r,i),o=n.spanX,a=n.spanY;s=Math.max(s,o),c+=a,e+=a})),l+=s,h=Math.max(h,c)})),o=Math.max(1,l),a=Math.max(s,h),e=this.level+a;var u=this.Endpoint.reflowPreCalculate(e+1,n,i),f=u.spanY;return a+=f,a+=1,this.spanX=o,this.spanY=a,{spanX:o,spanY:a,level:e,sequence:n}}},{key:"makeLink",value:function(t){var e=this,n=this;if(this.cases.length){var i=this.cases[this.cases.length-1].consequent;i.forEach((function(e){t({from:n.id,to:e.id,fromDir:b.BOTTOM,toDir:b.TOP,part:"consequent",meta:{from:n,to:e}}),n=e.makeLink(t)}))}return t({from:n.id,to:this.Endpoint.id,fromDir:b.BOTTOM,toDir:b.TOP,part:"alternate",meta:{from:n,to:this.Endpoint}}),this.cases.forEach((function(n){var i=n;n.alternate.forEach((function(e){t({from:i.id,to:e.id,fromDir:i===n?b.RIGHT:b.BOTTOM,toDir:b.TOP,part:"alternate",meta:{from:i,to:e}}),i=e.makeLink(t)})),t({from:i.id,to:e.Endpoint.id,fromDir:i===n?b.RIGHT:b.BOTTOM,toDir:b.RIGHT,part:"alternate",meta:{from:i,to:e.Endpoint}})})),this.Endpoint}},{key:"makeEndpoint",value:function(){this.Endpoint=jt({type:"endpoint",id:"".concat(this.id,"-endpoint")}),this.Endpoint.parent=this.parent,this.Endpoint.parentIterateType=this.parentIterateType,this.Endpoint.idx=this.idx}},{key:"traverse",value:function(t){t(this),this.cases.forEach((function(e){e.traverse(t)})),t(this.Endpoint)}}]),n}(dt),mt=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(){return Object(a["a"])(this,n),e.apply(this,arguments)}return n}(dt),bt=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this,t),i.body=(t.body||[]).map(_t("body").bind(Object(I["a"])(i))),console.log(i.body),i.isLocked=!0,i}return Object(r["a"])(n,[{key:"reflowPreCalculate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=1,o=1;this.level=t,this.sequence=e,n&&n(t,e,this);var a=e+1;return this.body.forEach((function(e){var r=e.reflowPreCalculate(t+1,a,n),s=r.spanX,c=r.spanY;i=Math.max(s,i),o+=c,t+=c})),this.spanX=i+1,this.spanY=o,{spanX:i,spanY:o,level:t,sequence:e}}},{key:"makeLink",value:function(t){var e=this,n=this;return this.body.forEach((function(i,o){t({from:n.id,to:i.id,part:"body",fromDir:n===e?b.RIGHT:b.BOTTOM,toDir:b.TOP,meta:{from:n,to:i}}),i=i.makeLink(t),n=i})),console.log(n===this),t({from:n.id,to:this.id,part:"body",fromDir:n===this?b.RIGHT:b.BOTTOM,anticlock:n===this,toDir:b.BOTTOM,meta:{from:n,to:this}}),this}},{key:"traverse",value:function(t){t(this),this.body.forEach((function(e){e.traverse(t)}))}},{key:"linkSource",value:function(t,e){this.source[e.part].unshift(t)}}]),n}(dt),kt=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this,t),i.consequent=(t.consequent||[]).map(_t("consequent").bind(Object(I["a"])(i))),i.alternate=(t.alternate||[]).map(_t("alternate").bind(Object(I["a"])(i))),i.lastCase=!1,i}return Object(r["a"])(n,[{key:"reflowPreCalculate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=1,o=1;this.level=t,this.sequence=e,n&&n(t,e,this);var a=0,r=0,s=0,c=0;this.lastCase&&this.consequent.forEach((function(i,o){var s=i.reflowPreCalculate(t+1,e,n),c=s.spanX,l=s.spanY;a=Math.max(a,c),r+=l,t+=l}));var l=e+Math.max(a,1);return t=this.level,this.alternate.forEach((function(e,i){var o=e.reflowPreCalculate(t+1,l,n),a=o.spanX,r=o.spanY;s=Math.max(s,a),c+=r,t+=r})),i=Math.max(1,a+s),o+=Math.max(r,c),this.spanX=i,this.spanY=o,{spanX:i,spanY:o,level:t,sequence:e}}},{key:"traverse",value:function(t){t(this),this.consequent.forEach((function(e){e.traverse(t)})),this.alternate.forEach((function(e){e.traverse(t)}))}},{key:"linkSource",value:function(t,e){this.source[e.part].unshift(t)}}]),n}(dt),yt={IfStatement:vt,SwitchStatement:pt,SwitchCase:kt,ForEachStatement:mt,WhileStatement:bt,Root:gt,other:dt};function _t(t){return function(e,n){var i=jt(e);return i.parent=this,i.idx=n,i.parentIterateType=t,i.makeEndpoint(),i}}function jt(t){var e=t.type,n=yt[e]||yt.other;console.log(e);var i=new n(t);return i}function wt(t){return t*t}function Ot(t,e){return wt(t[0]-e[0])+wt(t[1]-e[1])}var Tt=function(){function t(e){Object(a["a"])(this,t),this.linkLength=e.linkLength||18,this.gap=e.gap||30,this.reOrder(e.ast),this.static=!0}return Object(r["a"])(t,[{key:"reOrder",value:function(t){var e=this;this.ast=t,this.flowStack=[],this.flowLinkStack=[],this.root=jt(this.ast),this.root.traverse((function(t){e.flowStack.push({type:t.type,configs:t.source,layoutMeta:t})}));var n,i={vertical:{},horizontal:{}},o={};this.root.reflowBodyPreCalculate(0,0,(function(t,e,n){n.isroot||(i.vertical[t]||(i.vertical[t]={}),i.vertical[t][e]=n,i.horizontal[e]||(i.horizontal[e]={}),i.horizontal[e][t]=n)})),this.root.reflowPlaygroundPreCalculate((function(t){n=t.id,o[t.id]={vertical:{},horizontal:{},node:t}}),(function(t,e,i){var a=o[n];a.vertical[t]||(a.vertical[t]={}),a.vertical[t][e]=i,a.horizontal[e]||(a.horizontal[e]={}),a.horizontal[e][t]=i})),this.layoutMapping=i,this.playgroundLayoutMapping=o,this.root.makeLink((function(t){e.flowLinkStack.push(t)}))}},{key:"staticCheck",value:function(t,e){if(t._layoutNode&&t._layoutNode.isFree)return!1;var n=e._linkStack.find((function(e){return e.from===t||e.to===t}));if(!n)return!1;var i=t.anchor.slice();if(e.reflow(),!(e._linkStack.length<2)){var o=t.anchor,a=Ot(i,o);return a>1e3&&(console.log(t),t.dispatchEvent(new Z("outOfFlow",{anchor:i,instance:t,jflow:e,point:i})),!0)}}},{key:"reflowByMapping",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this.linkLength,o=this.gap,a=t.vertical,r=t.horizontal,s=e;Object.keys(r).forEach((function(t,e){var n=r[t],i=0,a=Object.keys(n);a.forEach((function(t){var e=n[t],o=e.getJflowInstance(),a=o.getBoundingDimension(),r=a.width;i=Math.max(r,i)})),s+=0===e?0:i/2,a.forEach((function(t){var e=n[t],i=e.getJflowInstance();i.anchor[0]=s})),s+=i/2+o}));var c=n;Object.keys(a).forEach((function(t,e){var n=a[t],o=0,r=Object.keys(n);r.forEach((function(t){var e=n[t],i=e.getJflowInstance(),a=i.getBoundingDimension(),r=a.height;a.width;o=Math.max(r,o)})),c+=0===e?0:o/2,r.forEach((function(t){var e=n[t],i=e.getJflowInstance();i.anchor[1]=c})),c+=o/2+i}))}},{key:"findLayoutNode",value:function(t){var e=this.flowStack.find((function(e){return e.configs===t}));return e?e.layoutMeta:null}},{key:"reflow",value:function(t){var e=this;this.reflowByMapping(this.layoutMapping),Object.values(this.playgroundLayoutMapping).forEach((function(t){var n=t.node.getJflowInstance();e.reflowByMapping(t,n.anchor[0],n.anchor[1])}))}}]),t}(),St=Tt,xt=function(t){Object(s["a"])(n,t);var e=Object(c["a"])(n);function n(t){var i;return Object(a["a"])(this,n),i=e.call(this),i.uniqueName="jflow",i.initStack(t),i.initLayout(t),i.plugins=[],i.ctx=null,i.canvas=null,i.dpr=1,i.padding=20,i.position=null,i.scale=null,i.maxZoom=3,i.minZoom=.5,i.offeset=null,i._lastState={x:null,y:null,dragging:!1,processing:!1},i._lastDragState={target:null,targetLink:null,processing:!1},i._target={instance:null,link:null,moving:null,isInstanceDirty:!1,isLinkDirty:!1,cache:{stack:null,belongs:null,point:null},meta:{x:void 0,y:void 0,initialX:void 0,initialY:void 0},status:{dragovering:!1,dragging:!1,processing:!1}},i._lastFocus={instance:null,processing:!1},i.allowDrop=t.allowDrop,i}return Object(r["a"])(n,[{key:"use",value:function(t){this.plugins.push(t)}},{key:"$mount",value:function(t){var e=h(t),n=e.canvas,i=e.ctx,o=e.scale,a=e.width,r=e.height,s=e.raw_width,c=e.raw_height;e.left,e.top;this.reflow(),this.ctx=i,this.DOMwrapper=t,this.canvas=n,this.canvasMeta={width:s,height:c,actual_width:a,actual_height:r},this.dpr=o,this._createEventHandler(),this._getBoundingGroupRect();var l=this.padding,u=this.bounding_box,f=u.width,d=u.height,g=u.x,v=u.y,p={x:l,y:l,width:a-2*l,height:r-2*l},m={x:0,y:0,offsetX:0,offsetY:0},b=p.width/f,k=p.height/d,y=b<=k?"x":"y",_=Math.min(b,k);this.scale=_,_>this.maxZoom&&(this.maxZoom=_),_<this.minZoom&&(this.minZoom=_),m.x="x"===y?p.x:(p.width-f*_)/2+l,m.y="y"===y?p.y:(p.height-d*_)/2+l,m.offsetX=m.x-g*_,m.offsetY=m.y-v*_,this.position=m,this._render()}},{key:"_getBoundingGroupRect",value:function(){var t=this._stack.getBoundingRectPoints();if(this.bounding_box){this.bounding_box=y(t);var e=this.bounding_box,n=e.x,i=e.y,o=this.scale;this.position.x=this.position.offsetX+n*o,this.position.y=this.position.offsetY+i*o}else this.bounding_box=y(t)}},{key:"$setFocus",value:function(t){var e=this;this._lastFocus.processing||(this._lastFocus.processing=!0,this._lastFocus.instance&&(this._lastFocus.instance.status.focus=!1),this._lastFocus.instance=t,t&&(t.status.focus=!0,t.bubbleEvent(new Z("focus"))),requestAnimationFrame((function(){e._render(),e._lastFocus.processing=!1})))}},{key:"_createEventHandler",value:function(){var t,e=this.canvas,n=this._onZoom.bind(this),i=this._onPressStart.bind(this),o=this._onPressMove.bind(this),a=this._onPressUp.bind(this),r=this._onPressUpDocument.bind(this),s=this._onContextMenu.bind(this);e.addEventListener("wheel",n),e.addEventListener("contextmenu",(function(t){t.preventDefault()})),e.addEventListener("pointerdown",i),e.addEventListener("pointermove",o),e.addEventListener("pointerup",a),e.addEventListener("contextmenu",s),document.addEventListener("pointerup",r);var c=function(){e.removeEventListener("wheel",n),e.removeEventListener("pointerdown",i),e.removeEventListener("pointermove",o),e.removeEventListener("pointerup",a),document.removeEventListener("pointerup",r)};if(t=c,this.allowDrop){var l=this._onDragover.bind(this),h=this._onDrop.bind(this);e.addEventListener("dragover",l),e.addEventListener("drop",h),t=function(){c(),e.removeEventListener("dragover",l),e.removeEventListener("drop",h)}}this.destroy=t}},{key:"_targetLockOn",value:function(t,e){var n=this,i=this._calculatePointBack(t);this._currentp=i;var o=this._stack,a=o.checkHit(i,(function(t){return n._target.status.dragging&&t===n._getMovingTarget()})),r=this._linkStack,s=this;a&&(r=a._belongs._linkStack,i=a._belongs._currentp,o=a._belongs._stack,s=a._belongs);var c=r.checkHit(i);if(Object.assign(this._target,{instance:a,link:c,isInstanceDirty:a===this._target.instance,isLinkDirty:c===this._target.link}),Object.assign(this._target.cache,{stack:o,belongs:s,point:i}),Object.assign(this._target.meta,{x:t[0],y:t[1]}),"pressStart"===e&&!this._target.status.dragging&&!this._target.status.dragovering){var l=a;while(l&&l._belongs.lock&&l!==this)l=l._belongs;l===this&&(l=a),l&&(l=l._layoutNode&&l._layoutNode.isLocked?l._layoutNode.getNodes():[l]),Object.assign(this._target,{moving:l})}return this._target}},{key:"_getMovingTarget",value:function(){return this._target.moving&&this._target.moving[0]}},{key:"_onDragover",value:function(t){var e=this;if(t.preventDefault(),!this._lastDragState.processing){this._lastDragState.processing=!0;var n=t.offsetX,i=t.offsetY;Object.assign(this._target.status,{dragovering:!0}),this._targetLockOn([n,i]),this._target.isLinkDirty||this._target.isInstanceDirty?requestAnimationFrame((function(){e._render(),e._target.isLinkDirty=!1,e._target.isInstanceDirty=!1,e._lastDragState.processing=!1})):this._lastDragState.processing=!1}}},{key:"_onDrop",value:function(t){var e=this,n=(t.offsetX,t.offsetY,t.clientX,t.clientY,this.consumeMessage()),i=n.instance,o=this._target,a=o.link,r=o.instance,s=this._target.cache,c=s.point,l=s.belongs;a?(i.anchor=c,a.dispatchEvent(new Z("drop",{event:t,instance:i,link:a,jflow:this,belongs:l,point:c}))):r?r.bubbleEvent(new Z("drop",{event:t,instance:i,jflow:this,target:r,point:c})):this.dispatchEvent(new Z("drop",{event:t,instance:i,jflow:this,target:r,point:c})),requestAnimationFrame((function(){e._target.instance=null,e._target.link=null,Object.assign(e._target.status,{dragovering:!1})}))}},{key:"_onZoom",value:function(t){var e=this;if(t.preventDefault(),!this._zooming){this._zooming=!0;var n=t.offsetX,i=t.offsetY,o=t.deltaY,a=this.bounding_box,r=a.width,s=a.height,c=a.x,l=a.y,h=this.scale,u=o>0?1.1:1/1.1;h*=u,this.maxZoom&&h>this.maxZoom&&(h=this.maxZoom),this.minZoom&&h<this.minZoom&&(h=this.minZoom);var f=h-this.scale,d=r*this.scale,g=s*this.scale,v=r*f,p=s*f,m=n-this.position.x,b=i-this.position.y,k=-m/d,y=-b/g;this.scale=h,this.position.x+=k*v,this.position.y+=y*p,this.position.offsetX=this.position.x-c*h,this.position.offsetY=this.position.y-l*h,requestAnimationFrame((function(){e._render(),e._zooming=!1}))}}},{key:"_onPressStart",value:function(t){console.log("pressStart",t);var e=t.offsetX,n=t.offsetY,i=(t.deltaY,t.button);if(0===i&&(this._targetLockOn([e,n],"pressStart"),Object.assign(this._target.meta,{initialX:e,initialY:n}),Object.assign(this._target.status,{dragging:!0,processing:!1}),this._target.moving)){var o=this._getMovingTarget();o.dispatchEvent(new Z("pressStart",{event:t,instance:o,jflow:this}))}}},{key:"_onPressMove",value:function(t){var e=this,n=this._target.status,i=n.dragging,o=n.processing,a=this._target.meta,r=a.x,s=a.y,c=t.offsetX,l=t.offsetY;t.clientX,t.clientY;if(!i&&!o){var h=this._targetLockOn([c,l]),u=h.link,f=h.instance;this.canvas.style.cursor=f||u?"move":"default"}if(i&&!o){var d=this._target.moving;this._target.status.processing=!0;var g=c-r,v=l-s;d?d.forEach((function(t){t.anchor[0]+=g/e.scale,t.anchor[1]+=v/e.scale})):this._recalculatePosition(g,v),this._targetLockOn([c,l]),requestAnimationFrame((function(){e._render(),e._target.isLinkDirty=!1,e._target.isInstanceDirty=!1,e._target.status.processing=!1}))}}},{key:"_onPressUp",value:function(t,e){t.preventDefault(),t.stopPropagation();var n=t.button;if(0===n){var i=this._target.meta;if(i.initialX===i.x&&i.initialY===i.y){if(this._target.instance&&!e){var o=this._target.instance;return o.bubbleEvent(new Z("click",{event:t,target:o,jflow:this,bubbles:!0})),this._clearTarget(),void this._render()}return this.dispatchEvent(new Z("click",{event:t,jflow:this})),this._clearTarget(),void this._render()}if(this._target.moving){var a=!1;if(this._layout.static&&(a=this.staticCheck(this._getMovingTarget())),!a&&this._target.link){var r=this._target.cache,s=(r.point,r.belongs),c=this._target.link,l=this._getMovingTarget();c.dispatchEvent(new Z("drop",{event:t,instance:l,link:c,jflow:this,belongs:s})),this._target.link=null,this._target.instance=null}this._target.moving&&(this._target.instance?this._target.instance.bubbleEvent(new Z("pressEnd",{event:t,instance:this._getMovingTarget(),jflow:this,target:this._target.instance,bubbles:!0})):this.dispatchEvent(new Z("pressEnd",{event:t,instance:this._getMovingTarget(),jflow:this}))),this._target.moving=null,this._render()}this._clearTarget()}}},{key:"_clearTarget",value:function(){Object.assign(this._target.meta,{x:void 0,y:void 0,initialX:void 0,initialY:void 0}),Object.assign(this._target.status,{dragging:!1,processing:!1}),Object.assign(this._target,{instance:null,link:null,moving:null})}},{key:"_onPressUpDocument",value:function(t){this._onPressUp(t,!0)}},{key:"_onClick",value:function(t){var e=t.offsetX,n=t.offsetY,i=this._calculatePointBack([e,n]);this._stack.checkHit(i)}},{key:"_onContextMenu",value:function(t){t.preventDefault(),t.stopPropagation();var e=t.offsetX,n=t.offsetY,i=this._targetLockOn([e,n]),o=i.link,a=i.instance;if(a||o){var r=a||o;r.bubbleEvent(new Z("contextclick",{event:t,jflow:this,target:r,bubbles:!0}))}}},{key:"_recalculatePosition",value:function(t,e,n){var i=this.bounding_box,o=i.x,a=i.y;void 0===n&&(n=this.scale),this.position.x+=t,this.position.y+=e,this.position.offsetX=this.position.x-o*n,this.position.offsetY=this.position.y-a*n}},{key:"calculateToRealWorld",value:function(t){var e=this.scale,n=this.position;return[t[0]*e+n.offsetX,t[1]*e+n.offsetY]}},{key:"_calculatePointBack",value:function(t){var e=this.scale,n=this.position;return[(t[0]-n.offsetX)/e,(t[1]-n.offsetY)/e]}},{key:"_calculateDistance",value:function(t){var e=this.scale;return e*t}},{key:"_resetTransform",value:function(){var t=this.canvasMeta,e=t.width,n=t.height,i=this.position,o=this.scale,a=this.ctx;a.setTransform(),a.clearRect(0,0,e,n),a.scale(this.dpr,this.dpr),a.transform(o,0,0,o,i.offsetX,i.offsetY)}},{key:"_render",value:function(){this._resetTransform();var t=this._linkStack;t.render(this.ctx),this._stack.render(this.ctx)}}]),n}(Object(l["a"])(EventTarget));Object.assign(xt.prototype,$),Object.assign(xt.prototype,R),Object.assign(xt.prototype,Y);var Et=xt,Ct=(n("b0c0"),{provide:function(){return{addToStack:this.addToStack,addToLinkStack:this.addToLinkStack,removeFromStack:this.removeFromStack,removeFromLinkStack:this.removeFromLinkStack,getInstanceByName:this.getInstanceByName}},data:function(){return{stack:[]}},methods:{getInstanceByName:function(t){var e=this.stack.find((function(e){return e.name===t}));return e?e.instance:null},addToStack:function(t,e){this._jflowInstance.addToStack(t),this.stack.push({name:e,instance:t})},addToLinkStack:function(t){this._jflowInstance.addToLinkStack(t)},removeFromStack:function(t){this._jflowInstance.removeFromStack(t)},removeFromLinkStack:function(t){this._jflowInstance.removeFromLinkStack(t)},onStackChangeHandler:function(){this._jflowInstance.recalculate(),this._jflowInstance.reflow()}}}),It={mixins:[Ct],provide:function(){return{renderJFlow:this.renderJFlow,addNameToRootStack:this.addNameToRootStack}},props:{configs:{type:Object,default:function(){return{}}}},data:function(){return{nodes:[],links:[]}},render:function(t){var e=this;if(this.nodes.length){var n=this.nodes.map((function(t){var n=t.type,i=t.configs,o=t.meta;if(e.$scopedSlots[n]){var a=e.$scopedSlots[n]({configs:i,meta:o}),r=Object(C["a"])(a,1),s=r[0];return o.getJflowInstance=function(){var t=s.componentInstance;while(t&&!t._jflowInstance)t=t.$children[0];return t._jflowInstance._layoutNode=o,t._jflowInstance},s.key=i.id,s}})),i=this.links.map((function(t){var n=t.type||"plainlink";if(!e.$scopedSlots[n])return null;var i=e.$scopedSlots[n]({configs:t}),o=Object(C["a"])(i,1),a=o[0];return a.key="".concat(t.from,"-").concat(t.to,"-").concat(t.part),a}));return t("div",[].concat(Object(p["a"])(n),Object(p["a"])(i)))}return t("div",this.$slots.default)},created:function(){this._jflowInstance=new Et(this.configs)},mounted:function(){var t=this;console.log(this),this.nodes=this._jflowInstance._layout.flowStack.map((function(t){return{type:t.type,configs:t.configs,meta:t.layoutMeta}})),this.links=this._jflowInstance._layout.flowLinkStack.slice(),this.$nextTick((function(){t._jflowInstance.$mount(t.$el)})),Object.keys(this.$listeners).map((function(e){console.log(e);var n=t.$listeners[e].bind(t);t._jflowInstance.addEventListener(e,n)}))},methods:{reflow:function(t){var e=this,n=this._jflowInstance._layout.flowStack.map((function(t){return{type:t.type,configs:t.configs,meta:t.layoutMeta}})),i=[];this.nodes.forEach((function(t){n.find((function(e){return e.configs.id===t.configs.id}))||i.push(t)})),this.nodes=n.concat(i),this.links=this._jflowInstance._layout.flowLinkStack.slice(),this.$nextTick((function(){t&&t(),e._jflowInstance.recalculate(),e._jflowInstance._render(),console.log(e._jflowInstance.bounding_box)}))},getInstance:function(){return this._jflowInstance},renderJFlow:function(){this._jflowInstance._render()},addNameToRootStack:function(t,e){this.stack.push({name:e,instance:t})}}},Pt=(n("8a79"),n("dd43")),Mt=n.n(Pt),Lt=function(t){var e="string"===typeof t?i[t]:t;return{inject:["addToStack","removeFromStack","addNameToRootStack"],props:{configs:{type:Object,default:function(){return{}}},name:{type:String}},watch:{configs:function(t,e){if(JSON.stringify(t)!==JSON.stringify(e)){var n=Mt()(t,e),i=Object.keys(n).filter((function(t){var e=t.toLowerCase();return!(e.endsWith("color")||t.endsWith("style"))}));this._jflowInstance.setConfig(t),console.log(i.length,t),i.length&&this._jflowInstance._belongs.recalculateUp(),this._jflowInstance._jflow._render()}},$listeners:function(t,e){var n=this,i=[],o=[],a=Object.keys(t).map((function(e){return{event:e,handler:t[e]}})),r=Object.keys(e).map((function(t){return{event:t,handler:e[t]}}));a.forEach((function(t){var e=t.handler;r.find((function(t){return t.handler===e}))||i.push(t)})),r.forEach((function(t){var e=t.handler;a.find((function(t){return t.handler===e}))||o.push(t)})),i.forEach((function(t){n._jflowInstance.addEventListener(t.event,t.handler)})),o.forEach((function(t){n._jflowInstance.removeEventListener(t.event,t.handler)}))}},render:function(t){return null},created:function(){this._jflowInstance=new e(this.configs),this.bindListeners(),this.addToStack(this._jflowInstance,this.name)},destroyed:function(){this.removeFromStack(this._jflowInstance)},methods:{bindListeners:function(){var t=this;Object.keys(this.$listeners).map((function(e){var n=t.$listeners[e];t._jflowInstance.addEventListener(e,n)}))}}}},Bt=function(t,e){return{inject:["addToLinkStack","removeFromLinkStack","getInstanceByName"],props:{configs:{type:Object,default:function(){return{}}},from:String,to:String},watch:{from:function(){this.resetLink()},to:function(){this.resetLink()}},render:function(t){return null},created:function(){var e=this,n=this.getInstanceByName(this.from),o=this.getInstanceByName(this.to),a=this.$vnode.key;n&&o&&(this._jflowInstance=new i[t](Object(G["a"])(Object(G["a"])({},this.configs),{},{key:a,from:n,to:o})),this.addToLinkStack(this._jflowInstance),Object.keys(this.$listeners).map((function(t){var n=e.$listeners[t].bind(e);e._jflowInstance.addEventListener(t,n)})))},methods:{resetLink:function(){var t=this.getInstanceByName(this.from),e=this.getInstanceByName(this.to);this._jflowInstance.from=t,this._jflowInstance.to=e}},destroyed:function(){this._jflowInstance&&this.removeFromLinkStack(this._jflowInstance)}}},Dt={mixins:[Ct],inject:{addToBelongStack:{from:"addToStack"},removeFromBelongStack:{from:"removeFromStack"},renderJFlow:{from:"renderJFlow"},addNameToRootStack:{from:"addNameToRootStack"}},render:function(t){return t("template",this.$slots.default)},props:{configs:{type:Object,default:function(){return{}}},name:{type:String}},watch:{configs:function(t,e){JSON.stringify(t)!==JSON.stringify(e)&&this._jflowInstance.setConfig(t)},$listeners:function(t,e){var n=this,i=[],o=[],a=Object.keys(t).map((function(e){return{event:e,handler:t[e]}})),r=Object.keys(e).map((function(t){return{event:t,handler:e[t]}}));a.forEach((function(t){var e=t.handler;r.find((function(t){return t.handler===e}))||i.push(t)})),r.forEach((function(t){var e=t.handler;a.find((function(t){return t.handler===e}))||o.push(t)})),i.forEach((function(t){n._jflowInstance.addEventListener(t.event,t.handler)})),o.forEach((function(t){n._jflowInstance.removeEventListener(t.event,t.handler)}))}},created:function(){var t=this;this._jflowInstance=new Q(this.configs),Object.keys(this.$listeners).map((function(e){var n=t.$listeners[e].bind(t);t._jflowInstance.addEventListener(e,n)})),this.addToBelongStack(this._jflowInstance,this.name),this.addNameToRootStack(this._jflowInstance,this.name)},mounted:function(){this._jflowInstance.recalculate()},destroyed:function(){this.removeFromBelongStack(this._jflowInstance)}},Ft=["Point","Rectangle","Text","Icon"],Rt=["Link","PolylineLink","BezierLink"],Ht=[{name:"Jflow",component:It},{name:"Group",component:Dt}].concat(Object(p["a"])(Ft.map((function(t){return{name:t,component:Lt(t)}}))),Object(p["a"])(Rt.map((function(t){return{name:t,component:Bt(t)}})))),Yt="j",Xt={install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Yt;e&&e.prefix&&(n=e.prefix),Ht.forEach((function(e){t.component("".concat(n).concat(e.name),e.component)})),e.custom&&Object.keys(e.custom).forEach((function(i){t.component("".concat(n).concat(i),Lt(e.custom[i]))}))}},$t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.$style.body,attrs:{id:"app"}},[n("div",{class:t.$style.sidebar},[n("div",[n("div",{class:t.$style.part,attrs:{draggable:"true",type:"IfStatement"},on:{dragstart:t.onDragStartRectangle}},[t._v("IfStatement")])]),n("div",[n("div",{class:t.$style.part,attrs:{draggable:"true",type:"variable"},on:{dragstart:t.onDragStartPoint}},[t._v("Variable")])])]),n("div",{staticStyle:{position:"relative"}},[n("j-jflow",{ref:"jflow",class:t.$style.wrapper,attrs:{configs:t.configs},on:{click:t.onClickNoWhere,drop:t.onDrop,pressEnd:t.onPressEnd},scopedSlots:t._u([{key:"start",fn:function(t){var e=t.configs;return[n("j-start",{attrs:{node:{name:e.id}}})]}},{key:"end",fn:function(t){var e=t.configs;return[n("j-end",{attrs:{node:{name:e.id}}})]}},{key:"variable",fn:function(e){var i=e.configs,o=e.meta;return[n("j-variable",{attrs:{node:{name:i.id,content:i.content}},on:{pressStart:function(e){return t.onPressStart(i)},outOfFlow:function(e){return t.onOutOfFlow(e,o)},change:function(e){return t.onChangeContent(e,i)}}})]}},{key:"IfStatement",fn:function(e){var i=e.configs,o=e.meta;return[n("j-ifstatement",{attrs:{node:{name:i.id,content:i.content}},on:{pressStart:function(e){return t.onPressStart(i)},outOfFlow:function(e){return t.onOutOfFlow(e,o)}}})]}},{key:"SwitchStatement",fn:function(e){var i=e.configs,o=e.meta;return[n("j-switch",{attrs:{node:{name:i.id,content:i.id,cases:i.cases}},on:{pressStart:function(e){return t.onPressStart(i)},outOfFlow:function(e){return t.onOutOfFlow(e,o)}}})]}},{key:"WhileStatement",fn:function(e){var i=e.configs,o=e.meta;return[n("j-whilestatement",{attrs:{node:{name:i.id,content:i.content}},on:{pressStart:function(e){return t.onPressStart(i)},outOfFlow:function(e){return t.onOutOfFlow(e,o)}}})]}},{key:"endpoint",fn:function(t){var e=t.configs;return[n("j-endpoint",{attrs:{node:{name:e.id}}})]}},{key:"CallLogic",fn:function(e){var i=e.configs,o=e.meta;return[n("j-calllogic",{attrs:{node:{name:i.id,content:i.content,params:i.params}},on:{"toggle-select":function(e){return t.onToggleSelect(e,i)},pressStart:function(e){return t.onPressStart(i)},outOfFlow:function(e){return t.onOutOfFlow(e,o)}}})]}},{key:"plainlink",fn:function(e){var i=e.configs;return[n("jBezierLink",{attrs:{configs:i,from:i.from,to:i.to},on:{drop:function(e){return t.onDropToLink(e,i)}}})]}}])}),t.isHover?n("div",{ref:"hoverblock",class:t.$style.hoverblock,style:"transform: translate("+t.offsetX+"px, "+t.offsetY+"px)"},[n("ul",t._l(t.logics,(function(e){return n("li",{key:e.content,on:{click:function(n){return t.onSelectLogic(e)}}},[t._v(t._s(e.content))])})),0)]):t._e()],1),n("div",{class:t.$style.ast},[n("pre",{domProps:{innerHTML:t._s(t.prettyJson(t.ast))}})])])},qt=[],At=(n("53ca"),n("a15b"),n("68ca")),zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",t._g({attrs:{name:t.node.name,configs:t.groupConfig}},t.$listeners),[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:t.node.content,lineHeight:26,editable:!0}},on:{change:t.onContentChange}})],1)},Wt=[],Nt={props:{node:Object},computed:{groupConfig:function(){return{layout:new ft({direction:"horizontal",gap:0}),borderColor:"#517cff",borderWidth:2,borderRadius:5,padding:10,hasShrink:!1,lock:!0,anchor:this.initialAnchor}}},methods:{onContentChange:function(t){console.log(t.detail),this.$emit("change",{val:t.detail.val,oldVal:t.detail.oldVal})}}},Gt=Nt,Jt=n("2877"),Zt=Object(Jt["a"])(Gt,zt,Wt,!1,null,null,null),Ut=Zt.exports,Vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",t._g({attrs:{name:t.node.name,configs:t.groupConfig}},t.$listeners),[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:"ifstatement"+t.node.name,lineHeight:26,indent:10}}})],1)},Kt=[],Qt={props:{node:Object,initialAnchor:Array},computed:{groupConfig:function(){return{layout:new ft({direction:"horizontal",gap:0}),borderColor:"#517cff",borderWidth:2,borderRadius:5,hasShrink:!1,lock:!0,anchor:this.initialAnchor}}}},te=Qt,ee=Object(Jt["a"])(te,Vt,Kt,!1,null,null,null),ne=ee.exports,ie=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",{attrs:{name:t.node.name,configs:t.configs},on:{mouseenter:t.onMouseEnter,mouseleave:t.onMouseLeave}},[n("j-text",{ref:"start",attrs:{configs:{fontSize:"12px",textColor:t.textColor,content:""}}}),n("j-point",{attrs:{configs:{color:"#99dbc5",radius:11}}})],1)},oe=[],ae={props:{node:Object},data:function(){return{textColor:"#585c63",configs:{layout:new ft({direction:"vertical",gap:0}),borderColor:"transparent",borderWidth:0,hoverStyle:"transparent",color:"transparent",hasShrink:!1,lock:!0}}},methods:{onMouseEnter:function(){this.textColor="red"},onMouseLeave:function(){this.textColor="#585c63"}}},re=ae,se=Object(Jt["a"])(re,ie,oe,!1,null,null,null),ce=se.exports,le=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",{attrs:{name:t.node.name,configs:t.configs}},[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:""}}}),n("j-rectangle",{attrs:{configs:{color:"#faaaaa",width:20,height:20,borderRadius:2}}})],1)},he=[],ue={props:{node:Object},data:function(){return{configs:{layout:new ft({direction:"vertical",gap:0}),borderColor:"transparent",borderWidth:0,hoverStyle:"translate",color:"transparent",hasShrink:!1,lock:!0}}}},fe=ue,de=Object(Jt["a"])(fe,le,he,!1,null,null,null),ge=de.exports,ve=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-point",{attrs:{name:t.node.name,configs:{color:"#fff",strokeColor:"#000",borderWidth:1,radius:5,ignoreHit:!0}}})},pe=[],me={props:{node:Object}},be=me,ke=Object(Jt["a"])(be,ve,pe,!1,null,null,null),ye=ke.exports,_e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",t._g({attrs:{name:t.node.name,configs:t.configs}},t.$listeners),[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:t.textColor,content:t.node.content}}}),t._l(t.node.cases,(function(t){return[n("j-switchcase",{key:t.id,attrs:{node:{content:t.id,name:t.id}}})]}))],2)},je=[],we=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",t._g({attrs:{name:t.node.name,configs:t.groupConfig,rootLink:!0}},t.$listeners),[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:t.node.name,lineHeight:26,indent:10}}})],1)},Oe=[],Te={props:{node:Object},computed:{groupConfig:function(){return{layout:new ft({direction:"horizontal",gap:0}),borderColor:"#517cff",borderWidth:2,borderRadius:5,hasShrink:!1,lock:!0,anchor:this.initialAnchor}}}},Se=Te,xe=Object(Jt["a"])(Se,we,Oe,!1,null,null,null),Ee=xe.exports,Ce={components:{"j-switchcase":Ee},props:{node:Object},data:function(){return{textColor:"#585c63",configs:{layout:new ft({direction:"vertical",gap:0}),borderColor:"#517cff",borderWidth:2,borderRadius:5,hoverStyle:"transparent",color:"transparent",hasShrink:!1,lock:!0}}}},Ie=Ce,Pe=Object(Jt["a"])(Ie,_e,je,!1,null,null,null),Me=Pe.exports,Le=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",t._g({attrs:{name:t.node.name,configs:t.groupConfig}},t.$listeners),[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:t.node.name,lineHeight:26,indent:10}}})],1)},Be=[],De={props:{node:Object},computed:{groupConfig:function(){return{layout:new ft({direction:"horizontal",gap:0}),borderColor:"#517cff",borderWidth:2,borderRadius:5,hasShrink:!1,lock:!0}}}},Fe=De,Re=Object(Jt["a"])(Fe,Le,Be,!1,null,null,null),He=Re.exports,Ye=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",t._g({attrs:{name:t.node.name,configs:t.configs}},t.$listeners),[n("j-group",{attrs:{configs:t.headerConfigs}},[n("j-icon",{attrs:{configs:t.imageConfig}}),n("j-text",{attrs:{configs:{fontSize:"16px",textColor:"#585c63",content:""}}})],1),n("j-group",{attrs:{configs:t.contentConfigs},on:{click:t.onClick}},[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:t.node.content||"",lineHeight:26,indent:10}}})],1),t.node.params&&t.node.params.length?[n("j-group",{ref:"paramGroup",attrs:{configs:t.paramsConfigs}},[n("j-text",{attrs:{configs:{fontSize:"16px",textColor:"#585c63",content:""}}}),t._l(t.node.params,(function(t){return n("j-text",{key:t.content,attrs:{configs:{fontSize:"16px",textColor:"#585c63",content:t.content}}})}))],2)]:t._e()],2)},Xe=[],$e=n("8896"),qe=n.n($e),Ae=new Image;Ae.src=qe.a;var ze={props:{node:Object},data:function(){return{configs:{layout:new ft({direction:"vertical",gap:0,alignment:"start"}),padding:10,borderColor:"#517cff",borderWidth:2,borderRadius:12,width:220,hoverStyle:"transparent",hasShrink:!1,lock:!0},headerConfigs:{layout:new ft({direction:"horizontal",gap:0}),borderRadius:10,borderColor:"#ccc",hoverStyle:"#517cff",borderWidth:0,lock:!0},contentConfigs:{layout:new ft({direction:"horizontal",gap:0}),borderColor:"#517cff",borderWidth:2,borderRadius:5,width:200,hoverStyle:"transparent",hasShrink:!1,lock:!0},paramsConfigs:{layout:new ft({direction:"vertical",gap:0,alignment:"start"}),borderColor:"transparent",hoverStyle:"transparent",hasShrink:!1,lock:!0},imageConfig:{image:Ae,width:30,height:30}}},watch:{"node.params":function(t){var e=this;this.$nextTick((function(){if(e.$refs.paramGroup){var t=e.$refs.paramGroup._jflowInstance;t.recalculateUp(),t._jflow._render()}}))}},methods:{onClick:function(t){console.log(t),t.detail.bubbles=!1;var e=t.currentTarget,n=[0,e.height/2],i=e.calculateToRealWorld(n);this.$emit("toggle-select",i)}}},We=ze,Ne=Object(Jt["a"])(We,Ye,Xe,!1,null,null,null),Ge=Ne.exports;var Je=0,Ze={components:{"j-variable":Ut,"j-start":ce,"j-end":ge,"j-endpoint":ye,"j-switch":Me,"j-ifstatement":ne,"j-whilestatement":He,"j-calllogic":Ge},data:function(){var t={type:"Root",body:[{type:"start",id:"start"},{type:"IfStatement",content:"aaaa",id:"logic1",consequent:[{type:"variable",content:"vvvkjhkjhvvvv",id:"logic5"}],alternate:[{type:"IfStatement",content:"ggggggg",id:"logic6",consequent:[{type:"variable",content:"jkhvvvv",id:"logic77"}],alternate:[{type:"variable",content:"yuuo",id:"logic88"}]},{type:"CallLogic",id:"CallLogic1",content:"",params:[]}]},{type:"SwitchStatement",id:"swtch1",cases:[{type:"SwitchCase",id:"switchcase11",content:"switchcase11",alternate:[{type:"variable",content:"yuuo",id:"sc1111122"}]},{type:"SwitchCase",id:"switchcase12",content:"switchcase12",alternate:[{type:"variable",content:"asdfag",id:"sc12344455"}],consequent:[{type:"variable",content:"dfhsdfg",id:"sc125444"}]}]},{type:"WhileStatement",id:"while1",content:"while1",body:[]},{type:"end",id:"end"}],playground:[]},e=new St({linkLength:30,ast:t});return{ast:t,configs:{allowDrop:!0,layout:e},isHover:!1,offsetX:0,offsetY:0,currentTarget:null,prepareBody:[],logics:[{content:"aaa",params:[{content:"p1"}]},{content:"vvvv",params:[{content:"p1"},{content:"p2"}]},{content:"sadasdf",params:[{content:"p1"}]},{content:"ggggg",params:[{content:"p1"},{content:"p2"},{content:"p3"}]}],currentEditingTarget:null}},computed:{inflowInstances:function(){return this.ast.body.filter((function(t){return!t.outflow}))}},mounted:function(){console.log(this.$refs.jflow.getInstance())},methods:{prettyJson:function(){return At["a"].toHtml(this.ast)},onDragStartRectangle:function(){var t=this.$refs.jflow.getInstance();t.sendMessage({instance:{type:"IfStatement",content:"IfStatement-rec".concat(Je++),id:"IfStatement-rec".concat(Je++),consequent:[],alternate:[]}})},onDragStartPoint:function(){var t=this.$refs.jflow.getInstance();t.sendMessage({instance:{type:"variable",content:"vvvvvvdasdfasfd",id:"logic-point".concat(Je++)}})},onOutOfFlow:function(t,e){var n=e.parentIterateType,i=e.idx,o=e.parent.source[n].splice(i,1),a=Object(C["a"])(o,1),r=a[0];this.ast.playground.push(r),this.configs.layout.reOrder(this.ast),this.$refs.jflow.reflow(),e.getJflowInstance().anchor=t.detail.point},onDrop:function(t){var e=this,n=t.detail.instance;this.ast.playground.push(n),this.configs.layout.reOrder(this.ast),this.$refs.jflow.reflow((function(){var i=e.configs.layout.findLayoutNode(n);i&&(i.getJflowInstance().anchor=t.detail.point)}))},onClick:function(t){var e=t.currentTarget,n=[0,e.height/2],i=e.calculateToRealWorld(n),o=Object(C["a"])(i,2),a=o[0],r=o[1];this.isHover=!this.isHover,this.offsetX=a,this.offsetY=r},onPressStart:function(t){console.log("pressStart"),console.log(t),this.currentTarget=t},onPressEnd:function(){console.log("pressEnd"),this.currentTarget=null},onDropToLink:function(t,e){console.log(t,e);var n=t.detail.instance;this.currentTarget&&(n.removeFromLayoutSource(),n=this.currentTarget),e.meta.from.linkSource(n,e),this.configs.layout.reOrder(this.ast),this.$refs.jflow.reflow()},onToggleSelect:function(t,e){var n=Object(C["a"])(t,2),i=n[0],o=n[1];this.offsetX=i,this.offsetY=o,this.isHover=!this.isHover,this.isHover?this.currentEditingTarget=e:this.currentEditingTarget=null},onSelectLogic:function(t){this.isHover=!1,console.log(this.currentEditingTarget),this.currentEditingTarget.content=t.content,this.currentEditingTarget.params=t.params},onClickNoWhere:function(){this.isHover=!1,this.currentEditingTarget=null},onChangeContent:function(t,e){e.content=t.val}}},Ue=Ze,Ve=n("5bb9");function Ke(t){this["$style"]=Ve["default"].locals||Ve["default"]}var Qe=Object(Jt["a"])(Ue,$t,qt,!1,Ke,null,null),tn=Qe.exports;o["a"].config.productionTip=!1,o["a"].use(Xt),new o["a"]({render:function(t){return t(tn)}}).$mount("#app")},"5bb9":function(t,e,n){"use strict";var i=n("a7d4"),o=n.n(i);n.d(e,"default",(function(){return o.a}))},8896:function(t,e,n){t.exports=n.p+"img/logic.17805d7a.svg"},a7d4:function(t,e,n){t.exports={app:"App_app_3cl75",wrapper:"App_wrapper_pE_0j",body:"App_body_1uhyl",sidebar:"App_sidebar_3dMLz",rect:"App_rect_2g-OE",part:"App_part_1uPSl",circle:"App_circle_2pifB",ast:"App_ast_3JyD2",hide:"App_hide_1hYJ-",hoverblock:"App_hoverblock_rjKeE"}}});
//# sourceMappingURL=app.933c15dc.js.map
(function(t){function e(e){for(var i,a,s=e[0],c=e[1],h=e[2],u=0,d=[];u<s.length;u++)a=s[u],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);l&&l(e);while(d.length)d.shift()();return r.push.apply(r,h||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],i=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(i=!1)}i&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var i={},o={app:0},r=[];function a(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=i,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)a.d(n,i,function(e){return t[e]}.bind(null,i));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var h=0;h<s.length;h++)e(s[h]);var l=c;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"56d7":function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"Group",(function(){return Ce})),n.d(i,"CapsuleGroup",(function(){return Me})),n.d(i,"RhombusGroup",(function(){return Ie})),n.d(i,"DiamondGroup",(function(){return Be})),n.d(i,"DiamondVerticalGroup",(function(){return Le})),n.d(i,"CapsuleVerticalGroup",(function(){return Pe})),n.d(i,"PointGroup",(function(){return De})),n.d(i,"default",(function(){return Ae})),n.d(i,"JFLOW_MODE",(function(){return j})),n.d(i,"JFlowEvent",(function(){return vt})),n.d(i,"commonEventAdapter",(function(){return At})),n.d(i,"Instance",(function(){return q})),n.d(i,"Node",(function(){return V})),n.d(i,"BaseLink",(function(){return Nt})),n.d(i,"Point",(function(){return Ot})),n.d(i,"Rectangle",(function(){return Tt})),n.d(i,"Capsule",(function(){return Et})),n.d(i,"CapsuleVertical",(function(){return Mt})),n.d(i,"Diamond",(function(){return Pt})),n.d(i,"Rhombus",(function(){return Bt})),n.d(i,"Text",(function(){return Xt})),n.d(i,"Icon",(function(){return zt})),n.d(i,"ShadowDom",(function(){return Jt})),n.d(i,"GroupFactory",(function(){return kt})),n.d(i,"Link",(function(){return Kt})),n.d(i,"PolyLink",(function(){return te})),n.d(i,"BezierLink",(function(){return ie})),n.d(i,"LinearLayout",(function(){return re})),n.d(i,"Lowcodelayout",(function(){return _e})),n.d(i,"ERLayout",(function(){return Oe})),n.d(i,"TextGroup",(function(){return Se})),n.d(i,"TextElement",(function(){return xe}));n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=n("2909"),a=n("3835"),s=n("d4ec"),c=n("bee2"),h=n("262e"),l=n("2caf"),u=n("9072");n("18a5"),n("9911"),n("caad"),n("d3b7"),n("159b"),n("99af"),n("c740"),n("a434");function d(t){var e=document.createElement("canvas"),n=e.getContext("2d"),i=t.getBoundingClientRect(),o=i.width,r=i.height,a=i.left,s=i.top;e.style.width=o+"px",e.style.height=r+"px",e.style.userSelect="none";var c=window.devicePixelRatio;return e.width=Math.floor(o*c),e.height=Math.floor(r*c),t&&(t.style.position="relative",t.style.overflow="hidden",t.append(e)),{canvas:e,width:o,height:r,raw_width:e.width,raw_height:e.height,left:a,top:s,ctx:n,scale:c}}function f(t,e){var n=e.getBoundingClientRect(),i=n.width,o=n.height;n.left,n.top;t.style.width=i+"px",t.style.height=o+"px";var r=window.devicePixelRatio;return t.width=Math.floor(i*r),t.height=Math.floor(o*r),{width:i,height:o,raw_width:t.width,raw_height:t.height}}var g=document.createElement("canvas");g.width=1,g.height=1;var v=g.getContext("2d"),p=window.devicePixelRatio;function b(t){v.clearRect(0,0,5,5),v.save(),t(v),v.restore(),v.clearRect(0,0,5,5)}function m(t){function e(){console.log("devicePixelRatio changed: "+window.devicePixelRatio),t(window.devicePixelRatio),m(t)}matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)")).addEventListener("change",e,{once:!0})}v.scale(p,p);var _=n("4478"),w=(n("b64b"),n("2532"),n("bb46")),y={RIGHT:0,BOTTOM:1,LEFT:2,TOP:3,SELF:100};var k=6,j={DEFAULT:"DEFAULT",LINKING:"LINKING"};function O(t){if(0===t.length)return{width:1,height:1,x:0,y:0};var e=1/0,n=1/0,i=-1/0,o=-1/0;for(var r in t){var a=t[r];a[0]<e&&(e=a[0]),a[0]>i&&(i=a[0]),a[1]<n&&(n=a[1]),a[1]>o&&(o=a[1])}return{width:Math.max(i-e,10),height:Math.max(o-n,10),x:e,y:n}}function x(t){return t*t}function T(t,e){return x(t[0]-e[0])+x(t[1]-e[1])}function S(t,e,n){var i=T(e,n);if(0===i)return T(t,e);var o=((t[0]-e[0])*(n[0]-e[0])+(t[1]-e[1])*(n[1]-e[1]))/i;return o=Math.max(0,Math.min(1,o)),T(t,[e[0]+o*(n[0]-e[0]),e[1]+o*(n[1]-e[1])])}function E(t,e){var n={fromDir:null,fromP:null,toDir:null,toP:null,distMin:1/0};return Object.keys(t).forEach((function(i){if(+i!==y.SELF){var o=t[i];Object.keys(e).forEach((function(t){if(+t!==y.SELF){var r=e[t],a=T(o,r);a<n.distMin&&Object.assign(n,{distMin:a,fromDir:+i,fromP:o,toDir:+t,toP:r})}}))}})),n}function C(t,e,n,i){return e===y.TOP?[t[0],t[1]-i]:e===y.BOTTOM?[t[0],t[1]+i]:e===y.LEFT?[t[0]-n,t[1]]:e===y.RIGHT?[t[0]+n,t[1]]:void 0}function M(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.TOP,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y.TOP,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=Math.max(Math.abs((t[0]-e[0])/2),o),c=Math.max(Math.abs((t[1]-e[1])/2),a),h=C(t,n,s,c),l=C(e,i,s,c),u=[y.TOP,y.LEFT].includes(i)?-5:5,d=[y.TOP,y.BOTTOM].includes(i),f=d?e[0]:e[0]+u,g=d?e[1]+u:e[1];return[].concat(Object(r["a"])(h),Object(r["a"])(l),[f,g])}function I(t,e){var n=1-t,i=n*n*n*e[0]+3*n*n*t*e[2]+3*n*t*t*e[4]+t*t*t*e[6],o=n*n*n*e[1]+3*n*n*t*e[3]+3*n*t*t*e[5]+t*t*t*e[7],r=n*n*(e[2]-e[0])+2*t*n*(e[4]-e[2])+t*t*(e[6]-e[4]),a=n*n*(e[3]-e[1])+2*t*n*(e[5]-e[3])+t*t*(e[7]-e[5]),s=Math.atan2(a,r);return[i,o,s]}function B(t,e){var n=Object(_["a"])(w["Bezier"],Object(r["a"])(e)),i=n.project({x:t[0],y:t[1]}),o=T(t,[i.x,i.y]);return o}function L(t,e,n,i,o,r,a,s,c){var h=Math.pow(1-t,2)*(i-e)+2*t*(1-t)*(r-i)+t*t*(s-r),l=Math.pow(1-t,2)*(o-n)+2*t*(1-t)*(a-o)+t*t*(c-a);return-Math.atan2(h,l)+.5*Math.PI}function P(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y.TOP,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:y.TOP,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:10,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:10,a=arguments.length>6?arguments[6]:void 0,s=Math.abs(n-i),c=n===y.TOP||n===y.BOTTOM,h=[];switch(s){case 0:if(n===y.TOP){var l=Math.min(t[1],e[1]),u=l-r;h.push([t[0],u]),h.push([e[0],u])}if(n===y.BOTTOM){var d=Math.max(t[1],e[1]),f=d+r;h.push([t[0],f]),h.push([e[0],f])}if(n===y.LEFT){var g=Math.min(t[0],e[0]),v=g-o;h.push([v,t[1]]),h.push([v,e[1]])}if(n===y.RIGHT){var p=Math.max(t[0],e[0]),b=p+o;h.push([b,t[1]]),h.push([b,e[1]])}break;case 1:case 3:if(a)c?(h.push([t[0],t[1]+r]),h.push([e[0]+o,t[1]+r]),h.push([e[0]+o,e[1]])):(h.push([t[0]+o,t[1]]),h.push([t[0]+o,e[1]+r]),h.push([e[0],e[1]+r]));else{var m=c?[t[0],e[1]]:[e[0],t[1]];h.push(m)}break;case 2:var _=[(t[0]-e[0])/2+e[0],(t[1]-e[1])/2+e[1]];c?(h.push([t[0],_[1]]),h.push([e[0],_[1]])):(h.push([_[0],t[1]]),h.push([_[0],e[1]]));break;default:break}return h.unshift(t),h.push(e),h}function D(t,e){return[t[0]-e[0],t[1]-e[1]]}function R(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function A(t,e){return[t[0]*e,t[1]*e]}function F(t,e,n,i){var o=D(e,t),r=D(e,n),a=R(o),s=R(r);if(!a||!s)return{p1:null,p2:null};var c=A(o,i/a),h=A(r,i/s);return{p1:D(e,c),p2:D(e,h)}}function N(t,e){return t[0]!=t[2]&&t[1]!=t[3]&&e[0]!=e[2]&&e[1]!=e[3]&&!(t[2]<=e[0]||t[3]<=e[1]||t[0]>=e[2]||t[1]>=e[3])}function H(t,e){var n=t[0],i=t.length,o=1,r=Object(a["a"])(e,4),s=r[0],c=r[1],h=r[2],l=r[3];while(o<i){var u=t[o];if(n[0]===u[0]){if(n[0]<h&&n[0]>s&&!(n[1]>l&&u[1]>l||n[1]<c&&u[1]<c))return!0}else if(n[1]<l&&n[1]>c&&!(n[0]>h&&u[0]>h||n[0]<s&&u[0]<s))return!0;n=u,o++}return!1}var W=n("ade3"),Y=n("257e"),X=(n("a4d3"),n("e01a"),Symbol("ishit")),$=Symbol("isInViewBox"),z=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["a"])(this,n),t=e.call(this),Object.assign(Object(Y["a"])(t),i),t.visible=!0,t._belongs=void 0,t[X]=!1,t.borderWidth=i.borderWidth||0,t.borderColor=i.borderColor||"transparent",t.backgroundColor=i.backgroundColor||"transparent",t.shadowColor=i.shadowColor,t.shadowBlur=i.shadowBlur||5,t.shadowOffsetX=i.shadowOffsetX||0,t.shadowOffsetY=i.shadowOffsetY||0,t.opacity=i.opacity||1,t}return Object(c["a"])(n,[{key:"_isTargeting",get:function(){return this===(this._jflow._target.instance||this._jflow._target.link)}},{key:"_isMoving",get:function(){return this===this._jflow._getMovingTarget()&&this._jflow._target.status.movingState}},{key:"_isHit",get:function(){return this[X]},set:function(t){this[X]!==t&&this.dispatchEvent(new CustomEvent(t?"mouseenter":"mouseleave",{detail:{instance:this,jflow:this._jflow}})),this[X]=t}},{key:"_jflow",get:function(){return"jflow"===this._belongs.uniqueName?this._belongs:this._belongs._jflow}},{key:"isInViewBox",get:function(){return this[$]}},{key:"_isInViewBox",set:function(t){var e=this[$];t!==e&&(t?this.onEnterViewbox():this.onLeaveViewbox()),this[$]=t}},{key:"onEnterViewbox",value:function(){}},{key:"onLeaveViewbox",value:function(){}},{key:"setConfig",value:function(t){var e=this;Object.keys(t).forEach((function(n){void 0!==t[n]&&null!==t[n]&&(e[n]=t[n])}))}},{key:"render",value:function(t){throw"require render implement"}},{key:"isHit",value:function(t){throw"require isHit implement"}},{key:"getBoundingRect",value:function(){throw"require getBoundingRect implement"}},{key:"calculateIntersection",value:function(){throw"require calculateIntersection implement"}},{key:"getIntersectionsInFourDimension",value:function(){throw"require getIntersectionsInFourDimension implement"}},{key:"getCenter",value:function(){return this.anchor}},{key:"getBoundingDimension",value:function(){var t=instance.getBoundingRect(),e=1/0,n=-1/0,i=1/0,o=-1/0;return t.forEach((function(t){n=Math.max(n,t[1]),e=Math.min(e,t[1]),o=Math.max(o,t[0]),i=Math.min(i,t[0])})),{height:n-e,width:o-i}}},{key:"bubbleEvent",value:function(t){t.detail.currentTarget=this,this.dispatchEvent(t),t.detail.bubbles&&(this._belongs.bubbleEvent?this._belongs.bubbleEvent(t):this._belongs.dispatchEvent(t))}},{key:"calculateToRealWorld",value:function(t){return this._belongs&&this._belongs.calculateToRealWorld?this._belongs.calculateToRealWorld(t):t}},{key:"calculateToRealWorldWithScalar",value:function(t){return this._jflow.scale*t}},{key:"recalculateUp",value:function(){this.belongs&&this.belongs.recalculateUp()}},{key:"destroy",value:function(){}}]),n}(Object(u["a"])(EventTarget)),q=z,G=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["a"])(this,n),t=e.call(this,i),t._rawConfigs=i,t.anchor=i.anchor||[0,0],t.absolutePosition=i.absolutePosition,t}return Object(c["a"])(n,[{key:"setConfig",value:function(t){var e=this;Object.keys(t).forEach((function(n){void 0!==t[n]&&null!==t[n]&&(e[n]=t[n],e._rawConfigs[n]=t[n])}))}},{key:"setAnchorX",value:function(t){this.anchor[0]=t}},{key:"setAnchorY",value:function(t){this.anchor[1]=t}},{key:"setAnchor",value:function(t,e){this.anchor[0]=t,this.anchor[1]=e}},{key:"clone",value:function(){var t=this.constructor,e=new t(this._rawConfigs);return e.visible=this.visible,e}}]),n}(q),V=G,J=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){return Object(s["a"])(this,n),e.call(this,t)}return Object(c["a"])(n,[{key:"render",value:function(t){}},{key:"isHit",value:function(t){return!1}},{key:"calculateIntersection",value:function(t){return this.anchor}},{key:"getBoundingRect",value:function(){var t=Object(a["a"])(this.anchor,2),e=t[0],n=t[1];return[e,n,e,n]}},{key:"getBoundingDimension",value:function(){return{width:0,height:0}}},{key:"getIntersectionsInFourDimension",value:function(){var t,e=Object(a["a"])(this.anchor,2),n=e[0],i=e[1];return t={},Object(W["a"])(t,y.RIGHT,[n+1,i]),Object(W["a"])(t,y.LEFT,[n-1,i]),Object(W["a"])(t,y.BOTTOM,[n,i+1]),Object(W["a"])(t,y.TOP,[n,i-1]),t}}]),n}(V),U=J;n("3ca3"),n("10d1"),n("ddb0");function K(){return{layoutNode:void 0,jflowNode:void 0,jflowlinks:[],jflowFromLinks:[],jflowToLinks:[]}}var Z=function(){function t(){Object(s["a"])(this,t),this._map=new WeakMap}return Object(c["a"])(t,[{key:"get",value:function(t){return this._map.get(t)}},{key:"set",value:function(t){var e=K();return this._map.set(t,e),e}},{key:"has",value:function(t){return this._map.has(t)}},{key:"delete",value:function(t){this._map.delete(t)}},{key:"clear",value:function(){this._map.clear()}}]),t}(),Q={initNodeWeakMap:function(){this.source_Layout_Render_NodeMap=new Z},getRenderNodeBySource:function(t){var e=this.source_Layout_Render_NodeMap.get(t);if(e)return e.jflowNode},getLayoutNodeBySource:function(t){var e=this.source_Layout_Render_NodeMap.get(t);if(e)return e.layoutNode},getSourceRenderMeta:function(t){var e=this.source_Layout_Render_NodeMap;return e.get(t)},_getMap:function(t){var e,n=this.source_Layout_Render_NodeMap;return e=n.has(t)?n.get(t):n.set(t),e},setLayoutNodeBySource:function(t,e){var n=this._getMap(t);n.layoutNode=e},setRenderNodeBySource:function(t,e){var n=this._getMap(t);n.jflowNode=e},addLinkNodeBySource:function(t,e,n){var i=this._getMap(t);i.jflowFromLinks.push(n),i=this._getMap(e),i.jflowToLinks.push(n)},removeLinkNodeBySource:function(t,e,n){var i=this._getMap(t),o=i.jflowFromLinks.findIndex((function(t){return t===n}));-1!==o&&i.jflowFromLinks.splice(o,1),i=this._getMap(e),o=i.jflowToLinks.findIndex((function(t){return t===n})),-1!==o&&i.jflowToLinks.splice(o,1)}},tt=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(){var t;return Object(s["a"])(this,n),t=e.call(this),t._currentHit=null,t}return Object(c["a"])(n,[{key:"render",value:function(t,e){var n;this.forEach((function(i){i._isMoving?n=i:!i.visible||e&&!e(i)||(t.save(),i.render(t),t.restore())})),n&&(t.save(),n.render(t),t.restore())}},{key:"checkHit",value:function(t,e,n){var i=this.length-1;while(i>=0){var o=this[i];if(o.visible&&!o.ignoreHit){if(e&&e(o)){i--;continue}if(n&&!n(o)){i--;continue}var r=o.isHit(t,e);if(o._isHit=!!r,r)return this._currentHit!==o&&(this._currentHit&&(this._currentHit._isHit=!1),this._currentHit=o),"boolean"!==typeof r?r:o}i--}return this._currentHit=null,null}},{key:"getBoundingRectPoints",value:function(){var t=[];return this.forEach((function(e){if(e.visible&&!e.absolutePosition){var n=e.getBoundingRect();t.push([n[0],n[1]]),t.push([n[2],n[3]])}})),t}},{key:"getAnchorRectPoints",value:function(){var t=[];return this.forEach((function(e){e.visible&&!e.absolutePosition&&t.push(e.anchor)})),t}}]),n}(Object(u["a"])(Array)),et=tt,nt={instances:[],links:[],_stack:null,_linkStack:null,initStack:function(t){var e=this,n=t.data;this._stack=new et,this._linkStack=new et,n&&(this.instances=n.instances,this.links=n.links,this.instances.forEach((function(t){e._stack.push(t),t._belongs=e})),this.links.forEach((function(t){e._linkStack.push(t),t._belongs=e})))},addToStack:function(t){t._belongs=this,this._stack.push(t)},replaceFromStack:function(t,e){var n=this._stack.findIndex((function(e){return e===t}));this._stack.splice(n,1,e),t._belongs=null,e._belongs=this},addToLinkStack:function(t){t._belongs=this,this._linkStack.push(t)},removeFromStack:function(t){var e=this._stack.findIndex((function(e){return e===t}));-1!==e&&this._stack.splice(e,1)},removeFromLinkStack:function(t){var e=this._linkStack.findIndex((function(e){return e===t}));-1!==e&&this._linkStack.splice(e,1)},emptyLink:function(){this._linkStack=new et},resetChildrenPosition:function(){this._stack.forEach((function(t){t.anchor=[0,0]}))},addInstanceToLink:function(t,e){this.addToStack(e);var n=t.from,i=t.to,o=this._linkStack.findIndex((function(e){return e===t})),r=t.__proto__.constructor,a=new r({from:n,to:e});a._belongs=this;var s=new r({from:e,to:i});s._belongs=this,this._linkStack.splice(o,1,a,s)},interateNodeStack:function(t){this._stack.forEach((function(e){t(e)}))}},it=nt,ot={_layout:null,initLayout:function(t){this._layout=t.layout},recalculateUp:function(){var t=!0;if(this.getBoundingDimension){var e=this.getBoundingDimension(),n=e.width,i=e.height;this.resetChildrenPosition&&this.resetChildrenPosition(),this._getBoundingGroupRect&&this._getBoundingGroupRect(),this.reflow(),this._getBoundingGroupRect&&this._getBoundingGroupRect();var o=this.getBoundingDimension(),r=o.width,a=o.height;t=n!==r||i!==a}else this.reflow();this._belongs&&t&&this._belongs.recalculateUp()},recalculate:function(){this.reflow(),this._getBoundingGroupRect&&this._getBoundingGroupRect()},staticCheck:function(t){return!!this._layout&&this._layout.staticCheck(t,this)},reflow:function(){this._layout&&this._layout.reflow(this)}},rt=ot,at={_message:null,sendMessage:function(t){this._message=t},consumeMessage:function(){var t=this._message;return this._message=null,t},readMessage:function(){return this._message}},st=at,ct={initAnime:function(){this.anime_queue=[],this.__animeClock__=void 0},requestJFlowAnime:function(t){var e=this.enqueueAnime(t);return this._runAnime(),e},enqueueAnime:function(t){var e=this,n={start:void 0,callback:t,cancel:function(){e._cancelAnime(n),e._render()}};return this.anime_queue.push(n),n},_cancelAnime:function(t){var e=this.anime_queue.findIndex((function(e){return e===t}));~e&&this.anime_queue.splice(e,1)},runAnime:function(){this._runAnime()},_runAnime:function(){var t=this;this.anime_queue.length&&this.scheduleRender((function(e){t.__animeClock__!==e&&t._runAnime(),t.__animeClock__=e}))},runAnimeFrame:function(){this.anime_queue.forEach((function(t){var e=Date.now();t.start||(t.start=e);var n=e-t.start;t.callback(n)}))}},ht={captureMap:function(t,e){var n=this,i=e.padding,o=void 0===i?0:i,r=e.placement,s=void 0===r?"normal":r;this._getBoundingGroupRect();var c=this.bounding_box,h=c.width,l=c.height,u=c.x,f=c.y,g=this.miniMap;if(!g){this.miniMap=d(t);var v=this.miniMap,p=v.width,b=v.height,m=v.raw_width,_=v.raw_height;this.addEventListener("zoompan",(function(){n._renderMap&&n._renderMap()}));var w=!1;this.miniMap.canvas.addEventListener("pointerdown",(function(t){var e=t.offsetX,i=t.offsetY;t.deltaX,t.deltaY;w=!0,n._onMoveMap&&n._onMoveMap(e,i)})),this.miniMap.canvas.addEventListener("pointermove",(function(t){var e=t.offsetX,i=t.offsetY;t.deltaX,t.deltaY;w&&n._onMoveMap&&n._onMoveMap(e,i),(i<5||e<5||e>p-5||i>b-5)&&(w=!1)})),this.miniMap.canvas.addEventListener("pointerup",(function(){w=!1}));var y=document.createElement("canvas");y.width=m,y.height=_,this.cacheMinimapCtx=y.getContext("2d")}var k=this.miniMap,j=k.width,O=k.height,x=k.raw_width,T=k.raw_height,S=(k.left,k.top,k.scale),E=k.ctx,C=2*o,M=o,I=(j-C)/h,B=(O-C)/l,L=Math.min(I,B),P=0,D=0;"center"===s?(D=(O-l*L)/2-f*L,P=(j-h*L)/2-u*L):I<B?(D=(O-l*L)/2-f*L,P=M):(P=(j-h*L)/2-u*L,D=M);var R=this.cacheMinimapCtx;R.setTransform(),R.clearRect(0,0,x,T),R.scale(S,S),R.transform(L,0,0,L,P,D);var A=[0,0,0,0];this.NodeRenderTop?(this._linkStack.render(R,(function(t){return t.isInViewBox(A),!0})),this._stack.render(R)):(this._stack.render(R),this._linkStack.render(R,(function(t){return t.isInViewBox(A),!0})));var F=R.getImageData(0,0,x,T);this._renderMap=function(){E.save(),E.setTransform(),E.clearRect(0,0,x,T),E.scale(S,S),E.putImageData(F,0,0),E.transform(L,0,0,L,P,D);var t=n._getViewBox(),e=Object(a["a"])(t,4),i=e[0],o=e[1],r=e[2],s=e[3];E.beginPath(),E.rect(i,o,r-i,s-o),E.setTransform(),E.rect(0,0,x,T),E.clip("evenodd"),E.fillStyle="rgba(0,0,0,0.4)",E.fillRect(0,0,x,T),E.restore()},this._renderMap(),this._onMoveMap=function(t,e){var i=n._getViewBox(),o=Object(a["a"])(i,4),r=o[0],s=o[1],c=o[2],h=o[3],l=(c-r)/2+r,u=(h-s)/2+s,d=[l*L+P,u*L+D];n._recalculatePosition((d[0]-t)/L*n.scale,(d[1]-e)/L*n.scale),n._render(),n._renderMap()}}},lt=(n("cb29"),function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(s["a"])(this,t),this.anchor=[0,0],this.width=n.barWidth||4,this.height=n.barWidth||4,this.barMarginX=0,this.barMarginY=0,this.dir=e,this.plainColor=n.plainColor||"rgba(0, 0, 0, 0.15)",this.focusColor=n.focusColor||"rgba(0, 0, 0, 0.25)",this.isFocus=!1}return Object(c["a"])(t,[{key:"render",value:function(t){var e=Object(a["a"])(this.anchor,2),n=e[0],i=e[1];if(t.save(),t.beginPath(),"x"===this.dir){var o=this.height/2,r=i+o,s=i+this.height,c=n+this.width-2*this.barMarginX-o,h=n+this.barMarginX+o;t.moveTo(h,s),t.arc(h,r,o,Math.PI/2,Math.PI/2*3),t.lineTo(c,i),t.arc(c,r,o,-Math.PI/2,Math.PI/2),t.closePath()}else{var l=this.width/2,u=i+this.barMarginY+l,d=i+this.height-2*this.barMarginY-l,f=n+l,g=n+this.width;t.moveTo(n,u),t.arc(f,u,l,-Math.PI,0),t.lineTo(g,d),t.arc(f,d,l,0,Math.PI),t.closePath()}t.fillStyle=this.isFocus?this.focusColor:this.plainColor,t.fill(),t.restore()}},{key:"isHit",value:function(t){var e=this.anchor,n=this.width,i=this.height;return t[0]>e[0]-5&&t[0]<e[0]+n+5&&t[1]>e[1]-5&&t[1]<e[1]+i+5}}]),t}()),ut={initScrollBar:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.barColor,i=e.barFocusColor,o=e.barMarginX,r=e.barMarginY,a=e.barWidth;this._scrollbarEnable=!0,this._scrollbarX=new lt("x",{plainColor:n,focusColor:i,barWidth:a}),this._scrollbarX.barMarginX=o||5,this._scrollbarY=new lt("y",{plainColor:n,focusColor:i,barWidth:a}),this._scrollbarY.barMarginY=r||5,this._scrollBarStatus={dragging:!1,target:null,xscale:void 0,yscale:void 0,barInitX:0,barInitY:0},this.addEventListener("zoompan",(function(){t.scrollBarOnPanAndZoom()})),this.scrollBarOnPanAndZoom(),this.canvas.addEventListener("pointerdown",(function(e){var n=e.offsetX,i=e.offsetY,o=e.clientX,r=e.clientY;t.onScrollbarPressStart(n,i,o,r)}))},checkScrollDragging:function(){return this._scrollBarStatus&&this._scrollBarStatus.dragging},onScrollbarPressStart:function(t,e,n,i){var o=this,r=this._scrollbarX.isHit([t,e]);r&&Object.assign(this._scrollBarStatus,{dragging:!0,target:this._scrollbarX,barStartX:this._scrollbarX.anchor[0],barInitX:n});var a=this._scrollbarY.isHit([t,e]);a&&Object.assign(this._scrollBarStatus,{dragging:!0,target:this._scrollbarY,barStartY:this._scrollbarY.anchor[1],barInitY:i});var s=function(t){var e=t.offsetX,n=t.offsetY,i=t.clientX,r=t.clientY;o.onDraggingScrollbar(e,n,i,r)}.bind(this);document.addEventListener("pointermove",s);var c=function(t){Object.assign(o._scrollBarStatus,{dragging:!1,target:null,x:void 0,y:void 0}),document.removeEventListener("pointermove",s),document.removeEventListener("pointerup",c),o.canvas.removeEventListener("pointerup",c)}.bind(this);this.canvas.addEventListener("pointerup",c,{once:!0}),document.addEventListener("pointerup",c,{once:!0})},onDraggingScrollbar:function(t,e,n,i){if(this._scrollbarEnable&&this._scrollBarStatus.dragging){var o=this._scrollBarStatus,r=o.target,a=o.barInitX,s=o.barStartX,c=o.barInitY,h=o.barStartY,l=(o.xscale,o.yscale,o.scollbarHeight),u=o.scollbarWidth,d=o.realR,f=o.realL,g=o.realT,v=o.realB,p=this.canvasMeta,b=p.actual_width,m=p.actual_height,_=this.bounding_box,w=_.x,y=_.y;if("x"===r.dir){var k=n-a,j=s+k,O=r.anchor[0]=Math.max(Math.min(j,b-u),0),x=O/b,T=(d-f)*x+f,S=(w-T)*this.scale;Object.assign(this.position,{offsetX:S-w*this.scale,x:S})}if("y"===r.dir){var E=i-c,C=h+E,M=r.anchor[1]=Math.max(Math.min(C,m-l),0),I=M/m,B=(v-g)*I+g,L=(y-B)*this.scale;Object.assign(this.position,{offsetY:L-y*this.scale,y:L})}return this.scheduleRender(),!0}return!1},checkScrollBarHover:function(t,e){if(this._scrollbarEnable){var n=this._scrollbarX.isHit([t,e]);if(n)return this._scrollbarX.isFocus||(this._scrollbarX.isFocus=!0,this.scheduleRender()),this.canvas.style.cursor="default",!0;var i=this._scrollbarY.isHit([t,e]);if(i)return this._scrollbarY.isFocus||(this._scrollbarY.isFocus=!0,this.scheduleRender()),this.canvas.style.cursor="default",!0}return!1},resetScrollBarHover:function(){this._scrollbarEnable&&(this._scrollbarY.isFocus||this._scrollbarX.isFocus)&&(this._scrollbarY.isFocus=!1,this._scrollbarX.isFocus=!1,this.scheduleRender())},_getScrollViewBoundingbox:function(){var t=120,e=this.bounding_box,n=e.width,i=e.height,o=e.x,r=e.y,a=t,s=2*t;return{width:n+s,height:i+s,x:o-a,y:r-a}},scrollBarOnPanAndZoom:function(){if(this._scrollbarEnable&&!this._scrollBarStatus.dragging){var t=this._getScrollViewBoundingbox(),e=t.width,n=t.height,i=t.x,o=t.y,r=this._getViewBox(),s=Object(a["a"])(r,4),c=s[0],h=s[1],l=s[2],u=s[3],d=Math.max(l,i+e),f=Math.min(c,i),g=Math.min(h,o),v=Math.max(u,o+n),p=l-c,b=u-h,m=this.canvasMeta,_=m.actual_width,w=m.actual_height,y=p/(d-f);if(y<1){var k=_*y,j=(c-f)*y*this.scale;this._scrollbarX.anchor=[j,w-10],this._scrollbarX.width=k,this._scrollBarStatus.scollbarWidth=k}var O=b/(v-g);if(O<1){var x=w*O,T=(h-g)*O*this.scale;this._scrollbarY.anchor=[_-10,T],this._scrollbarY.height=x,this._scrollBarStatus.scollbarHeight=x}Object.assign(this._scrollBarStatus,{yscale:O,xscale:y,realR:d,realL:f,realT:g,realB:v})}},resetScollBarStatus:function(){this._scrollbarEnable&&Object.assign(this._scrollBarStatus,{dragging:!1,target:null,x:void 0,y:void 0})},renderScrollBar:function(t){if(this._scrollbarEnable){t.setTransform(),t.scale(this.dpr,this.dpr);var e=this._scrollBarStatus,n=e.xscale,i=e.yscale;n<1&&this._scrollbarX.render(t),i<1&&this._scrollbarY.render(t)}}},dt={initSchedule:function(){this.__clock__=void 0},scheduleRender:function(t){var e=this;requestAnimationFrame((function(n){var i=e.__clock__!==n;i&&e.__render(),t&&t(n),e.__clock__=n}))}},ft=n("5530"),gt=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(s["a"])(this,n);var o=Object(ft["a"])(Object(ft["a"])({},i),{},{originEvent:i.event,target:i.target,jflow:i.jflow,bubbles:i.bubbles||!1});return e.call(this,t,{detail:o})}return n}(Object(u["a"])(CustomEvent)),vt=gt;function pt(){return{canvas:{wheel:function(t,e){t.preventDefault();var n=t.offsetX,i=t.offsetY,o=t.deltaX,r=t.deltaY;t.ctrlKey?(r=-r,e.zoomHandler(n,i,o,r,t)):e.panHandler(-o,-r,t)},pointerdown:function(t,e){var n=t.offsetX,i=t.offsetY,o=(t.deltaY,t.button);0===o&&e.pressStartHandler(n,i,t)},pointermove:function(t,e){var n=t.offsetX,i=t.offsetY;e.pressMoveHandler(n,i,t)},pointerup:function(t,e){t.preventDefault();var n=t.button;0===n&&e.pressUpHanlder(!1,t)},contextmenu:function(t,e){t.preventDefault(),t.stopPropagation();var n=t.offsetX,i=t.offsetY;e.contextMenuHanlder(n,i,t)},dblclick:function(t,e){t.preventDefault(),t.stopPropagation();var n=t.offsetX,i=t.offsetY;e.dblclickHandler(n,i,t)},click:function(t,e){t.preventDefault(),t.stopPropagation();var n=t.offsetX,i=t.offsetY;e.clickHanlder(n,i,t)}},document:{pointerup:function(t,e){e.pressUpHanlder(!0,t)}}}}var bt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s["a"])(this,t),this.plugin=pt(),this.use(e),this.canvasHandlers=[],this.documentHandlers=[]}return Object(c["a"])(t,[{key:"use",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.canvas,n=t.document;if(e)for(var i in e)e.hasOwnProperty(i)&&(this.plugin.canvas[i]=e[i]);if(n)for(var o in n)n.hasOwnProperty(o)&&(this.plugin.document[o]=n[o])}},{key:"apply",value:function(t){var e=this,n=this.plugin,i=n.canvas,o=n.document,r=t.canvas,a=function(n){var o=i[n];function a(e){o(e,t)}r.addEventListener(n,a),e.canvasHandlers.push({eventName:n,handlerWrapperd:a})};for(var s in i)a(s);var c=function(n){var i=o[n];function r(e){i(e,t)}document.addEventListener(n,r),e.documentHandlers.push({eventName:n,handlerWrapperd:r})};for(var h in o)c(h)}},{key:"unload",value:function(t){var e=t.canvas;this.canvasHandlers.forEach((function(t){var n=t.eventName,i=t.handlerWrapperd;e.removeEventListener(n,i)})),this.documentHandlers.forEach((function(t){var e=t.eventName,n=t.handlerWrapperd;document.removeEventListener(e,n)}))}}]),t}(),mt=bt,_t=Object(ft["a"])(Object(ft["a"])(Object(ft["a"])({},it),rt),{},{_setPadding:function(t){this.padding={top:t.paddingTop||t.padding||0,right:t.paddingRight||t.padding||0,bottom:t.paddingBottom||t.padding||0,left:t.paddingLeft||t.padding||0}},_setMargin:function(t){this.margin={top:t.marginTop||t.margin||0,right:t.marginRight||t.margin||0,bottom:t.marginBottom||t.margin||0,left:t.marginLeft||t.margin||0}},_getCenter:function(){var t=this.anchor,e=this.padding,n=this.margin,i=(n.left-n.right)/2,o=(n.top-n.bottom)/2,r=(e.left-e.right)/2+i,a=(e.top-e.bottom)/2+o;return this._shape.anchor=[t[0]+i,t[1]+o],[t[0]+r,t[1]+a]},setAnchorX:function(t){this.anchor[0]=t,this._getCenter()},setAnchorY:function(t){this.anchor[1]=t,this._getCenter()},setAnchor:function(t,e){this.anchor[0]=t,this.anchor[1]=e,this._getCenter()},_calculatePointBack:function(t){var e=Object(a["a"])(t,2),n=e[0],i=e[1],o=this._getCenter(),r=Object(a["a"])(o,2),s=r[0],c=r[1],h=[n-s,i-c];return h},calculateToCoordination:function(t){var e=Object(a["a"])(t,2),n=e[0],i=e[1],o=this._getCenter(),r=Object(a["a"])(o,2),s=r[0],c=r[1],h=[n+s,i+c];return this._belongs&&this._belongs.calculateToCoordination?this._belongs.calculateToCoordination(h):h},calculateToRealWorld:function(t){var e=Object(a["a"])(t,2),n=e[0],i=e[1],o=this._getCenter(),r=Object(a["a"])(o,2),s=r[0],c=r[1],h=[n+s,i+c];if(this._belongs&&this._belongs.calculateToRealWorld)return this._belongs.calculateToRealWorld(h)},clone:function(){var t=this.constructor,e=Object.assign({},this._rawConfigs,{layout:this._layout&&this._layout.clone()}),n=new t(e);return this.interateNodeStack((function(t){n.addToStack(t.clone())})),n.recalculate(),n.visible=this.visible,n},getBoundingDimension:function(){return{width:this.width,height:this.height}},getBoundingRect:function(){var t=this.anchor,e=this.width/2,n=this.height/2,i=t[0]-e,o=t[1]-n,r=t[0]+e,a=t[1]+n;return[i,o,r,a]},getIntersectionsInFourDimension:function(){var t,e=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(e=this._belongs.calculateToCoordination(e));var n=e,i=Object(a["a"])(n,2),o=i[0],r=i[1],s=this.width/2,c=this.height/2;return t={},Object(W["a"])(t,y.RIGHT,[o+s,r]),Object(W["a"])(t,y.LEFT,[o-s,r]),Object(W["a"])(t,y.BOTTOM,[o,r+c]),Object(W["a"])(t,y.TOP,[o,r-c]),Object(W["a"])(t,y.SELF,[o+.618*s,r+.618*c]),t},calculateIntersection:function(t){var e,n,i=Object(a["a"])(t,2),o=i[0],r=i[1],s=Object(a["a"])(this.anchor,2),c=s[0],h=s[1],l=this.width/2,u=this.height/2,d=c-o,f=h-r,g=u/l,v=Math.abs(f/d),p=o>c,b=r>h;return v<g?(e=c+(p?l:-l),n=l*(b?v:-v)+h):(n=h+(b?u:-u),e=u/(p?v:-v)+c),[e,n]},onEnterViewbox:function(){this.interateNodeStack((function(t){t.onEnterViewbox()}))},onLeaveViewbox:function(){this.interateNodeStack((function(t){t.onLeaveViewbox()}))},destroy:function(){this._shape.destroy(),this.interateNodeStack((function(t){t.destroy()}))}});function wt(t,e){return[t,e]}function yt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n="function"===typeof e.shapeShift?e.shapeShift:wt,i=function(e){Object(h["a"])(i,e);var n=Object(l["a"])(i);function i(e){var o,r,a;return Object(s["a"])(this,i),a=n.call(this,e),a.initStack(e),a.initLayout(e),a._shape=new t(e),a._shape.anchor=[0,0],a._shape._belongs=Object(Y["a"])(a),a._setPadding(e),a._setMargin(e),a.definedWidth=e.width,a.minWidth=e.minWidth,a.definedHeight=e.height,a.lock=null===(o=e.lock)||void 0===o||o,a.display=e.display||"default",a.transparent=null!==(r=e.transparent)&&void 0!==r&&r,a._getBoundingGroupRect(),a.reflow(),a._getBoundingGroupRect(),a}return i}(V);return Object.assign(i.prototype,_t),Object.assign(i.prototype,{reflow:function(){_t.reflow.call(this);var t=this.margin,e=n(this.width-t.left-t.right,this.height-t.top-t.bottom,this._shape),i=Object(a["a"])(e,2),o=i[0],r=i[1];this._shape.width=o,this._shape.height=r},setConfig:function(t){this._shape.setConfig(t),this._setPadding(t),this._setMargin(t),"opacity"in t&&(this.opacity=t.opacity),t.layout&&this._layout!==t.layout&&(this._layout=t.layout)},_getBoundingGroupRect:function(){var t=this._stack.getBoundingRectPoints(),e=O(t),i=this.padding,o=this.minWidth,r=this.definedWidth,s=e.width+i.left+i.right,c=e.height+i.top+i.bottom,h=o?Math.max(o,s):r||s,l=this.definedHeight||c;this._paddingWidth=h,this._paddingHeight=l;var u=n(h,l,this._shape),d=Object(a["a"])(u,2),f=d[0],g=d[1];this._shape.width=f,this._shape.height=g;var v=this.margin;this.width=f+v.left+v.right,this.height=g+v.top+v.bottom},render:function(t){t.save(),this._isMoving?t.globalAlpha=.6:1!==this.opacity&&(t.globalAlpha=this.opacity);var e=this._getCenter(),n=Object(a["a"])(e,2),i=n[0],o=n[1];this._shape.render(t),t.translate(i,o),this._stack.render(t),this._linkStack.render(t),t.translate(-i,-o),t.restore()},isHit:function(t,e){var n=this._calculatePointBack(t);this._currentp=n;var i=this._stack.checkHit(n,e);return i||!this.transparent&&this._shape.isHit(t)}}),i}var kt=yt,jt=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.type="Point",i.radius=t.radius||10,i._doCache(),i}return Object(c["a"])(n,[{key:"setConfig",value:function(t){var e=this;Object.keys(t).forEach((function(n){void 0!==t[n]&&null!==t[n]&&(e[n]=t[n],e._rawConfigs[n]=t[n])})),this._doCache()}},{key:"_doCache",value:function(){this.width=2*this.radius,this.height=2*this.radius}},{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.6),t.beginPath(),t.arc(this.anchor[0],this.anchor[1],this.radius,0,2*Math.PI),t.fillStyle=this.backgroundColor,t.fill(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor,t.stroke()),t.restore()}},{key:"isHit",value:function(t){var e=this.anchor;return Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)<this.radius*this.radius}},{key:"getBoundingRect",value:function(){var t=this.anchor,e=this.radius,n=t[0]-e,i=t[1]-e,o=t[0]+e,r=t[1]+e;return[n,i,o,r]}},{key:"calculateIntersection",value:function(t){var e=Object(a["a"])(t,2),n=e[0],i=e[1],o=Object(a["a"])(this.anchor,2),r=o[0],s=o[1],c=r-n,h=s-i,l=Math.sqrt(c*c+h*h),u=this.radius/l;return[r-u*c,s-u*h]}},{key:"getIntersectionsInFourDimension",value:function(){var t,e=Object(a["a"])(this.anchor,2),n=e[0],i=e[1],o=this.radius;return t={},Object(W["a"])(t,y.RIGHT,[n+o,i]),Object(W["a"])(t,y.LEFT,[n-o,i]),Object(W["a"])(t,y.BOTTOM,[n,i+o]),Object(W["a"])(t,y.TOP,[n,i-o]),t}},{key:"calculateIntersectionInFourDimension",value:function(t,e){var n,i=Object(a["a"])(t,2),o=i[0],r=i[1],s=Object(a["a"])(this.anchor,2),c=s[0],h=s[1],l=this.radius,u=c-o,d=h-r,f=(n={},Object(W["a"])(n,y.RIGHT,[c+l,h]),Object(W["a"])(n,y.LEFT,[c-l,h]),Object(W["a"])(n,y.BOTTOM,[c,h+l]),Object(W["a"])(n,y.TOP,[c,h-l]),n),g=Math.abs(d)>Math.abs(u)?d<0?y.BOTTOM:y.TOP:u<0?y.RIGHT:y.LEFT;return{p:f[g],dir:g}}},{key:"getBoundingDimension",value:function(){return{width:this.width,height:this.height}}}]),n}(V),Ot=jt,xt=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["a"])(this,n),t=e.call(this,i),t.type="Rectangle",t.width=i.width||10,t.height=i.height||10,t.borderRadius=i.borderRadius||0,t._setBorder(i),t}return Object(c["a"])(n,[{key:"_setBorder",value:function(t){var e,n,i,o,r,a,s,c,h,l,u,d,f,g,v,p,b,m,_,w,y,k,j,O;this.border={top:{color:(null===(e=t.border)||void 0===e||null===(n=e.top)||void 0===n?void 0:n.borderColor)||t.borderColor||"transparent",width:(null===(i=t.border)||void 0===i||null===(o=i.top)||void 0===o?void 0:o.borderWidth)||t.borderWidth||0,enable:null===(r=t.border)||void 0===r||null===(a=r.top)||void 0===a?void 0:a.borderWidth},right:{color:(null===(s=t.border)||void 0===s||null===(c=s.right)||void 0===c?void 0:c.borderColor)||t.borderColor||"transparent",width:(null===(h=t.border)||void 0===h||null===(l=h.right)||void 0===l?void 0:l.borderWidth)||t.borderWidth||0,enable:null===(u=t.border)||void 0===u||null===(d=u.right)||void 0===d?void 0:d.borderWidth},bottom:{color:(null===(f=t.border)||void 0===f||null===(g=f.bottom)||void 0===g?void 0:g.borderColor)||t.borderColor||"transparent",width:(null===(v=t.border)||void 0===v||null===(p=v.bottom)||void 0===p?void 0:p.borderWidth)||t.borderWidth||0,enable:null===(b=t.border)||void 0===b||null===(m=b.bottom)||void 0===m?void 0:m.borderWidth},left:{color:(null===(_=t.border)||void 0===_||null===(w=_.left)||void 0===w?void 0:w.borderColor)||t.borderColor||"transparent",width:(null===(y=t.border)||void 0===y||null===(k=y.left)||void 0===k?void 0:k.borderWidth)||t.borderWidth||0,enable:null===(j=t.border)||void 0===j||null===(O=j.left)||void 0===O?void 0:O.borderWidth}},this.borderColor=t.borderColor||"transparent",this.borderWidth=t.borderWidth||0}},{key:"setConfig",value:function(t){var e=this;Object.keys(t).forEach((function(n){void 0!==t[n]&&null!==t[n]&&(e[n]=t[n],e._rawConfigs[n]=t[n])})),this._setBorder(t)}},{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.6);var e=this.borderRadius,n=(this.anchor,this.width),i=this.height,o=this.anchor[0]-this.width/2,r=this.anchor[1]-this.height/2,a=this.anchor[0]+this.width/2,s=this.anchor[1]+this.height/2;if(this.borderRadius?(t.beginPath(),t.moveTo(o+e,r),t.lineTo(o+n-e,r),t.quadraticCurveTo(o+n,r,o+n,r+e),t.lineTo(o+n,r+i-e),t.quadraticCurveTo(o+n,r+i,o+n-e,r+i),t.lineTo(o+e,r+i),t.quadraticCurveTo(o,r+i,o,r+i-e),t.lineTo(o,r+e),t.quadraticCurveTo(o,r,o+e,r),t.closePath()):(t.beginPath(),t.rect(this.anchor[0]-this.width/2,this.anchor[1]-this.height/2,this.width,this.height)),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor),this.shadowColor&&"transparent"!==this.shadowColor){t.shadowColor=this.shadowColor;var c=this._jflow.scale;t.shadowBlur=this.shadowBlur*c,t.shadowOffsetX=this.shadowOffsetX*c,t.shadowOffsetY=this.shadowOffsetY*c;var h=new Path2D;this.borderRadius?(h.moveTo(o+e,r),h.lineTo(o+n-e,r),h.quadraticCurveTo(o+n,r,o+n,r+e),h.lineTo(o+n,r+i-e),h.quadraticCurveTo(o+n,r+i,o+n-e,r+i),h.lineTo(o+e,r+i),h.quadraticCurveTo(o,r+i,o,r+i-e),h.lineTo(o,r+e),h.quadraticCurveTo(o,r,o+e,r),h.closePath()):h.rect(this.anchor[0]-this.width/2,this.anchor[1]-this.height/2,this.width,this.height),h.rect(o-10,r-10,this.width+20,this.height+20),t.save(),t.clip(h,"evenodd"),t.stroke(),t.restore()}if(t.fillStyle=this.backgroundColor,t.fill(),this.borderRadius&&this.borderWidth&&(t.shadowColor="transparent",t.stroke()),this.borderRadius){if(this.border.top.enable){var l=r-this.border.top.width/2;t.beginPath();var u=new Path2D;u.moveTo(o,l+e),u.quadraticCurveTo(o,l,o+e,l),u.lineTo(o+n-e,l),u.quadraticCurveTo(o+n,l,o+n,l+e),u.closePath(),t.clip(u),t.save(),t.shadowColor="transparent",t.fillStyle=this.border.top.color,t.rect(o,l,this.width,this.border.top.width),t.fill(),t.restore()}}else this.border.top.width&&(t.beginPath(),t.moveTo(o,r),t.lineTo(a,r),t.strokeStyle=this.border.top.color,t.lineWidth=this.border.top.width,t.stroke()),this.border.right.width&&(t.beginPath(),t.moveTo(a,r),t.lineTo(a,s),t.strokeStyle=this.border.right.color,t.lineWidth=this.border.right.width,t.stroke()),this.border.bottom.width&&(t.beginPath(),t.moveTo(a,s),t.lineTo(o,s),t.strokeStyle=this.border.bottom.color,t.lineWidth=this.border.bottom.width,t.stroke()),this.border.left.width&&(t.beginPath(),t.moveTo(o,s),t.lineTo(o,r),t.strokeStyle=this.border.left.color,t.lineWidth=this.border.left.width,t.stroke());t.restore()}},{key:"isHit",value:function(t){var e=this.anchor,n=this.width/2,i=this.height/2;return t[0]>e[0]-n&&t[0]<e[0]+n&&t[1]>e[1]-i&&t[1]<e[1]+i}},{key:"getBoundingRect",value:function(){var t=this.anchor,e=this.width/2,n=this.height/2,i=t[0]-e,o=t[1]-n,r=t[0]+e,a=t[1]+n;return[i,o,r,a]}},{key:"getBoundingDimension",value:function(){return{height:this.height,width:this.width}}},{key:"calculateIntersection",value:function(t){var e,n,i=Object(a["a"])(t,2),o=i[0],r=i[1],s=Object(a["a"])(this.anchor,2),c=s[0],h=s[1],l=this.width/2,u=this.height/2,d=c-o,f=h-r,g=u/l,v=Math.abs(f/d),p=o>c,b=r>h;return v<g?(e=c+(p?l:-l),n=l*(b?v:-v)+h):(n=h+(b?u:-u),e=u/(p?v:-v)+c),[e,n]}},{key:"getIntersectionsInFourDimension",value:function(){var t,e=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(e=this._belongs.calculateToCoordination(e));var n=e,i=Object(a["a"])(n,2),o=i[0],r=i[1],s=this.width/2,c=this.height/2;return t={},Object(W["a"])(t,y.RIGHT,[o+s,r]),Object(W["a"])(t,y.LEFT,[o-s,r]),Object(W["a"])(t,y.BOTTOM,[o,r+c]),Object(W["a"])(t,y.TOP,[o,r-c]),t}},{key:"calculateIntersectionInFourDimension",value:function(t,e){var n,i=Object(a["a"])(t,2),o=i[0],r=i[1],s=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(s=this._belongs.calculateToCoordination(s));var c=s,h=Object(a["a"])(c,2),l=h[0],u=h[1],d=this.width/2,f=this.height/2,g=(n={},Object(W["a"])(n,y.RIGHT,[l+d,u]),Object(W["a"])(n,y.LEFT,[l-d,u]),Object(W["a"])(n,y.BOTTOM,[l,u+f]),Object(W["a"])(n,y.TOP,[l,u-f]),n),v=l-o,p=u-r,b=f/d,m=Math.abs(p/v),_=o>l,w=r>u,k=m>b?w?y.BOTTOM:y.TOP:_?y.RIGHT:y.LEFT;return{p:g[k],dir:k}}}]),n}(V),Tt=xt,St=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["a"])(this,n),t=e.call(this,i),t.type="Capsule",t.width=i.width||20,t.height=i.height||10,t}return Object(c["a"])(n,[{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.6),t.beginPath();var e=Object(a["a"])(this.anchor,2),n=e[0],i=e[1],o=this.width/2,r=this.height/2,s=n-o+r,c=n+o-r,h=i-r,l=i+r;t.moveTo(s,h),t.lineTo(c,h),t.arc(c,i,r,-Math.PI/2,Math.PI/2),t.lineTo(s,l),t.arc(s,i,r,Math.PI/2,Math.PI/2*3),t.fillStyle=this.backgroundColor,this.shadowColor&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),t.fill(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor,t.stroke()),t.restore()}},{key:"isHit",value:function(t){var e=this.anchor,n=this.width/2,i=this.height/2,o=Math.abs(n-i),r=e[0]-n+i,a=e[0]+n-i,s=i*i;return t[0]>e[0]-o&&t[0]<e[0]+o&&t[1]>e[1]-i&&t[1]<e[1]+i||Math.pow(t[0]-r,2)+Math.pow(t[1]-e[1],2)<s||Math.pow(t[0]-a,2)+Math.pow(t[1]-e[1],2)<s}},{key:"getBoundingRect",value:function(){var t=this.anchor,e=this.width/2,n=this.height/2,i=t[0]-e,o=t[1]-n,r=t[0]+e,a=t[1]+n;return[i,o,r,a]}},{key:"getBoundingDimension",value:function(){return{height:this.height,width:this.width}}},{key:"getIntersectionsInFourDimension",value:function(){var t,e=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(e=this._belongs.calculateToCoordination(e));var n=e,i=Object(a["a"])(n,2),o=i[0],r=i[1],s=this.width/2,c=this.height/2;return t={},Object(W["a"])(t,y.RIGHT,[o+s,r]),Object(W["a"])(t,y.LEFT,[o-s,r]),Object(W["a"])(t,y.BOTTOM,[o,r+c]),Object(W["a"])(t,y.TOP,[o,r-c]),t}}]),n}(V),Et=St,Ct=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(){return Object(s["a"])(this,n),e.apply(this,arguments)}return Object(c["a"])(n,[{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.6),t.beginPath();var e=Object(a["a"])(this.anchor,2),n=e[0],i=e[1],o=this.width/2,r=this.height/2,s=i-r+o,c=i+r-o,h=n-o,l=n+o;t.moveTo(h,s),t.arc(n,s,o,-Math.PI,0),t.lineTo(l,c),t.arc(n,c,o,0,Math.PI),t.closePath(),t.fillStyle=this.backgroundColor,this.shadowColor&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),t.fill(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor,t.stroke()),t.restore()}},{key:"isHit",value:function(t,e){var n=Object(a["a"])(this.anchor,2),i=n[0],o=n[1],r=this.width/2,s=this.height/2,c=Math.abs(s-r),h=o-s+r,l=o+s-r,u=r*r;return t[0]>i-r&&t[0]<i+r&&t[1]>o-c&&t[1]<o+c||Math.pow(t[0]-i,2)+Math.pow(t[1]-h,2)<u||Math.pow(t[0]-i,2)+Math.pow(t[1]-l,2)<u}}]),n}(Et),Mt=Ct,It=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["a"])(this,n),t=e.call(this,i),t.type="Rhombus",t.height=i.diagonalsV||10,t.width=i.diagonalsH||20,t}return Object(c["a"])(n,[{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.6);var e=this.width/2,n=this.height/2,i=this.anchor;if(t.translate(i[0],i[1]),t.beginPath(),t.moveTo(0,-n),t.lineTo(e,0),t.lineTo(0,n),t.lineTo(-e,0),t.closePath(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor),this.shadowColor){t.shadowColor=this.shadowColor;var o=this._jflow.scale;t.shadowBlur=this.shadowBlur*o,t.shadowOffsetX=this.shadowOffsetX*o,t.shadowOffsetY=this.shadowOffsetY*o;var r=new Path2D;r.moveTo(0,-n),r.lineTo(e,0),r.lineTo(0,n),r.lineTo(-e,0),r.closePath(),r.rect(-e-10,-n-10,this.width+20,this.height+20),t.save(),t.clip(r,"evenodd"),t.stroke(),t.restore()}t.fillStyle=this.backgroundColor,t.fill(),this.borderWidth&&(t.shadowColor="transparent",t.stroke()),t.translate(-i[0],-i[1]),t.restore()}},{key:"isHit",value:function(t){var e=this.height/2,n=this.width/2,i=this.anchor,o=Math.abs(t[0]-i[0]),r=Math.abs(t[1]-i[1]);return o/n+r/e<=1}},{key:"getBoundingRect",value:function(){var t=this.anchor,e=this.width/2,n=this.height/2,i=t[0]-e,o=t[1]-n,r=t[0]+e,a=t[1]+n;return[i,o,r,a]}},{key:"getBoundingDimension",value:function(){return{height:this.height,width:this.width}}},{key:"getIntersectionsInFourDimension",value:function(){var t,e=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(e=this._belongs.calculateToCoordination(e));var n=e,i=Object(a["a"])(n,2),o=i[0],r=i[1],s=this.width/2,c=this.height/2;return t={},Object(W["a"])(t,y.RIGHT,[o+s,r]),Object(W["a"])(t,y.LEFT,[o-s,r]),Object(W["a"])(t,y.BOTTOM,[o,r+c]),Object(W["a"])(t,y.TOP,[o,r-c]),Object(W["a"])(t,y.SELF,[o+.618*s,r+.618*c]),t}}]),n}(V),Bt=It,Lt=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["a"])(this,n),t=e.call(this,i),t.type="Diamond",t.width=i.width||20,t.height=i.height||10,t.side=i.side||6,t._doCache(),t}return Object(c["a"])(n,[{key:"setConfig",value:function(t){var e=this;Object.keys(t).forEach((function(n){void 0!==t[n]&&null!==t[n]&&(e[n]=t[n],e._rawConfigs[n]=t[n])})),this._doCache()}},{key:"_doCache",value:function(){this.sinSIDE=Math.sin(Math.PI/3)*this.side,this.cosSIDE=Math.cos(Math.PI/3)*this.side}},{key:"render",value:function(t){var e=Object(a["a"])(this.anchor,2),n=e[0],i=e[1],o=this.width/2,r=this.height/2,s=r/1.732,c=n-o+s,h=n+o-s,l=n+o,u=n-o,d=i-r,f=i+r;this._cachePoints=[[h,d],[l,i],[h,f],[c,f],[u,i],[c,d]],t.save(),this._isMoving&&(t.globalAlpha=.6),t.beginPath();var g=this.side,v=this.sinSIDE,p=this.cosSIDE;t.moveTo(n,d),t.lineTo(h-g,d),t.quadraticCurveTo(h,d,h+p,d+v),t.lineTo(l-p,i-v),t.quadraticCurveTo(l,i,l-p,i+v),t.lineTo(h+p,f-v),t.quadraticCurveTo(h,f,h-g,f),t.lineTo(c+g,f),t.quadraticCurveTo(c,f,c-p,f-v),t.lineTo(u+p,i+v),t.quadraticCurveTo(u,i,u+p,i-v),t.lineTo(c-p,d+v),t.quadraticCurveTo(c,d,c+g,d),t.closePath(),t.fillStyle=this.backgroundColor,this.shadowColor&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),t.fill(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor,t.stroke()),t.restore()}},{key:"isHit",value:function(t){if(!this._cachePoints)return!1;for(var e=this._cachePoints,n=!1,i=0,o=e.length-1;i<e.length;i++)e[i][1]>t[1]!==e[o][1]>t[1]&&t[0]<(e[o][0]-e[i][0])*(t[1]-e[i][1])/(e[o][1]-e[i][1])+e[i][0]&&(n=!n),o=i;return n}},{key:"getBoundingRect",value:function(){var t=this.anchor,e=this.width/2,n=this.height/2,i=t[0]-e,o=t[1]-n,r=t[0]+e,a=t[1]+n;return[i,o,r,a]}},{key:"getBoundingDimension",value:function(){return{height:this.height,width:this.width}}},{key:"getIntersectionsInFourDimension",value:function(){var t,e=this.anchor;this._belongs&&this._belongs.calculateToCoordination&&(e=this._belongs.calculateToCoordination(e));var n=e,i=Object(a["a"])(n,2),o=i[0],r=i[1],s=this.width/2,c=this.height/2;return t={},Object(W["a"])(t,y.RIGHT,[o+s,r]),Object(W["a"])(t,y.LEFT,[o-s,r]),Object(W["a"])(t,y.BOTTOM,[o,r+c]),Object(W["a"])(t,y.TOP,[o,r-c]),t}}]),n}(V),Pt=Lt,Dt=(Math.sqrt(3),function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){return Object(s["a"])(this,n),e.call(this,t)}return Object(c["a"])(n,[{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.6),t.beginPath();var e=Object(a["a"])(this.anchor,2),n=e[0],i=e[1],o=this.width/2,r=this.height/2,s=o/1.732,c=i-r,h=i+r,l=i-r+s,u=i+r-s,d=n-o,f=n+o;t.moveTo(n,c),t.lineTo(f,l),t.lineTo(f,u),t.lineTo(n,h),t.lineTo(d,u),t.lineTo(d,l),t.closePath(),t.fillStyle=this.backgroundColor,this.shadowColor&&(t.shadowColor=this.shadowColor,t.shadowBlur=this.shadowBlur,t.shadowOffsetX=this.shadowOffsetX,t.shadowOffsetY=this.shadowOffsetY),t.fill(),this.borderWidth&&(t.lineWidth=this.borderWidth,t.strokeStyle=this.borderColor,t.stroke()),t.restore(),this._cachePoints=[[n,c],[f,l],[f,u],[n,h],[d,u],[d,l]]}}]),n}(Pt)),Rt=Dt,At={canvas:{wheel:function(t,e){t.preventDefault();var n=t.offsetX,i=t.offsetY,o=t.deltaX,r=t.deltaY;t.ctrlKey&&(r=-r),e.zoomHandler(n,i,o,r,t)}}},Ft=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(s["a"])(this,n),t=e.call(this),t.from=i.from,t.to=i.to,t.fromDir=i.fromDir,t.toDir=i.toDir,t._cachePoints=null,t.backgroundColor=i.backgroundColor||"#000",t.isSelf=!!i.isSelf,t}return Object(c["a"])(n,[{key:"isInViewBox",value:function(t){return!0}},{key:"bringToTop",value:function(){var t=this,e=this._jflow._linkStack,n=e.findIndex((function(e){return e===t}));e.splice(n,1),e.push(this),this._jflow._render()}}]),n}(q),Nt=Ft;n("ac1f");function Ht(){var t=document.createElement("input");return t.setAttribute("style","\n        position: absolute;\n        left: 0;\n        top: 0;\n        border:none;\n        background-image:none;\n        background-color:transparent;\n        -webkit-box-shadow: none;\n        -moz-box-shadow: none;\n        box-shadow: none;"),t}var Wt={CENTER:"center",LEFT:"left",RIGHT:"right"},Yt=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.type="Text",i.content=t.content||"",i.fontFamily=t.fontFamily||"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji",i.fontSize=t.fontSize||"28px",i.fontWeight=t.fontWeight||"",i.textColor=t.textColor||"white",i.placeholderColor=t.placeholderColor||t.textColor||"white",i.textAlign=t.textAlign||Wt.CENTER,i.textBaseline=t.textBaseline||"middle",i.lineHeight=t.lineHeight,i.indent=t.indent||0,i.backgroundColor=t.backgroundColor,i.editable=t.editable,i.minWidth=t.minWidth||0,i.maxWidth=t.maxWidth,i.ellipsis=t.ellipsis,i.placeholder=t.placeholder||"",i.emptyWhenInput=t.emptyWhenInput||!1,i.editting=!1,i.disabled=t.disabled,i.textBuffer=document.createElement("canvas"),b((function(t){i.renderShadowText(t),i.cacheText()})),i._makeEditable(),i}return Object(c["a"])(n,[{key:"currentContent",get:function(){return this.content||this.placeholder}},{key:"isEmpty",get:function(){return!this.content}},{key:"cacheText",value:function(){var t=4,e=this.textBuffer,n=this.fontSize,i=this.fontFamily,o=this.fontWeight,r=this.currentContent;if(this.ellipsisContent&&(r=this.ellipsisContent),r){var a=parseInt(n),s=this._textWidth*t,c=a*t;e.width=s,e.height=c;var h=e.getContext("2d");h.clearRect(-1e3,-1e3,1e4,1e4),h.fillStyle=this.textColor,h.font="".concat(o," ").concat(c,"px ").concat(i),h.textBaseline="middle",h.fillText(r,0,c/2),this.cacheTextBounding=[0,0,s,c]}else this.cacheTextBounding=null}},{key:"_renderCache",value:function(t){if(this.cacheTextBounding){var e=Object(a["a"])(this.cacheTextBounding,4),n=e[0],i=e[1],o=e[2],r=e[3],s=this._textWidth,c=parseInt(this.fontSize);if(this.textAlign===Wt.LEFT){var h=this.width/2;t.drawImage(this.textBuffer,n,i,o,r,this.anchor[0]-h+this.indent/2,this.anchor[1]-c/2,s,c)}else if(this.textAlign===Wt.RIGHT){var l=this.width/2,u=this._textWidth;t.drawImage(this.textBuffer,n,i,o,r,this.anchor[0]+l-u,this.anchor[1]-c/2,s,c)}else{var d=this._textWidth/2;t.drawImage(this.textBuffer,n,i,o,r,this.anchor[0]-d+this.indent/2,this.anchor[1]-c/2,s,c)}}}},{key:"_makeEditable",value:function(){var t=this;this.editable&&this.addEventListener("click",(function(e){if(!t.disabled){var n,i=t.width/2;n=t.textAlign===Wt.LEFT?t.anchor[0]-i+t.indent/2:t.textAlign===Wt.RIGHT?t.anchor[0]+i:t.anchor[0]+t.indent/2;var o=[n,-t.height/2],r=+/(\d+)/.exec(t.fontSize)[1],s=t.calculateToRealWorld(o),c=Object(a["a"])(s,2),h=c[0],l=c[1],u=Ht(),d=t._jflow.DOMwrapper,f=t.content,g=t.textColor;u.style.margin=0,u.style.padding=0,u.style.transform="translate(".concat(h,"px, ").concat(l,"px)"),u.style.width=t.calculateToRealWorldWithScalar(t.width)+"px",u.style.height=t.calculateToRealWorldWithScalar(t.height)+"px",u.style.fontFamily=t.fontFamily,d.style.fontSize="".concat(r*t._jflow.scale,"px"),u.style.fontSize="".concat(r*t._jflow.scale,"px"),u.style.lineHeight="".concat(t.lineHeight*t._jflow.scale,"px"),u.style.textIndent="".concat(t.indent*t._jflow.scale,"px"),u.value=t.emptyWhenInput?"":t.content,u.style.color=t.textColor,u.setAttribute("placeholder",t.placeholder),u.addEventListener("focus",(function(e){t.textColor="transparent",t.editting=!0,t._jflow._render(),u.style.outline="none"}));var v=function(){t.editting=!1,t.dispatchEvent(new vt("blur",{target:t}));var e=u.value;t.dispatchEvent(new vt("change",{target:t,oldVal:f,val:e})),t.textColor=g,t._jflow._render(),t._jflow.removeEventListener("zoompan",v),u.removeEventListener("blur",v),u.removeEventListener("keypress",p),d.removeChild(u),u=null,v=null,t.inputElement=null};t._jflow.addEventListener("zoompan",v),u.addEventListener("blur",v);var p=function e(n){if("Enter"===n.key||13===n.keyCode){n.preventDefault();var i=!0;t.dispatchEvent(new vt("enterkeypressed",{target:t,handler:function(t){i=t}})),i&&(u.removeEventListener("keypress",e),v())}};u.addEventListener("keypress",p),u.addEventListener("input",(function(e){var n=!1;t.dispatchEvent(new vt("input",{target:t,oldVal:f,val:e.target.value,handler:function(t){f=t,u.value=t,n=!0}})),n||(f=e.target.value)})),d.append(u),u.focus({preventScroll:!0}),t.inputElement=u}}))}},{key:"renderShadowText",value:function(t){t.beginPath(),t.font="".concat(this.fontSize," ").concat(this.fontFamily),t.textAlign=this.textAlign,t.textBaseline=this.textBaseline,t.fillStyle=this.textColor;var e=parseInt(this.fontSize),n=this.currentContent,i=t.measureText(n),o=i.actualBoundingBoxLeft,r=i.actualBoundingBoxRight,a=i.fontBoundingBoxAscent,s=i.fontBoundingBoxDescent;if(this._textWidth=this.indent+Math.abs(o)+Math.abs(r),this.maxWidth&&this.ellipsis){if(this._textWidth>this.maxWidth){var c=this.maxWidth/this._textWidth,h=Math.floor(n.length*c-3);this.ellipsisContent=n.substring(0,h)+"..."}else this.ellipsisContent=n;this.width=this.maxWidth}else this.width=Math.max(this.minWidth,this._textWidth);var l=Math.abs(a)+Math.abs(s)||e;this.lineHeight?this.height=this.lineHeight:this.height=l}},{key:"setConfig",value:function(t){var e=this;Object.keys(t).forEach((function(n){void 0!==t[n]&&null!==t[n]&&(e[n]=t[n],e._rawConfigs[n]=t[n])})),b((function(t){e.renderShadowText(t),e.cacheText()}))}},{key:"render",value:function(t){if(this._isMoving&&(t.globalAlpha=.6),!this.editting)if(this._jflow.scale*parseInt(this.fontSize)<8)this._renderCache(t);else{t.beginPath(),t.font="".concat(this.fontWeight," ").concat(this.fontSize," ").concat(this.fontFamily),t.textAlign=this.textAlign,t.textBaseline=this.textBaseline,t.fillStyle=this.isEmpty?this.placeholderColor:this.textColor;var e=this.currentContent;if(this.ellipsisContent&&(e=this.ellipsisContent),e)if(this.textAlign===Wt.LEFT){var n=this.width/2;t.fillText(e,this.anchor[0]-n+this.indent/2,this.anchor[1])}else if(this.textAlign===Wt.RIGHT){var i=this.width/2;t.fillText(e,this.anchor[0]+i,this.anchor[1])}else t.fillText(e,this.anchor[0]+this.indent/2,this.anchor[1])}}}]),n}(Tt),Xt=Yt,$t=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.image=t.image,i.image.onload=function(){i._jflow._render()},i.imageBounding={width:t.imageWidth||t.width,height:t.imageHeight||t.height},i}return Object(c["a"])(n,[{key:"setConfig",value:function(t){var e=this;Object.keys(t).forEach((function(n){void 0!==t[n]&&null!==t[n]&&(e[n]=t[n],e._rawConfigs[n]=t[n])})),t.image&&!t.image.complete&&(this.image.onload=function(){e._jflow._render()}),this.imageBounding={width:t.imageWidth||t.width||this.imageBounding.width,height:t.imageHeight||t.height||this.imageBounding.height}}},{key:"render",value:function(t){t.save(),this._isMoving&&(t.globalAlpha=.6),Tt.prototype.render.call(this,t);var e=this.anchor[0]-this.width/2,n=this.anchor[1]-this.height/2;this.opacity<1&&(t.globalAlpha=this.opacity),this.image.complete&&t.drawImage(this.image,e,n,this.imageBounding.width,this.imageBounding.height),t.restore()}}]),n}(Tt),zt=$t,qt=n("45eb"),Gt=n("7e84"),Vt=(n("fb6a"),function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.domFactory=t.createDocument,i._dom=null,i}return Object(c["a"])(n,[{key:"getRealWorldPosition",value:function(){var t=this.getBoundingRect();return this.calculateToRealWorld(t.slice(0,2))}},{key:"render",value:function(t){var e=this;if(!this._dom&&this.domFactory)requestAnimationFrame((function(){if(!e._dom){var t=document.createElement("div"),n=e.getRealWorldPosition(),i=e._jflow.scale;t.setAttribute("style","\n                        position: absolute;\n                        width: ".concat(e.width,"px;\n                        height: ").concat(e.height,"px;\n                        transform-origin: left top;\n                        top: 0;\n                        left: 0;\n                        transform: translate(").concat(n[0],"px, ").concat(n[1],"px) scale(").concat(i,");")),e._dom=t,e._jflow.DOMwrapper.appendChild(t),e.domFactory(t)}}));else{var i=this.getRealWorldPosition(),o=this._jflow.scale;this._dom.style.transform="translate(".concat(i[0],"px, ").concat(i[1],"px) scale(").concat(o,")")}Object(qt["a"])(Object(Gt["a"])(n.prototype),"render",this).call(this,t)}},{key:"onEnterViewbox",value:function(){this._dom&&(this._dom.style.display="block")}},{key:"onLeaveViewbox",value:function(){this._dom&&(this._dom.style.display="none")}},{key:"destroy",value:function(){this._dom&&this._jflow.DOMwrapper.removeChild(this._dom),Object(qt["a"])(Object(Gt["a"])(n.prototype),"destroy",this).call(this)}}]),n}(Tt)),Jt=Vt,Ut=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.fontFamily=t.fontFamily="-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji",i.fontSize=t.fontSize||"12px",i.content=t.content||"",i.lineDash=t.lineDash,i.approximate=t.approximate||k,i}return Object(c["a"])(n,[{key:"_calculateAnchorPoints",value:function(){var t=this.from.calculateIntersection(this.to.getCenter()),e=this.to.calculateIntersection(this.from.getCenter());this._cachePoints=[t,e];var n=e[0]-t[0],i=e[1]-t[1],o=Math.atan2(i,n);this._cacheAngle=o}},{key:"isInViewBox",value:function(t){return this._calculateAnchorPoints(),!0}},{key:"render",value:function(t){var e=Object(a["a"])(this._cachePoints,2),n=e[0],i=e[1],o=this._cacheAngle,r=i[0]-n[0],s=i[1]-n[1];if(t.fillStyle=t.strokeStyle=this.backgroundColor,t.beginPath(),this.content){t.textAlign="center",t.font="".concat(this.fontSize," ").concat(this.fontFamily),t.textBaseline="middle";var c=t.measureText(this.content),h=c.actualBoundingBoxLeft,l=c.actualBoundingBoxRight,u=c.fontBoundingBoxAscent,d=c.fontBoundingBoxDescent,f=r/2+n[0],g=s/2+n[1];t.fillText(this.content,f,g);var v=Math.abs(h)+Math.abs(l)+20,p=1.5*(Math.abs(u)+Math.abs(d));t.beginPath();var b=new Path2D;b.rect(f-v/2,g-p/2,v,p);var m=Math.min(i[0],n[0])-10,_=Math.min(i[1],n[1])-10,w=Math.abs(r)+20,y=Math.abs(s)+20;b.rect(m,_,w,y),t.clip(b,"evenodd")}t.moveTo(n[0],n[1]),t.lineTo(i[0],i[1]),this.lineDash&&(t.save(),t.setLineDash(this.lineDash)),t.stroke(),this.lineDash&&t.restore(),t.translate(i[0],i[1]),t.rotate(o),t.moveTo(0,0),t.lineTo(-5,-4),t.lineTo(-5,4),t.lineTo(0,0),t.fill(),t.rotate(-o),t.translate(-i[0],-i[1])}},{key:"isHit",value:function(t){if(!this._cachePoints)return!1;var e=Object(a["a"])(this._cachePoints,2),n=e[0],i=e[1],o=S(t,n,i);return o<this.approximate}}]),n}(Nt),Kt=Ut,Zt=Math.PI/180,Qt=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.approximate=t.approximate||k,i.radius=t.radius||0,i.minSpanX=t.minSpanX||10,i.minSpanY=t.minSpanY||10,i.lineDash=t.lineDash,i.doubleLink=t.doubleLink,i.fontFamily=t.fontFamily="-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji",i.fontSize=t.fontSize||"12px",i.content=t.content||"",i.isSelf=!!t.isSelf,i.noArrow=!!t.noArrow,i}return Object(c["a"])(n,[{key:"_calculateAnchorPoints",value:function(){var t=this.from.getIntersectionsInFourDimension(),e=this.to.getIntersectionsInFourDimension();if(this.isSelf){var n=P(t[this.fromDir],e[y.SELF],this.fromDir,this.toDir,this.minSpanX,this.minSpanY,!0);this._cachePoints=n,this._cacheAngle=[this.fromDir,this.toDir]}else if(void 0!==this.fromDir&&void 0!==this.toDir){var i=P(t[this.fromDir],e[this.toDir],this.fromDir,this.toDir,this.minSpanX,this.minSpanY);this._cachePoints=i,this._cacheAngle=[this.fromDir,this.toDir]}else{var o=E(t,e),r=P(o.fromP,o.toP,o.fromDir,o.toDir,this.minSpanX,this.minSpanY);this._cachePoints=r,this._cacheAngle=[o.fromDir,o.toDir]}}},{key:"isInViewBox",value:function(t){return!!this._static||(this._calculateAnchorPoints(),H(this._cachePoints,t))}},{key:"render",value:function(t){var e=this,n=this.radius,i=this._cachePoints,o=i[0],r=i[i.length-1],a=(this._cacheAngle[1]+2)%4*90*Zt;if(t.fillStyle=t.strokeStyle=this.backgroundColor,this.doubleLink){var s=(this._cacheAngle[0]+2)%4*90*Zt;t.beginPath(),t.translate(o[0],o[1]),t.rotate(s),t.moveTo(5,0),t.lineTo(0,-4),t.lineTo(0,4),t.lineTo(5,0),t.fill(),t.rotate(-s),t.translate(-o[0],-o[1])}if(t.beginPath(),t.moveTo(o[0],o[1]),i.slice(1,i.length-1).forEach((function(o,r){if(e.radius){var a=i[r],s=i[r+2],c=F(a,o,s,n),h=c.p1,l=c.p2;h&&l?(t.lineTo(h[0],h[1]),t.quadraticCurveTo(o[0],o[1],l[0],l[1])):t.lineTo(o[0],o[1])}else t.lineTo(o[0],o[1])})),t.lineTo(r[0],r[1]),this.lineDash&&(t.save(),t.setLineDash(this.lineDash)),t.stroke(),this.lineDash&&t.restore(),this.noArrow||(t.beginPath(),t.translate(r[0],r[1]),t.rotate(a),t.moveTo(0,0),t.lineTo(-5,-4),t.lineTo(-5,4),t.lineTo(0,0),t.fill(),t.rotate(-a),t.translate(-r[0],-r[1])),this.content)switch(t.beginPath(),t.font="".concat(this.fontSize," ").concat(this.fontFamily),this.fromDir){case y.BOTTOM:t.textAlign="left",t.fillText(this.content,o[0]+2,o[1]+10);break;case y.RIGHT:t.textAlign="left",t.fillText(this.content,o[0]+10,o[1]-2);break;default:break}}},{key:"isHit",value:function(t){if(this._static)return!1;if(!this._cachePoints)return!1;var e=this._cachePoints,n=e[0],i=e.slice(1);do{var o=i.shift();if(o){var r=S(t,n,o);if(r<this.approximate)return!0}n=o}while(n);return!1}},{key:"cloneStatic",value:function(){var t,e=new n({});return Object.assign(e,(t={radius:this.radius,_cachePoints:this._cachePoints,_cacheAngle:this._cacheAngle,backgroundColor:this.backgroundColor,doubleLink:this.doubleLink},Object(W["a"])(t,"radius",this.radius),Object(W["a"])(t,"lineDash",this.lineDash),Object(W["a"])(t,"noArrow",this.noArrow),Object(W["a"])(t,"content",this.content),Object(W["a"])(t,"fontSize",this.fontSize),Object(W["a"])(t,"fontFamily",this.fontFamily),Object(W["a"])(t,"fromDir",this.fromDir),Object(W["a"])(t,"_static",!0),t)),e}}]),n}(Nt),te=Qt,ee=Math.PI/180,ne=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.approximate=t.approximate||k,i.minSpanX=t.minSpanX||0,i.minSpanY=t.minSpanY||0,i.lineDash=t.lineDash,i.doubleLink=t.doubleLink,i.fontFamily=t.fontFamily="-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji",i.fontSize=t.fontSize||"12px",i.content=t.content||"",i.isSelf=!!t.isSelf,i}return Object(c["a"])(n,[{key:"_calculateAnchorPoints",value:function(){var t=this.from.getIntersectionsInFourDimension(),e=this.to.getIntersectionsInFourDimension();if(this.isSelf){var n=M(t[this.fromDir],e[y.SELF],this.fromDir,y.BOTTOM,this.minSpanX,this.minSpanY);this._cachePoints=[].concat(Object(r["a"])(t[this.fromDir]),Object(r["a"])(n)),this._cacheAngle=[this.fromDir,y.BOTTOM]}else if(void 0!==this.fromDir&&void 0!==this.toDir){var i=M(t[this.fromDir],e[this.toDir],this.fromDir,this.toDir,this.minSpanX,this.minSpanY);this._cachePoints=[].concat(Object(r["a"])(t[this.fromDir]),Object(r["a"])(i)),this._cacheAngle=[this.fromDir,this.toDir]}else{var o=E(t,e),a=M(o.fromP,o.toP,o.fromDir,o.toDir);this._cachePoints=[].concat(Object(r["a"])(o.fromP),Object(r["a"])(a)),this._cacheAngle=[o.fromDir,o.toDir]}}},{key:"render",value:function(t){this._calculateAnchorPoints();var e=this._cachePoints,n=L.apply(null,[1].concat(Object(r["a"])(e)));if(t.fillStyle=t.strokeStyle=this.backgroundColor,this.doubleLink){var i=(this._cacheAngle[0]+2)%4*90*ee;t.beginPath(),t.translate(e[0],e[1]),t.rotate(i),t.moveTo(5,0),t.lineTo(0,-4),t.lineTo(0,4),t.lineTo(5,0),t.fill(),t.rotate(-i),t.translate(-e[0],-e[1])}if(t.beginPath(),t.moveTo(e[0],e[1]),t.bezierCurveTo.apply(t,Object(r["a"])(e.slice(2))),this.lineDash&&(t.save(),t.setLineDash(this.lineDash)),t.stroke(),this.lineDash&&t.restore(),t.beginPath(),t.translate(e[6],e[7]),t.rotate(n),t.moveTo(5,0),t.lineTo(0,-4),t.lineTo(0,4),t.lineTo(5,0),t.fill(),t.rotate(-n),t.translate(-e[6],-e[7]),this.content){t.beginPath();var o=e[0]>e[6],s=I(.5,e),c=Object(a["a"])(s,3),h=c[0],l=c[1],u=c[2];t.translate(h,l),t.rotate(u),o&&t.rotate(Math.PI),t.font="".concat(this.fontSize," ").concat(this.fontFamily),t.textAlign="center",t.fillText(this.content,0,-(parseInt(this.fontSize)||12)/4),o&&t.rotate(Math.PI),t.rotate(-u),t.translate(-h,-l)}}},{key:"isHit",value:function(t){if(!this._cachePoints)return!1;var e=this._cachePoints,n=B(t,e);return n<this.approximate}}]),n}(Nt),ie=ne,oe=(n("4de4"),function(){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(s["a"])(this,t),this.direction=n.direction||"vertical",this.gap=null!==(e=n.gap)&&void 0!==e?e:5,this.alignment=n.alignment||"center",this.justify=n.justify||"center",this._rawConfigs=n}return Object(c["a"])(t,[{key:"reflow",value:function(t){var e=this,n=t._stack.filter((function(t){return t.visible&&!t.absolutePosition})),i=t._stack.filter((function(t){return t.visible&&t.absolutePosition})),o=t.width-t.padding.left-t.padding.right;if("vertical"===this.direction){var r=0,a=0,s=0,c=0,h=n.concat(i);h.forEach((function(t,e){"block"===t.display&&(t.width=0,t.resetChildrenPosition(),t.reflow(),t._getBoundingGroupRect())})),n.forEach((function(t,n){var i=t.getBoundingDimension(),o=i.width,h=i.height,l=n>0?e.gap:0;"outstretch"!==t.display&&(s=Math.max(o,s)),c+=h+l,r+=h/2+l+a,a=h/2,t.anchor=[0,r]})),h.forEach((function(e,n){if("block"===e.display)e.resetChildrenPosition(),e.width=s,e.reflow();else if("outstretch"===e.display){var i=t._belongs.width-t._belongs.padding.left-t._belongs.padding.right;e.resetChildrenPosition(),e.width=Math.max(i,s),e.reflow()}})),s=Math.max(o,s),c/=2,"start"===this.alignment&&n.forEach((function(t,e){var n=t.getBoundingDimension(),i=n.width;t.anchor[0]=-(s-i)/2,t.anchor[1]-=c})),"end"===this.alignment&&n.forEach((function(t,e){var n=t.getBoundingDimension(),i=n.width;t.anchor[0]=(s-i)/2,t.anchor[1]-=c})),"center"===this.alignment&&n.forEach((function(t,e){var n=t.getBoundingDimension();n.width;t.anchor[1]-=c}))}if("horizontal"===this.direction){var l=0,u=0,d=0,f=0;if(n.forEach((function(t,n){var i=t.getBoundingDimension(),o=i.width,r=i.height,a=n>0?e.gap:0;d=Math.max(r,d),f+=o+a,o,l+=o/2+a+u,u=o/2,t.anchor=[l,0]})),"start"===this.justify){var g=o/2;n.forEach((function(t,e){t.anchor[0]-=g}))}if("end"===this.justify){var v=o/2-f;n.forEach((function(t,e){t.anchor[0]+=v}))}if("center"===this.justify){var p=f/2;n.forEach((function(t,e){t.anchor[0]-=p}))}if("space-between"===this.justify&&n.length>1){var b=Math.max(o,f),m=(b-f)/(n.length-1),_=b/2;n.forEach((function(t,e){t.anchor[0]+=m*e-_}))}"start"===this.alignment&&n.forEach((function(t,e){var n=t.getBoundingDimension(),i=n.height;t.anchor[1]=-(d-i)/2})),"end"===this.alignment&&n.forEach((function(t,e){var n=t.getBoundingDimension(),i=n.height;t.anchor[1]=(d-i)/2}))}if(i.length){"block"===t.display?t.getBoundingDimension():t._getBoundingGroupRect();var w=t.width/2,y=t.height/2;i.forEach((function(t){t.anchor=e._resolveAbsoluteAnchor(t.absolutePosition,t,w,y)}))}}},{key:"_resolveAbsoluteAnchor",value:function(t,e,n,i){var o=t.top,r=t.right,a=t.bottom,s=t.left,c=e.getBoundingDimension(),h=c.width,l=c.height,u=h/2,d=l/2,f=0,g=0;return"number"===typeof o&&(f=o+d-i),"number"===typeof r&&(g=n-r-u),"number"===typeof a&&(f=i-a-d),"number"===typeof s&&(g=s+u-n),[g,f]}},{key:"clone",value:function(){return new t(this._rawConfigs)}}]),t}()),re=oe,ae=(n("7db0"),n("07ac"),n("d81d"),function(){function t(e){Object(s["a"])(this,t),this.source=e,this.id=e.id,this.type=e.type,this.level=void 0,this.sequence=void 0,this.isFree=!1,this.parent=void 0,this.idx=void 0,this.parentIterateType=void 0,this.hasEndPoint=!1}return Object(c["a"])(t,[{key:"reflowPreCalculate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return this.level=t,this.sequence=e,this.spanX=1,this.spanY=1,n&&n(t,e,this),{spanX:this.spanX,spanY:this.spanY,level:t,sequence:e}}},{key:"makeLink",value:function(t){return this}},{key:"makeEndpoint",value:function(){}},{key:"traverse",value:function(t){t(this)}},{key:"getNodes",value:function(t){var e=[];return this.traverse((function(n){var i=t.getRenderNodeBySource(n.source);i&&e.push(i)})),e}},{key:"linkSource",value:function(t){this.parent.source[this.parentIterateType].splice(this.idx+1,0,t)}},{key:"remove",value:function(){this.parent.source[this.parentIterateType].splice(this.idx,1)}}]),t}()),se=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;Object(s["a"])(this,n),i=e.call(this,t),i.isroot=!0,i.body=(t.body||[]).map(ge("body").bind(Object(Y["a"])(i)));var o=ge("playground").bind(Object(Y["a"])(i));return i.playground=(t.playground||[]).map((function(t,e){var n=o(t,e);return n.isFree=!0,n})),i}return Object(c["a"])(n,[{key:"reflowBodyPreCalculate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=1,o=1;return this.level=t,this.sequence=e,n&&n(t,e,this),this.body.forEach((function(r){var a=r.reflowPreCalculate(t+1,e,n),s=a.spanX,c=a.spanY;i=Math.max(s,i),o+=c,t+=c})),this.spanX=i,this.spanY=o,{spanX:i,spanY:o,level:t,sequence:e}}},{key:"reflowPlaygroundPreCalculate",value:function(t,e){this.playground.forEach((function(n){t(n),n.reflowPreCalculate(0,0,e)}))}},{key:"makeLink",value:function(t){var e;return this.body.forEach((function(n){e?(t({from:e,to:n,part:"body",fromDir:y.BOTTOM,toDir:y.TOP}),n=n.makeLink(t),e=n):e=n})),this.playground.forEach((function(e){e.makeLink(t)})),this}},{key:"traverse",value:function(t){this.body.forEach((function(e){e.traverse(t)})),this.playground.forEach((function(e){e.traverse(t)}))}}]),n}(ae),ce=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.consequent=(t.consequent||[]).map(ge("consequent").bind(Object(Y["a"])(i))),i.alternate=(t.alternate||[]).map(ge("alternate").bind(Object(Y["a"])(i))),i.isLocked=!0,i.hasEndPoint=!0,i}return Object(c["a"])(n,[{key:"reflowPreCalculate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=1,o=1;this.level=t,this.sequence=e,n&&n(t,e,this);var r=1,a=0,s=0,c=0;this.consequent.forEach((function(i,o){var s=i.reflowPreCalculate(t+1,e,n),c=s.spanX,h=s.spanY;r=Math.max(r,c),a+=h,t+=h}));var h=e+r;t=this.level,this.alternate.forEach((function(e,i){var o=e.reflowPreCalculate(t+1,h,n),r=o.spanX,a=o.spanY;s=Math.max(s,r),c+=a,t+=a})),i=Math.max(1,r+s),o+=Math.max(a,c),t=this.level+o-1;var l=this.Endpoint.reflowPreCalculate(t+1,e,n),u=l.spanY;return o+=u,this.spanX=i,this.spanY=o,{spanX:i,spanY:o,level:t,sequence:e}}},{key:"makeLink",value:function(t){var e=this,n=this;this.consequent.forEach((function(e){t({from:n,to:e,part:"consequent",fromDir:y.BOTTOM,toDir:y.TOP}),e=e.makeLink(t),n=e})),t({from:n,to:this.Endpoint,fromDir:y.BOTTOM,toDir:y.TOP,part:"consequent"});var i=this;return this.alternate.forEach((function(n){t({from:i,to:n,fromDir:i===e?y.RIGHT:y.BOTTOM,toDir:y.TOP,part:"alternate"}),n=n.makeLink(t),i=n})),t({from:i,to:this.Endpoint,fromDir:i===this?y.RIGHT:y.BOTTOM,toDir:y.RIGHT,part:"alternate"}),this.Endpoint}},{key:"traverse",value:function(t){t(this),this.consequent.forEach((function(e){e.traverse(t)})),this.alternate.forEach((function(e){e.traverse(t)})),console.log(this.Endpoint),t(this.Endpoint)}},{key:"linkSource",value:function(t,e){this.source[e.part].unshift(t)}}]),n}(ae),he=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.cases=(t.cases||[]).map(ge("case").bind(Object(Y["a"])(i))),i.cases.length&&(i.cases[i.cases.length-1].lastCase=!0),i.isLocked=!0,i.hasEndPoint=!0,i}return Object(c["a"])(n,[{key:"reflowPreCalculate",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,o=1,r=1;this.level=e,this.sequence=n,i&&i(e,n,this);var a=1,s=0;if(this.cases.length){var c=this.cases[this.cases.length-1].consequent;e=this.level,c.forEach((function(t){var o=t.reflowPreCalculate(e+1,n,i),r=o.spanX,c=o.spanY;a=Math.max(a,r),s+=c,e+=c}))}var h=a,l=0;this.cases.forEach((function(o,r){var a=n+h,s=0,c=0;e=t.level,o.alternate.forEach((function(t){var n=t.reflowPreCalculate(e+1,a,i),o=n.spanX,r=n.spanY;s=Math.max(s,o),c+=r,e+=r})),h+=s,l=Math.max(l,c)})),o=Math.max(1,h),r=Math.max(s,l),e=this.level+r;var u=this.Endpoint.reflowPreCalculate(e+1,n,i),d=u.spanY;return r+=d,r+=1,this.spanX=o,this.spanY=r,{spanX:o,spanY:r,level:e,sequence:n}}},{key:"makeLink",value:function(t){var e=this,n=this;if(this.cases.length){var i=this.cases[this.cases.length-1].consequent;i.forEach((function(e,i){t({from:n,to:e,fromDir:y.BOTTOM,toDir:y.TOP,part:"consequent"}),n=e.makeLink(t)}))}return console.log(n),t({from:n,to:this.Endpoint,fromDir:y.BOTTOM,toDir:y.TOP,part:"consequent"}),this.cases.forEach((function(n,i){var o=n;n.alternate.forEach((function(e){t({from:o,to:e,fromDir:o===n?y.RIGHT:y.BOTTOM,toDir:y.TOP,part:"alternate"}),o=e.makeLink(t)})),t({from:o,to:e.Endpoint,fromDir:o===n?y.RIGHT:y.BOTTOM,toDir:y.RIGHT,part:"alternate",minSpanX:32*(i+1)})})),this.Endpoint}},{key:"traverse",value:function(t){t(this),this.cases.forEach((function(e){e.traverse(t)})),t(this.Endpoint)}},{key:"getNodes",value:function(t){var e=[];return this.traverse((function(n){if("SwitchCase"!==n.type){var i=t.getRenderNodeBySource(n.source);i&&e.push(i)}})),e}},{key:"linkSource",value:function(t,e){var n=this.source.cases,i=n[n.length-1].consequent;i.unshift(t)}}]),n}(ae),le=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(){return Object(s["a"])(this,n),e.apply(this,arguments)}return n}(ae),ue=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.body=(t.body||[]).map(ge("body").bind(Object(Y["a"])(i))),i.isLocked=!0,i}return Object(c["a"])(n,[{key:"reflowPreCalculate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=1,o=1;this.level=t,this.sequence=e,n&&n(t,e,this);var r=e+1;return this.body.forEach((function(e){var a=e.reflowPreCalculate(t+1,r,n),s=a.spanX,c=a.spanY;i=Math.max(s,i),o+=c,t+=c})),this.spanX=i+1,this.spanY=o,{spanX:i,spanY:o,level:t,sequence:e}}},{key:"makeLink",value:function(t){var e=this,n=this;return this.body.forEach((function(i,o){t({from:n,to:i,part:"body",fromDir:n===e?y.RIGHT:y.BOTTOM,toDir:y.TOP}),i=i.makeLink(t),n=i})),t({from:n,to:this,part:"body",fromDir:n===this?y.RIGHT:y.BOTTOM,anticlock:n===this,toDir:y.BOTTOM,isSelf:!0,minSpanX:20,minSpanY:20}),this}},{key:"traverse",value:function(t){t(this),this.body.forEach((function(e){e.traverse(t)}))}},{key:"linkSource",value:function(t,e){this.source[e.part].unshift(t)}}]),n}(ae),de=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.consequent=(t.consequent||[]).map(ge("consequent").bind(Object(Y["a"])(i))),i.alternate=(t.alternate||[]).map(ge("alternate").bind(Object(Y["a"])(i))),i.lastCase=!1,i}return Object(c["a"])(n,[{key:"reflowPreCalculate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=1,o=1;this.level=t,this.sequence=e,n&&n(t,e,this);var r=0,a=0,s=0,c=0;this.lastCase&&this.consequent.forEach((function(i,o){var s=i.reflowPreCalculate(t+1,e,n),c=s.spanX,h=s.spanY;r=Math.max(r,c),a+=h,t+=h}));var h=e+Math.max(r,1);return t=this.level,this.alternate.forEach((function(e,i){var o=e.reflowPreCalculate(t+1,h,n),r=o.spanX,a=o.spanY;s=Math.max(s,r),c+=a,t+=a})),i=Math.max(1,r+s),o+=Math.max(a,c),this.spanX=i,this.spanY=o,{spanX:i,spanY:o,level:t,sequence:e}}},{key:"traverse",value:function(t){t(this),this.consequent.forEach((function(e){e.traverse(t)})),this.alternate.forEach((function(e){e.traverse(t)}))}},{key:"linkSource",value:function(t,e){this.source[e.part].unshift(t)}}]),n}(ae),fe={IfStatement:ce,SwitchStatement:he,SwitchCase:de,ForEachStatement:le,WhileStatement:ue,Root:se,other:ae};function ge(t){return function(e,n){var i=ve(e);if(i.parent=this,i.idx=n,i.parentIterateType=t,i.hasEndPoint){e.__endpoint__||(e.__endpoint__={type:"endpoint",id:"".concat(i.id,"-endpoint")});var o=ve(e.__endpoint__);o.parent=this,o.idx=n,o.parentIterateType=t,i.Endpoint=o}return i}}function ve(t){var e=t.type,n=fe[e]||fe.other,i=new n(t);return i}function pe(t){return t*t}function be(t,e){return pe(t[0]-e[0])+pe(t[1]-e[1])}var me=function(){function t(e){var n;Object(s["a"])(this,t),this.linkLength=e.linkLength||18,this.gap=e.gap||30,this.treeItemDraggable=null===(n=e.treeItemDraggable)||void 0===n||n,this.reOrder(e.ast),this.static=!0}return Object(c["a"])(t,[{key:"reOrder",value:function(t){var e=this;this.ast=t,this.flowStack=[],this.flowLinkStack=[],this.root=ve(this.ast),this.root.traverse((function(t){"playground"!==t.parentIterateType&&(t.isDraggable=e.treeItemDraggable),e.flowStack.push({type:t.type,source:t.source,layoutNode:t})}));var n,i={vertical:{},horizontal:{}},o={};this.root.reflowBodyPreCalculate(0,0,(function(t,e,n){n.isroot||(i.vertical[t]||(i.vertical[t]={}),i.vertical[t][e]=n,i.horizontal[e]||(i.horizontal[e]={}),i.horizontal[e][t]=n)})),this.root.reflowPlaygroundPreCalculate((function(t){n=t.id,o[t.id]={vertical:{},horizontal:{},node:t}}),(function(t,e,i){var r=o[n];r.vertical[t]||(r.vertical[t]={}),r.vertical[t][e]=i,r.horizontal[e]||(r.horizontal[e]={}),r.horizontal[e][t]=i})),this.layoutMapping=i,this.playgroundLayoutMapping=o,this.root.makeLink((function(t){e.flowLinkStack.push(t)}))}},{key:"staticCheck",value:function(t,e){if(t._layoutNode&&t._layoutNode.isFree)return!1;var n=e._linkStack.find((function(e){return e.from===t||e.to===t}));if(!n)return!1;var i=t.anchor.slice();if(e.reflow(),!(e._linkStack.length<2)){var o=t.anchor,r=be(i,o);return r>1e3&&(t.dispatchEvent(new vt("outOfFlow",{anchor:i,instance:t,jflow:e,point:i})),!0)}}},{key:"reflowByMapping",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=this.linkLength,r=this.gap,a=e.vertical,s=e.horizontal,c=n;Object.keys(s).forEach((function(e,n){var i=s[e],o=0,a=Object.keys(i);a.forEach((function(e){var n=i[e],r=t.getRenderNodeBySource(n.source),a=r.getBoundingDimension(),s=a.width;o=Math.max(s,o)})),c+=0===n?0:o/2,a.forEach((function(e){var n=i[e],o=t.getRenderNodeBySource(n.source);o.anchor[0]=c})),c+=o/2+r}));var h=i;Object.keys(a).forEach((function(e,n){var i=a[e],r=0,s=Object.keys(i);s.forEach((function(e){var n=i[e],o=t.getRenderNodeBySource(n.source),a=o.getBoundingDimension(),s=a.height;a.width;r=Math.max(s,r)})),h+=0===n?0:r/2,s.forEach((function(e){var n=i[e],o=t.getRenderNodeBySource(n.source);o.anchor[1]=h})),h+=r/2+o}))}},{key:"findLayoutNode",value:function(t){var e=this.flowStack.find((function(e){return e.configs===t}));return e?e.layoutMeta:null}},{key:"reflow",value:function(t){var e=this;this.reflowByMapping(t,this.layoutMapping),Object.values(this.playgroundLayoutMapping).forEach((function(n){var i=t.getRenderNodeBySource(n.node.source);e.reflowByMapping(t,n,i.anchor[0],i.anchor[1])}))}}]),t}(),_e=me;n("b0c0");var we=function t(e,n,i){Object(s["a"])(this,t),this.type="ERProperty",this.source=e,this.node=n,this.ref=e.ref,this.type=e.type,this.association=e.association,this.id=i?"".concat(n.id,"-").concat(e.name,"-navigation"):"".concat(n.id,"-").concat(e.name),this._selfLink=!1,this.parentPropertyRef=void 0,this.getJflowInstance=void 0,this.doubleRef=void 0},ye=function(){function t(e){var n=this;Object(s["a"])(this,t),this.type="ERNode",this.source=e,this.id=e.name,this.isDraggable=!0,this.getJflowInstance=void 0,this.propertyList=e.propertyList.map((function(t){return new we(t,n)})),this.navigationPropertyList=e.navigationPropertyList.map((function(t){return new we(t,n,!0)})),this.idProperty=this.propertyList.find((function(t){return"id"===t.source.name}))}return Object(c["a"])(t,[{key:"_traverseProperty",value:function(t){var e=this;this.propertyList.forEach((function(n){var i=n.source.idRef;n.source.isParentRef;if(i&&"Array"!==n.source.type&&t[i]){var o=t[i];n.source.isParentRef&&(e.parentRef=o),o===e&&(n._selfLink=!0),n.parentPropertyRef=o.idProperty}})),this.navigationPropertyList.forEach((function(n){var i=n.source.objectRef;if(i&&t[i]){var o=t[i],r=o.navigationPropertyList.find((function(t){return t.source.objectRef===e.id}));o===e&&(n._selfLink=!0),n.doubleRef=r}}))}},{key:"traverse",value:function(e){e(this),this.propertyList.forEach((function(n){n.ref instanceof t&&e(n)}))}},{key:"makeLink",value:function(t){this.propertyList.forEach((function(e){if(e.parentPropertyRef instanceof we){var n=e.parentPropertyRef;e._selfLink?t({from:e.id,to:n.id,part:"property",fromDir:y.LEFT,toDir:y.LEFT,content:e.association,minSpanX:80,meta:{from:e,to:n}}):t({from:e.id,to:n.id,part:"property",content:e.association,meta:{from:e,to:n}})}})),this.navigationPropertyList.forEach((function(e){if(e.doubleRef instanceof we){var n=e.doubleRef;e._selfLink?t({from:e.id,to:n.id,part:"property",fromDir:y.LEFT,toDir:y.TOP,lineDash:[10,5],doubleLink:!0,content:e.association,minSpanX:80,minSpanY:80,meta:{from:e,to:n}}):t({from:e.id,to:n.id,part:"property",lineDash:[10,5],doubleLink:!0,content:e.association,meta:{from:e,to:n,isObjectRef:!0}})}}))}}]),t}();function ke(t){var e={},n=t.map((function(t){var n=new ye(t);return e[t.name]=n,n}));return n.forEach((function(t){t._traverseProperty(e)})),n}var je=function(){function t(e){Object(s["a"])(this,t),this.static=!1,this.flowStack=[],this.flowLinkStack=[],this.erNodes=[],this.reOrder(e.entityRelationship)}return Object(c["a"])(t,[{key:"reOrder",value:function(t){var e=this;this.er=t,this.flowStack=[],this.flowLinkStack=[];var n=ke(this.er),i=[];n.forEach((function(t){t.traverse((function(t){e.flowStack.push({type:t.type,configs:t.source,layoutMeta:t})})),t.makeLink((function(t){var n=t.from,o=t.to,r=t.meta;if(r.isObjectRef){var a="".concat(n,"-").concat(o),s="".concat(o,"-").concat(n),c=r.from;if(i.includes(a)||i.includes(s))return;c.source.isParentRef||(i.push(a),i.push(s),e.flowLinkStack.push(t))}else e.flowLinkStack.push(t)}))})),this.erNodes=n}},{key:"staticCheck",value:function(t,e){return!1}},{key:"reflow",value:function(t){this.flowLinkStack,this.erNodes;var e={},n=1e3;function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=[0,0];return t.parentRef?e.includes(t.parentRef)?[o[0]-n/2+t.source.diagramWeight*n,o[1]]:(e.push(t.parentRef),o=i(t.parentRef,e),[o[0]-n/2+t.source.diagramWeight*n,o[1]+600]):o}this.erNodes.forEach((function(t){var n=t.getJflowInstance(),o=i(t),r=Object(a["a"])(o,2),s=r[0],c=r[1];e[c]||(e[c]=[]),e[c].push(t),n.anchor=[s+500*e[c].length,c],300}))}}]),t}(),Oe=je,xe=function(){function t(e,n){Object(s["a"])(this,t),this.type=e,this.source=n,this.needWrap=!1,this.width=0,this.reduceWidth=0,this.height=0,this.anchorX=0,this.anchorY=0,this.dirty=!0}return Object(c["a"])(t,[{key:"shift",value:function(t,e,n){if("text"===this.type){var i=this.source,o=i.length,r=t+e;return r<0?"prev":r>o?"next":"self"}return e>0?"next":e<0?"prev":void 0}},{key:"tailOffset",value:function(){return"text"===this.type?this.needWrap?this.source.length:Math.max(0,this.source.length-1):0}},{key:"headOffset",value:function(){return 0}}]),t}(),Te=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this,t),i.initStack(t),i.initLayout(t),i._lines=[],i.textColor=t.textColor||"transparent",i.fontFamily=t.fontFamily||"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Helvetica,Tahoma,Arial,Noto Sans,PingFang SC,Microsoft YaHei,Hiragino Sans GB,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji",i.fontSize=t.fontSize||"28px",i.fontWeight=t.fontWeight||"",i.elementSpace=t.elementSpace||5,i.lineSpace=t.lineSpace||5,i.resolver=function(){var e=t.resolver();return"text"!==e[e.length-1].type&&e.push(new xe("text","")),e},i._textElements=i.resolver(),i._status={editing:!1,dragover:!1,cursorshow:!0,cursoranime:null,lastElapsed:0,refreshElapsed:!1},i._cursor={row:0,column:[0,0]},i._makeFunctional(),i}return Object(c["a"])(n,[{key:"currentLineHeight",get:function(){return this.lineHeight||parseInt(this.fontSize)}},{key:"setConfig",value:function(t){Object(qt["a"])(Object(Gt["a"])(n.prototype),"setConfig",this).call(this,t)}},{key:"refreshTextElements",value:function(){this._textElements=this.resolver()}},{key:"refresh",value:function(){this.recalculateUp(),this._jflow._render()}},{key:"getBoundingDimension",value:function(){return{width:this.width,height:this.height}}},{key:"render",value:function(t){t.save(),this._isMoving?t.globalAlpha=.6:1!==this.opacity&&(t.globalAlpha=this.opacity);var e=Object(a["a"])(this.anchor,2),n=e[0],i=e[1],o=this.width,r=this.height,s=this._jflow;if(t.translate(n,i),t.beginPath(),t.rect(-o/2,-r/2,o,r),t.stroke(),t.beginPath(),t.font="".concat(this.fontWeight," ").concat(this.fontSize," ").concat(this.fontFamily),t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.textColor,this._lines.forEach((function(e){var n=e.elements;n.forEach((function(e){"text"===e.type&&t.fillText(e.source,e.anchorX,e.anchorY)}))})),this._textElements.forEach((function(e){if("text"!==e.type){var n=s.getRenderNodeBySource(e.source);n.visible&&(t.save(),n.render(t),t.restore())}})),this._status.cursorshow&&(this._status.editing||this._status.dragover)){var c,h=this._cursor,l=h.row,u=h.column,d=this._lines[l],f=d.elements,g=d.anchorY,v=Object(a["a"])(u,2),p=v[0],b=v[1],m=f[p];if("text"===m.type){var _=m.source.substring(0,b);c=m.anchorX-m.width/2+t.measureText(_).width}else c=m.anchorX-m.width/2;t.beginPath(),t.moveTo(c,g-8),t.lineTo(c,g+8),t.lineWidth=2,t.strokeStyle="#60CFC4",t.stroke()}t.translate(-n,-i),t.restore()}},{key:"_makeFunctional",value:function(){var t,e=this,n=function(n){e._status.editing=!1,t&&t.remove(),e._belongs&&e._jflow._render()};this.addEventListener("dblclick",(function(n){if(n.currentTarget===e){n.detail.bubbles=!1;var i=e._currentp,o=e._jflow;if(e._status.editing);else{e._positionToCursorOffset(i),t=Ee(e._controlCallback.bind(e));var r=o.DOMwrapper;r.append(t),t.focus(),o.setFocusInstance(e),e._status.editing=!0,e._status.cursoranime=o.requestJFlowAnime((function(t){var n=e._status.lastElapsed;e._status.refreshElapsed&&(e._status.lastElapsed=t,e._status.refreshElapsed=!1),t-n>500&&(e._status.cursorshow=!e._status.cursorshow,e._status.lastElapsed=t)}))}}})),this.addEventListener("click",(function(n){if(e._status.editing){n.detail.bubbles=!1;var i=e._currentp;e._positionToCursorOffset(i),t.focus(),e._refreshCursor()}})),this.addEventListener("blur",(function(t){n(t),e.dispatchEvent(new vt("change",{target:e,textElements:e._textElements.slice()})),e._status.cursoranime.cancel(),Object.assign(e._status,{cursorshow:!0,cursoranime:null,lastElapsed:0}),e._status.cursorshow=!0,e._status.cursoranime=null})),this.addEventListener("dragenter",(function(){var t=e._currentp;e._positionToCursorOffset(t),e._status.dragover=!0})),this.addEventListener("dragover",(function(){var t=e._currentp;e._positionToCursorOffset(t)})),this.addEventListener("dragleave",(function(){e._status.dragover=!1})),this.addEventListener("drop",(function(t){t.detail.bubbles=!1,e._status.dragover=!1;var n,i=e._cursor,o=i.row,r=i.column,s=e._lines[o],c=Object(a["a"])(r,2),h=c[0],l=c[1],u=s.elements[h],d=s.elements[h-1];"text"!==u.type&&"text"===(null===d||void 0===d?void 0:d.type)?(l=d.source.length,n=e._textElements.findIndex((function(t){return t===d}))):n=e._textElements.findIndex((function(t){return t===u})),e.dispatchEvent(new vt("insert",Object(ft["a"])(Object(ft["a"])({},t.detail),{},{textElements:e._textElements.slice(),idx:n,offset:l})))}))}},{key:"_positionToCursorOffset",value:function(t){var e=Object(a["a"])(t,2),n=e[0],i=e[1],o=Object(a["a"])(this.anchor,2),r=o[0],s=o[1],c=this.width/2,h=this.height/2,l=n-r+c,u=i-s+h,d=0,f=this._lines;while(d<f.length){if(f[d].reduceHeight>u)break;d++}this._cursor.row=d;var g=f[d],v=g.elements;if(l>=g.width){var p=v[v.length-1],b=0;"text"===p.type&&(b=p.source.length),this._cursor.column=[v.length-1,b]}else{var m=0,_=0,w=v[m].width;while(m<v.length-1){if(w>l)break;_=w,m++,w+=v[m].width}var y=v[m];if("text"===y.type){var k=l-_,j=this._calculateOffsetByWidth(k,y);this._cursor.column=[m,j]}else this._cursor.column=[m,0]}}},{key:"_calculateOffsetByWidth",value:function(t,e){var n=this,i=e.source,o=i.length-1,r=Math.floor(t/e.width);return b((function(e){var a,s;e.font="".concat(n.fontSize," ").concat(n.fontFamily);do{var c=i.substring(0,r-1),h=i.substring(0,r),l=i.substring(0,r+1),u=e.measureText(c).width,d=e.measureText(h).width,f=e.measureText(l).width;if(a=(d-u)/2+u,s=(f-d)/2+d,s<t)r+=1;else if(a>t)r-=1;else if(a<=t&&s>=t)break}while(r>=0&&r<=o)})),r}},{key:"_refreshCursor",value:function(){Object.assign(this._status,{cursorshow:!0,refreshElapsed:!0})}},{key:"_controlCallback",value:function(t,e){switch(this._refreshCursor(),t){case"Input":case"compositionstart":case"compositionupdate":case"compositionend":case"Enter":case"Backspace":this._inputControl(t,e);break;case"ArrowLeft":this._onArrowLeft();break;case"ArrowRight":this._onArrowRight();break;case"ArrowDown":this._onArrowDown();break;case"ArrowUp":this._onArrowUp();break;default:break}}},{key:"_inputControl",value:function(t,e){var n=this._cursor,i=n.row,o=n.column,r=this._lines[i],s=Object(a["a"])(o,2),c=s[0],h=s[1],l=r.elements[c],u=r.elements[c-1],d="";if("text"===l.type)d=l.source;else if("text"===(null===u||void 0===u?void 0:u.type))d=u.source,l=u,h=d.length,this._cursor.column[0]-=1,this._cursor.column[1]=d.length;else{var f=new xe("text",""),g=this._textElements.findIndex((function(t){return t===l}));this._textElements.splice(g,0,f),l=f}var v,p=d.substring(0,h);switch(v=this.cacheIdx?d.substring(this.cacheIdx[1]):d.substring(h),t){case"Input":p+=e,o[1]+=e.length,l.source=p+v,l.dirty=!0;break;case"compositionstart":this.cacheIdx=[p.length,p.length];break;case"compositionupdate":p=p.substring(0,this.cacheIdx[0]),p+=e,l.source=p+v,l.dirty=!0,o[1]=this.cacheIdx[0]+e.length,this.cacheIdx[1]=this.cacheIdx[0]+e.length;break;case"compositionend":p=p.substring(0,this.cacheIdx[0]),o[1]=this.cacheIdx[0]+e.length,this.cacheIdx=null,p+=e,l.source=p+v,l.dirty=!0;break;case"Enter":l.source=p,l.dirty=!0,l.needWrap=!0;var b=new xe("text",v),m=this._textElements.findIndex((function(t){return t===l}));b.needWrap=m!==this._textElements.length-1,this._textElements.splice(m+1,0,b),this._cursor.row+=1,this._cursor.column=[0,0];break;case"Backspace":var _=l.shift(h,-1);switch(_){case"prev":var w=this._textElements.findIndex((function(t){return t===l}));if(c>0){this._textElements.splice(w-1,1),w-=1,l.source=v,l.dirty=!0;var y=this._blandAdjacentElement(this._textElements[w-1],l,w);this._cursor.column=[c-(y>0?2:1),y]}else if(w>0){var k=i-1,j=this._lines[k].elements.length-1,O=this._blandAdjacentElement(this._textElements[w-1],l,w);this._cursor.row=k,this._cursor.column=[j,O]}break;case"self":p=p.substring(0,p.length-1),o[1]-=1,l.source=p+v,l.dirty=!0;break}break}this.recalculateUp(),this._jflow._render()}},{key:"_onArrowLeft",value:function(){var t=this._cursor,e=t.row,n=t.column,i=Object(a["a"])(n,2),o=i[0],r=i[1],s=this._lines[e].elements,c=s[o],h=this._textElements.findIndex((function(t){return t===c})),l=c.shift(r,-1);switch(l){case"prev":if(o>0){var u=s[o-1];this._cursor.column=[o-1,u.tailOffset()]}else if(h>0){var d=e-1,f=this._lines[d].elements.length-1,g=this._textElements[h-1].tailOffset();this._cursor.row=d,this._cursor.column=[f,g]}this._jflow._render();break;case"self":n[1]-=1,this._jflow._render();break}}},{key:"_onArrowRight",value:function(){var t=this._cursor,e=t.row,n=t.column,i=Object(a["a"])(n,2),o=i[0],r=i[1],s=this._lines[e].elements,c=s[o],h=this._textElements.findIndex((function(t){return t===c})),l=c.shift(r,1,h===this._textElements.length-1);switch(l){case"next":if(o<s.length-1){var u=s[o+1];"text"===c.type&&"text"!==u.type?this._cursor.column=[o+2,u.headOffset()]:this._cursor.column=[o+1,u.headOffset()]}else if(h<this._textElements.length-1){var d=e+1,f=this._textElements[h+1].headOffset();this._cursor.row=d,this._cursor.column=[0,f]}this._jflow._render();break;case"self":n[1]+=1,this._jflow._render();break}}},{key:"_onArrowDown",value:function(){var t=this._cursor.row,e=this._lines.length;t+1<e&&this._ArrowVerticalHanlder(t+1)}},{key:"_onArrowUp",value:function(){var t=this._cursor.row;t-1>-1&&this._ArrowVerticalHanlder(t-1)}},{key:"_ArrowVerticalHanlder",value:function(t){var e=this,n=this._cursor,i=n.row,o=n.column,r=Object(a["a"])(o,2),s=r[0],c=r[1],h=this._lines[i].elements[s],l=h.reduceWidth;c>0&&b((function(t){t.font="".concat(e.fontSize," ").concat(e.fontFamily),l+=t.measureText(h.source.substring(0,c)).width}));var u=this._lines[t];if(u.width<l){var d=u.elements.length-1,f=u.elements[d];this._cursor.row=t,this._cursor.column=[d,f.tailOffset()]}else{var g=u.elements.slice(),v=0;while(g.length){var p=g.shift();if(p.reduceWidth+p.width>l){var m=l-p.reduceWidth;if("text"===p.type){var _=this._calculateOffsetByWidth(m,p);this._cursor.row=t,this._cursor.column=[v,_]}else if(this._cursor.row=t,m<p.width/2){var w=p[v-1];"text"===(null===w||void 0===w?void 0:w.type)?this._cursor.column=[v-1,p.tailOffset()]:this._cursor.column=[v,p.headOffset()]}else this._cursor.column=[v+1,p.headOffset()];break}v++}}this._jflow._render()}},{key:"getBoundingRect",value:function(){var t=this.anchor,e=this.width/2,n=this.height/2,i=t[0]-e,o=t[1]-n,r=t[0]+e,a=t[1]+n;return[i,o,r,a]}},{key:"_calculatePointBack",value:function(t){var e=Object(a["a"])(t,2),n=e[0],i=e[1],o=Object(a["a"])(this.anchor,2),r=o[0],s=o[1],c=[n-r,i-s];return c}},{key:"isHit",value:function(t,e){var n=this._calculatePointBack(t),i=this._jflow;this._currentp=n;var o=[];this._textElements.forEach((function(t){if("text"!==t.type){var e=i.getRenderNodeBySource(t.source);e.visible&&o.push(e)}}));var r=this._stack.checkHit(n,e,(function(t){return o.includes(t)}));if(r)return r;var a=this.anchor,s=this.width/2,c=this.height/2;return t[0]>a[0]-s&&t[0]<a[0]+s&&t[1]>a[1]-c&&t[1]<a[1]+c}},{key:"_blandAdjacentElement",value:function(t,e,n){if(!t)return 0;if("text"===t.type&&"text"===e.type){var i=t.source.length;return t.source+=e.source,t.dirty=!0,t.needWrap=e.needWrap,this._textElements.splice(n,1),i}return 0}}]),n}(V);Object.assign(Te.prototype,it),Object.assign(Te.prototype,rt),Object.assign(Te.prototype,{_getBoundingGroupRect:function(){},resetChildrenPosition:function(){},reflow:function(){var t=this,e=this.currentLineHeight,n=this._jflow;b((function(e){e.font="".concat(t.fontSize," ").concat(t.fontFamily),t._textElements.forEach((function(t){"text"===t.type&&t.dirty&&(t.width=e.measureText(t.source).width,t.dirty=!1)}))}));var i={width:0,height:e,elements:[]},o=[i],r=0,a=0,s=null,c=this.lineSpace;this._textElements.forEach((function(h){if(i.elements.push(h),h.reduceWidth=i.width,"text"===h.type)i.width+=h.width,h.needWrap&&(r+=i.height+c,i.reduceHeight=r,a=Math.max(i.width,a),i={width:0,height:e,elements:[],reduceHeight:0},o.push(i));else{var l,u=n.getRenderNodeBySource(h.source);i.height=Math.max(i.height,u.height);var d="text"!==(null===(l=s)||void 0===l?void 0:l.type)?t.elementSpace:2*t.elementSpace;i.width+=u.width+d}s=h})),r+=i.height,i.reduceHeight=r,a=Math.max(i.width,a);var h=r/2,l=a/2,u=-h,d=0;o.forEach((function(e){var i=e.height,o=e.elements,r=e.reduceHeight,a=u+d+i/2;e.anchorY=a;var s=-l,c=null;o.forEach((function(e){if("text"!==e.type){var i=n.getRenderNodeBySource(e.source),o="text"!==(null===c||void 0===c?void 0:c.type)?t.elementSpace:2*t.elementSpace;e.width=i.width+o,e.anchorY=a,e.anchorX=s+e.width/2+o/2,i.anchor=[e.anchorX,e.anchorY],s+=e.width+o/2}else e.anchorY=a,e.anchorX=s+e.width/2,s+=e.width})),d=r})),this._lines=o,this.width=a,this.height=r}});var Se=Te;function Ee(t){var e=document.createElement("input");e.setAttribute("style","\n        width: 100%;\n        position: absolute;\n        left: 0;\n        top: 0;\n        border:none;\n        opacity: 0;\n        z-index: -1;\n        contain: strict;"),e.setAttribute("tabindex",-1),e.setAttribute("aria-hidden",!0),e.setAttribute("spellcheck",!1),e.setAttribute("autocorrect","off");var n=!1;return e.addEventListener("beforeinput",(function(e){e.preventDefault(),e.data&&(n||t("Input",e.data))})),e.addEventListener("compositionstart",(function(e){t("compositionstart"),n=!0})),e.addEventListener("compositionupdate",(function(e){t("compositionupdate",e.data)})),e.addEventListener("compositionend",(function(i){t("compositionend",i.data),e.value="",n=!1})),e.addEventListener("keydown",(function(e){switch(e.code){case"Enter":t("Enter");break;case"Backspace":t("Backspace");break;case"ArrowLeft":t("ArrowLeft");break;case"ArrowRight":t("ArrowRight");break;case"ArrowDown":t("ArrowDown");break;case"ArrowUp":t("ArrowUp");break}})),e}var Ce=kt(Tt),Me=kt(Et),Ie=kt(Bt),Be=kt(Pt,{shapeShift:function(t,e){return[t+.28865*e,e]}}),Le=kt(Rt,{shapeShift:function(t,e){return[t,e+.5773*t]}}),Pe=kt(Mt),De=kt(Ot,{shapeShift:function(t,e,n){var i=Math.ceil(Math.sqrt(t*t+e*e)/2);n.radius=i;var o=2*i;return[o,o]}}),Re=function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(t){var i;return Object(s["a"])(this,n),i=e.call(this),i.uniqueName="jflow",i.eventAdapter=new mt(t.eventAdapter),i.initNodeWeakMap(),i.initAnime(),i.initStack(t),i.initLayout(t),i.ctx=null,i.canvas=null,i.dpr=1,i.padding=20,i.position=null,i.scale=null,i.initialZoom=t.initialZoom,i.initialPosition=t.setInitialPosition,i.maxZoom=t.maxZoom||3,i.minZoom=t.minZoom||.5,i.NodeRenderTop=!!t.NodeRenderTop,i.worldMargin=t.worldMargin,i.draggingbehavior=Object.assign({panInBorder:{enable:!0,padding:20,deltamovement:8,allowMovingTargetInPan:!0}},t.draggingbehavior||{}),i.scrollBarBehavior=Object.assign({enable:!0},t.scrollBarBehavior||{}),i.offeset=null,i._lastState={x:null,y:null,dragging:!1,processing:!1},i._lastDragState={target:null,targetLink:null,processing:!1},i._target={instance:null,link:null,moving:null,isInstanceDirty:!1,isLinkDirty:!1,cache:{stack:null,belongs:null,point:null},meta:{x:void 0,y:void 0,initialX:void 0,initialY:void 0},status:{dragovering:!1,dragging:!1,processing:!1,movingState:!1}},i._focus={instance:null},i._dragOverTarget=null,i.allowDrop=t.allowDrop,i._tempNode=null,i._tempLink=null,i.mode=j.DEFAULT,i._allowMovingTarget=!0,i}return Object(c["a"])(n,[{key:"setMovingTargets",value:function(t){Object.assign(this._target,{moving:t})}},{key:"setTempDraggingInstance",value:function(t){t._belongs=this,this._tempNode=t,Object.assign(this._target,{moving:[this._tempNode],dragging:!0})}},{key:"removeTempDraggingInstance",value:function(){if(this._tempNode){var t=this._tempNode.anchor;return this._tempNode=null,t}}},{key:"preventDefaultDragging",value:function(){this._allowMovingTarget=!1}},{key:"allowDefaultDragging",value:function(){this._allowMovingTarget=!0}},{key:"$mount",value:function(t){var e=this,n=d(t),i=n.canvas,o=n.ctx,r=n.scale,a=n.width,s=n.height,c=n.raw_width,h=n.raw_height;n.left,n.top;this.reflow(),this.ctx=o,this.DOMwrapper=t,this.canvas=i,this.canvas.setAttribute("data-jflow",!0),this.canvas.$jflow=this,this.canvasMeta={width:c,height:h,actual_width:a,actual_height:s},this.dpr=r,this._getBoundingGroupRect();var l,u=this.padding,f=this.bounding_box,g=f.width,v=f.height,p=f.x,b=f.y,_={x:u,y:u,width:a-2*u,height:s-2*u},w={x:0,y:0,offsetX:0,offsetY:0},y=_.width/g,k=_.height/v,j=y<=k?"x":"y";l=this.initialZoom?this.initialZoom:Math.min(y,k),this.scale=l,l>this.maxZoom&&(this.maxZoom=l),l<this.minZoom&&(this.minZoom=l);var O=p*l,x=b*l,T=_.width,S=_.height;if(this.initialPosition){var E=this.initialPosition(O,x,T,S,_.x,_.y,a,s,p,b,g,v),C=E.x,M=E.y;w.x=C,w.y=M}else w.x="x"===j?_.x:(T-g*l)/2+u,w.y="y"===j?_.y:(S-v*l)/2+u;w.offsetX=w.x-O,w.offsetY=w.y-x,this.position=w,this._readyToRender=!0,this.scrollBarBehavior.enable&&this.initScrollBar(this.scrollBarBehavior),this.scheduleRender((function(){e._createEventHandler()})),m((function(t){e.dpr=t,e.scheduleRender()}))}},{key:"setLinkingMode",value:function(t,e,n){var i=this.getRenderNodeBySource(t);this._tempNode=new U,this._tempLink=e(n?{from:this._tempNode,to:i}:{from:i,to:this._tempNode}),this.sendMessage({instance:t}),this.mode=j.LINKING}},{key:"isInLinkingMode",value:function(){return this.mode===j.LINKING}},{key:"setLinkingLink",value:function(t){this.mode===j.LINKING&&this._tempLink.setConfig(t)}},{key:"resetLinkingLink",value:function(){this.mode===j.LINKING&&this._tempLink.setConfig({to:this._tempNode})}},{key:"clearTemp",value:function(){this._tempNode&&(this._tempNode.destroy(),this._tempNode=null),this._tempLink&&(this._tempLink.destroy(),this._tempLink=null),this._render()}},{key:"preventClearTemp",value:function(){this._preventClearTemp=!0}},{key:"resizeCanvas",value:function(){var t=f(this.canvas,this.DOMwrapper),e=t.width,n=t.height,i=t.raw_width,o=t.raw_height;this.canvasMeta={width:i,height:o,actual_width:e,actual_height:n}}},{key:"setFocusInstance",value:function(t){this._focus.instance=t}},{key:"focusOn",value:function(t){var e=this._calculatePointBack([this.canvasMeta.actual_width/2,this.canvasMeta.actual_height/2]),n=t.anchor;t._belongs.calculateToCoordination&&(n=t._belongs.calculateToCoordination(n));var i=(e[0]-n[0])*this.scale,o=(e[1]-n[1])*this.scale;this._recalculatePosition(i,o),this._render()}},{key:"_getBoundingGroupRect",value:function(){var t=this._stack.getBoundingRectPoints();if(this.bounding_box){this.bounding_box=O(t);var e=this.bounding_box,n=e.x,i=e.y,o=this.scale;this.position.x=this.position.offsetX+n*o,this.position.y=this.position.offsetY+i*o}else this.bounding_box=O(t)}},{key:"_createEventHandler",value:function(){var t,e=this,n=this.canvas;this.eventAdapter.apply(this);var i=function(){e.eventAdapter.unload(e)};if(t=i,this.allowDrop){var o=this._onDragover.bind(this),r=this._onDrop.bind(this),a=this._onDragLeave.bind(this);n.addEventListener("dragstart",(function(t){t.preventDefault()})),n.addEventListener("dragover",o),n.addEventListener("drop",r),n.addEventListener("dragleave",a),t=function(){i(),n.removeEventListener("dragover",o),n.removeEventListener("drop",r),n.removeEventListener("dragleave",a)}}this.destroy=t}},{key:"_targetLockOn",value:function(t,e){var n=this,i=this._calculatePointBack(t),o=i;this._currentp=i;var r,a=this._stack,s=this._getViewBox(),c=a.checkHit(i,(function(t){return n._target.status.dragging&&t===n._getMovingTarget()}),(function(t){return N(s,t.getBoundingRect())})),h=this._linkStack,l=this;if(c&&c._belongs!==this||(r=h.checkHit(i,(function(t){if(!n._target.status.dragging)return!1;var e=n._getMovingTarget();return t.from===e||t.to===e}))),r||(r=h.checkHit(i,(function(t){return!t.ON_TOP}))),Object.assign(this._target,{instance:c,link:r,isInstanceDirty:c===this._target.instance,isLinkDirty:r===this._target.link}),Object.assign(this._target.cache,{stack:a,belongs:l,point:i,topLayerPoint:o}),Object.assign(this._target.meta,{x:t[0],y:t[1]}),"pressStart"===e&&!this._target.status.dragging&&!this._target.status.dragovering){var u=c;while(u&&u._belongs.lock&&u!==this)u=u._belongs;this.setMovingTargets(u&&[u]),u&&c.bubbleEvent(new vt("afterResolveMovingTarget",{event:e,target:u,jflow:this,bubbles:!0}))}return["pressStart","click","dblclick","contextclick"].includes(e)&&this._focus.instance&&this._focus.instance!==c&&(this._focus.instance.dispatchEvent(new vt("blur",{relatedTarget:c})),this._focus.instance=null),this._target}},{key:"_getMovingTarget",value:function(){return this._target.moving&&this._target.moving[0]}},{key:"_processDragOver",value:function(t,e){if(this._dragOverTarget!==t){var n,i=null===(n=this.readMessage())||void 0===n?void 0:n.instance;this._dragCurrentData=i;var o=this._target.cache.point;if(this._dragOverTarget){var r=this._dragOverTarget;r.dispatchEvent(new vt("dragleave",{event:e,instance:r,target:i,jflow:this,point:o}))}t&&t.dispatchEvent(new vt("dragenter",{event:e,instance:t,target:i,jflow:this,point:o})),this._dragOverTarget=t}else this._dragOverTarget&&this._dragOverTarget.dispatchEvent(new vt("dragover",{event:e,instance:t,jflow:this,target:this._dragCurrentData}));this._processPanInBorder()}},{key:"_processPanInBorder",value:function(){var t,e,n=this;if(null!==(t=this.draggingbehavior)&&void 0!==t&&null!==(e=t.panInBorder)&&void 0!==e&&e.enable&&(this.draggingbehavior.panInBorder.timer||(this.draggingbehavior.panInBorder.timer=Date.now()),Date.now()-this.draggingbehavior.panInBorder.timer>500)){var i=Object(a["a"])(this._cacheViewBox,4),o=i[0],r=i[1],s=i[2],c=i[3],h=Object(a["a"])(this._currentp,2),l=h[0],u=h[1],d=this.draggingbehavior.panInBorder,f=d.padding,g=d.deltamovement,v=0,p=0;l<o+f&&(v=g),l>s-f&&(v=-g),u<r+f&&(p=g),u>c-f&&(p=-g),this.__processOverAnime&&this.__processOverAnime.cancel(),v||p?this.__processOverAnime=this.requestJFlowAnime((function(){n.panHandler(v,p)})):this.draggingbehavior.panInBorder.timer=null}}},{key:"_onDragover",value:function(t){var e=this;if(t.preventDefault(),t.stopPropagation(),!this._lastDragState.processing){this._lastDragState.processing=!0;var n=t.offsetX,i=t.offsetY;Object.assign(this._target.status,{dragovering:!0}),this._targetLockOn([n,i]);var o=this._target.instance||this._target.link;this._processDragOver(o,t),this._target.isLinkDirty||this._target.isInstanceDirty?Promise.resolve().then((function(){e._render(),e._target.isLinkDirty=!1,e._target.isInstanceDirty=!1,e._lastDragState.processing=!1})):this._lastDragState.processing=!1}}},{key:"_cancelPanInBorder",value:function(){var t;this.__processOverAnime&&this.__processOverAnime.cancel(),null!==(t=this.draggingbehavior)&&void 0!==t&&t.panInBorder&&(this.draggingbehavior.panInBorder.timer=null)}},{key:"_onDragLeave",value:function(){this._cancelPanInBorder()}},{key:"_onDrop",value:function(t){var e=this;this._cancelPanInBorder();var n=this.consumeMessage(),i=n.instance;if(this._dragOverTarget){var o=this._dragOverTarget;o.dispatchEvent(new vt("dragoverend",{event:t,instance:o})),this._dragOverTarget=null}var r=this._target,a=r.link,s=r.instance,c=this._target.cache,h=c.point,l=c.belongs;a?a.dispatchEvent(new vt("drop",{event:t,instance:i,link:a,jflow:this,belongs:l,point:h})):s?s.bubbleEvent(new vt("drop",{event:t,instance:i,jflow:this,target:s,point:h,bubbles:!0})):this.dispatchEvent(new vt("drop",{event:t,instance:i,jflow:this,target:s,point:h})),requestAnimationFrame((function(){e.cancelDrop()}))}},{key:"cancelDrop",value:function(){this._target.instance=null,this._target.link=null,Object.assign(this._target.status,{dragovering:!1})}},{key:"zoomHandler",value:function(t,e,n,i,o){var r=this;if(!this._zooming){this._zooming=!0;var a=this.bounding_box,s=a.width,c=a.height,h=(a.x,a.y,this.canvasMeta),l=h.actual_width,u=h.actual_height,d=this.minZoom;if(this.worldMargin){var f=this.worldMargin,g=s+2*f,v=c+2*f;d=Math.max(d,Math.max(l/g,u/v))}var p=this.scale,b=i>0?1.1:1/1.1;p*=b,p=Math.min(this.maxZoom,Math.max(d,p));var m=p-this.scale,_=s*this.scale,w=c*this.scale,y=s*m,k=c*m,j=t-this.position.x,O=e-this.position.y,x=-j/_,T=-O/w;this.scale=p,this._recalculatePosition(x*y,T*k),this.dispatchEvent(new vt("zoompan",{deltaX:0,deltaY:0})),this.scheduleRender((function(){r._zooming=!1}))}}},{key:"panHandler",value:function(t,e,n){var i=this;if(!this._panning){this._panning=!0;var o=this._target.status.dragging;if(o){var r=this._target.moving;r&&this.draggingbehavior.panInBorder.allowMovingTargetInPan&&r.forEach((function(n){n.anchor[0]+=-t/i.scale,n.anchor[1]+=-e/i.scale}))}this._recalculatePosition(t,e),this.dispatchEvent(new vt("zoompan",{deltaX:t,deltaY:e})),this.scheduleRender((function(){i._panning=!1}))}}},{key:"pressStartHandler",value:function(t,e,n){if(!this.checkScrollDragging()){Object.assign(this._target.meta,{initialX:t,initialY:e});var i=this._targetLockOn([t,e],"pressStart"),o=i.link,r=i.instance;if(this.mode!==j.LINKING){if(Object.assign(this._target.status,{dragging:!0,processing:!1}),this._target.moving){var a=this._getMovingTarget();a.dispatchEvent(new vt("pressStart",{event:n,instance:a,jflow:this}))}var s=this._resolveLockOnTarget(o,r);s&&s.bubbleEvent(new vt("instancePressStart",{event:n,target:s,jflow:this,bubbles:!0})),this.dispatchEvent(new vt("jflowPressStart",{event:n,jflow:this}))}}}},{key:"pressMoveHandler",value:function(t,e,n){var i=this;if(!this.checkScrollDragging()){var o=this._target.status,r=o.dragging,a=o.processing,s=this._target.meta,c=s.x,h=s.y;if(!r){if(this.checkScrollBarHover(t,e))return;this.resetScrollBarHover()}if(!r&&!a){var l=this._targetLockOn([t,e]),u=l.link,d=l.instance,f=this._resolveLockOnTarget(u,d);if(f?f.bubbleEvent(new vt("instancemousemove",{event:n,instance:f,jflow:this,bubbles:!0})):this.dispatchEvent(new vt("instancemousemove",{event:n,instance:null,jflow:this})),this.mode===j.LINKING)return this._tempNode.anchor=this._currentp,this.scheduleRender((function(){i._target.isLinkDirty=!1,i._target.isInstanceDirty=!1,i._target.status.processing=!1})),void this._processPanInBorder()}if(this.dispatchEvent(new vt("canvasmousemove",{event:n,jflow:this})),r&&!a){var g=this._target.moving;this._target.status.movingState=!0,this._target.status.processing=!0;var v=t-c,p=e-h;g?this._allowMovingTarget&&g.forEach((function(t){t.anchor[0]+=v/i.scale,t.anchor[1]+=p/i.scale})):(this._recalculatePosition(v,p),this.dispatchEvent(new vt("zoompan",{deltaX:v,deltaY:p})));var b=this._targetLockOn([t,e]),m=b.instance,_=b.link;this._processDragOver(m||_,n),this.scheduleRender((function(){i._target.isLinkDirty=!1,i._target.isInstanceDirty=!1,i._target.status.processing=!1}))}}}},{key:"pressUpHanlder",value:function(t,e){this.__processOverAnime&&this.__processOverAnime.cancel(),this._cancelPanInBorder();this._target.meta;if(this.mode===j.LINKING){var n=this._target.instance,i=this.consumeMessage();if(n)n.bubbleEvent(new vt("link",{event:e,target:n,jflow:this,payload:i,bubbles:!0,link:this._tempLink}));else{var o=e.offsetX,r=e.offsetY;this.dispatchEvent(new vt("link",{event:e,jflow:this,payload:i,anchor:this._calculatePointBack([o,r]),link:this._tempLink}))}return this._clearTarget(),this._preventClearTemp||(this._tempNode&&(this._tempNode.destroy(),this._tempNode=null),this._tempLink&&(this._tempLink.destroy(),this._tempLink=null)),this._preventClearTemp=!1,this.mode=j.DEFAULT,void this._render()}if(this._target.moving){var a=!1;if(this._layout.static&&(a=this.staticCheck(this._getMovingTarget())),!a&&this._target.link){var s=this._target.cache,c=(s.point,s.belongs),h=this._target.link,l=this._getMovingTarget();h.dispatchEvent(new vt("drop",{event:e,instance:l,link:h,jflow:this,belongs:c})),this._target.link=null,this._target.instance=null}this._target.moving&&(this._target.instance?this._target.instance.bubbleEvent(new vt("pressEnd",{event:e,instance:this._getMovingTarget(),jflow:this,target:this._target.instance,bubbles:!0})):this.dispatchEvent(new vt("pressEnd",{event:e,instance:this._getMovingTarget(),jflow:this}))),this._target.moving=null,this.removeTempDraggingInstance(),this._render()}this._clearTarget()}},{key:"clickHanlder",value:function(t,e,n){var i=this._targetLockOn([t,e],"click"),o=i.link,r=i.instance,a=i.meta;if(Math.abs(a.initialX-a.x)<1&&Math.abs(a.initialY-a.y)<1){if(n.target!==this.canvas)return this._clearTarget(),void Object.assign(this._target.meta,{initialX:void 0,initialY:void 0});var s=this._target.cache.topLayerPoint,c=this._resolveLockOnTarget(o,r);if(c){var h=c;h.bubbleEvent(new vt("click",{event:n,jflow:this,target:h,topLayerPoint:s,bubbles:!0}))}else this.dispatchEvent(new vt("click",{event:n,jflow:this,topLayerPoint:s}));this._clearTarget(),Object.assign(this._target.meta,{initialX:void 0,initialY:void 0})}}},{key:"contextMenuHanlder",value:function(t,e,n){var i=this._targetLockOn([t,e],"contextclick"),o=i.link,r=i.instance,a=this._target.cache.topLayerPoint,s=this._resolveLockOnTarget(o,r);if(s){var c=s;c.bubbleEvent(new vt("contextclick",{event:n,jflow:this,target:c,topLayerPoint:a,bubbles:!0}))}else this.dispatchEvent(new vt("contextclick",{event:n,jflow:this,topLayerPoint:a}))}},{key:"dblclickHandler",value:function(t,e,n){var i=this._targetLockOn([t,e],"dblclick"),o=i.link,r=i.instance,a=this._target.cache.topLayerPoint,s=this._resolveLockOnTarget(o,r);if(s){var c=s;c.bubbleEvent(new vt("dblclick",{event:n,jflow:this,target:c,topLayerPoint:a,bubbles:!0}))}else this.dispatchEvent(new vt("dblclick",{event:n,jflow:this,topLayerPoint:a}))}},{key:"_resolveLockOnTarget",value:function(t,e){return null!==t&&void 0!==t&&t.ON_TOP?t:e||t}},{key:"_clearTarget",value:function(){Object.assign(this._target.meta,{x:void 0,y:void 0}),Object.assign(this._target.status,{dragging:!1,processing:!1,movingState:!1}),Object.assign(this._target,{instance:null,link:null,moving:null})}},{key:"_recalculatePosition",value:function(t,e,n){var i=this.bounding_box,o=i.x,r=i.y,a=i.width,s=i.height,c=this.canvasMeta,h=c.actual_width,l=c.actual_height;if(void 0===n&&(n=this.scale),this.worldMargin){var u=this.worldMargin,d=(o+a+u)*n-h,f=(o-u)*n,g=o*n,v=this.position.x+t,p=v-g;this.position.offsetX=Math.min(Math.max(-d,p),-f),this.position.x=this.position.offsetX+g;var b=(r+s+u)*n-l,m=(r-u)*n,_=r*n,w=this.position.y+e,y=w-_;this.position.offsetY=Math.min(Math.max(-b,y),-m),this.position.y=this.position.offsetY+_}else this.position.x+=t,this.position.y+=e,this.position.offsetX=this.position.x-o*n,this.position.offsetY=this.position.y-r*n}},{key:"calculateToRealWorld",value:function(t){var e=this.scale,n=this.position;return[t[0]*e+n.offsetX,t[1]*e+n.offsetY]}},{key:"_calculatePointBack",value:function(t){var e=this.scale,n=this.position;return[(t[0]-n.offsetX)/e,(t[1]-n.offsetY)/e]}},{key:"_calculateDistance",value:function(t){var e=this.scale;return e*t}},{key:"_resetTransform",value:function(){var t=this.canvasMeta,e=t.width,n=t.height,i=this.position,o=this.scale,r=this.ctx;r.setTransform(),r.clearRect(0,0,e,n),r.scale(this.dpr,this.dpr),r.transform(o,0,0,o,i.offsetX,i.offsetY)}},{key:"resetTransform",value:function(t){var e=this.position,n=this.scale;t.setTransform(),t.scale(this.dpr,this.dpr),t.transform(n,0,0,n,e.offsetX,e.offsetY)}},{key:"_getViewBox",value:function(){var t=[].concat(Object(r["a"])(this._calculatePointBack([0,0])),Object(r["a"])(this._calculatePointBack([this.canvasMeta.actual_width,this.canvasMeta.actual_height])));return this._cacheViewBox=t,t}},{key:"setNodeToTopLayer",value:function(t){var e=this._stack.findIndex((function(e){return e===t}));if(-1!==e){var n=this._stack.splice(e,1),i=Object(a["a"])(n,1),o=i[0];this._stack.push(o)}}},{key:"getCacheViewBox",value:function(){return this._cacheViewBox}},{key:"_render",value:function(){this.scheduleRender()}},{key:"__render",value:function(){if(this._readyToRender){this.runAnimeFrame(),this._resetTransform();var t=this.ctx;this.dispatchEvent(new vt("beforeJflowRender",{ctx:t}));var e=this._getViewBox();this._viewBox=e,this.NodeRenderTop?(this._linkStack.render(t,(function(t){return!t.ON_TOP&&t.isInViewBox(e)})),this._stack.render(t,(function(t){var n=N(e,t.getBoundingRect());return t._isInViewBox=n,n})),this._linkStack.render(t,(function(t){return t.ON_TOP&&t.isInViewBox(e)}))):(this._stack.render(t,(function(t){var n=N(e,t.getBoundingRect());return t._isInViewBox=n,n})),this._linkStack.render(t,(function(t){return t.isInViewBox(e)}))),this._tempNode&&(t.save(),this._tempNode.render(t),t.restore()),this._tempLink&&(t.save(),this._tempLink.isInViewBox(e),this._tempLink.render(t),t.restore()),this.dispatchEvent(new vt("afterJflowRender",{ctx:t})),this.renderScrollBar(t)}}}]),n}(Object(u["a"])(EventTarget));Object.assign(Re.prototype,st),Object.assign(Re.prototype,it),Object.assign(Re.prototype,rt),Object.assign(Re.prototype,Q),Object.assign(Re.prototype,ct),Object.assign(Re.prototype,ht),Object.assign(Re.prototype,dt),Object.assign(Re.prototype,ut);var Ae=Re,Fe={provide:function(){return{addToStack:this.addToStack,addToLinkStack:this.addToLinkStack,removeFromStack:this.removeFromStack,removeFromLinkStack:this.removeFromLinkStack}},data:function(){return{stack:[]}},methods:{addToStack:function(t,e){this._jflowInstance.addToStack(t),e&&t._jflow.setRenderNodeBySource(e,t)},addToLinkStack:function(t,e,n){this._jflowInstance.addToLinkStack(t),e&&n&&t._jflow.addLinkNodeBySource(e,n,t)},removeFromStack:function(t){this._jflowInstance.removeFromStack(t)},removeFromLinkStack:function(t,e,n){this._jflowInstance.removeFromLinkStack(t),e&&n&&t._jflow.removeLinkNodeBySource(e,n,t)},onStackChangeHandler:function(){this._jflowInstance.recalculate(),this._jflowInstance.reflow()}}},Ne={mixins:[Fe],provide:function(){return{renderJFlow:this.renderJFlow,getJFlow:this.getInstance}},props:{configs:{type:Object,default:function(){return{}}},loading:Boolean,genVueComponentKey:{type:Function}},data:function(){return{renderNodes:[],renderLinks:[]}},render:function(t){var e=this;if(this.renderNodes.length){var n=this.renderNodes.map((function(t){var n=t.type,i=t.source,o=t.layoutNode;if(!e.$scopedSlots[n]){if(!e.$scopedSlots["jflowcommon"])return;n="jflowcommon"}if(o.__vnode__)return o.__vnode__;var r=e.$scopedSlots[n]({source:i,layoutNode:o}),s=Object(a["a"])(r,1),c=s[0];return e.genVueComponentKey&&(c.key=e.genVueComponentKey(i)),o.__vnode__=c,c})),i=this.renderLinks.map((function(t){var n=t.type||"plainlink";if(!e.$scopedSlots[n])return null;if(t.__vnode__)return t.__vnode__;var i=e.$scopedSlots[n]({configs:t}),o=Object(a["a"])(i,1),r=o[0];if(e.genVueComponentKey){var s=e.genVueComponentKey(t.from.source),c=e.genVueComponentKey(t.to.source),h=t.part;r.key="".concat(s,"-").concat(c,"-").concat(h)}return t.__vnode__=r,r}));return t("div",[].concat(Object(r["a"])(n),Object(r["a"])(i)))}return t("div",this.$slots.default)},created:function(){this._jflowInstance=new Ae(this.configs),this.genNodeLinkMeta(),this.loadingNodes()},beforeDestroy:function(){this._jflowInstance.destroy()},methods:{loadingNodes:function(){var t=this;this.$emit("update:loading",!0);var e=0,n=function n(){var i=e+100,o=t.links.slice(e,i);o.length?(t.renderLinks=t.renderLinks.concat(o),e=i,requestAnimationFrame(n)):requestAnimationFrame(t.mountJFlow.bind(t))},i=function i(){var o=e+100,r=t.nodes.slice(e,o);r.length?(t.renderNodes=t.renderNodes.concat(r),e=o,requestAnimationFrame(i)):(e=0,requestAnimationFrame(n))};requestAnimationFrame(i)},mountJFlow:function(){var t=this;this._jflowInstance.$mount(this.$el),Object.keys(this.$listeners).map((function(e){var n=t.$listeners[e].bind(t);t._jflowInstance.addEventListener(e,n)})),this.$emit("update:loading",!1)},genNodeLinkMeta:function(){var t=this;this.nodes=this._jflowInstance._layout.flowStack.map((function(e){e.type;var n,i=e.layoutNode,o=e.source,r=t._jflowInstance.source_Layout_Render_NodeMap;return n=r.has(o)?r.get(o):r.set(o),n.layoutNode=i,e})),this.links=this._jflowInstance._layout.flowLinkStack.slice()},syncNodeLink:function(){this.renderNodes=this.nodes.slice(),this.renderLinks=this.links.slice()},reflow:function(t,e){var n=this;this.genNodeLinkMeta(),this.syncNodeLink(),this.$nextTick((function(){t&&t(),n._jflowInstance.recalculate(),n._jflowInstance.scheduleRender((function(){e&&e()}))}))},getInstance:function(){return this._jflowInstance},renderJFlow:function(){var t=this;this.__renderInSchedule__||(this.__renderInSchedule__=!0,this.$nextTick((function(){t._jflowInstance._render(),t.__renderInSchedule__=!1})))}}},He=n("dd43"),We=n.n(He),Ye=function(t){var e="string"===typeof t?i[t]:t;return{inject:["addToStack","removeFromStack"],props:{configs:{type:Object,default:function(){return{}}},visible:{type:Boolean,default:!0},source:{type:Object}},watch:{configs:function(t,e){var n=We()(t,e);0!==Object.keys(n).length&&this._jflowInstance.setConfig(t)},$listeners:function(t,e){var n=this,i=[],o=[],r=Object.keys(t).map((function(e){return{event:e,handler:t[e]}})),a=Object.keys(e).map((function(t){return{event:t,handler:e[t]}}));r.forEach((function(t){var e=t.handler;a.find((function(t){return t.handler===e}))||i.push(t)})),a.forEach((function(t){var e=t.handler;r.find((function(t){return t.handler===e}))||o.push(t)})),i.forEach((function(t){n._jflowInstance.addEventListener(t.event,t.handler)})),o.forEach((function(t){n._jflowInstance.removeEventListener(t.event,t.handler)}))},visible:function(t){this._jflowInstance.visible=t},source:function(t){this._jflowInstance._jflow.setRenderNodeBySource(t,this._jflowInstance)}},render:function(t){return null},created:function(){this._jflowInstance=new e(this.configs),this._jflowInstance.visible=this.visible,this.bindListeners(),this.addToStack(this._jflowInstance,this.source)},destroyed:function(){this._jflowInstance.destroy(),this.removeFromStack(this._jflowInstance)},methods:{bindListeners:function(){var t=this;Object.keys(this.$listeners).map((function(e){var n=t.$listeners[e];t._jflowInstance.addEventListener(e,n)}))}}}},Xe=function(t,e){var n="string"===typeof t?i[t]:t;return{inject:["addToLinkStack","removeFromLinkStack","getJFlow"],props:{configs:{type:Object,default:function(){return{}}},from:Object,to:Object},render:function(t){return null},created:function(){var t=this.getJFlow(),e=t.getRenderNodeBySource(this.from),n=t.getRenderNodeBySource(this.to);this.createInstance(e,n)},mounted:function(){var t=this;this.unwatch=this.$watch((function(){return[t.from,t.to,t.configs]}),(function(){t.refreshConfig()}))},methods:{createInstance:function(t,e){t&&e&&(this._jflowInstance=new n(Object(ft["a"])(Object(ft["a"])({},this.configs),{},{from:t,to:e})),this.bindListeners(),this.addToLinkStack(this._jflowInstance,this.from,this.to))},refreshConfig:function(){var t=this.getJFlow(),e=t.getRenderNodeBySource(this.from),n=t.getRenderNodeBySource(this.to);this._jflowInstance?this._jflowInstance.setConfig(Object(ft["a"])(Object(ft["a"])({},this.configs),{},{from:e,to:n})):this.createInstance(e,n)},bindListeners:function(){var t=this;Object.keys(this.$listeners).map((function(e){var n=t.$listeners[e];t._jflowInstance.addEventListener(e,n)}))}},destroyed:function(){this.unwatch(),this._jflowInstance&&this.removeFromLinkStack(this._jflowInstance,this.from,this.to)}}},$e=(n("e9c4"),function(t){var e="string"===typeof t?i[t]:t;return{mixins:[Fe],inject:{addToBelongStack:{from:"addToStack"},removeFromBelongStack:{from:"removeFromStack"},renderJFlow:{from:"renderJFlow"}},render:function(t){return t("jflow-group",this.$slots.default)},props:{configs:{type:Object,default:function(){return{}}},visible:{type:Boolean,default:!0},source:{type:Object}},watch:{configs:function(t,e){JSON.stringify(t)!==JSON.stringify(e)&&this._jflowInstance.setConfig(t)},$listeners:function(t,e){var n=this,i=[],o=[],r=Object.keys(t).map((function(e){return{event:e,handler:t[e]}})),a=Object.keys(e).map((function(t){return{event:t,handler:e[t]}}));r.forEach((function(t){var e=t.handler;a.find((function(t){return t.handler===e}))||i.push(t)})),a.forEach((function(t){var e=t.handler;r.find((function(t){return t.handler===e}))||o.push(t)})),i.forEach((function(t){n._jflowInstance.addEventListener(t.event,t.handler)})),o.forEach((function(t){n._jflowInstance.removeEventListener(t.event,t.handler)}))},visible:function(t){this._jflowInstance.visible=t},source:function(t){this._jflowInstance._jflow.setRenderNodeBySource(t,this._jflowInstance)}},created:function(){var t=this;this._jflowInstance=new e(this.configs),this._jflowInstance.visible=this.visible,Object.keys(this.$listeners).map((function(e){var n=t.$listeners[e].bind(t);t._jflowInstance.addEventListener(e,n)})),this.addToBelongStack(this._jflowInstance,this.source)},mounted:function(){this._jflowInstance.recalculate()},updated:function(){this._jflowInstance.recalculateUp()},destroyed:function(){this._jflowInstance.destroy(),this.removeFromBelongStack(this._jflowInstance)}}}),ze=n("b1f8"),qe={mixins:[Fe],inject:{addToBelongStack:{from:"addToStack"},removeFromBelongStack:{from:"removeFromStack"},renderJFlow:{from:"renderJFlow"}},data:function(){return{nodes:[]}},props:{configs:{type:Object,default:function(){return{}}},visible:{type:Boolean,default:!0},source:{type:Object},genVueComponentKey:{type:Function}},watch:{configs:function(t,e){JSON.stringify(t)!==JSON.stringify(e)&&this._jflowInstance.setConfig(t)},$listeners:function(t,e){var n=this,i=[],o=[],r=Object.keys(t).map((function(e){return{event:e,handler:t[e]}})),a=Object.keys(e).map((function(t){return{event:t,handler:e[t]}}));r.forEach((function(t){var e=t.handler;a.find((function(t){return t.handler===e}))||i.push(t)})),a.forEach((function(t){var e=t.handler;r.find((function(t){return t.handler===e}))||o.push(t)})),i.forEach((function(t){n._jflowInstance.addEventListener(t.event,t.handler)})),o.forEach((function(t){n._jflowInstance.removeEventListener(t.event,t.handler)}))},visible:function(t){this._jflowInstance.visible=t},source:function(t){this._jflowInstance._jflow.setRenderNodeBySource(t,this._jflowInstance)}},created:function(){var t=this;this._jflowInstance=new Se(this.configs),this._jflowInstance.visible=this.visible,Object.keys(this.$listeners).map((function(e){var n=t.$listeners[e].bind(t);t._jflowInstance.addEventListener(e,n)})),this.addToBelongStack(this._jflowInstance,this.source),this.genTextElementMeta()},mounted:function(){this._jflowInstance.recalculate()},updated:function(){this._jflowInstance.recalculateUp()},destroyed:function(){this._jflowInstance.destroy(),this.removeFromBelongStack(this._jflowInstance)},render:function(t){var e=this;if(this.nodes.length){var n=this.nodes.map((function(t){var n=t.type,i=t.source;if(!e.$scopedSlots[n]){if(!e.$scopedSlots["jflowcommon"])return;Object(ze["a"])("type")}if(t.__vnode__)return t.__vnode__;var o=e.$scopedSlots[n]({source:i,textElement:t}),r=Object(a["a"])(o,1),s=r[0];return e.genVueComponentKey&&(s.key=e.genVueComponentKey(i)),t.__vnode__=s,s}));return t("div",n)}return t("jflow-group",this.$slots.default)},methods:{genTextElementMeta:function(){this.nodes=this._jflowInstance._textElements.filter((function(t){return"text"!==t.type}))},reflow:function(){var t=this;this._jflowInstance.refreshTextElements(),this.genTextElementMeta(),this.$nextTick((function(){t._jflowInstance.refresh()}))}}},Ge=["Point","Rectangle","Capsule","Diamond","Rhombus","Text","Icon","ShadowDom","TextEditor"],Ve=["Link","PolyLink","BezierLink"],Je=["CapsuleGroup","CapsuleVerticalGroup","DiamondGroup","DiamondVerticalGroup","RhombusGroup","PointGroup"],Ue=[{name:"Jflow",component:Ne},{name:"Group",component:$e("Group")}].concat(Object(r["a"])(Je.map((function(t){return{name:t,component:$e(t)}}))),Object(r["a"])(Ge.map((function(t){return{name:t,component:Ye(t)}}))),Object(r["a"])(Ve.map((function(t){return{name:t,component:Xe(t)}}))),[{name:"TextGroup",component:qe}]),Ke="j";customElements.define("jflow-group",function(t){Object(h["a"])(n,t);var e=Object(l["a"])(n);function n(){var t;return Object(s["a"])(this,n),t=e.call(this),t.attachShadow({mode:"open"}),t}return n}(Object(u["a"])(HTMLElement)));var Ze={install:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ke;e&&e.prefix&&(n=e.prefix),Ue.forEach((function(e){t.component("".concat(n).concat(e.name),e.component)})),e.customInstance&&Object.keys(e.customInstance).forEach((function(i){t.component("".concat(n).concat(i),Ye(e.customInstance[i]))})),e.customGroups&&Object.keys(e.customGroups).forEach((function(i){t.component("".concat(n).concat(i),$e(e.customGroups[i]))})),e.customLink&&Object.keys(e.customLink).forEach((function(i){t.component("".concat(n).concat(i),Xe(e.customLink[i]))}))}},Qe=n("f513");window.$jflow_version=Qe.version;var tn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.$style.body,attrs:{id:"app"}},[n("div",{class:t.$style.sidebar},[n("div",[n("div",{class:t.$style.part,attrs:{draggable:"true",type:"IfStatement"},on:{dragstart:t.onDragStartRectangle}},[t._v("IfStatement")])]),n("div",[n("div",{class:t.$style.part,attrs:{draggable:"true",type:"variable"},on:{dragstart:t.onDragStartPoint}},[t._v("Variable")])]),n("div",[n("div",{class:t.$style.part,attrs:{draggable:"true",type:"jsblock"},on:{dragstart:t.onDragjsBlock}},[t._v("jsBlock")])])]),n("div",{staticStyle:{position:"relative"}},[n("j-jflow",{ref:"jflow",class:t.$style.wrapper,attrs:{configs:t.configs,loading:t.jflowloading,genVueComponentKey:t.genVueComponentKey},on:{"update:loading":function(e){t.jflowloading=e},click:t.onClickNoWhere,drop:t.onDrop,pressEnd:t.onPressEnd},scopedSlots:t._u([{key:"start",fn:function(t){var e=t.source;return[n("j-start",{attrs:{node:e}})]}},{key:"end",fn:function(t){var e=t.source;return[n("j-end",{attrs:{node:e}})]}},{key:"variable",fn:function(e){var i=e.source;return[n("j-variable",{attrs:{node:i},on:{pressStart:function(e){return t.onPressStart(i)},outOfFlow:function(e){return t.onOutOfFlow(e,i)},change:function(e){return t.onChangeContent(e,i)}}})]}},{key:"IfStatement",fn:function(e){var i=e.source;return[n("j-ifstatement",{attrs:{node:i},on:{pressStart:function(e){return t.onPressStart(i)},outOfFlow:function(e){return t.onOutOfFlow(e,i)}}})]}},{key:"SwitchStatement",fn:function(e){var i=e.source;return[n("j-switch",{attrs:{node:i},on:{pressStart:function(e){return t.onPressStart(i)},outOfFlow:function(e){return t.onOutOfFlow(e,i)}}})]}},{key:"WhileStatement",fn:function(e){var i=e.source;return[n("j-whilestatement",{attrs:{node:i},on:{pressStart:function(e){return t.onPressStart(i)},outOfFlow:function(e){return t.onOutOfFlow(e,i)}}})]}},{key:"endpoint",fn:function(t){var e=t.source;return[n("j-endpoint",{attrs:{node:e}})]}},{key:"CallLogic",fn:function(e){var i=e.source;return[n("j-calllogic",{attrs:{node:i},on:{"toggle-select":function(e){return t.onToggleSelect(e,i)},pressStart:function(e){return t.onPressStart(i)},outOfFlow:function(e){return t.onOutOfFlow(e,i)}}})]}},{key:"JSblock",fn:function(e){var i=e.source;return[n("j-jsblock",{attrs:{node:i},on:{pressStart:function(e){return t.onPressStart(i)},outOfFlow:function(e){return t.onOutOfFlow(e,i)},demojsblock:t.onclickdemojsblock,change:function(e){return t.onContentChange(e,i)}}})]}},{key:"plainlink",fn:function(e){var i=e.configs;return[n("instance-link",{attrs:{linkConfigs:i},on:{drop:function(e){return t.onDropToLink(e,i)}}})]}}])}),t.isHover?n("div",{ref:"hoverblock",class:t.$style.hoverblock,style:"transform: translate("+t.offsetX+"px, "+t.offsetY+"px)"},[n("ul",t._l(t.logics,(function(e){return n("li",{key:e.content,on:{click:function(n){return t.onSelectLogic(e)}}},[t._v(t._s(e.content))])})),0)]):t._e()],1)])},en=[],nn=(n("53ca"),n("a15b"),n("dca8"),n("68ca")),on=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-diamond-group",t._g({attrs:{source:t.node,configs:t.groupConfig},on:{dblclick:t.onDbClick}},t.$listeners),[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:t.node.content,lineHeight:26,editable:!0}},on:{change:t.onContentChange}})],1)},rn=[],an={props:{node:Object},computed:{groupConfig:function(){return{layout:new re({direction:"horizontal",gap:0}),borderColor:"#517cff",borderWidth:2,borderRadius:5,padding:10}}},methods:{onContentChange:function(t){console.log(t.detail),this.$emit("change",{val:t.detail.val,oldVal:t.detail.oldVal})},onDbClick:function(t){console.log("dblclick")}}},sn=an,cn=n("2877"),hn=Object(cn["a"])(sn,on,rn,!1,null,null,null),ln=hn.exports,un=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-rhombus-group",t._g({attrs:{source:t.node,configs:t.groupConfig},on:{mouseenter:function(e){t.touch=!0},mouseleave:function(e){t.touch=!1},afterResolveMovingTarget:t.onAfterResolveMovingTarget}},t.$listeners),[n("j-point",{attrs:{configs:{backgroundColor:"#99DBC5",radius:8,borderColor:"#33B88C",borderWidth:2,absolutePosition:{top:10,right:10}}},on:{click:function(e){t.shrink=!t.shrink}}}),n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:"",lineHeight:26,absolutePosition:{top:-13}}}}),n("j-group",[t.shrink?n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:"ifstatement "+t.node.id,lineHeight:26,indent:10}}}):n("j-rectangle",{attrs:{configs:{backgroundColor:"#FAAAAA",width:36,height:72}}})],1)],1)},dn=[],fn={props:{node:Object,layoutNode:Object},inject:["renderJFlow"],data:function(){return{touch:!1,shrinkButton:{backgroundColor:"#99DBC5",radius:20,borderColor:"#33B88C"},shrink:!1}},computed:{groupConfig:function(){return{layout:new re({direction:"horizontal",gap:0}),borderColor:"#517cff",backgroundColor:this.touch?"red":"#fff",shadowColor:"#517cff",shadowBlur:15,borderWidth:2,borderRadius:5,padding:30,marginTop:30}}},watch:{shrink:function(t){console.log(t)},touch:function(t){console.log(t)}},updated:function(){this.renderJFlow()},methods:{onAfterResolveMovingTarget:function(t){var e=t.detail.jflow,n=e.getLayoutNodeBySource(this.node),i=n.getNodes(e);e.setMovingTargets(i)}}},gn=fn,vn=Object(cn["a"])(gn,un,dn,!1,null,null,null),pn=vn.exports,bn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",{attrs:{source:t.node,configs:t.configs}},[n("j-text",{ref:"start",attrs:{configs:{fontSize:"12px",textColor:"#000",content:"Start"}}}),n("j-point",{attrs:{configs:{backgroundColor:"#99DBC5",radius:20,borderColor:"#33B88C",borderWidth:2,shadowBlur:8,shadowColor:"rgba(0, 0, 0, 0.1)",shadowOffsetY:2,shadowOffsetX:0}}})],1)},mn=[],_n={props:{node:Object},data:function(){return{configs:{layout:new re({direction:"vertical",gap:10}),borderColor:"transparent",borderWidth:0}}}},wn=_n,yn=Object(cn["a"])(wn,bn,mn,!1,null,null,null),kn=yn.exports,jn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",{attrs:{source:t.node,configs:t.configs}},[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#000",content:"End"}}}),n("j-rectangle",{attrs:{configs:{backgroundColor:"#FAAAAA",width:36,height:36,borderRadius:8,borderWidth:2,borderColor:"#F55656",shadowBlur:8,shadowColor:"rgba(0, 0, 0, 0.1)",shadowOffsetY:2,shadowOffsetX:0}}})],1)},On=[],xn={props:{node:Object},data:function(){return{configs:{layout:new re({direction:"vertical",gap:0}),borderColor:"transparent",borderWidth:0}}}},Tn=xn,Sn=Object(cn["a"])(Tn,jn,On,!1,null,null,null),En=Sn.exports,Cn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-point",{attrs:{source:t.node,configs:{backgroundColor:"#fff",borderColor:"#000",borderWidth:1,radius:5,ignoreHit:!0}}})},Mn=[],In={props:{node:Object}},Bn=In,Ln=Object(cn["a"])(Bn,Cn,Mn,!1,null,null,null),Pn=Ln.exports,Dn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-capsule-vertical-group",t._g({attrs:{source:t.node,configs:t.configs},on:{afterResolveMovingTarget:t.onAfterResolveMovingTarget}},t.$listeners),[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:t.textColor,content:t.node.id}}}),t._l(t.node.cases,(function(t){return[n("j-switchcase",{key:t.id,attrs:{node:t}})]}))],2)},Rn=[],An=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-diamond-group",t._g({attrs:{source:t.node,configs:t.groupConfig,rootLink:!0}},t.$listeners),[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:t.node.content,lineHeight:26}}})],1)},Fn=[],Nn={props:{node:Object},computed:{groupConfig:function(){return{layout:new re({direction:"horizontal",gap:0}),borderColor:"#517cff",paddingTop:2,paddingBottom:2,padding:10,borderWidth:2,borderRadius:5}}}},Hn=Nn,Wn=Object(cn["a"])(Hn,An,Fn,!1,null,null,null),Yn=Wn.exports,Xn={components:{"j-switchcase":Yn},props:{node:Object},data:function(){return{textColor:"#585c63",configs:{layout:new re({direction:"vertical",gap:10}),borderColor:"#517cff",borderWidth:2,borderRadius:5,paddingTop:20,paddingBottom:20}}},methods:{onAfterResolveMovingTarget:function(t){var e=t.detail.jflow,n=e.getLayoutNodeBySource(this.node),i=n.getNodes(e);e.setMovingTargets(i)}}},$n=Xn,zn=Object(cn["a"])($n,Dn,Rn,!1,null,null,null),qn=zn.exports,Gn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-rhombus-group",t._g({attrs:{source:t.node,configs:t.groupConfig},on:{afterResolveMovingTarget:t.onAfterResolveMovingTarget}},t.$listeners),[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:t.node.content,lineHeight:26,indent:10}}})],1)},Vn=[],Jn={props:{node:Object},computed:{groupConfig:function(){return{layout:new re({direction:"horizontal",gap:0}),borderColor:"#517cff",borderWidth:2,borderRadius:5,padding:30}}},methods:{onAfterResolveMovingTarget:function(t){var e=t.detail.jflow,n=e.getLayoutNodeBySource(this.node),i=n.getNodes(e);e.setMovingTargets(i)}}},Un=Jn,Kn=Object(cn["a"])(Un,Gn,Vn,!1,null,null,null),Zn=Kn.exports,Qn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",t._g({attrs:{source:t.node,configs:t.configs}},t.$listeners),[n("j-group",{attrs:{configs:t.headerConfigs}},[n("j-icon",{attrs:{configs:t.imageConfig}}),n("j-text",{attrs:{configs:{fontSize:"16px",textColor:"#585c63",content:""}}})],1),n("j-group",{attrs:{configs:t.contentConfigs},on:{click:t.onClick}},[n("j-text",{attrs:{configs:{fontSize:"12px",textColor:"#585c63",content:t.node.content||""}}})],1),t.node.params&&t.node.params.length?[n("j-group",{ref:"paramGroup",attrs:{configs:t.paramsConfigs}},[n("j-text",{attrs:{configs:{fontSize:"16px",textColor:"#585c63",content:""}}}),t._l(t.node.params,(function(t){return n("j-text",{key:t.content,attrs:{configs:{fontSize:"16px",textColor:"#585c63",content:t.content}}})}))],2)]:t._e()],2)},ti=[],ei=n("8896"),ni=n.n(ei),ii=new Image;ii.src=ni.a;var oi={props:{node:Object},data:function(){return{configs:{layout:new re({direction:"vertical",gap:0,alignment:"start"}),padding:10,borderColor:"#517cff",borderWidth:2,borderRadius:12},headerConfigs:{layout:new re({direction:"horizontal",gap:0}),borderRadius:10,borderColor:"#ccc",borderWidth:0},contentConfigs:{layout:new re({direction:"horizontal",gap:0,justify:"start"}),borderColor:"#517cff",borderWidth:2,borderRadius:5,width:200,height:36},paramsConfigs:{layout:new re({direction:"vertical",gap:0,alignment:"end"}),borderColor:"transparent",hoverStyle:"transparent"},imageConfig:{image:ii,width:30,height:30}}},watch:{"node.params":function(t){var e=this;this.$nextTick((function(){if(e.$refs.paramGroup){var t=e.$refs.paramGroup._jflowInstance;t.recalculateUp(),t._jflow._render()}}))}},methods:{onClick:function(t){console.log(t),t.detail.bubbles=!1;var e=t.currentTarget,n=[-e.width/2,e.height/2];console.log(n);var i=e.calculateToRealWorld(n);this.$emit("toggle-select",i)}}},ri=oi,ai=Object(cn["a"])(ri,Qn,ti,!1,null,null,null),si=ai.exports,ci=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("jPolyLink",{attrs:{configs:t.configs,from:t.linkConfigs.from.source,to:t.linkConfigs.to.source},on:{dragenter:t.onDragEnter,dragleave:t.onDragOverEnd,drop:t.onDropToLink}})},hi=[],li={inject:["renderJFlow"],props:{linkConfigs:Object},data:function(){return{isDragOver:!1}},computed:{configs:function(){return Object(ft["a"])(Object(ft["a"])({},this.linkConfigs),{},{radius:5,approximate:400,backgroundColor:this.isDragOver?"rgba(81, 124, 255, 0.5)":"#000"})}},methods:{onDropToLink:function(t){this.$emit("drop",t),this.isDragOver=!1},onDragEnter:function(t){console.log("dragenter"),this.isDragOver=!0},onDragOverEnd:function(){console.log("onDragOverEnd"),this.isDragOver=!1}},updated:function(){this.renderJFlow()}},ui=li,di=Object(cn["a"])(ui,ci,hi,!1,null,null,null),fi=di.exports,gi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("j-group",t._g({attrs:{source:t.node,configs:t.configs},on:{click:t.onClick}},t.$listeners),[n("j-group",{attrs:{configs:t.headerConfigs}},[n("j-icon",{attrs:{configs:t.imageConfig}}),n("j-text",{attrs:{configs:{fontSize:"16px",textColor:"#585c63",content:"JS "}}})],1),n("j-shadow-dom",{attrs:{configs:t.editorRect}})],1)},vi=[],pi=new Image;pi.src=ni.a;var bi={props:{node:Object},data:function(){var t=this;return{configs:{layout:new re({direction:"vertical",gap:0,alignment:"start"}),padding:10,borderColor:"#517cff",borderWidth:2,borderRadius:12},headerConfigs:{layout:new re({direction:"horizontal",gap:0}),borderRadius:10,borderColor:"#ccc",borderWidth:0},contentConfigs:{layout:new re({direction:"horizontal",gap:0,justify:"start"}),borderColor:"#517cff",borderWidth:2,borderRadius:5,width:200,height:36},editorRect:{width:568,height:321,createDocument:function(e){var n=document.createElement("div");n.style.height="100%",n.style.background="#0d1117",n.style.color="#c9d1d9",n.innerText=t.node.content,n.setAttribute("contenteditable",!0),n.addEventListener("input",(function(){console.log(n.innerText),t.$emit("change",n.innerText)})),e.appendChild(n)}},imageConfig:{image:pi,width:30,height:30}}},watch:{"node.params":function(t){var e=this;this.$nextTick((function(){if(e.$refs.paramGroup){var t=e.$refs.paramGroup._jflowInstance;t.recalculateUp(),t._jflow._render()}}))}},methods:{onClick:function(t){console.log(t),this.$emit("demojsblock")}}},mi=bi,_i=Object(cn["a"])(mi,gi,vi,!1,null,null,null),wi=_i.exports;console.log(At);var yi=0,ki=0;function ji(){return ki++}function Oi(t){var e={type:"Root",body:[{type:"start",id:"start"}],playground:[]};function n(){var t=ji();return{type:"variable",content:"variable-".concat(t),id:"variable".concat(t)}}function i(){var t=ji();return{type:"CallLogic",id:"CallLogic-".concat(t),content:"CallLogic-".concat(t),params:[]}}function o(){var t=ji();return{type:"IfStatement",content:"IfStatement-".concat(t),id:"IfStatement-".concat(t),consequent:[n()],alternate:[n()]}}var r=e.body;function a(){var t,e=Math.floor(10*Math.random());switch(e){case 0:case 1:t=o(),r.push(t);var a=Math.floor(2*Math.random());r=0===a?t.consequent:t.alternate;break;case 2:case 3:case 4:case 5:t=i(),r.push(t);break;case 6:case 7:case 8:case 9:t=n(),r.push(t);break}}while(t--)a();return e}Oi(1e3);var xi={components:{"j-variable":ln,"j-start":kn,"j-end":En,"j-endpoint":Pn,"j-switch":qn,"j-ifstatement":pn,"j-whilestatement":Zn,"j-calllogic":si,"j-jsblock":wi,instanceLink:fi},provide:function(){return{renderJFlow:this.renderJFlow}},data:function(){var t={type:"Root",body:[{type:"start",id:"start"},{type:"variable",content:"vvvkjhkjhvvvv",id:"logic5"},{type:"IfStatement",content:"ggggggg",id:"logic6",consequent:[{type:"variable",content:"jkhvvvv",id:"logic77"}],alternate:[{type:"variable",content:"yuuo",id:"logic88"}]},{type:"end",id:"end"}],playground:[]},e=new _e({linkLength:60,ast:t});this.ast=t;var n=Object.freeze({allowDrop:!0,layout:e,initialZoom:1,minZoom:.2,setInitialPosition:function(t,e,n,i,o,r,a,s){return{x:t+a/2,y:r}}});return{configs:n,isHover:!1,offsetX:0,offsetY:0,currentTarget:null,prepareBody:[],jflowloading:!1,logics:[{content:"aaa",params:[{content:"p1"}]},{content:"vvvv",params:[{content:"p1"},{content:"p2"}]},{content:"sadasdf",params:[{content:"p1"}]},{content:"ggggg",params:[{content:"p1"},{content:"p2"},{content:"p3"}]}],currentEditingTarget:null}},computed:{inflowInstances:function(){return this.ast.body.filter((function(t){return!t.outflow}))}},watch:{jflowloading:function(t){console.log(Date.now()),console.log(t)}},methods:{prettyJson:function(){return nn["a"].toHtml(this.ast)},onDragStartRectangle:function(){var t=this.$refs.jflow.getInstance();t.sendMessage({instance:{type:"IfStatement",content:"IfStatement-rec".concat(yi++),id:"IfStatement-rec".concat(yi++),consequent:[],alternate:[]}})},onDragStartPoint:function(){var t=this.$refs.jflow.getInstance();t.sendMessage({instance:{type:"variable",content:"vvvvvvdasdfasfd",id:"logic-point".concat(yi++)}})},onDragjsBlock:function(){var t=this.$refs.jflow.getInstance();t.sendMessage({instance:{type:"JSblock",id:"JSblock-".concat(yi++),content:'function(args) {\n                        console.log("hello world!");\n                    }'}})},onOutOfFlow:function(t,e){var n=this.$refs.jflow.getInstance(),i=n.getLayoutNodeBySource(e);i.remove(),this.ast.playground.push(e),this.configs.layout.reOrder(this.ast),this.$refs.jflow.reflow(),n.getRenderNodeBySource(e).anchor=t.detail.point},onDrop:function(t){var e=this.$refs.jflow.getInstance(),n=t.detail.instance;this.ast.playground.push(n),this.configs.layout.reOrder(this.ast),this.$refs.jflow.reflow((function(){e.getRenderNodeBySource(n).anchor=t.detail.point}))},onClick:function(t){var e=t.currentTarget,n=[0,e.height/2],i=e.calculateToRealWorld(n),o=Object(a["a"])(i,2),r=o[0],s=o[1];this.isHover=!this.isHover,this.offsetX=r,this.offsetY=s},onPressStart:function(t){this.currentTarget=t},onPressEnd:function(){this.currentTarget=null},onDropToLink:function(t,e){var n=this.$refs.jflow.getInstance(),i=t.detail.instance;if(this.currentTarget){i=this.currentTarget;var o=n.getLayoutNodeBySource(i);o.remove()}e.from.linkSource(i,e),this.configs.layout.reOrder(this.ast),this.$refs.jflow.reflow()},onToggleSelect:function(t,e){var n=Object(a["a"])(t,2),i=n[0],o=n[1];this.offsetX=i,this.offsetY=o,this.isHover=!this.isHover,this.isHover?this.currentEditingTarget=e:this.currentEditingTarget=null},onSelectLogic:function(t){this.isHover=!1,console.log(this.currentEditingTarget),this.currentEditingTarget.content=t.content,this.currentEditingTarget.params=t.params},onClickNoWhere:function(){this.isHover=!1,this.currentEditingTarget=null},onChangeContent:function(t,e){e.content=t.val},renderJFlow:function(){this.$refs.jflow.renderJFlow()},onclickdemojsblock:function(){this.ast.body.splice(1,1),this.configs.layout.reOrder(this.ast),this.$refs.jflow.reflow()},onContentChange:function(t,e){e.content=t,console.log(t,e)},genVueComponentKey:function(t){return t.id}}},Ti=xi,Si=n("5bb9");function Ei(t){this["$style"]=Si["default"].locals||Si["default"]}var Ci=Object(cn["a"])(Ti,tn,en,!1,Ei,null,null),Mi=Ci.exports;o["a"].config.productionTip=!1,o["a"].use(Ze),new o["a"]({render:function(t){return t(Mi)}}).$mount("#app")},"5bb9":function(t,e,n){"use strict";var i=n("a7d4"),o=n.n(i);n.d(e,"default",(function(){return o.a}))},8896:function(t,e,n){t.exports=n.p+"img/logic.17805d7a.svg"},a7d4:function(t,e,n){t.exports={app:"App_app_3cl75",wrapper:"App_wrapper_pE_0j",body:"App_body_1uhyl",sidebar:"App_sidebar_3dMLz",rect:"App_rect_2g-OE",part:"App_part_1uPSl",circle:"App_circle_2pifB",ast:"App_ast_3JyD2",hide:"App_hide_1hYJ-",hoverblock:"App_hoverblock_rjKeE"}},f513:function(t){t.exports=JSON.parse('{"name":"@joskii/jflow","version":"0.1.21-beta","description":"","main":"src/index.js","files":["dist/*.js"],"scripts":{"dev:demo":"cd demo/vue-scopedslots && npm run serve","build:doc":"rm -rf docs && cd jsdoc-plugin && npm run build && cd ../demo/vue-scopedslots && npm run build && cd ../../ && npm run build:jsdoc","build:jsdoc":"rm -rf docs &&  jsdoc -c conf.json -t ~/Documents/Source-Codes/docstrap/template -R README.md -r . && mv out docs","build:lib":"webpack --config configs/webpack.lib.config.js"},"author":"","license":"ISC","dependencies":{"bezier-js":"^4.1.1","object-diff":"0.0.4"},"peerDependencies":{"vue":"^2.6.11"},"devDependencies":{"@babel/core":"^7.17.5","@babel/preset-env":"^7.16.11","@vue/compiler-sfc":"^3.2.26","babel-loader":"^8.2.3","ink-docstrap":"^1.3.2","jsdoc":"^3.6.7","jsdoc-vuejs":"^4.0.0","webpack":"^5.70.0","webpack-cli":"^4.9.2"}}')}});
//# sourceMappingURL=app.185c5786.js.map